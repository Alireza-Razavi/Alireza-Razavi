# Report

Audit report for **2023-11-shellprotocol** generated by *ubl4nk_bot*.

## Medium Issues


*Total <b>10</b> instances over <b>3</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [M-1](#M-1) | `call()` should be used instead of `transfer()`/`send()` on an address payable | 1 |
| [M-2](#M-2) | Return values of `approve()` not checked | 4 |
| [M-3](#M-3) | Centralization Risk for trusted owners | 5 |

## Low Issues


*Total <b>113</b> instances over <b>23</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Missing zero address check in functions with address parameters | 20 |
| [L-2](#L-2) | Use `increaseAllowance()`/`decreaseAllowance()` instead of `approve()`/`safeApprove()` | 4 |
| [L-3](#L-3) | Division by zero not prevented | 1 |
| [L-4](#L-4) | Constructor / initialization function lacks parameter validation | 3 |
| [L-5](#L-5) | Empty `receive()`/`fallback()` function | 1 |
| [L-6](#L-6) | Enum values should be used instead of constant array indexes | 5 |
| [L-7](#L-7) | Code does not follow the best practice of check-effects-interaction | 26 |
| [L-8](#L-8) | Large approvals may not work with some `ERC20` tokens | 4 |
| [L-9](#L-9) | Missing checks for state variable assignments | 4 |
| [L-10](#L-10) | Missing zero address check in constructor | 3 |
| [L-11](#L-11) | Consider some checks for `address(0)` when setting address state variables | 2 |
| [L-12](#L-12) | Numbers downcast to `address`es may result in collisions | 1 |
| [L-13](#L-13) | `receive()`/`fallback()` function does not authorize requests | 1 |
| [L-14](#L-14) | Solidity version 0.8.20 or above may not work on other chains due to PUSH0 | 4 |
| [L-15](#L-15) | Some tokens may revert when large transfers are made | 2 |
| [L-16](#L-16) | Some tokens may revert when zero value transfers are made | 2 |
| [L-17](#L-17) | Unsafe downcast | 1 |
| [L-18](#L-18) | Consider using `ERC721A` instead of `ERC721` | 1 |
| [L-19](#L-19) | Using zero as a parameter | 17 |
| [L-20](#L-20) | Vulnerable versions of packages are being used | 1 |
| [L-21](#L-21) |  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()` | 1 |
| [L-22](#L-22) | `decimals()` is not a part of the ERC-20 standard | 8 |
| [L-23](#L-23) | Empty body - Consider commenting why | 1 |

## Non Critical Issues


*Total <b>544</b> instances over <b>78</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | `abi.encodePacked()` should be replaced with `bytes.concat()` | 1 |
| [NC-2](#NC-2) | Add inline comments for unnamed variables | 5 |
| [NC-3](#NC-3) | `assert()` should be replaced with `require()` or `revert()` | 4 |
| [NC-4](#NC-4) | Complex casting | 3 |
| [NC-5](#NC-5) | Consider adding a block/deny-list | 4 |
| [NC-6](#NC-6) | Consider adding emergency-stop functionality | 3 |
| [NC-7](#NC-7) | Consider adding formal verification proofs | 1 |
| [NC-8](#NC-8) | Consider bounding input array length | 1 |
| [NC-9](#NC-9) | Consider using descriptive `constant`s when passing zero as a function argument | 18 |
| [NC-10](#NC-10) | Constant redefined elsewhere | 1 |
| [NC-11](#NC-11) | Constants should be put on the left side of comparisons | 3 |
| [NC-12](#NC-12) | Contract does not follow the Solidity Style Guide's suggested layout ordering | 19 |
| [NC-13](#NC-13) | Contract should expose an `interface` | 13 |
| [NC-14](#NC-14) | Contracts should each be defined in separate files | 2 |
| [NC-15](#NC-15) | Contracts should have full test coverage | 1 |
| [NC-16](#NC-16) | Convert simple `if` statements to ternary expressions | 2 |
| [NC-17](#NC-17) | Events that mark critical parameter changes should contain both the old and the new value | 22 |
| [NC-18](#NC-18) | Custom errors has no error details | 4 |
| [NC-19](#NC-19) | Duplicated `require()`/`revert()` checks should be refactored | 1 |
| [NC-20](#NC-20) | `else` block not required | 5 |
| [NC-21](#NC-21) | Empty bytes check is missing | 4 |
| [NC-22](#NC-22) | Enable IR-based code generation | 1 |
| [NC-23](#NC-23) | Names of structs, events, enums and errors should use CapWords style | 4 |
| [NC-24](#NC-24) | Events are emitted without the sender information | 7 |
| [NC-25](#NC-25) | Events may be emitted out of order due to reentrancy | 14 |
| [NC-26](#NC-26) |  Function ordering does not follow the Solidity Style Guide | 11 |
| [NC-27](#NC-27) | Functions with array parameters should have length checks in place | 3 |
| [NC-28](#NC-28) | High cyclomatic complexity | 4 |
| [NC-29](#NC-29) | Variable names for `immutable`s should use CONSTANT_CASE | 9 |
| [NC-30](#NC-30) | Import declarations should import specific identifiers, rather than the whole file | 6 |
| [NC-31](#NC-31) | Inconsistent spacing in comments | 14 |
| [NC-32](#NC-32) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-33](#NC-33) | Large numeric literals should use underscores for readability | 1 |
| [NC-34](#NC-34) | Long functions should be refactored into multiple, smaller, functions | 4 |
| [NC-35](#NC-35) | Magic numbers should be replaced with constants | 11 |
| [NC-36](#NC-36) | Missing disallow list for `ERC721` | 1 |
| [NC-37](#NC-37) | Consider moving `msg.sender` checks to `modifier`s | 1 |
| [NC-38](#NC-38) | Named mappings are recommended | 5 |
| [NC-39](#NC-39) | Named imports of parent contracts are missing | 3 |
| [NC-40](#NC-40) | Missing NatSpec from contract declarations | 1 |
| [NC-41](#NC-41) | Missing NatSpec `@author` from contract declaration | 4 |
| [NC-42](#NC-42) | Missing NatSpec `@dev` from contract declaration | 4 |
| [NC-43](#NC-43) | Missing NatSpec `@dev` from event declaration | 19 |
| [NC-44](#NC-44) | Missing NatSpec `@dev` from function declaration | 18 |
| [NC-45](#NC-45) | Missing NatSpec `@dev` from modifier declaration | 1 |
| [NC-46](#NC-46) | Error declarations should have NatSpec descriptions | 4 |
| [NC-47](#NC-47) | Event declarations should have NatSpec descriptions | 19 |
| [NC-48](#NC-48) | NatSpec documentation for function is missing | 7 |
| [NC-49](#NC-49) | Missing NatSpec `@notice` from contract declaration | 2 |
| [NC-50](#NC-50) | Missing NatSpec `@notice` from event declaration | 19 |
| [NC-51](#NC-51) | Missing NatSpec `@notice` from function declaration | 38 |
| [NC-52](#NC-52) | Missing NatSpec `@notice` from modifier declaration | 1 |
| [NC-53](#NC-53) | Missing NatSpec `@param` from event declaration | 19 |
| [NC-54](#NC-54) | Missing NatSpec `@param` from function declaration | 27 |
| [NC-55](#NC-55) | Missing NatSpec `@return` from function declaration | 22 |
| [NC-56](#NC-56) | Missing NatSpec `@title` from contract declaration | 4 |
| [NC-57](#NC-57) | There is no need to initialize variables with 0 | 2 |
| [NC-58](#NC-58) | Put all system-wide constants in one file | 6 |
| [NC-59](#NC-59) | Redundant `return` statement in a function with named return variables | 3 |
| [NC-60](#NC-60) | State variables should include comments | 7 |
| [NC-61](#NC-61) | Lines are too long | 1 |
| [NC-62](#NC-62) | Typos | 3 |
| [NC-63](#NC-63) | Unused arguments should be removed or implemented | 6 |
| [NC-64](#NC-64) | Unused import | 1 |
| [NC-65](#NC-65) | Unused named return | 7 |
| [NC-66](#NC-66) | Expressions for constant values should use `immutable` rather than `constant` | 6 |
| [NC-67](#NC-67) | Use `@inheritdoc` for overridden functions | 7 |
| [NC-68](#NC-68) | Upgrade `openzeppelin` to the latest version (`5.0.0`) | 1 |
| [NC-69](#NC-69) | Use the latest solidity version for deployment (`0.8.23`) | 4 |
| [NC-70](#NC-70) | Use of `override` is unnecessary | 7 |
| [NC-71](#NC-71) | Returning a struct instead of a bunch of variables is better | 7 |
| [NC-72](#NC-72) | Visibility of state variables is not explicitly defined | 12 |
| [NC-73](#NC-73) | Common functions should be refactored to a common base contract | 4 |
| [NC-74](#NC-74) | Names of `private`/`internal` functions should be prefixed with an underscore | 9 |
| [NC-75](#NC-75) | Names of `private`/`internal` state variables should be prefixed with an underscore | 10 |
| [NC-76](#NC-76) |  `require()` / `revert()` statements should have descriptive reason strings | 1 |
| [NC-77](#NC-77) | Event is missing `indexed` fields | 13 |
| [NC-78](#NC-78) | Functions not used internally could be marked `external` | 1 |

## Gas Optimizations


*Total <b>176</b> instances over <b>30</b> issues:*

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Optimize gas by using do-while loops | 2 | 510 |
| [GAS-2](#GAS-2) | Consider activating via-ir for deploying | 1 | - |
| [GAS-3](#GAS-3) | Divisions can be `unchecked` to save gas | 4 | 80 |
| [GAS-4](#GAS-4) | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas | 1 | - |
| [GAS-5](#GAS-5) | `internal` functions only called once can be inlined to save gas | 11 | 330 |
| [GAS-6](#GAS-6) | Newer versions of solidity are more gas efficient | 4 | - |
| [GAS-7](#GAS-7) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 16 | 48 |
| [GAS-8](#GAS-8) | Optimize names to save gas | 1 | 22 |
| [GAS-9](#GAS-9) | The result of a function call should be cached rather than re-calling the function | 6 | 600 |
| [GAS-10](#GAS-10) | Unused named return variables without optimizer waste gas | 7 | 63 |
| [GAS-11](#GAS-11) | Optimize external calls with assembly for memory efficiency | 22 | 4840 |
| [GAS-12](#GAS-12) | Use assembly to compute hashes to save gas | 1 | 80 |
| [GAS-13](#GAS-13) | Use assembly to emit events | 22 | 836 |
| [GAS-14](#GAS-14) | Use assembly to validate `msg.sender` | 1 | - |
| [GAS-15](#GAS-15) | Use assembly to write address/contract type storage values | 2 | 100 |
| [GAS-16](#GAS-16) | Using a double `if` statement instead of a logical AND (`&&`) | 15 | 450 |
| [GAS-17](#GAS-17) | Use local variables for emitting | 1 | 97 |
| [GAS-18](#GAS-18) | Use a more recent version of solidity | 4 | - |
| [GAS-19](#GAS-19) | Use `unchecked` block for safe subtractions | 5 | 425 |
| [GAS-20](#GAS-20) | Using `constant`s directly, rather than caching the value, saves gas | 6 | - |
| [GAS-21](#GAS-21) | Using `this` to access functions results in an external call, wasting gas | 1 | 100 |
| [GAS-22](#GAS-22) | Use `selfbalance()` instead of `address(this).balance` | 1 | - |
| [GAS-23](#GAS-23) | Cache array length outside of loop | 1 | - |
| [GAS-24](#GAS-24) | State variables should be cached in stack variables rather than re-reading them from storage | 11 | 1067 |
| [GAS-25](#GAS-25) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 2 | - |
| [GAS-26](#GAS-26) | Don't initialize variables with default value | 2 | - |
| [GAS-27](#GAS-27) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 18 | 990 |
| [GAS-28](#GAS-28) | Constructors can be marked as `payable` to save deployment gas | 4 | 84 |
| [GAS-29](#GAS-29) | Functions guaranteed to revert when called by normal users can be marked `payable` | 1 | 21 |
| [GAS-30](#GAS-30) | Using assembly to check for zero can save gas | 3 | 18 |

## Medium Issues

<a name="M-1"></a> 
### [M-1] `call()` should be used instead of `transfer()`/`send()` on an address payable
The `transfer()` and `send()` functions forward a fixed amount of 2300 gas. Historically, it has often been recommended to use these functions for value transfers to guard against reentrancy attacks. However, the gas cost of EVM instructions may change significantly during hard forks which may break already deployed contract systems that make fixed assumptions about gas costs. For example. EIP 1884 broke several existing smart contracts due to a cost increase of the `SLOAD` instruction.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

982:         payable(userAddress).transfer(transferAmount);

```
*Github:* [[982](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L982)]



<a name="M-2"></a> 
### [M-2] Return values of `approve()` not checked
Not all IERC20 implementations `revert()` when there's a failure in `approve()`. The function signature has a boolean return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually approving anything

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

190:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

191:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[190](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L190), [191](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L191)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

242:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

243:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[242](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L242), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L243)]



<a name="M-3"></a> 
### [M-3] Centralization Risk for trusted owners
Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

55:     function computeOutputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 inputAmount,
            address,
            bytes32 metadata
        )
            external
            override
            onlyOcean

81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean

```
*Github:* [[55](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L55), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81)]


```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

256:     function forwardedDoInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)

281:     function forwardedDoMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281)]




## Low Issues

<a name="L-1"></a> 
### [L-1] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: src/adapters/OceanAdapter.sol

/// @audit missing zero check for `userAddress`
81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean
            returns (uint256 inputAmount)
        {

/// @audit missing zero check for `tokenAddress`
108:     function _calculateOceanId(address tokenAddress, uint256 tokenId) internal pure returns (uint256) {

/// @audit missing zero check for ``
/// @audit missing zero check for ``
117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

```
*Github:* [[81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L108), [117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117)]


```solidity
File: src/ocean/Ocean.sol

/// @audit missing zero check for ``
/// @audit missing zero check for ``
309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

/// @audit missing zero check for ``
/// @audit missing zero check for ``
326:     function onERC1155Received(
             address,
             address,
             uint256,
             uint256,
             bytes calldata
         )
             external
             view
             override
             returns (bytes4)
         {

/// @audit missing zero check for ``
/// @audit missing zero check for ``
353:     function onERC1155BatchReceived(
             address,
             address,
             uint256[] calldata,
             uint256[] calldata,
             bytes calldata
         )
             external
             pure
             override
             returns (bytes4)
         {

/// @audit missing zero check for `userAddress`
380:     function _doInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

/// @audit missing zero check for `userAddress`
445:     function _doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             internal
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit missing zero check for `externalContract`
/// @audit missing zero check for `userAddress`
597:     function _executeInteraction(
             Interaction memory interaction,
             InteractionType interactionType,
             address externalContract,
             uint256 specifiedToken,
             uint256 specifiedAmount,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

/// @audit missing zero check for `externalContract`
700:     function _getSpecifiedToken(
             InteractionType interactionType,
             address externalContract,
             Interaction memory interaction
         )
             internal
             view
             returns (uint256 specifiedToken)
         {

/// @audit missing zero check for `userAddress`
745:     function _computeOutputAmount(
             address primitive,
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             address userAddress,
             bytes32 metadata
         )
             internal
             returns (uint256 outputAmount)
         {

/// @audit missing zero check for `userAddress`
786:     function _computeInputAmount(
             address primitive,
             uint256 inputToken,
             uint256 outputToken,
             uint256 outputAmount,
             address userAddress,
             bytes32 metadata
         )
             internal
             returns (uint256 inputAmount)
         {

/// @audit missing zero check for `userAddress`
820:     function _erc20Wrap(address tokenAddress, uint256 amount, address userAddress, uint256 outputToken) private {

/// @audit missing zero check for `userAddress`
864:     function _erc20Unwrap(address tokenAddress, uint256 amount, address userAddress, uint256 inputToken) private {

/// @audit missing zero check for `userAddress`
889:     function _erc721Wrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

/// @audit missing zero check for `userAddress`
903:     function _erc721Unwrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

/// @audit missing zero check for `userAddress`
920:     function _erc1155Wrap(
             address tokenAddress,
             uint256 tokenId,
             uint256 amount,
             address userAddress,
             uint256 oceanId
         )
             private
         {

/// @audit missing zero check for `userAddress`
955:     function _erc1155Unwrap(
             address tokenAddress,
             uint256 tokenId,
             uint256 amount,
             address userAddress,
             uint256 oceanId
         )
             private
         {

/// @audit missing zero check for `primitive`
1004:     function _increaseBalanceOfPrimitive(address primitive, uint256 inputToken, uint256 inputAmount) internal {

/// @audit missing zero check for `primitive`
1038:     function _decreaseBalanceOfPrimitive(address primitive, uint256 outputToken, uint256 outputAmount) internal {

```
*Github:* [[309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353), [380](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L380), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [597](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L597), [700](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L700), [745](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L745), [786](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L786), [820](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L820), [864](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L864), [889](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L889), [903](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L903), [920](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L920), [955](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L955), [1004](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1004), [1038](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1038)]


</details>


<a name="L-2"></a> 
### [L-2] Use `increaseAllowance()`/`decreaseAllowance()` instead of `approve()`/`safeApprove()`
Changing an allowance with approve() brings the risk that someone may use both the old and the new allowance by unfortunate transaction ordering. Refer to [ERC20 API: An Attack Vector on the Approve/TransferFrom Methods](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM). It is recommended to use the `increaseAllowance()`/`decreaseAllowance()` to avoid ths problem.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

190:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

191:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[190](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L190), [191](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L191)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

242:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

243:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[242](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L242), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L243)]



<a name="L-3"></a> 
### [L-3] Division by zero not prevented
The divisions below take an input parameter that has no zero-value checks, which can cause the functions reverting if zero is passed.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `unwrapFeeDivisor`
1159:         feeCharged = unwrapAmount / unwrapFeeDivisor;

```
*Github:* [[1159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1159)]



<a name="L-4"></a> 
### [L-4] Constructor / initialization function lacks parameter validation
Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `ocean_` not validated
77:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[77](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L77)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `ocean_` not validated
/// @audit `primitive_` not validated
85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `ocean_` not validated
/// @audit `primitive_` not validated
32:     constructor(address ocean_, address primitive_) {

```
*Github:* [[32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L32)]



<a name="L-5"></a> 
### [L-5] Empty `receive()`/`fallback()` function
If the intention is for Ether sent by a caller to be used for an actual purpose (i.e. the function is not just a WETH `withdraw()` handler), the function should call another function (e.g. call `weth.deposit()` and use the token on the caller's behalf) or at least emit an event to track that funds were sent directly to it.

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

291:     fallback() external payable { }

```
*Github:* [[291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]



<a name="L-6"></a> 
### [L-6] Enum values should be used instead of constant array indexes
Create a commented enum value to use instead of constant array indexes, this makes the code far easier to understand.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

557:                 _mint(userAddress, mintIds[0], mintAmounts[0]);

557:                 _mint(userAddress, mintIds[0], mintAmounts[0]);

567:                 _burn(userAddress, burnIds[0], burnAmounts[0]);

567:                 _burn(userAddress, burnIds[0], burnAmounts[0]);

688:         interactionType = InteractionType(uint8(interactionTypeAndAddress[0]));

```
*Github:* [[557](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L557), [557](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L557), [567](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L567), [567](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L567), [688](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L688)]



<a name="L-7"></a> 
### [L-7] Code does not follow the best practice of check-effects-interaction
Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

<details>
<summary>
There are <b>26</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `.coins(...)` is called on line 78
79:         xToken = _calculateOceanId(xTokenAddress, 0);

/// @audit `.coins(...)` is called on line 78
80:         underlying[xToken] = xTokenAddress;

/// @audit `.coins(...)` is called on line 78
81:         decimals[xToken] = IERC20Metadata(xTokenAddress).decimals();

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
85:         yToken = _calculateOceanId(yTokenAddress, 0);

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
86:         indexOf[yToken] = int128(1);

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
87:         underlying[yToken] = yTokenAddress;

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
88:         decimals[yToken] = IERC20Metadata(yTokenAddress).decimals();

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
/// @audit `.decimals(...)` is called on line 88
91:         lpTokenId = _calculateOceanId(primitive_, 0);

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
/// @audit `.decimals(...)` is called on line 88
92:         underlying[lpTokenId] = primitive_;

/// @audit `.coins(...)` is called on line 78
/// @audit `.decimals(...)` is called on line 81
/// @audit `.coins(...)` is called on line 84
/// @audit `.decimals(...)` is called on line 88
93:         decimals[lpTokenId] = IERC20Metadata(primitive_).decimals();

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L79), [80](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L80), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L81), [85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L85), [86](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L86), [87](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L87), [88](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L88), [91](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L91), [92](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L92), [93](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L93)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `.coins(...)` is called on line 86
87:         xToken = _calculateOceanId(xTokenAddress, 0);

/// @audit `.coins(...)` is called on line 86
88:         underlying[xToken] = xTokenAddress;

/// @audit `.coins(...)` is called on line 86
89:         decimals[xToken] = IERC20Metadata(xTokenAddress).decimals();

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
93:         yToken = _calculateOceanId(yTokenAddress, 0);

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
94:         indexOf[yToken] = 1;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
95:         underlying[yToken] = yTokenAddress;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
96:         decimals[yToken] = IERC20Metadata(yTokenAddress).decimals();

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
100:         zToken = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
101:         indexOf[zToken] = 2;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
102:         underlying[zToken] = wethAddress;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
103:         decimals[zToken] = NORMALIZED_DECIMALS;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
/// @audit `.token(...)` is called on line 106
107:         lpTokenId = _calculateOceanId(lpTokenAddress, 0);

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
/// @audit `.token(...)` is called on line 106
108:         underlying[lpTokenId] = lpTokenAddress;

/// @audit `.coins(...)` is called on line 86
/// @audit `.decimals(...)` is called on line 89
/// @audit `.coins(...)` is called on line 92
/// @audit `.decimals(...)` is called on line 96
/// @audit `.coins(...)` is called on line 99
/// @audit `.token(...)` is called on line 106
109:         decimals[lpTokenId] = IERC20Metadata(lpTokenAddress).decimals();

```
*Github:* [[87](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L87), [88](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L88), [89](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L89), [93](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L93), [94](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L94), [95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L95), [96](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L96), [100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L100), [101](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L101), [102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L102), [103](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L103), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L107), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L108), [109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L109)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `.safeTransferFrom(...)` is called on line 891
892:         _ERC721InteractionStatus = NOT_INTERACTION;

/// @audit `.safeTransferFrom(...)` is called on line 931
932:         _ERC1155InteractionStatus = NOT_INTERACTION;

```
*Github:* [[892](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L892), [932](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L932)]


</details>


<a name="L-8"></a> 
### [L-8] Large approvals may not work with some `ERC20` tokens
Not all `IERC20` implementations are totally compliant, and some (e.g `UNI`, `COMP`) may fail if the valued passed to `approve` is larger than `uint96`. If the approval amount is `type(uint256).max`, which may cause issues with systems that expect the value passed to approve to be reflected in the allowances mapping.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

190:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

191:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[190](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L190), [191](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L191)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

242:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

243:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[242](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L242), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L243)]



<a name="L-9"></a> 
### [L-9] Missing checks for state variable assignments
There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `primitive_`
92:         underlying[lpTokenId] = primitive_;

```
*Github:* [[92](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L92)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `ocean_`
33:         ocean = ocean_;

/// @audit `primitive_`
34:         primitive = primitive_;

```
*Github:* [[33](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L33), [34](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L34)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `nextUnwrapFeeDivisor`
200:         unwrapFeeDivisor = nextUnwrapFeeDivisor;

```
*Github:* [[200](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L200)]



<a name="L-10"></a> 
### [L-10] Missing zero address check in constructor
Constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a checking, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could be due to an error or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it will be irretrievable. It's therefore crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit missing zero check for `ocean_`
77:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[77](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L77)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit missing zero check for `ocean_`
/// @audit missing zero check for `primitive_`
85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit missing zero check for `ocean_`
/// @audit missing zero check for `primitive_`
32:     constructor(address ocean_, address primitive_) {

```
*Github:* [[32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L32)]



<a name="L-11"></a> 
### [L-11] Consider some checks for `address(0)` when setting address state variables
Check for zero-address to avoid the risk of setting `address(0)` for state variables after an update.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `ocean_`
33:         ocean = ocean_;

/// @audit `primitive_`
34:         primitive = primitive_;

```
*Github:* [[33](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L33), [34](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L34)]



<a name="L-12"></a> 
### [L-12] Numbers downcast to `address`es may result in collisions
If a number is downcast to an `address` the upper bytes are truncated, which may mean that more than one value will map to the `address`.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

689:         externalContract = address(uint160(uint256(interactionTypeAndAddress)));

```
*Github:* [[689](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L689)]



<a name="L-13"></a> 
### [L-13] `receive()`/`fallback()` function does not authorize requests
Having no access control on the function (e.g. `require(msg.sender == address(weth))`) means that someone may send Ether to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue mistakenly-sent Ether.

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

291:     fallback() external payable { }

```
*Github:* [[291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]



<a name="L-14"></a> 
### [L-14] Solidity version 0.8.20 or above may not work on other chains due to PUSH0
Solidity version 0.8.20 or above uses the new [Shanghai EVM](https://blog.soliditylang.org/2023/05/10/solidity-0.8.20-release-announcement/#important-note) which introduces the PUSH0 opcode. This op code may not yet be implemented on all evm-chains or Layer2s, so deployment on these chains will fail. Consider using an earlier solidity version.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L4)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L4)]


```solidity
File: src/adapters/OceanAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L4)]


```solidity
File: src/ocean/Ocean.sol

6: pragma solidity 0.8.20;

```
*Github:* [[6](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L6)]



<a name="L-15"></a> 
### [L-15] Some tokens may revert when large transfers are made
Tokens such as COMP or UNI will revert when an address' balance reaches `type(uint96).max`. Ensure that the calls below can be broken up into smaller batches if necessary.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

836:             SafeERC20.safeTransferFrom(IERC20(tokenAddress), userAddress, address(this), transferAmount);

875:             SafeERC20.safeTransfer(IERC20(tokenAddress), userAddress, transferAmount);

```
*Github:* [[836](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L836), [875](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L875)]



<a name="L-16"></a> 
### [L-16] Some tokens may revert when zero value transfers are made
Despite the fact that [EIP-20 states](https://github.com/ethereum/EIPs/blob/7500ac4fc1bbdfaf684e7ef851f798f6b667b2fe/EIPS/eip-20.md?plain=1#L116) that zero-value transfers must be accepted, some tokens, such as LEND, will revert if this is attempted, which may cause transactions that involve other tokens (such as batch operations) to fully revert. Consider skipping the transfer if the amount is zero, which will also save gas.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

836:             SafeERC20.safeTransferFrom(IERC20(tokenAddress), userAddress, address(this), transferAmount);

875:             SafeERC20.safeTransfer(IERC20(tokenAddress), userAddress, transferAmount);

```
*Github:* [[836](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L836), [875](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L875)]



<a name="L-17"></a> 
### [L-17] Unsafe downcast
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit uint256 -> uint160
689:         externalContract = address(uint160(uint256(interactionTypeAndAddress)));

```
*Github:* [[689](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L689)]



<a name="L-18"></a> 
### [L-18] Consider using `ERC721A` instead of `ERC721`
[ERC721A](https://www.erc721a.org/) is an implementation of IERC721 with significant gas savings for minting multiple NFTs in a single transaction.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="L-19"></a> 
### [L-19] Using zero as a parameter
Taking `0` as a valid argument in Solidity without checks can lead to severe security issues. A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because 0 can be interpreted as an uninitialized `address`, leading to transfers to the 0x0 address, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code. It's important to always validate input and handle edge cases like `0` appropriately. Use `require()` statements to enforce conditions and provide clear error messages to facilitate debugging and safer code.

<details>
<summary>
There are <b>17</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

79:         xToken = _calculateOceanId(xTokenAddress, 0);

85:         yToken = _calculateOceanId(yTokenAddress, 0);

91:         lpTokenId = _calculateOceanId(primitive_, 0);

105:         Interaction memory interaction = Interaction({

124:         Interaction memory interaction = Interaction({

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L79), [85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L85), [91](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L91), [105](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L105), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L124)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

87:         xToken = _calculateOceanId(xTokenAddress, 0);

93:         yToken = _calculateOceanId(yTokenAddress, 0);

100:         zToken = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

107:         lpTokenId = _calculateOceanId(lpTokenAddress, 0);

122:             interaction = Interaction({

131:             interaction = Interaction({

151:             interaction = Interaction({

152:                 interactionTypeAndAddress: _fetchInteractionId(address(0), uint256(InteractionType.UnwrapEther)),

159:             interaction = Interaction({

```
*Github:* [[87](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L87), [93](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L93), [100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L100), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L107), [122](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L122), [131](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L131), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L151), [152](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L152), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L159)]


```solidity
File: src/ocean/Ocean.sol

173:         WRAPPED_ETHER_ID = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

464:             balanceDeltas[i] = BalanceDelta(ids[i], 0);

710:             specifiedToken = _calculateOceanId(externalContract, 0);

```
*Github:* [[173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L173), [464](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L464), [710](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L710)]


</details>


<a name="L-20"></a> 
### [L-20] Vulnerable versions of packages are being used
This project is using specific package versions which are vulnerable to the specific CVEs listed below. Consider switching to more recent versions of these packages that don't have these vulnerabilities.
- [CVE-2023-40014](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40014) - **MEDIUM** - (`openzeppelin-solidity >=4.0.0 <4.9.3`): OpenZeppelin Contracts is a library for secure smart contract development. Starting in version 4.0.0 and prior to version 4.9.3, contracts using `ERC2771Context` along with a custom trusted forwarder may see `_msgSender` return `address(0)` in calls that originate from the forwarder with calldata shorter than 20 bytes. This combination of circumstances does not appear to be common, in particular it is not the case for `MinimalForwarder` from OpenZeppelin Contracts, or any deployed forwarder the team is aware of, given that the signer address is appended to all calls that originate from these forwarders. The problem has been patched in v4.9.3.

- [CVE-2023-34459](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34459) - **MEDIUM** - (`openzeppelin-solidity >=4.7.0 <4.9.2`): OpenZeppelin Contracts is a library for smart contract development. Starting in version 4.7.0 and prior to version 4.9.2, when the `verifyMultiProof`, `verifyMultiProofCalldata`, `procesprocessMultiProof`, or `processMultiProofCalldat` functions are in use, it is possible to construct merkle trees that allow forging a valid multiproof for an arbitrary set of leaves. A contract may be vulnerable if it uses multiproofs for verification and the merkle tree that is processed includes a node with value 0 at depth 1 (just under the root). This could happen inadvertedly for balanced trees with 3 leaves or less, if the leaves are not hashed. This could happen deliberately if a malicious tree builder includes such a node in the tree. A contract is not vulnerable if it uses single-leaf proving (`verify`, `verifyCalldata`, `processProof`, or `processProofCalldata`), or if it uses multiproofs with a known tree that has hashed leaves. Standard merkle trees produced or validated with the @openzeppelin/merkle-tree library are safe. The problem has been patched in version 4.9.2. Some workarounds are available. For those using multiproofs: When constructing merkle trees hash the leaves and do not insert empty nodes in your trees. Using the @openzeppelin/merkle-tree package eliminates this issue. Do not accept user-provided merkle roots without reconstructing at least the first level of the tree. Verify the merkle tree structure by reconstructing it from the leaves.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="L-21"></a> 
### [L-21]  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`
Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

109:         return uint256(keccak256(abi.encodePacked(tokenAddress, tokenId)));

```
*Github:* [[109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L109)]



<a name="L-22"></a> 
### [L-22] `decimals()` is not a part of the ERC-20 standard
The `decimals()` function is not a part of the ERC-20 standard, and was added later as an optional extension. As such, some valid ERC20 tokens do not support this interface, so it is unsafe to blindly cast all tokens to this interface, and then call this function.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

81:         decimals[xToken] = IERC20Metadata(xTokenAddress).decimals();

88:         decimals[yToken] = IERC20Metadata(yTokenAddress).decimals();

93:         decimals[lpTokenId] = IERC20Metadata(primitive_).decimals();

```
*Github:* [[81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L81), [88](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L88), [93](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L93)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

89:         decimals[xToken] = IERC20Metadata(xTokenAddress).decimals();

96:         decimals[yToken] = IERC20Metadata(yTokenAddress).decimals();

109:         decimals[lpTokenId] = IERC20Metadata(lpTokenAddress).decimals();

```
*Github:* [[89](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L89), [96](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L96), [109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L109)]


```solidity
File: src/ocean/Ocean.sol

821:         try IERC20Metadata(tokenAddress).decimals() returns (uint8 decimals) {

865:         try IERC20Metadata(tokenAddress).decimals() returns (uint8 decimals) {

```
*Github:* [[821](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L821), [865](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L865)]



<a name="L-23"></a> 
### [L-23] Empty body - Consider commenting why

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

291:     fallback() external payable { }

```
*Github:* [[291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]




## Non Critical Issues

<a name="NC-1"></a> 
### [NC-1] `abi.encodePacked()` should be replaced with `bytes.concat()`
Solidity version 0.8.4 introduces `bytes.concat()`, which can be used to replace `abi.encodePacked()` on bytes/strings. It can make the intended operation clearer, leading to less reviewer confusion.

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

109:         return uint256(keccak256(abi.encodePacked(tokenAddress, tokenId)));

```
*Github:* [[109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L109)]



<a name="NC-2"></a> 
### [NC-2] Add inline comments for unnamed variables
`function foo(address x, address)` -> `function foo(address x, address /* y */)`

*There are <b>5</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

55:     function computeOutputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 inputAmount,
            address,
            bytes32 metadata
        )
            external
            override
            onlyOcean
            returns (uint256 outputAmount)
        {

117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

```
*Github:* [[55](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L55), [117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117)]


```solidity
File: src/ocean/Ocean.sol

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

326:     function onERC1155Received(
             address,
             address,
             uint256,
             uint256,
             bytes calldata
         )
             external
             view
             override
             returns (bytes4)
         {

353:     function onERC1155BatchReceived(
             address,
             address,
             uint256[] calldata,
             uint256[] calldata,
             bytes calldata
         )
             external
             pure
             override
             returns (bytes4)
         {

```
*Github:* [[309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353)]



<a name="NC-3"></a> 
### [NC-3] `assert()` should be replaced with `require()` or `revert()`
In versions of Solidity prior to 0.8.0, when encountering an assert all the remaining gas will be consumed. Even after solidity 0.8.0, the assert function is still not recommended, as described in the [documentation](https://docs.soliditylang.org/en/v0.8.20/control-structures.html#panic-via-assert-and-error-via-require):
> Assert should only be used to test for internal errors, and to check invariants. Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

667:             assert(interactionType == InteractionType.UnwrapEther && specifiedToken == WRAPPED_ETHER_ID);

721:             assert(interactionType == InteractionType.UnwrapEther);

1100:             assert(normalizedTruncatedAmount == 0);

1101:             assert(normalizedTransferAmount > amount);

```
*Github:* [[667](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L667), [721](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L721), [1100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1100), [1101](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1101)]



<a name="NC-4"></a> 
### [NC-4] Complex casting
Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

167:             inputAmounts[uint256(int256(indexOfInputAmount))] = rawInputAmount;

```
*Github:* [[167](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L167)]


```solidity
File: src/adapters/OceanAdapter.sol

100:         uint256 packedValue = uint256(uint160(token));

```
*Github:* [[100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L100)]


```solidity
File: src/ocean/Ocean.sol

689:         externalContract = address(uint160(uint256(interactionTypeAndAddress)));

```
*Github:* [[689](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L689)]



<a name="NC-5"></a> 
### [NC-5] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/adapters/OceanAdapter.sol

14: abstract contract OceanAdapter is IOceanPrimitive {

```
*Github:* [[14](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L14)]


```solidity
File: src/ocean/Ocean.sol

79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="NC-6"></a> 
### [NC-6] Consider adding emergency-stop functionality
Consider adding `Pausable` to the following contracts so it's possible to stop them in case of an emergency.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/ocean/Ocean.sol

79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="NC-7"></a> 
### [NC-7] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="NC-8"></a> 
### [NC-8] Consider bounding input array length
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to require() that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit consider length check for `interactions`
501:             for (uint256 i = 0; i < interactions.length;) {

```
*Github:* [[501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501)]



<a name="NC-9"></a> 
### [NC-9] Consider using descriptive `constant`s when passing zero as a function argument
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

<details>
<summary>
There are <b>18</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

78:         address xTokenAddress = ICurve2Pool(primitive).coins(0);

79:         xToken = _calculateOceanId(xTokenAddress, 0);

85:         yToken = _calculateOceanId(yTokenAddress, 0);

91:         lpTokenId = _calculateOceanId(primitive_, 0);

164:                 ICurve2Pool(primitive).exchange(indexOfInputAmount, indexOfOutputAmount, rawInputAmount, 0);

168:             rawOutputAmount = ICurve2Pool(primitive).add_liquidity(inputAmounts, 0);

170:             rawOutputAmount = ICurve2Pool(primitive).remove_liquidity_one_coin(rawInputAmount, indexOfOutputAmount, 0);

```
*Github:* [[78](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L78), [79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L79), [85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L85), [91](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L91), [164](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L164), [168](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L168), [170](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L170)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

86:         address xTokenAddress = ICurveTricrypto(primitive).coins(0);

87:         xToken = _calculateOceanId(xTokenAddress, 0);

93:         yToken = _calculateOceanId(yTokenAddress, 0);

100:         zToken = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

107:         lpTokenId = _calculateOceanId(lpTokenAddress, 0);

201:             ICurveTricrypto(primitive).exchange{ value: inputToken == zToken ? rawInputAmount : 0 }(
                     indexOfInputAmount, indexOfOutputAmount, rawInputAmount, 0, useEth

210:             ICurveTricrypto(primitive).add_liquidity(inputAmounts, 0);

214:                 ICurveTricrypto(primitive).remove_liquidity_one_coin(rawInputAmount, indexOfOutputAmount, 0);

219:                 ICurveTricrypto(primitive).remove_liquidity_one_coin(rawInputAmount, indexOfOutputAmount, 0);

```
*Github:* [[86](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L86), [87](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L87), [93](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L93), [100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L100), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L107), [201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L201), [210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L210), [214](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L214), [219](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L219)]


```solidity
File: src/ocean/Ocean.sol

173:         WRAPPED_ETHER_ID = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

710:             specifiedToken = _calculateOceanId(externalContract, 0);

```
*Github:* [[173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L173), [710](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L710)]


</details>


<a name="NC-10"></a> 
### [NC-10] Constant redefined elsewhere
Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit also seen in src/adapters/OceanAdapter.sol
99:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99)]



<a name="NC-11"></a> 
### [NC-11] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

391:         if (msg.value != 0) {

474:         if (msg.value != 0) {

1100:             assert(normalizedTruncatedAmount == 0);

```
*Github:* [[391](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L391), [474](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L474), [1100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1100)]



<a name="NC-12"></a> 
### [NC-12] Contract does not follow the Solidity Style Guide's suggested layout ordering
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be `1) Type declarations`, `2) State variables`, `3) Events`, `4) Modifiers`, and `5) Functions`, but the contract(s) below do not follow this ordering

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
56:     uint256 public immutable xToken;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
59:     uint256 public immutable yToken;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
62:     uint256 public immutable lpTokenId;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
65:     mapping(uint256 => int128) indexOf;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
68:     mapping(uint256 => uint8) decimals;

```
*Github:* [[56](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L56), [59](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L59), [62](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L62), [65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L65), [68](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L68)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
15: enum ComputeType {

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
29:     error INVALID_COMPUTE_TYPE();

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
30:     error SLIPPAGE_LIMIT_EXCEEDED();

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
35:     event Swap(

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
43:     event Deposit(

/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
51:     event Withdraw(

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
61:     uint256 public immutable xToken;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
64:     uint256 public immutable yToken;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
67:     uint256 public immutable zToken;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
70:     uint256 public immutable lpTokenId;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
73:     mapping(uint256 => uint256) indexOf;

/// @audit event/error `Swap` came earlier
/// @audit event/error `Deposit` came earlier
/// @audit event/error `Withdraw` came earlier
/// @audit event/error `INVALID_COMPUTE_TYPE` came earlier
/// @audit event/error `SLIPPAGE_LIMIT_EXCEEDED` came earlier
/// @audit function `deposit` came earlier
/// @audit function `withdraw` came earlier
76:     mapping(uint256 => uint8) decimals;

```
*Github:* [[15](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L15), [29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L29), [30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L30), [35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51), [61](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L61), [64](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L64), [67](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L67), [70](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L70), [73](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L73), [76](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L76)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit function `constructor` came earlier
38:     modifier onlyOcean() {

```
*Github:* [[38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L38)]


```solidity
File: src/ocean/Ocean.sol

/// @audit function `constructor` came earlier
185:     modifier onlyApprovedForwarder(address userAddress) {

```
*Github:* [[185](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L185)]


</details>


<a name="NC-13"></a> 
### [NC-13] Contract should expose an `interface`
All `external`/`public` functions should extend an `interface`. This is useful to make sure that the whole API is extracted.

*Note:* It is possible that the interface is out-of-scope and has not been seen by the bot.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/adapters/OceanAdapter.sol

55:     function computeOutputAmount(

81:     function computeInputAmount(

117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

```
*Github:* [[55](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L55), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124)]


```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

210:     function doInteraction(Interaction calldata interaction)

229:     function doMultipleInteractions(

256:     function forwardedDoInteraction(

281:     function forwardedDoMultipleInteractions(

305:     function supportsInterface(bytes4 interfaceId) public view virtual override(OceanERC1155, IERC165) returns (bool) {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

326:     function onERC1155Received(

353:     function onERC1155BatchReceived(

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196), [210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L210), [229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281), [305](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L305), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353)]


</details>


<a name="NC-14"></a> 
### [NC-14] Contracts should each be defined in separate files
Keeping each contract in a separate file makes it easier to work with multiple people, makes the code easier to maintain, and is a common practice on most projects. The following files each contains more than one contract/library/interface.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit another contract is defined in this file
10: interface IWETH {

/// @audit another contract is defined in this file
25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]



<a name="NC-15"></a> 
### [NC-15] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="NC-16"></a> 
### [NC-16] Convert simple `if` statements to ternary expressions
Converting some if statements to ternaries (such as `z = (a < b) ? x : y`) can make the code more concise and easier to read.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

150:         if (tokenId == zToken) {
                 interaction = Interaction({
                     interactionTypeAndAddress: _fetchInteractionId(address(0), uint256(InteractionType.UnwrapEther)),
                     inputToken: 0,
                     outputToken: 0,
                     specifiedAmount: amount,
                     metadata: bytes32(0)
                 });
             } else {
                 interaction = Interaction({

```
*Github:* [[150](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L150)]


```solidity
File: src/ocean/Ocean.sol

515:                 if (interaction.specifiedAmount == GET_BALANCE_DELTA) {
                         specifiedAmount = balanceDeltas.getBalanceDelta(interactionType, specifiedToken);
                     } else {
                         specifiedAmount = interaction.specifiedAmount;

```
*Github:* [[515](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L515)]



<a name="NC-17"></a> 
### [NC-17] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>22</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

178:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

180:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

182:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L178), [180](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L180), [182](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L182)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

230:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

232:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

234:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[230](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L230), [232](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L232), [234](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L234)]


```solidity
File: src/ocean/Ocean.sol

199:         emit ChangeUnwrapFee(unwrapFeeDivisor, nextUnwrapFeeDivisor, msg.sender);

216:         emit OceanTransaction(msg.sender, 1);

243:         emit OceanTransaction(msg.sender, interactions.length);

266:         emit ForwardedOceanTransaction(msg.sender, userAddress, 1);

297:         emit ForwardedOceanTransaction(msg.sender, userAddress, interactions.length);

396:             emit EtherWrap(msg.value, userAddress);

479:             emit EtherWrap(msg.value, userAddress);

764:         emit ComputeOutputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

805:         emit ComputeInputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

838:             emit Erc20Wrap(tokenAddress, transferAmount, amount, dust, userAddress, outputToken);

876:             emit Erc20Unwrap(tokenAddress, transferAmount, amount, feeCharged, userAddress, inputToken);

893:         emit Erc721Wrap(tokenAddress, tokenId, userAddress, oceanId);

905:         emit Erc721Unwrap(tokenAddress, tokenId, userAddress, oceanId);

933:         emit Erc1155Wrap(tokenAddress, tokenId, amount, userAddress, oceanId);

969:         emit Erc1155Unwrap(tokenAddress, tokenId, amount, feeCharged, userAddress, oceanId);

983:         emit EtherUnwrap(transferAmount, feeCharged, userAddress);

```
*Github:* [[199](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L199), [216](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L216), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L243), [266](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L266), [297](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L297), [396](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L396), [479](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L479), [764](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L764), [805](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L805), [838](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L838), [876](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L876), [893](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L893), [905](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L905), [933](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L933), [969](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L969), [983](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L983)]


</details>


<a name="NC-18"></a> 
### [NC-18] Custom errors has no error details
Consider adding parameters to the error to indicate which user or values caused the failure.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

24:     error INVALID_COMPUTE_TYPE();

25:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[24](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L24), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L25)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

29:     error INVALID_COMPUTE_TYPE();

30:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L29), [30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L30)]



<a name="NC-19"></a> 
### [NC-19] Duplicated `require()`/`revert()` checks should be refactored
Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit duplicated on line 878
840:             revert NO_DECIMAL_METHOD();

```
*Github:* [[840](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L840)]



<a name="NC-20"></a> 
### [NC-20] `else` block not required
One level of nesting can be removed by not having an `else` block when the `if`-block always jumps at the end. For example:
```solidity
if (condition) {
	body1...
	return x;
} else {
	body2...
}
```
can be changed to:
```solidity
if (condition) {
	body1...
	return x;
}
body2...
```

*There are <b>5</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

214:         } else if ((inputToken == lpTokenId) && ((outputToken == xToken) || (outputToken == yToken))) {
                 return ComputeType.Withdraw;
             } else {

```
*Github:* [[214](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L214)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

250:         if (tokenAddress == underlying[zToken]) {
                 return address(this).balance;
             } else {

282:         } else if (
                 (inputToken == lpTokenId) && ((outputToken == xToken) || (outputToken == yToken) || (outputToken == zToken))
             ) {
                 return ComputeType.Withdraw;
             } else {

```
*Github:* [[250](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L250), [282](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L282)]


```solidity
File: src/ocean/Ocean.sol

310:         if (_ERC721InteractionStatus == INTERACTION) {
                 return IERC721Receiver.onERC721Received.selector;
             } else {

338:         if (_ERC1155InteractionStatus == INTERACTION) {
                 return IERC1155Receiver.onERC1155Received.selector;
             } else {

```
*Github:* [[310](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L310), [338](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L338)]



<a name="NC-21"></a> 
### [NC-21] Empty bytes check is missing
Passing empty bytes to a function can cause unexpected behavior, such as certain operations failing, producing incorrect results, or wasting gas. It is recommended to check that all byte parameters are not empty.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

/// @audit missing empty check for ``
117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

```
*Github:* [[117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117)]


```solidity
File: src/ocean/Ocean.sol

/// @audit missing empty check for ``
309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

/// @audit missing empty check for ``
326:     function onERC1155Received(
             address,
             address,
             uint256,
             uint256,
             bytes calldata
         )
             external
             view
             override
             returns (bytes4)
         {

/// @audit missing empty check for ``
353:     function onERC1155BatchReceived(
             address,
             address,
             uint256[] calldata,
             uint256[] calldata,
             bytes calldata
         )
             external
             pure
             override
             returns (bytes4)
         {

```
*Github:* [[309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353)]



<a name="NC-22"></a> 
### [NC-22] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="NC-23"></a> 
### [NC-23] Names of structs, events, enums and errors should use CapWords style
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html)

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

24:     error INVALID_COMPUTE_TYPE();

25:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[24](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L24), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L25)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

29:     error INVALID_COMPUTE_TYPE();

30:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L29), [30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L30)]



<a name="NC-24"></a> 
### [NC-24] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

764:         emit ComputeOutputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

805:         emit ComputeInputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

893:         emit Erc721Wrap(tokenAddress, tokenId, userAddress, oceanId);

905:         emit Erc721Unwrap(tokenAddress, tokenId, userAddress, oceanId);

933:         emit Erc1155Wrap(tokenAddress, tokenId, amount, userAddress, oceanId);

969:         emit Erc1155Unwrap(tokenAddress, tokenId, amount, feeCharged, userAddress, oceanId);

983:         emit EtherUnwrap(transferAmount, feeCharged, userAddress);

```
*Github:* [[764](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L764), [805](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L805), [893](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L893), [905](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L905), [933](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L933), [969](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L969), [983](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L983)]



<a name="NC-25"></a> 
### [NC-25] Events may be emitted out of order due to reentrancy
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `.remove_liquidity_one_coin(...)` is called on line 170
/// @audit `.add_liquidity(...)` is called on line 168
/// @audit `.exchange(...)` is called on line 164
178:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

/// @audit `.remove_liquidity_one_coin(...)` is called on line 170
/// @audit `.add_liquidity(...)` is called on line 168
/// @audit `.exchange(...)` is called on line 164
180:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

/// @audit `.remove_liquidity_one_coin(...)` is called on line 170
/// @audit `.add_liquidity(...)` is called on line 168
/// @audit `.exchange(...)` is called on line 164
182:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L178), [180](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L180), [182](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L182)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `.remove_liquidity_one_coin(...)` is called on line 219
/// @audit `.balanceOf(...)` is called on line 213
/// @audit `.remove_liquidity_one_coin(...)` is called on line 214
/// @audit `.balanceOf(...)` is called on line 216
/// @audit `.withdraw(...)` is called on line 215
/// @audit `.add_liquidity(...)` is called on line 210
230:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

/// @audit `.remove_liquidity_one_coin(...)` is called on line 219
/// @audit `.balanceOf(...)` is called on line 213
/// @audit `.remove_liquidity_one_coin(...)` is called on line 214
/// @audit `.balanceOf(...)` is called on line 216
/// @audit `.withdraw(...)` is called on line 215
/// @audit `.add_liquidity(...)` is called on line 210
232:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

/// @audit `.remove_liquidity_one_coin(...)` is called on line 219
/// @audit `.balanceOf(...)` is called on line 213
/// @audit `.remove_liquidity_one_coin(...)` is called on line 214
/// @audit `.balanceOf(...)` is called on line 216
/// @audit `.withdraw(...)` is called on line 215
/// @audit `.add_liquidity(...)` is called on line 210
234:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[230](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L230), [232](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L232), [234](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L234)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `.computeOutputAmount(...)` is called on line 760
764:         emit ComputeOutputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

/// @audit `.computeInputAmount(...)` is called on line 801
805:         emit ComputeInputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

/// @audit `.safeTransferFrom(...)` is called on line 836
/// @audit `.decimals(...)` is called on line 821
838:             emit Erc20Wrap(tokenAddress, transferAmount, amount, dust, userAddress, outputToken);

/// @audit `.safeTransfer(...)` is called on line 875
/// @audit `.decimals(...)` is called on line 865
876:             emit Erc20Unwrap(tokenAddress, transferAmount, amount, feeCharged, userAddress, inputToken);

/// @audit `.safeTransferFrom(...)` is called on line 891
893:         emit Erc721Wrap(tokenAddress, tokenId, userAddress, oceanId);

/// @audit `.safeTransferFrom(...)` is called on line 904
905:         emit Erc721Unwrap(tokenAddress, tokenId, userAddress, oceanId);

/// @audit `.safeTransferFrom(...)` is called on line 931
933:         emit Erc1155Wrap(tokenAddress, tokenId, amount, userAddress, oceanId);

/// @audit `.safeTransferFrom(...)` is called on line 968
969:         emit Erc1155Unwrap(tokenAddress, tokenId, amount, feeCharged, userAddress, oceanId);

```
*Github:* [[764](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L764), [805](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L805), [838](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L838), [876](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L876), [893](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L893), [905](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L905), [933](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L933), [969](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L969)]


</details>


<a name="NC-26"></a> 
### [NC-26]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit a function was seen before constructor
/// @audit a function was seen before constructor
85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

/// @audit private function `_approveToken` came earlier from this internal function
249:     function _getBalance(address tokenAddress) internal view returns (uint256 balance) {

/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
/// @audit a function was seen before fallback()
291:     fallback() external payable { }

```
*Github:* [[85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85), [249](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L249), [291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit internal function `_fetchInteractionId` came earlier from this public function
/// @audit internal function `_calculateOceanId` came earlier from this public function
117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

/// @audit internal function `_fetchInteractionId` came earlier from this external function
/// @audit internal function `_calculateOceanId` came earlier from this external function
/// @audit public function `onERC1155Received` came earlier from this external function
124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

```
*Github:* [[117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124)]


```solidity
File: src/ocean/Ocean.sol

/// @audit public function `supportsInterface` came earlier from this external function
309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

/// @audit public function `supportsInterface` came earlier from this external function
326:     function onERC1155Received(

/// @audit public function `supportsInterface` came earlier from this external function
353:     function onERC1155BatchReceived(

/// @audit private function `_erc20Wrap` came earlier from this internal function
/// @audit private function `_erc20Unwrap` came earlier from this internal function
/// @audit private function `_erc721Wrap` came earlier from this internal function
/// @audit private function `_erc721Unwrap` came earlier from this internal function
/// @audit private function `_erc1155Wrap` came earlier from this internal function
/// @audit private function `_erc1155Unwrap` came earlier from this internal function
/// @audit private function `_etherUnwrap` came earlier from this internal function
1004:     function _increaseBalanceOfPrimitive(address primitive, uint256 inputToken, uint256 inputAmount) internal {

/// @audit private function `_erc20Wrap` came earlier from this internal function
/// @audit private function `_erc20Unwrap` came earlier from this internal function
/// @audit private function `_erc721Wrap` came earlier from this internal function
/// @audit private function `_erc721Unwrap` came earlier from this internal function
/// @audit private function `_erc1155Wrap` came earlier from this internal function
/// @audit private function `_erc1155Unwrap` came earlier from this internal function
/// @audit private function `_etherUnwrap` came earlier from this internal function
1038:     function _decreaseBalanceOfPrimitive(address primitive, uint256 outputToken, uint256 outputAmount) internal {

/// @audit private function `_erc20Wrap` came earlier from this internal function
/// @audit private function `_erc20Unwrap` came earlier from this internal function
/// @audit private function `_erc721Wrap` came earlier from this internal function
/// @audit private function `_erc721Unwrap` came earlier from this internal function
/// @audit private function `_erc1155Wrap` came earlier from this internal function
/// @audit private function `_erc1155Unwrap` came earlier from this internal function
/// @audit private function `_etherUnwrap` came earlier from this internal function
/// @audit private function `_determineTransferAmount` came earlier from this internal function
1123:     function _convertDecimals(

```
*Github:* [[309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353), [1004](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1004), [1038](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1038), [1123](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1123)]


</details>


<a name="NC-27"></a> 
### [NC-27] Functions with array parameters should have length checks in place

*There are <b>3</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `ids`
229:     function doMultipleInteractions(

/// @audit `ids`
281:     function forwardedDoMultipleInteractions(

/// @audit `interactions`
445:     function _doMultipleInteractions(

```
*Github:* [[229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445)]



<a name="NC-28"></a> 
### [NC-28] High cyclomatic complexity
Consider breaking down these blocks into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit Number of blocks: 11
178:     function primitiveOutputAmount(

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178)]


```solidity
File: src/ocean/Ocean.sol

/// @audit Number of blocks: 81
169:     constructor(string memory uri_) OceanERC1155(uri_) {

/// @audit Number of blocks: 16
445:     function _doMultipleInteractions(

/// @audit Number of blocks: 10
597:     function _executeInteraction(

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [597](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L597)]



<a name="NC-29"></a> 
### [NC-29] Variable names for `immutable`s should use CONSTANT_CASE
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)

*There are <b>9</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

56:     uint256 public immutable xToken;

59:     uint256 public immutable yToken;

62:     uint256 public immutable lpTokenId;

```
*Github:* [[56](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L56), [59](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L59), [62](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L62)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

61:     uint256 public immutable xToken;

64:     uint256 public immutable yToken;

67:     uint256 public immutable zToken;

70:     uint256 public immutable lpTokenId;

```
*Github:* [[61](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L61), [64](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L64), [67](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L67), [70](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L70)]


```solidity
File: src/adapters/OceanAdapter.sol

19:     address public immutable ocean;

22:     address public immutable primitive;

```
*Github:* [[19](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L19), [22](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L22)]



<a name="NC-30"></a> 
### [NC-30] Import declarations should import specific identifiers, rather than the whole file
Using import declarations of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas).

*There are <b>6</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

7: import "./ICurve2Pool.sol";

8: import "./OceanAdapter.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L7), [8](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L8)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

7: import "./ICurveTricrypto.sol";

8: import "./OceanAdapter.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L7), [8](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L8)]


```solidity
File: src/adapters/OceanAdapter.sol

7: import "../ocean/IOceanPrimitive.sol";

8: import "../ocean/Interactions.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L7), [8](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L8)]



<a name="NC-31"></a> 
### [NC-31] Inconsistent spacing in comments
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

21:     /////////////////////////////////////////////////////////////////////

23:     /////////////////////////////////////////////////////////////////////

27:     /////////////////////////////////////////////////////////////////////

29:     /////////////////////////////////////////////////////////////////////

70:     //*********************************************************************//

72:     //*********************************************************************//

```
*Github:* [[21](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L21), [23](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L23), [27](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L27), [29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L29), [70](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L70), [72](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L72)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

26:     /////////////////////////////////////////////////////////////////////

28:     /////////////////////////////////////////////////////////////////////

32:     /////////////////////////////////////////////////////////////////////

34:     /////////////////////////////////////////////////////////////////////

78:     //*********************************************************************//

80:     //*********************************************************************//

```
*Github:* [[26](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L26), [28](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L28), [32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L32), [34](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L34), [78](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L78), [80](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L80)]


```solidity
File: src/adapters/OceanAdapter.sol

27:     //*********************************************************************//

29:     //*********************************************************************//

```
*Github:* [[27](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L27), [29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L29)]


</details>


<a name="NC-32"></a> 
### [NC-32] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="NC-33"></a> 
### [NC-33] Large numeric literals should use underscores for readability
Large hardcoded numbers in code can be difficult to read. Consider using underscores for number literals to improve readability (e.g `1234567` -> `1_234_567`). Consider using an underscore for every third digit from the right.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

```
*Github:* [[95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95)]



<a name="NC-34"></a> 
### [NC-34] Long functions should be refactored into multiple, smaller, functions

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit 58 lines
178:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178)]


```solidity
File: src/ocean/Ocean.sol

/// @audit 1108 lines
169:     constructor(string memory uri_) OceanERC1155(uri_) {

/// @audit 128 lines
445:     function _doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             internal
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit 77 lines
597:     function _executeInteraction(
             Interaction memory interaction,
             InteractionType interactionType,
             address externalContract,
             uint256 specifiedToken,
             uint256 specifiedAmount,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [597](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L597)]



<a name="NC-35"></a> 
### [NC-35] Magic numbers should be replaced with constants
Magic numbers are hard-coded values in code that can make it difficult for developers and maintainers to understand the code, and can also cause confusion or errors. To improve the readability and maintainability of code, it is recommended to replace magic numbers with constants that have good readability.

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

// @audit `2`
166:             uint256[2] memory inputAmounts;

```
*Github:* [[166](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L166)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

// @audit `2`
99:         address wethAddress = ICurveTricrypto(primitive).coins(2);

// @audit `0x4574686572`
100:         zToken = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

// @audit `2`
101:         indexOf[zToken] = 2;

// @audit `3`
205:             uint256[3] memory inputAmounts;

```
*Github:* [[99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L99), [100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L100), [101](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L101), [205](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L205)]


```solidity
File: src/adapters/OceanAdapter.sol

// @audit `248`
101:         packedValue |= interactionType << 248;

// @audit `10`
152:             uint256 shift = 10 ** (uint256(decimalsTo - decimalsFrom));

// @audit `10`
156:             uint256 shift = 10 ** (uint256(decimalsFrom - decimalsTo));

```
*Github:* [[101](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L101), [152](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L152), [156](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L156)]


```solidity
File: src/ocean/Ocean.sol

// @audit `0x4574686572`
173:         WRAPPED_ETHER_ID = _calculateOceanId(address(0x4574686572), 0); // hexadecimal(ascii("Ether"))

// @audit `10`
1138:             uint256 shift = 10 ** (uint256(decimalsTo - decimalsFrom));

// @audit `10`
1143:             uint256 shift = 10 ** (uint256(decimalsFrom - decimalsTo));

```
*Github:* [[173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L173), [1138](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1138), [1143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1143)]


</details>


<a name="NC-36"></a> 
### [NC-36] Missing disallow list for `ERC721`
Recently, there has been an increase in the theft of NFTs. These stolen NFTs are then added to platforms where they can be easily converted into liquidity.

Some popular marketplaces(e.g. Opensea), have already taken steps to combat this problem by introducing a disallow list feature. This means that if an NFT is reported as stolen, it won't be listed or sold on their platform. This may increase the centralization of the project, but it can help solve this problem if it is a concern.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="NC-37"></a> 
### [NC-37] Consider moving `msg.sender` checks to `modifier`s
If some functions are only allowed to be called by some specific users, consider using a modifier instead of checking with a require statement, especially if this check is done in multiple functions.

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

39:         require(msg.sender == ocean);

```
*Github:* [[39](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L39)]



<a name="NC-38"></a> 
### [NC-38] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

65:     mapping(uint256 => int128) indexOf;

68:     mapping(uint256 => uint8) decimals;

```
*Github:* [[65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L65), [68](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L68)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

73:     mapping(uint256 => uint256) indexOf;

76:     mapping(uint256 => uint8) decimals;

```
*Github:* [[73](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L73), [76](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L76)]


```solidity
File: src/adapters/OceanAdapter.sol

25:     mapping(uint256 => address) public underlying;

```
*Github:* [[25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L25)]



<a name="NC-39"></a> 
### [NC-39] Named imports of parent contracts are missing

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `OceanAdapter`
20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `OceanAdapter`
25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `IOceanPrimitive`
14: abstract contract OceanAdapter is IOceanPrimitive {

```
*Github:* [[14](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L14)]



<a name="NC-40"></a> 
### [NC-40] Missing NatSpec from contract declarations
e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec.

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

10: interface IWETH {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10)]



<a name="NC-41"></a> 
### [NC-41] Missing NatSpec `@author` from contract declaration
Some contract definitions have an incomplete NatSpec: add a `@author` notation to improve the code documentation.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

10: interface IWETH {

25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/adapters/OceanAdapter.sol

14: abstract contract OceanAdapter is IOceanPrimitive {

```
*Github:* [[14](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L14)]



<a name="NC-42"></a> 
### [NC-42] Missing NatSpec `@dev` from contract declaration
Some contract definitions have an incomplete NatSpec: add a `@dev` notation to improve the code documentation.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

10: interface IWETH {

25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/adapters/OceanAdapter.sol

14: abstract contract OceanAdapter is IOceanPrimitive {

```
*Github:* [[14](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L14)]



<a name="NC-43"></a> 
### [NC-43] Missing NatSpec `@dev` from event declaration
Some event definitions have an incomplete NatSpec: add a `@dev` notation to improve the code documentation.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

30:     event Swap(

38:     event Deposit(

46:     event Withdraw(

```
*Github:* [[30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L30), [38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L38), [46](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L46)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

35:     event Swap(

43:     event Deposit(

51:     event Withdraw(

```
*Github:* [[35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51)]


```solidity
File: src/ocean/Ocean.sol

111:     event ChangeUnwrapFee(uint256 oldFee, uint256 newFee, address sender);

112:     event Erc20Wrap(

120:     event Erc20Unwrap(

128:     event Erc721Wrap(address indexed erc721Token, uint256 erc721id, address indexed user, uint256 indexed oceanId);

129:     event Erc721Unwrap(address indexed erc721Token, uint256 erc721Id, address indexed user, uint256 indexed oceanId);

130:     event Erc1155Wrap(

133:     event Erc1155Unwrap(

141:     event EtherWrap(uint256 amount, address indexed user);

142:     event EtherUnwrap(uint256 amount, uint256 feeCharged, address indexed user);

143:     event ComputeOutputAmount(

151:     event ComputeInputAmount(

159:     event OceanTransaction(address indexed user, uint256 numberOfInteractions);

160:     event ForwardedOceanTransaction(address indexed forwarder, address indexed user, uint256 numberOfInteractions);

```
*Github:* [[111](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L111), [112](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L112), [120](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L120), [128](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L128), [129](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L129), [130](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L130), [133](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L133), [141](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L141), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L142), [143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L143), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L151), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L160)]


</details>


<a name="NC-44"></a> 
### [NC-44] Missing NatSpec `@dev` from function declaration
Some function definitions have an incomplete NatSpec: add a `@dev` notation to improve the code documentation.

<details>
<summary>
There are <b>18</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

77:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[77](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L77)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

11:     function deposit() external payable;

12:     function withdraw(uint256 amount) external payable;

85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

291:     fallback() external payable { }

```
*Github:* [[11](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L11), [12](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L12), [85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85), [291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]


```solidity
File: src/adapters/OceanAdapter.sol

32:     constructor(address ocean_, address primitive_) {

81:     function computeInputAmount(

99:     function _fetchInteractionId(address token, uint256 interactionType) internal pure returns (bytes32) {

108:     function _calculateOceanId(address tokenAddress, uint256 tokenId) internal pure returns (uint256) {

124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

161:     function primitiveOutputAmount(

171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L32), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L99), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L108), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124), [161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]


```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

700:     function _getSpecifiedToken(

1004:     function _increaseBalanceOfPrimitive(address primitive, uint256 inputToken, uint256 inputAmount) internal {

1038:     function _decreaseBalanceOfPrimitive(address primitive, uint256 outputToken, uint256 outputAmount) internal {

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [700](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L700), [1004](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1004), [1038](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1038)]


</details>


<a name="NC-45"></a> 
### [NC-45] Missing NatSpec `@dev` from modifier declaration
Some modifier definitions have an incomplete NatSpec: add a `@dev` notation to improve the code documentation.

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

38:     modifier onlyOcean() {

```
*Github:* [[38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L38)]



<a name="NC-46"></a> 
### [NC-46] Error declarations should have NatSpec descriptions

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

24:     error INVALID_COMPUTE_TYPE();

25:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[24](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L24), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L25)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

29:     error INVALID_COMPUTE_TYPE();

30:     error SLIPPAGE_LIMIT_EXCEEDED();

```
*Github:* [[29](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L29), [30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L30)]



<a name="NC-47"></a> 
### [NC-47] Event declarations should have NatSpec descriptions

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

30:     event Swap(

38:     event Deposit(

46:     event Withdraw(

```
*Github:* [[30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L30), [38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L38), [46](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L46)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

35:     event Swap(

43:     event Deposit(

51:     event Withdraw(

```
*Github:* [[35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51)]


```solidity
File: src/ocean/Ocean.sol

111:     event ChangeUnwrapFee(uint256 oldFee, uint256 newFee, address sender);

112:     event Erc20Wrap(

120:     event Erc20Unwrap(

128:     event Erc721Wrap(address indexed erc721Token, uint256 erc721id, address indexed user, uint256 indexed oceanId);

129:     event Erc721Unwrap(address indexed erc721Token, uint256 erc721Id, address indexed user, uint256 indexed oceanId);

130:     event Erc1155Wrap(

133:     event Erc1155Unwrap(

141:     event EtherWrap(uint256 amount, address indexed user);

142:     event EtherUnwrap(uint256 amount, uint256 feeCharged, address indexed user);

143:     event ComputeOutputAmount(

151:     event ComputeInputAmount(

159:     event OceanTransaction(address indexed user, uint256 numberOfInteractions);

160:     event ForwardedOceanTransaction(address indexed forwarder, address indexed user, uint256 numberOfInteractions);

```
*Github:* [[111](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L111), [112](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L112), [120](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L120), [128](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L128), [129](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L129), [130](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L130), [133](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L133), [141](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L141), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L142), [143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L143), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L151), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L160)]


</details>


<a name="NC-48"></a> 
### [NC-48] NatSpec documentation for function is missing
It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as DeFi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

11:     function deposit() external payable;

12:     function withdraw(uint256 amount) external payable;

291:     fallback() external payable { }

```
*Github:* [[11](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L11), [12](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L12), [291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]


```solidity
File: src/adapters/OceanAdapter.sol

161:     function primitiveOutputAmount(

171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]


```solidity
File: src/ocean/Ocean.sol

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

```
*Github:* [[309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309)]



<a name="NC-49"></a> 
### [NC-49] Missing NatSpec `@notice` from contract declaration
Some contract definitions have an incomplete NatSpec: add a `@notice` notation to improve the code documentation.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

10: interface IWETH {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10)]


```solidity
File: src/ocean/Ocean.sol

79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="NC-50"></a> 
### [NC-50] Missing NatSpec `@notice` from event declaration
Some event definitions have an incomplete NatSpec: add a `@notice` notation to improve the code documentation.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

30:     event Swap(

38:     event Deposit(

46:     event Withdraw(

```
*Github:* [[30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L30), [38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L38), [46](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L46)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

35:     event Swap(

43:     event Deposit(

51:     event Withdraw(

```
*Github:* [[35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51)]


```solidity
File: src/ocean/Ocean.sol

111:     event ChangeUnwrapFee(uint256 oldFee, uint256 newFee, address sender);

112:     event Erc20Wrap(

120:     event Erc20Unwrap(

128:     event Erc721Wrap(address indexed erc721Token, uint256 erc721id, address indexed user, uint256 indexed oceanId);

129:     event Erc721Unwrap(address indexed erc721Token, uint256 erc721Id, address indexed user, uint256 indexed oceanId);

130:     event Erc1155Wrap(

133:     event Erc1155Unwrap(

141:     event EtherWrap(uint256 amount, address indexed user);

142:     event EtherUnwrap(uint256 amount, uint256 feeCharged, address indexed user);

143:     event ComputeOutputAmount(

151:     event ComputeInputAmount(

159:     event OceanTransaction(address indexed user, uint256 numberOfInteractions);

160:     event ForwardedOceanTransaction(address indexed forwarder, address indexed user, uint256 numberOfInteractions);

```
*Github:* [[111](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L111), [112](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L112), [120](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L120), [128](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L128), [129](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L129), [130](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L130), [133](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L133), [141](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L141), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L142), [143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L143), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L151), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L160)]


</details>


<a name="NC-51"></a> 
### [NC-51] Missing NatSpec `@notice` from function declaration
Some function definitions have an incomplete NatSpec: add a `@notice` notation to improve the code documentation.

<details>
<summary>
There are <b>38</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

102:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

121:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

142:     function primitiveOutputAmount(

189:     function _approveToken(address tokenAddress) private {

201:     function _determineComputeType(

```
*Github:* [[102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L102), [121](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L121), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L142), [189](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L189), [201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

11:     function deposit() external payable;

12:     function withdraw(uint256 amount) external payable;

118:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

178:     function primitiveOutputAmount(

241:     function _approveToken(address tokenAddress) private {

249:     function _getBalance(address tokenAddress) internal view returns (uint256 balance) {

264:     function _determineComputeType(

291:     fallback() external payable { }

```
*Github:* [[11](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L11), [12](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L12), [118](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L118), [147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147), [178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178), [241](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L241), [249](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L249), [264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264), [291](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L291)]


```solidity
File: src/adapters/OceanAdapter.sol

55:     function computeOutputAmount(

117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

138:     function _convertDecimals(

161:     function primitiveOutputAmount(

171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[55](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L55), [117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117), [138](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L138), [161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]


```solidity
File: src/ocean/Ocean.sol

305:     function supportsInterface(bytes4 interfaceId) public view virtual override(OceanERC1155, IERC165) returns (bool) {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

326:     function onERC1155Received(

353:     function onERC1155BatchReceived(

380:     function _doInteraction(

445:     function _doMultipleInteractions(

597:     function _executeInteraction(

682:     function _unpackInteractionTypeAndAddress(Interaction memory interaction)

700:     function _getSpecifiedToken(

745:     function _computeOutputAmount(

786:     function _computeInputAmount(

889:     function _erc721Wrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

903:     function _erc721Unwrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

978:     function _etherUnwrap(uint256 amount, address userAddress) private {

1068:     function _determineTransferAmount(

1123:     function _convertDecimals(

1158:     function _calculateUnwrapFee(uint256 unwrapAmount) private view returns (uint256 feeCharged) {

1166:     function _grantFeeToOcean(uint256 oceanId, uint256 amount) private {

```
*Github:* [[305](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L305), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353), [380](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L380), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [597](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L597), [682](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L682), [700](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L700), [745](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L745), [786](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L786), [889](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L889), [903](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L903), [978](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L978), [1068](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1068), [1123](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1123), [1158](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1158), [1166](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1166)]


</details>


<a name="NC-52"></a> 
### [NC-52] Missing NatSpec `@notice` from modifier declaration
Some modifier definitions have an incomplete NatSpec: add a `@notice` notation to improve the code documentation.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

185:     modifier onlyApprovedForwarder(address userAddress) {

```
*Github:* [[185](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L185)]



<a name="NC-53"></a> 
### [NC-53] Missing NatSpec `@param` from event declaration
Some event definitions have an incomplete NatSpec: add a `@param` notation to improve the code documentation.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

30:     event Swap(

38:     event Deposit(

46:     event Withdraw(

```
*Github:* [[30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L30), [38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L38), [46](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L46)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

35:     event Swap(

43:     event Deposit(

51:     event Withdraw(

```
*Github:* [[35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51)]


```solidity
File: src/ocean/Ocean.sol

111:     event ChangeUnwrapFee(uint256 oldFee, uint256 newFee, address sender);

112:     event Erc20Wrap(

120:     event Erc20Unwrap(

128:     event Erc721Wrap(address indexed erc721Token, uint256 erc721id, address indexed user, uint256 indexed oceanId);

129:     event Erc721Unwrap(address indexed erc721Token, uint256 erc721Id, address indexed user, uint256 indexed oceanId);

130:     event Erc1155Wrap(

133:     event Erc1155Unwrap(

141:     event EtherWrap(uint256 amount, address indexed user);

142:     event EtherUnwrap(uint256 amount, uint256 feeCharged, address indexed user);

143:     event ComputeOutputAmount(

151:     event ComputeInputAmount(

159:     event OceanTransaction(address indexed user, uint256 numberOfInteractions);

160:     event ForwardedOceanTransaction(address indexed forwarder, address indexed user, uint256 numberOfInteractions);

```
*Github:* [[111](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L111), [112](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L112), [120](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L120), [128](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L128), [129](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L129), [130](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L130), [133](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L133), [141](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L141), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L142), [143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L143), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L151), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L160)]


</details>


<a name="NC-54"></a> 
### [NC-54] Missing NatSpec `@param` from function declaration
Some function definitions have an incomplete NatSpec: add a `@param` notation to improve the code documentation.

<details>
<summary>
There are <b>27</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit missing @param for `ocean_`
/// @audit missing @param for `primitive_`
77:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

/// @audit missing @param for `tokenAddress`
189:     function _approveToken(address tokenAddress) private {

/// @audit missing @param for `inputToken`
/// @audit missing @param for `outputToken`
201:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[77](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L77), [189](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L189), [201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit missing @param for `amount`
12:     function withdraw(uint256 amount) external payable;

/// @audit missing @param for `ocean_`
/// @audit missing @param for `primitive_`
85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

/// @audit missing @param for `tokenAddress`
241:     function _approveToken(address tokenAddress) private {

/// @audit missing @param for `tokenAddress`
249:     function _getBalance(address tokenAddress) internal view returns (uint256 balance) {

/// @audit missing @param for `inputToken`
/// @audit missing @param for `outputToken`
264:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[12](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L12), [85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85), [241](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L241), [249](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L249), [264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit missing @param for `ocean_`
/// @audit missing @param for `primitive_`
32:     constructor(address ocean_, address primitive_) {

/// @audit missing @param for `inputToken`
/// @audit missing @param for `outputToken`
/// @audit missing @param for `outputAmount`
/// @audit missing @param for `userAddress`
/// @audit missing @param for `maximumInputAmount`
81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean
            returns (uint256 inputAmount)
        {

/// @audit missing @param for `token`
/// @audit missing @param for `interactionType`
99:     function _fetchInteractionId(address token, uint256 interactionType) internal pure returns (bytes32) {

/// @audit missing @param for `tokenAddress`
/// @audit missing @param for `tokenId`
108:     function _calculateOceanId(address tokenAddress, uint256 tokenId) internal pure returns (uint256) {

/// @audit missing @param for `tokenId`
124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

/// @audit missing @param for `inputToken`
/// @audit missing @param for `outputToken`
/// @audit missing @param for `inputAmount`
/// @audit missing @param for `metadata`
161:     function primitiveOutputAmount(

/// @audit missing @param for `tokenId`
/// @audit missing @param for `amount`
171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

/// @audit missing @param for `tokenId`
/// @audit missing @param for `amount`
173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L32), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L99), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L108), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124), [161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]


```solidity
File: src/ocean/Ocean.sol

/// @audit missing @param for `uri_`
169:     constructor(string memory uri_) OceanERC1155(uri_) {

/// @audit missing @param for `interfaceId`
305:     function supportsInterface(bytes4 interfaceId) public view virtual override(OceanERC1155, IERC165) returns (bool) {

/// @audit missing @param for `outputToken`
820:     function _erc20Wrap(address tokenAddress, uint256 amount, address userAddress, uint256 outputToken) private {

/// @audit missing @param for `inputToken`
864:     function _erc20Unwrap(address tokenAddress, uint256 amount, address userAddress, uint256 inputToken) private {

/// @audit missing @param for `oceanId`
889:     function _erc721Wrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

/// @audit missing @param for `oceanId`
903:     function _erc721Unwrap(address tokenAddress, uint256 tokenId, address userAddress, uint256 oceanId) private {

/// @audit missing @param for `oceanId`
920:     function _erc1155Wrap(
             address tokenAddress,
             uint256 tokenId,
             uint256 amount,
             address userAddress,
             uint256 oceanId
         )
             private
         {

/// @audit missing @param for `oceanId`
955:     function _erc1155Unwrap(
             address tokenAddress,
             uint256 tokenId,
             uint256 amount,
             address userAddress,
             uint256 oceanId
         )
             private
         {

/// @audit missing @param for `primitive`
/// @audit missing @param for `inputToken`
/// @audit missing @param for `inputAmount`
1004:     function _increaseBalanceOfPrimitive(address primitive, uint256 inputToken, uint256 inputAmount) internal {

/// @audit missing @param for `primitive`
/// @audit missing @param for `outputToken`
/// @audit missing @param for `outputAmount`
1038:     function _decreaseBalanceOfPrimitive(address primitive, uint256 outputToken, uint256 outputAmount) internal {

/// @audit missing @param for `oceanId`
/// @audit missing @param for `amount`
1166:     function _grantFeeToOcean(uint256 oceanId, uint256 amount) private {

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169), [305](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L305), [820](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L820), [864](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L864), [889](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L889), [903](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L903), [920](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L920), [955](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L955), [1004](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1004), [1038](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1038), [1166](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1166)]


</details>


<a name="NC-55"></a> 
### [NC-55] Missing NatSpec `@return` from function declaration
Some function definitions have an incomplete NatSpec: add a `@return` notation to improve the code documentation.

<details>
<summary>
There are <b>22</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

142:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

201:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L142), [201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

178:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

249:     function _getBalance(address tokenAddress) internal view returns (uint256 balance) {

264:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178), [249](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L249), [264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264)]


```solidity
File: src/adapters/OceanAdapter.sol

55:     function computeOutputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 inputAmount,
            address,
            bytes32 metadata
        )
            external
            override
            onlyOcean
            returns (uint256 outputAmount)
        {

81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean
            returns (uint256 inputAmount)
        {

99:     function _fetchInteractionId(address token, uint256 interactionType) internal pure returns (bytes32) {

108:     function _calculateOceanId(address tokenAddress, uint256 tokenId) internal pure returns (uint256) {

124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

161:     function primitiveOutputAmount(

```
*Github:* [[55](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L55), [81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L99), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L108), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124), [161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161)]


```solidity
File: src/ocean/Ocean.sol

210:     function doInteraction(Interaction calldata interaction)
             external
             payable
             override
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

229:     function doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids
         )
             external
             payable
             override
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

256:     function forwardedDoInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

281:     function forwardedDoMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

305:     function supportsInterface(bytes4 interfaceId) public view virtual override(OceanERC1155, IERC165) returns (bool) {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

326:     function onERC1155Received(
             address,
             address,
             uint256,
             uint256,
             bytes calldata
         )
             external
             view
             override
             returns (bytes4)
         {

353:     function onERC1155BatchReceived(
             address,
             address,
             uint256[] calldata,
             uint256[] calldata,
             bytes calldata
         )
             external
             pure
             override
             returns (bytes4)
         {

380:     function _doInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

445:     function _doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             internal
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

682:     function _unpackInteractionTypeAndAddress(Interaction memory interaction)
             internal
             pure
             returns (InteractionType interactionType, address externalContract)
         {

```
*Github:* [[210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L210), [229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281), [305](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L305), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309), [326](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L326), [353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353), [380](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L380), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [682](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L682)]


</details>


<a name="NC-56"></a> 
### [NC-56] Missing NatSpec `@title` from contract declaration
Some contract definitions have an incomplete NatSpec: add a `@title` notation to improve the code documentation.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

20: contract Curve2PoolAdapter is OceanAdapter {

```
*Github:* [[20](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L20)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

10: interface IWETH {

25: contract CurveTricryptoAdapter is OceanAdapter {

```
*Github:* [[10](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L10), [25](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L25)]


```solidity
File: src/adapters/OceanAdapter.sol

14: abstract contract OceanAdapter is IOceanPrimitive {

```
*Github:* [[14](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L14)]



<a name="NC-57"></a> 
### [NC-57] There is no need to initialize variables with 0
Since the variables are automatically set to 0 when created, it is redundant to initialize it with 0 again.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

463:         for (uint256 i = 0; i < _idLength;) {

501:             for (uint256 i = 0; i < interactions.length;) {

```
*Github:* [[463](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L463), [501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501)]



<a name="NC-58"></a> 
### [NC-58] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16)]


```solidity
File: src/ocean/Ocean.sol

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

99:     uint8 constant NORMALIZED_DECIMALS = 18;

102:     uint256 constant GET_BALANCE_DELTA = type(uint256).max;

106:     uint256 constant NOT_INTERACTION = 1;

107:     uint256 constant INTERACTION = 2;

```
*Github:* [[95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99), [102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L102), [106](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L106), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L107)]



<a name="NC-59"></a> 
### [NC-59] Redundant `return` statement in a function with named return variables
Because the return variable (or its default value) has been assigned, explicit return at the end of the function is unnecessary, as it is returned automatically.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

201:     function _determineComputeType(

```
*Github:* [[201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

249:     function _getBalance(address tokenAddress) internal view returns (uint256 balance) {

264:     function _determineComputeType(

```
*Github:* [[249](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L249), [264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264)]



<a name="NC-60"></a> 
### [NC-60] State variables should include comments
Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

19:     address public immutable ocean;

22:     address public immutable primitive;

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16), [19](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L19), [22](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L22)]


```solidity
File: src/ocean/Ocean.sol

84:     uint256 public immutable WRAPPED_ETHER_ID;

90:     uint256 public unwrapFeeDivisor;

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

99:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[84](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L84), [90](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L90), [95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99)]



<a name="NC-61"></a> 
### [NC-61] Lines are too long
The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

160:                 interactionTypeAndAddress: _fetchInteractionId(underlying[tokenId], uint256(InteractionType.UnwrapErc20)),

```
*Github:* [[160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L160)]



<a name="NC-62"></a> 
### [NC-62] Typos

*There are <b>3</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `imlementation`
65:  *  3. Read through the imlementation of Ocean.doMultipleInteractions(), again

/// @audit `prefering`
322:      * @dev We don't revert, prefering to let the external contract

/// @audit `prefering`
349:      * @dev We don't revert, prefering to let the external contract

```
*Github:* [[65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L65), [322](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L322), [349](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L349)]



<a name="NC-63"></a> 
### [NC-63] Unused arguments should be removed or implemented
Some arguments are never used: if this is intentional, consider removing these arguments from the function. Otherwise, implement the missing logic accordingly.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `amount`
12:     function withdraw(uint256 amount) external payable;

```
*Github:* [[12](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L12)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `inputToken`
/// @audit `outputToken`
/// @audit `outputAmount`
/// @audit `userAddress`
/// @audit `maximumInputAmount`
81:     function computeInputAmount(

/// @audit `tokenId`
124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

/// @audit `inputToken`
/// @audit `outputToken`
/// @audit `inputAmount`
/// @audit `metadata`
161:     function primitiveOutputAmount(

/// @audit `tokenId`
/// @audit `amount`
171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

/// @audit `tokenId`
/// @audit `amount`
173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81), [124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124), [161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]



<a name="NC-64"></a> 
### [NC-64] Unused import
The identifier is imported but never used within the file.

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `IERC20`
6: import { IERC20 } from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

```
*Github:* [[6](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L6)]



<a name="NC-65"></a> 
### [NC-65] Unused named return
Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment. This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `computeType` not used
201:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `computeType` not used
264:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `inputAmount` not used
81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean
            returns (uint256 inputAmount)
        {

```
*Github:* [[81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `burnId` not used
/// @audit `burnAmount` not used
/// @audit `mintId` not used
/// @audit `mintAmount` not used
210:     function doInteraction(Interaction calldata interaction)
             external
             payable
             override
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit `burnIds` not used
/// @audit `burnAmounts` not used
/// @audit `mintIds` not used
/// @audit `mintAmounts` not used
229:     function doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids
         )
             external
             payable
             override
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit `burnId` not used
/// @audit `burnAmount` not used
/// @audit `mintId` not used
/// @audit `mintAmount` not used
256:     function forwardedDoInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit `burnIds` not used
/// @audit `burnAmounts` not used
/// @audit `mintIds` not used
/// @audit `mintAmounts` not used
281:     function forwardedDoMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

```
*Github:* [[210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L210), [229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281)]



<a name="NC-66"></a> 
### [NC-66] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16)]


```solidity
File: src/ocean/Ocean.sol

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

99:     uint8 constant NORMALIZED_DECIMALS = 18;

102:     uint256 constant GET_BALANCE_DELTA = type(uint256).max;

106:     uint256 constant NOT_INTERACTION = 1;

107:     uint256 constant INTERACTION = 2;

```
*Github:* [[95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99), [102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L102), [106](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L106), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L107)]



<a name="NC-67"></a> 
### [NC-67] Use `@inheritdoc` for overridden functions

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

102:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

121:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

```
*Github:* [[102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L102), [121](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L121)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

118:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

```
*Github:* [[118](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L118), [147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147)]


```solidity
File: src/adapters/OceanAdapter.sol

124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

```
*Github:* [[124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124)]


```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309)]



<a name="NC-68"></a> 
### [NC-68] Upgrade `openzeppelin` to the latest version (`5.0.0`)
These contracts import contracts from openzeppelin contracts but they are not using the latest version. For more information, please visit: [OpenZeppelin GitHub Releases](https://github.com/OpenZeppelin/openzeppelin-contracts/releases) It is recommended to always use the latest version to take advantage of updates and security fixes.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="NC-69"></a> 
### [NC-69] Use the latest solidity version for deployment (`0.8.23`)
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L4)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L4)]


```solidity
File: src/adapters/OceanAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L4)]


```solidity
File: src/ocean/Ocean.sol

6: pragma solidity 0.8.20;

```
*Github:* [[6](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L6)]



<a name="NC-70"></a> 
### [NC-70] Use of `override` is unnecessary
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

102:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

121:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

```
*Github:* [[102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L102), [121](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L121)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

118:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

```
*Github:* [[118](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L118), [147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147)]


```solidity
File: src/adapters/OceanAdapter.sol

124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

```
*Github:* [[124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124)]


```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

309:     function onERC721Received(address, address, uint256, bytes calldata) external view override returns (bytes4) {

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196), [309](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L309)]



<a name="NC-71"></a> 
### [NC-71] Returning a struct instead of a bunch of variables is better
If a function returns [too many variables](https://docs.soliditylang.org/en/v0.8.21/contracts.html#returning-multiple-values), replacing them with a struct can improve code readability, maintainability and reusability.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit 4 return variables
210:     function doInteraction(Interaction calldata interaction)
             external
             payable
             override
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit 4 return variables
229:     function doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids
         )
             external
             payable
             override
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit 4 return variables
256:     function forwardedDoInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit 4 return variables
281:     function forwardedDoMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit 4 return variables
380:     function _doInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

/// @audit 4 return variables
445:     function _doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             internal
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit 4 return variables
597:     function _executeInteraction(
             Interaction memory interaction,
             InteractionType interactionType,
             address externalContract,
             uint256 specifiedToken,
             uint256 specifiedAmount,
             address userAddress
         )
             internal
             returns (uint256 inputToken, uint256 inputAmount, uint256 outputToken, uint256 outputAmount)
         {

```
*Github:* [[210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L210), [229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281), [380](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L380), [445](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L445), [597](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L597)]



<a name="NC-72"></a> 
### [NC-72] Visibility of state variables is not explicitly defined
To avoid misunderstandings and unexpected state accesses, it is recommended to explicitly define the visibility of each state variable.

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

65:     mapping(uint256 => int128) indexOf;

68:     mapping(uint256 => uint8) decimals;

```
*Github:* [[65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L65), [68](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L68)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

73:     mapping(uint256 => uint256) indexOf;

76:     mapping(uint256 => uint8) decimals;

```
*Github:* [[73](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L73), [76](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L76)]


```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16)]


```solidity
File: src/ocean/Ocean.sol

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

99:     uint8 constant NORMALIZED_DECIMALS = 18;

102:     uint256 constant GET_BALANCE_DELTA = type(uint256).max;

106:     uint256 constant NOT_INTERACTION = 1;

107:     uint256 constant INTERACTION = 2;

108:     uint256 _ERC1155InteractionStatus;

109:     uint256 _ERC721InteractionStatus;

```
*Github:* [[95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99), [102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L102), [106](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L106), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L107), [108](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L108), [109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L109)]


</details>


<a name="NC-73"></a> 
### [NC-73] Common functions should be refactored to a common base contract
The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit seen in src/adapters/CurveTricryptoAdapter.sol
189:     function _approveToken(address tokenAddress) private {

```
*Github:* [[189](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L189)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit seen in src/adapters/Curve2PoolAdapter.sol
241:     function _approveToken(address tokenAddress) private {

```
*Github:* [[241](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L241)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit seen in src/ocean/Ocean.sol
124:     function getTokenSupply(uint256 tokenId) external view override returns (uint256) {

```
*Github:* [[124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L124)]


```solidity
File: src/ocean/Ocean.sol

/// @audit seen in src/adapters/OceanAdapter.sol
353:     function onERC1155BatchReceived(
             address,
             address,
             uint256[] calldata,
             uint256[] calldata,
             bytes calldata
         )
             external
             pure
             override
             returns (bytes4)
         {

```
*Github:* [[353](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L353)]



<a name="NC-74"></a> 
### [NC-74] Names of `private`/`internal` functions should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are <b>9</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

102:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

121:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

142:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

```
*Github:* [[102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L102), [121](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L121), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L142)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

118:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

178:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

```
*Github:* [[118](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L118), [147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147), [178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178)]


```solidity
File: src/adapters/OceanAdapter.sol

161:     function primitiveOutputAmount(

171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]



<a name="NC-75"></a> 
### [NC-75] Names of `private`/`internal` state variables should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are <b>10</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

65:     mapping(uint256 => int128) indexOf;

68:     mapping(uint256 => uint8) decimals;

```
*Github:* [[65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L65), [68](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L68)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

73:     mapping(uint256 => uint256) indexOf;

76:     mapping(uint256 => uint8) decimals;

```
*Github:* [[73](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L73), [76](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L76)]


```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16)]


```solidity
File: src/ocean/Ocean.sol

95:     uint256 constant MIN_UNWRAP_FEE_DIVISOR = 2000;

99:     uint8 constant NORMALIZED_DECIMALS = 18;

102:     uint256 constant GET_BALANCE_DELTA = type(uint256).max;

106:     uint256 constant NOT_INTERACTION = 1;

107:     uint256 constant INTERACTION = 2;

```
*Github:* [[95](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L95), [99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99), [102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L102), [106](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L106), [107](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L107)]



<a name="NC-76"></a> 
### [NC-76]  `require()` / `revert()` statements should have descriptive reason strings

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

39:         require(msg.sender == ocean);

```
*Github:* [[39](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L39)]



<a name="NC-77"></a> 
### [NC-77] Event is missing `indexed` fields
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

30:     event Swap(

38:     event Deposit(

46:     event Withdraw(

```
*Github:* [[30](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L30), [38](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L38), [46](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L46)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

35:     event Swap(

43:     event Deposit(

51:     event Withdraw(

```
*Github:* [[35](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L35), [43](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L43), [51](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L51)]


```solidity
File: src/ocean/Ocean.sol

111:     event ChangeUnwrapFee(uint256 oldFee, uint256 newFee, address sender);

141:     event EtherWrap(uint256 amount, address indexed user);

142:     event EtherUnwrap(uint256 amount, uint256 feeCharged, address indexed user);

143:     event ComputeOutputAmount(

151:     event ComputeInputAmount(

159:     event OceanTransaction(address indexed user, uint256 numberOfInteractions);

160:     event ForwardedOceanTransaction(address indexed forwarder, address indexed user, uint256 numberOfInteractions);

```
*Github:* [[111](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L111), [141](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L141), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L142), [143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L143), [151](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L151), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L160)]


</details>


<a name="NC-78"></a> 
### [NC-78] Functions not used internally could be marked `external`

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

```
*Github:* [[117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117)]




## Gas Optimizations

<a name="GAS-1"></a> 
### [GAS-1] Optimize gas by using do-while loops
Using `do-while` loops instead of `for` loops can be more gas-efficient. Even if you add an `if` condition to account for the case where the loop doesn't execute at all, a `do-while` loop can still be cheaper in terms of gas.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

463:         for (uint256 i = 0; i < _idLength;) {

501:             for (uint256 i = 0; i < interactions.length;) {

```
*Github:* [[463](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L463), [501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501)]



<a name="GAS-2"></a> 
### [GAS-2] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/)]



<a name="GAS-3"></a> 
### [GAS-3] Divisions can be `unchecked` to save gas
The expression `type(int).min/(-1)` is the only case where division causes an overflow. Therefore, uncheck can be used to [save gas](https://gist.github.com/DadeKuma/3bc597338ae774b8b3bd43280d55271f) in scenarios where it is certain that such an overflow will not occur.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

70:         uint256 unwrapFee = inputAmount / IOceanInteractions(ocean).unwrapFeeDivisor();

157:             convertedAmount = amountToConvert / shift;

```
*Github:* [[70](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L70), [157](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L157)]


```solidity
File: src/ocean/Ocean.sol

1144:             convertedAmount = amountToConvert / shift;

1159:         feeCharged = unwrapAmount / unwrapFeeDivisor;

```
*Github:* [[1144](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1144), [1159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1159)]



<a name="GAS-4"></a> 
### [GAS-4] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas
Saves deployment costs.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit duplicated on line 878
840:             revert NO_DECIMAL_METHOD();

```
*Github:* [[840](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L840)]



<a name="GAS-5"></a> 
### [GAS-5] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `wrapToken` is used only once
102:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

/// @audit `unwrapToken` is used only once
121:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

/// @audit `primitiveOutputAmount` is used only once
142:     function primitiveOutputAmount(

```
*Github:* [[102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L102), [121](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L121), [142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L142)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `wrapToken` is used only once
118:     function wrapToken(uint256 tokenId, uint256 amount) internal override {

/// @audit `unwrapToken` is used only once
147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

/// @audit `primitiveOutputAmount` is used only once
178:     function primitiveOutputAmount(

```
*Github:* [[118](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L118), [147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147), [178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `primitiveOutputAmount` is used only once
161:     function primitiveOutputAmount(

/// @audit `wrapToken` is used only once
171:     function wrapToken(uint256 tokenId, uint256 amount) internal virtual;

/// @audit `unwrapToken` is used only once
173:     function unwrapToken(uint256 tokenId, uint256 amount) internal virtual;

```
*Github:* [[161](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L161), [171](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L171), [173](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L173)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `_computeOutputAmount` is used only once
745:     function _computeOutputAmount(

/// @audit `_computeInputAmount` is used only once
786:     function _computeInputAmount(

```
*Github:* [[745](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L745), [786](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L786)]


</details>


<a name="GAS-6"></a> 
### [GAS-6] Newer versions of solidity are more gas efficient
The solidity language continues to pursue more efficient gas optimization schemes. Adopting a newer version of solidity can be more gas efficient.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L4)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L4)]


```solidity
File: src/adapters/OceanAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L4)]


```solidity
File: src/ocean/Ocean.sol

6: pragma solidity 0.8.20;

```
*Github:* [[6](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L6)]



<a name="GAS-7"></a> 
### [GAS-7] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: src/adapters/OceanAdapter.sol

150:         } else if (decimalsFrom < decimalsTo) {

```
*Github:* [[150](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L150)]


```solidity
File: src/ocean/Ocean.sol

198:         if (MIN_UNWRAP_FEE_DIVISOR > nextUnwrapFeeDivisor) revert();

419:         if (inputAmount > 0) {

426:         if (outputAmount > 0) {

463:         for (uint256 i = 0; i < _idLength;) {

501:             for (uint256 i = 0; i < interactions.length;) {

527:                 if (inputAmount > 0) {

533:                 if (outputAmount > 0) {

558:             } else if (mintIds.length > 1) {

568:             } else if (burnIds.length > 1) {

1009:         if (_isNotTokenOfPrimitive(inputToken, primitive) && (inputAmount > 0)) {

1043:         if (_isNotTokenOfPrimitive(outputToken, primitive) && (outputAmount > 0)) {

1084:         if (truncated > 0) {

1101:             assert(normalizedTransferAmount > amount);

1136:         } else if (decimalsFrom < decimalsTo) {

1167:         if (amount > 0) {

```
*Github:* [[198](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L198), [419](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L419), [426](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L426), [463](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L463), [501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501), [527](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L527), [533](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L533), [558](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L558), [568](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L568), [1009](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1009), [1043](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1043), [1084](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1084), [1101](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1101), [1136](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1136), [1167](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1167)]


</details>


<a name="GAS-8"></a> 
### [GAS-8] Optimize names to save gas
`public`/`external` function names and `public` member variable names can be optimized to save gas. See this [link](https://gist.github.com/IllIllI000/a5d8b486a8259f9f77891a919febd1a9) for an example of how it works. Below are the interfaces/abstract contracts that can be optimized so that the most frequently-called functions use the least amount of gas possible during method lookup. Method IDs that have two leading zero bytes can save 128 gas each during deployment, and renaming functions to have lower method IDs will save 22 gas per call, [per sorted position shifted](https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92)

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `changeUnwrapFee`, `doInteraction`, `doMultipleInteractions`, `forwardedDoInteraction`, `forwardedDoMultipleInteractions`, `supportsInterface`, `onERC721Received`, `onERC1155Received`, `onERC1155BatchReceived`
79: contract Ocean is IOceanInteractions, IOceanFeeChange, OceanERC1155, IERC721Receiver, IERC1155Receiver {

```
*Github:* [[79](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L79)]



<a name="GAS-9"></a> 
### [GAS-9] The result of a function call should be cached rather than re-calling the function
The function calls in solidity are expensive. If the same result of the same function calls are to be used several times, the result should be cached to reduce the gas consumption of repeated calls.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `_convertDecimals` is called 2 times
142:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

```
*Github:* [[142](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L142)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `_fetchInteractionId` is called 2 times
147:     function unwrapToken(uint256 tokenId, uint256 amount) internal override {

/// @audit `_convertDecimals` is called 2 times
/// @audit `_getBalance` is called 2 times
178:     function primitiveOutputAmount(
             uint256 inputToken,
             uint256 outputToken,
             uint256 inputAmount,
             bytes32 minimumOutputAmount
         )
             internal
             override
             returns (uint256 outputAmount)
         {

```
*Github:* [[147](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L147), [178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L178)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `_calculateOceanId` is called 3 times
/// @audit `doInteraction` is called 2 times
/// @audit `_doInteraction` is called 2 times
/// @audit `doMultipleInteractions` is called 2 times
/// @audit `_doMultipleInteractions` is called 2 times
/// @audit `_unpackInteractionTypeAndAddress` is called 2 times
/// @audit `_getSpecifiedToken` is called 2 times
/// @audit `_executeInteraction` is called 2 times
/// @audit `computeOutputAmount` is called 2 times
/// @audit `computeInputAmount` is called 2 times
/// @audit `_calculateUnwrapFee` is called 3 times
/// @audit `_convertDecimals` is called 3 times
169:     constructor(string memory uri_) OceanERC1155(uri_) {

/// @audit `_calculateOceanId` is called 2 times
700:     function _getSpecifiedToken(
             InteractionType interactionType,
             address externalContract,
             Interaction memory interaction
         )
             internal
             view
             returns (uint256 specifiedToken)
         {

/// @audit `_convertDecimals` is called 2 times
1068:     function _determineTransferAmount(
              uint256 amount,
              uint8 decimals
          )
              private
              pure
              returns (uint256 transferAmount, uint256 dust)
          {

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169), [700](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L700), [1068](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1068)]



<a name="GAS-10"></a> 
### [GAS-10] Unused named return variables without optimizer waste gas
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `computeType` not used
201:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[201](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L201)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `computeType` not used
264:     function _determineComputeType(
             uint256 inputToken,
             uint256 outputToken
         )
             private
             view
             returns (ComputeType computeType)
         {

```
*Github:* [[264](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L264)]


```solidity
File: src/adapters/OceanAdapter.sol

/// @audit `inputAmount` not used
81:     function computeInputAmount(
            uint256 inputToken,
            uint256 outputToken,
            uint256 outputAmount,
            address userAddress,
            bytes32 maximumInputAmount
        )
            external
            override
            onlyOcean
            returns (uint256 inputAmount)
        {

```
*Github:* [[81](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L81)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `burnId` not used
/// @audit `burnAmount` not used
/// @audit `mintId` not used
/// @audit `mintAmount` not used
210:     function doInteraction(Interaction calldata interaction)
             external
             payable
             override
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit `burnIds` not used
/// @audit `burnAmounts` not used
/// @audit `mintIds` not used
/// @audit `mintAmounts` not used
229:     function doMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids
         )
             external
             payable
             override
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

/// @audit `burnId` not used
/// @audit `burnAmount` not used
/// @audit `mintId` not used
/// @audit `mintAmount` not used
256:     function forwardedDoInteraction(
             Interaction calldata interaction,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (uint256 burnId, uint256 burnAmount, uint256 mintId, uint256 mintAmount)
         {

/// @audit `burnIds` not used
/// @audit `burnAmounts` not used
/// @audit `mintIds` not used
/// @audit `mintAmounts` not used
281:     function forwardedDoMultipleInteractions(
             Interaction[] calldata interactions,
             uint256[] calldata ids,
             address userAddress
         )
             external
             payable
             override
             onlyApprovedForwarder(userAddress)
             returns (
                 uint256[] memory burnIds,
                 uint256[] memory burnAmounts,
                 uint256[] memory mintIds,
                 uint256[] memory mintAmounts
             )
         {

```
*Github:* [[210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L210), [229](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L229), [256](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L256), [281](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L281)]



<a name="GAS-11"></a> 
### [GAS-11] Optimize external calls with assembly for memory efficiency
Using interfaces to make external contract calls in Solidity is convenient but can be inefficient in terms of memory utilization. Each such call involves creating a new memory location to store the data being passed, thus incurring memory expansion costs.

Inline assembly allows for optimized memory usage by re-using already allocated memory spaces or using the scratch space for smaller datasets. This can result in notable gas savings, especially for contracts that make frequent external calls.

Additionally, using inline assembly enables important safety checks like verifying if the target address has code deployed to it using `extcodesize(addr)` before making the call, mitigating risks associated with contract interactions.

<details>
<summary>
There are <b>22</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit `.doInteraction(...)`
113:         IOceanInteractions(ocean).doInteraction(interaction);

/// @audit `.doInteraction(...)`
132:         IOceanInteractions(ocean).doInteraction(interaction);

/// @audit `.exchange(...)`
164:                 ICurve2Pool(primitive).exchange(indexOfInputAmount, indexOfOutputAmount, rawInputAmount, 0);

/// @audit `.approve(...)`
190:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

/// @audit `.approve(...)`
191:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[113](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L113), [132](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L132), [164](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L164), [190](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L190), [191](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L191)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit `.doInteraction(...)`
138:             IOceanInteractions(ocean).doInteraction(interaction);

/// @audit `.doInteraction(...)`
168:         IOceanInteractions(ocean).doInteraction(interaction);

/// @audit `.add_liquidity(...)`
210:             ICurveTricrypto(primitive).add_liquidity(inputAmounts, 0);

/// @audit `.remove_liquidity_one_coin(...)`
214:                 ICurveTricrypto(primitive).remove_liquidity_one_coin(rawInputAmount, indexOfOutputAmount, 0);

/// @audit `.withdraw(...)`
215:                 IWETH(underlying[zToken]).withdraw(

/// @audit `.balanceOf(...)`
216:                     IERC20Metadata(underlying[zToken]).balanceOf(address(this)) - wethBalance

/// @audit `.remove_liquidity_one_coin(...)`
219:                 ICurveTricrypto(primitive).remove_liquidity_one_coin(rawInputAmount, indexOfOutputAmount, 0);

/// @audit `.approve(...)`
242:         IERC20Metadata(tokenAddress).approve(ocean, type(uint256).max);

/// @audit `.approve(...)`
243:         IERC20Metadata(tokenAddress).approve(primitive, type(uint256).max);

```
*Github:* [[138](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L138), [168](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L168), [210](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L210), [214](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L214), [215](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L215), [216](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L216), [219](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L219), [242](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L242), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L243)]


```solidity
File: src/ocean/Ocean.sol

/// @audit `.computeOutputAmount(...)`
760:             IOceanPrimitive(primitive).computeOutputAmount(inputToken, outputToken, inputAmount, userAddress, metadata);

/// @audit `.computeInputAmount(...)`
801:             IOceanPrimitive(primitive).computeInputAmount(inputToken, outputToken, outputAmount, userAddress, metadata);

/// @audit `.safeTransferFrom(...)`
836:             SafeERC20.safeTransferFrom(IERC20(tokenAddress), userAddress, address(this), transferAmount);

/// @audit `.safeTransfer(...)`
875:             SafeERC20.safeTransfer(IERC20(tokenAddress), userAddress, transferAmount);

/// @audit `.safeTransferFrom(...)`
891:         IERC721(tokenAddress).safeTransferFrom(userAddress, address(this), tokenId);

/// @audit `.safeTransferFrom(...)`
904:         IERC721(tokenAddress).safeTransferFrom(address(this), userAddress, tokenId);

/// @audit `.safeTransferFrom(...)`
931:         IERC1155(tokenAddress).safeTransferFrom(userAddress, address(this), tokenId, amount, "");

/// @audit `.safeTransferFrom(...)`
968:         IERC1155(tokenAddress).safeTransferFrom(address(this), userAddress, tokenId, amountRemaining, "");

```
*Github:* [[760](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L760), [801](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L801), [836](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L836), [875](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L875), [891](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L891), [904](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L904), [931](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L931), [968](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L968)]


</details>


<a name="GAS-12"></a> 
### [GAS-12] Use assembly to compute hashes to save gas
If the arguments to the encode call can fit into the scratch space (two words or fewer), then it's more efficient to use assembly to generate the hash (80 gas):

`keccak256(abi.encodePacked(x, y)) -> assembly {mstore(0x00, a); mstore(0x20, b); let hash := keccak256(0x00, 0x40); }`

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

109:         return uint256(keccak256(abi.encodePacked(tokenAddress, tokenId)));

```
*Github:* [[109](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L109)]



<a name="GAS-13"></a> 
### [GAS-13] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>22</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

178:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

180:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

182:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[178](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L178), [180](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L180), [182](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L182)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

230:             emit Swap(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

232:             emit Deposit(inputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

234:             emit Withdraw(outputToken, inputAmount, outputAmount, minimumOutputAmount, primitive, true);

```
*Github:* [[230](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L230), [232](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L232), [234](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L234)]


```solidity
File: src/ocean/Ocean.sol

199:         emit ChangeUnwrapFee(unwrapFeeDivisor, nextUnwrapFeeDivisor, msg.sender);

216:         emit OceanTransaction(msg.sender, 1);

243:         emit OceanTransaction(msg.sender, interactions.length);

266:         emit ForwardedOceanTransaction(msg.sender, userAddress, 1);

297:         emit ForwardedOceanTransaction(msg.sender, userAddress, interactions.length);

396:             emit EtherWrap(msg.value, userAddress);

479:             emit EtherWrap(msg.value, userAddress);

764:         emit ComputeOutputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

805:         emit ComputeInputAmount(primitive, inputToken, outputToken, inputAmount, outputAmount, userAddress);

838:             emit Erc20Wrap(tokenAddress, transferAmount, amount, dust, userAddress, outputToken);

876:             emit Erc20Unwrap(tokenAddress, transferAmount, amount, feeCharged, userAddress, inputToken);

893:         emit Erc721Wrap(tokenAddress, tokenId, userAddress, oceanId);

905:         emit Erc721Unwrap(tokenAddress, tokenId, userAddress, oceanId);

933:         emit Erc1155Wrap(tokenAddress, tokenId, amount, userAddress, oceanId);

969:         emit Erc1155Unwrap(tokenAddress, tokenId, amount, feeCharged, userAddress, oceanId);

983:         emit EtherUnwrap(transferAmount, feeCharged, userAddress);

```
*Github:* [[199](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L199), [216](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L216), [243](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L243), [266](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L266), [297](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L297), [396](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L396), [479](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L479), [764](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L764), [805](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L805), [838](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L838), [876](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L876), [893](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L893), [905](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L905), [933](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L933), [969](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L969), [983](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L983)]


</details>


<a name="GAS-14"></a> 
### [GAS-14] Use assembly to validate `msg.sender`

*There is one instance of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

39:         require(msg.sender == ocean);

```
*Github:* [[39](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L39)]



<a name="GAS-15"></a> 
### [GAS-15] Use assembly to write address/contract type storage values
Using `assembly { sstore(state.slot, addr)` instead of `state = addr` can save gas.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

33:         ocean = ocean_;

34:         primitive = primitive_;

```
*Github:* [[33](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L33), [34](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L34)]



<a name="GAS-16"></a> 
### [GAS-16] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

<details>
<summary>
There are <b>15</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

209:         if (((inputToken == xToken) && (outputToken == yToken)) || ((inputToken == yToken) && (outputToken == xToken)))

209:         if (((inputToken == xToken) && (outputToken == yToken)) || ((inputToken == yToken) && (outputToken == xToken)))

212:         } else if (((inputToken == xToken) || (inputToken == yToken)) && (outputToken == lpTokenId)) {

214:         } else if ((inputToken == lpTokenId) && ((outputToken == xToken) || (outputToken == yToken))) {

```
*Github:* [[209](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L209), [209](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L209), [212](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L212), [214](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L214)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

273:             ((inputToken == xToken && outputToken == yToken) || (inputToken == yToken && outputToken == xToken))

273:             ((inputToken == xToken && outputToken == yToken) || (inputToken == yToken && outputToken == xToken))

274:                 || ((inputToken == xToken && outputToken == zToken) || (inputToken == zToken && outputToken == xToken))

274:                 || ((inputToken == xToken && outputToken == zToken) || (inputToken == zToken && outputToken == xToken))

275:                 || ((inputToken == yToken && outputToken == zToken) || (inputToken == zToken && outputToken == yToken))

275:                 || ((inputToken == yToken && outputToken == zToken) || (inputToken == zToken && outputToken == yToken))

279:             ((inputToken == xToken) || (inputToken == yToken) || (inputToken == zToken)) && (outputToken == lpTokenId)

283:             (inputToken == lpTokenId) && ((outputToken == xToken) || (outputToken == yToken) || (outputToken == zToken))

```
*Github:* [[273](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L273), [273](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L273), [274](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L274), [274](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L274), [275](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L275), [275](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L275), [279](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L279), [283](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L283)]


```solidity
File: src/ocean/Ocean.sol

667:             assert(interactionType == InteractionType.UnwrapEther && specifiedToken == WRAPPED_ETHER_ID);

1009:         if (_isNotTokenOfPrimitive(inputToken, primitive) && (inputAmount > 0)) {

1043:         if (_isNotTokenOfPrimitive(outputToken, primitive) && (outputAmount > 0)) {

```
*Github:* [[667](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L667), [1009](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1009), [1043](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1043)]


</details>


<a name="GAS-17"></a> 
### [GAS-17] Use local variables for emitting
Use the function/modifier's local copy of the state variable, rather than incurring an extra Gwarmaccess (100 gas). In the unlikely event that the state variable hasn't already been used by the function/modifier, consider whether it is really necessary to include it in the event, given the fact that it incurs a Gcoldsload (2100 gas), or whether it can be passed in to or back out of the functions that do use it

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `unwrapFeeDivisor`
199:         emit ChangeUnwrapFee(unwrapFeeDivisor, nextUnwrapFeeDivisor, msg.sender);

```
*Github:* [[199](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L199)]



<a name="GAS-18"></a> 
### [GAS-18] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L4)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L4)]


```solidity
File: src/adapters/OceanAdapter.sol

4: pragma solidity 0.8.20;

```
*Github:* [[4](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L4)]


```solidity
File: src/ocean/Ocean.sol

6: pragma solidity 0.8.20;

```
*Github:* [[6](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L6)]



<a name="GAS-19"></a> 
### [GAS-19] Use `unchecked` block for safe subtractions
If it can be confirmed that the subtraction operation will not overflow, using an unchecked block can save gas. For example, `require(x <= y); z = y - x;` can be optimized to `require(x <= y); unchecked { z = y - x; }`

*There are <b>5</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

/// @audit this subtraction is checked on line 147
152:             uint256 shift = 10 ** (uint256(decimalsTo - decimalsFrom));

/// @audit this subtraction is checked on line 147
156:             uint256 shift = 10 ** (uint256(decimalsFrom - decimalsTo));

```
*Github:* [[152](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L152), [156](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L156)]


```solidity
File: src/ocean/Ocean.sol

/// @audit this subtraction is checked on line 1101
1102:             dust = normalizedTransferAmount - amount;

/// @audit this subtraction is checked on line 1132
1138:             uint256 shift = 10 ** (uint256(decimalsTo - decimalsFrom));

/// @audit this subtraction is checked on line 1132
1143:             uint256 shift = 10 ** (uint256(decimalsFrom - decimalsTo));

```
*Github:* [[1102](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1102), [1138](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1138), [1143](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1143)]



<a name="GAS-20"></a> 
### [GAS-20] Using `constant`s directly, rather than caching the value, saves gas

*There are <b>6</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

/// @audit `INTERACTION`
890:         _ERC721InteractionStatus = INTERACTION;

/// @audit `NOT_INTERACTION`
892:         _ERC721InteractionStatus = NOT_INTERACTION;

/// @audit `INTERACTION`
892:         _ERC721InteractionStatus = NOT_INTERACTION;

/// @audit `INTERACTION`
930:         _ERC1155InteractionStatus = INTERACTION;

/// @audit `NOT_INTERACTION`
932:         _ERC1155InteractionStatus = NOT_INTERACTION;

/// @audit `INTERACTION`
932:         _ERC1155InteractionStatus = NOT_INTERACTION;

```
*Github:* [[890](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L890), [892](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L892), [892](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L892), [930](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L930), [932](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L932), [932](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L932)]



<a name="GAS-21"></a> 
### [GAS-21] Using `this` to access functions results in an external call, wasting gas
External calls have an overhead of 100 gas, which can be avoided by not referencing the function using `this`. Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`, so make this change if it's required in order to call the function internally.

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

251:             return address(this).balance;

```
*Github:* [[251](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L251)]



<a name="GAS-22"></a> 
### [GAS-22] Use `selfbalance()` instead of `address(this).balance`
Use assembly when getting a contract's balance of ETH.

You can use `selfbalance()` instead of `address(this).balance` when getting your contract's balance of ETH to save gas.
Additionally, you can use `balance(address)` instead of `address.balance()` when getting an external contract's balance of ETH.

*Saves 15 gas when checking internal balance, 6 for external*

*There is one instance of this issue:*
```solidity
File: src/adapters/CurveTricryptoAdapter.sol

251:             return address(this).balance;

```
*Github:* [[251](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L251)]



<a name="GAS-23"></a> 
### [GAS-23] Cache array length outside of loop
If not cached, the solidity compiler will always read the length of the array during each iteration. That is, if it is a storage array, this is an extra sload operation (100 additional extra gas for each iteration except for the first) and if it is a memory array, this is an extra mload operation (3 additional gas for each iteration except for the first).

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

501:             for (uint256 i = 0; i < interactions.length;) {

```
*Github:* [[501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501)]



<a name="GAS-24"></a> 
### [GAS-24] State variables should be cached in stack variables rather than re-reading them from storage
The instances below point to the second+ access of a state variable within a function. Caching of a state variable replaces each Gwarmaccess (100 gas) with a much cheaper stack read. Other less obvious fixes/optimizations include having local memory caches of state variable structs, or having local caches of state variable contracts/addresses.

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

/// @audit more than 1 read for `indexOf`, line 160 and 159
160:         int128 indexOfOutputAmount = indexOf[outputToken];

```
*Github:* [[160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L160)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

/// @audit more than 1 read for `indexOf`, line 196 and 195
196:         uint256 indexOfOutputAmount = indexOf[outputToken];

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L196)]


```solidity
File: src/ocean/Ocean.sol

/// @audit more than 1 read for `unwrapFeeDivisor`, line 200 and 170
200:         unwrapFeeDivisor = nextUnwrapFeeDivisor;

/// @audit more than 1 read for `_ERC721InteractionStatus`, line 310 and 172
310:         if (_ERC721InteractionStatus == INTERACTION) {

/// @audit more than 1 read for `_ERC1155InteractionStatus`, line 338 and 171
338:         if (_ERC1155InteractionStatus == INTERACTION) {

/// @audit more than 1 read for `_ERC721InteractionStatus`, line 890 and 172
890:         _ERC721InteractionStatus = INTERACTION;

/// @audit more than 1 read for `_ERC721InteractionStatus`, line 892 and 172
892:         _ERC721InteractionStatus = NOT_INTERACTION;

/// @audit more than 1 read for `_ERC721InteractionStatus`, line 892 and 890
892:         _ERC721InteractionStatus = NOT_INTERACTION;

/// @audit more than 1 read for `_ERC1155InteractionStatus`, line 930 and 171
930:         _ERC1155InteractionStatus = INTERACTION;

/// @audit more than 1 read for `_ERC1155InteractionStatus`, line 932 and 171
932:         _ERC1155InteractionStatus = NOT_INTERACTION;

/// @audit more than 1 read for `_ERC1155InteractionStatus`, line 932 and 930
932:         _ERC1155InteractionStatus = NOT_INTERACTION;

```
*Github:* [[200](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L200), [310](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L310), [338](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L338), [890](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L890), [892](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L892), [892](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L892), [930](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L930), [932](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L932), [932](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L932)]


</details>


<a name="GAS-25"></a> 
### [GAS-25] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/adapters/OceanAdapter.sol

117:     function onERC1155Received(address, address, uint256, uint256, bytes memory) public pure returns (bytes4) {

```
*Github:* [[117](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L117)]


```solidity
File: src/ocean/Ocean.sol

169:     constructor(string memory uri_) OceanERC1155(uri_) {

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169)]



<a name="GAS-26"></a> 
### [GAS-26] Don't initialize variables with default value

*There are <b>2</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

463:         for (uint256 i = 0; i < _idLength;) {

501:             for (uint256 i = 0; i < interactions.length;) {

```
*Github:* [[463](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L463), [501](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L501)]



<a name="GAS-27"></a> 
### [GAS-27] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

<details>
<summary>
There are <b>18</b> instances (click to show):
</summary>

```solidity
File: src/adapters/Curve2PoolAdapter.sol

65:     mapping(uint256 => int128) indexOf;

68:     mapping(uint256 => uint8) decimals;

86:         indexOf[yToken] = int128(1);

159:         int128 indexOfInputAmount = indexOf[inputToken];

160:         int128 indexOfOutputAmount = indexOf[outputToken];

```
*Github:* [[65](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L65), [68](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L68), [86](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L86), [159](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L159), [160](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L160)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

76:     mapping(uint256 => uint8) decimals;

```
*Github:* [[76](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L76)]


```solidity
File: src/adapters/OceanAdapter.sol

16:     uint8 constant NORMALIZED_DECIMALS = 18;

100:         uint256 packedValue = uint256(uint160(token));

139:         uint8 decimalsFrom,

140:         uint8 decimalsTo,

```
*Github:* [[16](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L16), [100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L100), [139](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L139), [140](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L140)]


```solidity
File: src/ocean/Ocean.sol

99:     uint8 constant NORMALIZED_DECIMALS = 18;

688:         interactionType = InteractionType(uint8(interactionTypeAndAddress[0]));

689:         externalContract = address(uint160(uint256(interactionTypeAndAddress)));

821:         try IERC20Metadata(tokenAddress).decimals() returns (uint8 decimals) {

865:         try IERC20Metadata(tokenAddress).decimals() returns (uint8 decimals) {

1070:         uint8 decimals

1124:         uint8 decimalsFrom,

1125:         uint8 decimalsTo,

```
*Github:* [[99](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L99), [688](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L688), [689](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L689), [821](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L821), [865](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L865), [1070](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1070), [1124](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1124), [1125](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1125)]


</details>


<a name="GAS-28"></a> 
### [GAS-28] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/adapters/Curve2PoolAdapter.sol

77:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[77](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/Curve2PoolAdapter.sol#L77)]


```solidity
File: src/adapters/CurveTricryptoAdapter.sol

85:     constructor(address ocean_, address primitive_) OceanAdapter(ocean_, primitive_) {

```
*Github:* [[85](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/CurveTricryptoAdapter.sol#L85)]


```solidity
File: src/adapters/OceanAdapter.sol

32:     constructor(address ocean_, address primitive_) {

```
*Github:* [[32](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/adapters/OceanAdapter.sol#L32)]


```solidity
File: src/ocean/Ocean.sol

169:     constructor(string memory uri_) OceanERC1155(uri_) {

```
*Github:* [[169](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L169)]



<a name="GAS-29"></a> 
### [GAS-29] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided.

*There is one instance of this issue:*
```solidity
File: src/ocean/Ocean.sol

196:     function changeUnwrapFee(uint256 nextUnwrapFeeDivisor) external override onlyOwner {

```
*Github:* [[196](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L196)]



<a name="GAS-30"></a> 
### [GAS-30] Using assembly to check for zero can save gas
Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/ocean/Ocean.sol

391:         if (msg.value != 0) {

474:         if (msg.value != 0) {

1100:             assert(normalizedTruncatedAmount == 0);

```
*Github:* [[391](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L391), [474](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L474), [1100](https://github.com/code-423n4/2023-11-shellprotocol/blob/8139366f0f2eb32672efea621c5ae2590ffaf99f/src/ocean/Ocean.sol#L1100)]



