# Report

Audit report for **2023-09-venus** generated by *ubl4nk_bot*.

## Medium Issues


*Total <b>3</b> instances over <b>1</b> issue:*

|ID|Issue|Instances|
|-|:-|:-:|
| [M-1](#M-1) | Centralization Risk for trusted owners | 3 |

## Low Issues


*Total <b>264</b> instances over <b>12</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Array is `push()`ed but not `pop()`ed | 1 |
| [L-2](#L-2) | Check division by zero is prevented | 124 |
| [L-3](#L-3) | Consider implementing two-step procedure for updating protocol addresses | 1 |
| [L-4](#L-4) | Constructor / initialization function lacks parameter validation | 2 |
| [L-5](#L-5) | Enum values should be used instead of constant array indexes | 1 |
| [L-6](#L-6) | Governance functions should be controlled by time locks | 1 |
| [L-7](#L-7) | Loss of precision in divisions | 124 |
| [L-8](#L-8) | Check storage gap for upgradable contracts | 2 |
| [L-9](#L-9) | Prevent re-setting a state variable with the same value | 1 |
| [L-10](#L-10) | Timestamp may be manipulation | 3 |
| [L-11](#L-11) | Missing zero address check in initializer | 2 |
| [L-12](#L-12) | Initializers could be front-run | 2 |

## Non Critical Issues


*Total <b>931</b> instances over <b>43</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | Contract declarations should have NatSpec `@author` annotations | 6 |
| [NC-2](#NC-2) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 2 |
| [NC-3](#NC-3) | Consider adding a block/deny-list | 3 |
| [NC-4](#NC-4) | Consider adding formal verification proofs | 1 |
| [NC-5](#NC-5) | Consider bounding input array length | 3 |
| [NC-6](#NC-6) | Consider using `AccessControlDefaultAdminRules` rather than `AccessControl` | 2 |
| [NC-7](#NC-7) | Constants should be put on the left side of comparisons | 36 |
| [NC-8](#NC-8) | Contracts should have full test coverage | 1 |
| [NC-9](#NC-9) | Events that mark critical parameter changes should contain both the old and the new value | 15 |
| [NC-10](#NC-10) | Custom errors has no error details | 17 |
| [NC-11](#NC-11) | Duplicated `require()`/`revert()` checks should be refactored | 1 |
| [NC-12](#NC-12) | `else` block not required | 3 |
| [NC-13](#NC-13) | Enable IR-based code generation | 1 |
| [NC-14](#NC-14) | Events are emitted without the sender information | 13 |
| [NC-15](#NC-15) |  Function ordering does not follow the Solidity Style Guide | 10 |
| [NC-16](#NC-16) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-17](#NC-17) | Long functions should be refactored into multiple, smaller, functions | 2 |
| [NC-18](#NC-18) | Magic numbers should be replaced with constants | 19 |
| [NC-19](#NC-19) | Missing zero address check in functions with address parameters | 42 |
| [NC-20](#NC-20) | Named mappings are recommended | 11 |
| [NC-21](#NC-21) | NatSpec documentation for contract is missing | 6 |
| [NC-22](#NC-22) | Missing NatSpec `@param` | 6 |
| [NC-23](#NC-23) | NatSpec `@return` is missing | 4 |
| [NC-24](#NC-24) | There is no need to initialize variables with 0 | 13 |
| [NC-25](#NC-25) | Put all system-wide constants in one file | 12 |
| [NC-26](#NC-26) | State variables should include comments | 1 |
| [NC-27](#NC-27) | Contract declarations should have NatSpec `@title` annotations | 6 |
| [NC-28](#NC-28) | Lines are too long | 6 |
| [NC-29](#NC-29) | Typos | 589 |
| [NC-30](#NC-30) | Unused errors | 1 |
| [NC-31](#NC-31) | Unused `event` definition | 3 |
| [NC-32](#NC-32) | Unused named return | 4 |
| [NC-33](#NC-33) | Consider using `delete` rather than assigning zero to clear values | 5 |
| [NC-34](#NC-34) | Solidity compiler version is not fixed | 1 |
| [NC-35](#NC-35) | Expressions for constant values should use `immutable` rather than `constant` | 12 |
| [NC-36](#NC-36) | Use the latest solidity version for deployment | 6 |
| [NC-37](#NC-37) | Whitespace in Expressions | 1 |
| [NC-38](#NC-38) | Missing checks for `address(0)` when assigning values to address state variables | 1 |
| [NC-39](#NC-39) | Names of `private`/`internal` functions should be prefixed with an underscore | 9 |
| [NC-40](#NC-40) | Names of `private`/`internal` state variables should be prefixed with an underscore | 12 |
| [NC-41](#NC-41) | Variables should be named in mixedCase style | 16 |
| [NC-42](#NC-42) | Event is missing `indexed` fields | 8 |
| [NC-43](#NC-43) | Constants should be defined rather than using magic numbers | 20 |

## Gas Optimizations


*Total <b>391</b> instances over <b>31</b> issues:*

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate | 2 | - |
| [GAS-2](#GAS-2) | Consider activating via-ir for deploying | 1 | - |
| [GAS-3](#GAS-3) | Divisions can be `unchecked` to save gas | 124 | 2480 |
| [GAS-4](#GAS-4) | Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables | 41 | 4633 |
| [GAS-5](#GAS-5) | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas | 1 | - |
| [GAS-6](#GAS-6) | Increments can be `unchecked` to save gas | 3 | 180 |
| [GAS-7](#GAS-7) | Initializers can be marked as payable to save deployment gas | 2 | 42 |
| [GAS-8](#GAS-8) | `internal` functions only called once can be inlined to save gas | 6 | 180 |
| [GAS-9](#GAS-9) | Multiple accesses of the same mapping/array key/index should be cached | 5 | 210 |
| [GAS-10](#GAS-10) | Newer versions of solidity are more gas efficient | 6 | - |
| [GAS-11](#GAS-11) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 40 | 120 |
| [GAS-12](#GAS-12) | Reduce gas usage by moving to Solidity 0.8.19 or later | 6 | 6000 |
| [GAS-13](#GAS-13) | Remove or replace unused state variables | 1 | - |
| [GAS-14](#GAS-14) | Unused named return variables without optimizer waste gas | 4 | 36 |
| [GAS-15](#GAS-15) | Use assembly to emit events | 16 | 608 |
| [GAS-16](#GAS-16) | Using a double `if` statement instead of a logical AND (`&&`) | 9 | 270 |
| [GAS-17](#GAS-17) | Use a more recent version of solidity | 6 | - |
| [GAS-18](#GAS-18) | Use `unchecked` block for safe subtractions | 2 | 170 |
| [GAS-19](#GAS-19) | Using bitmap to store bool states can save gas | 1 | - |
| [GAS-20](#GAS-20) | Using bools for storage incurs overhead | 1 | - |
| [GAS-21](#GAS-21) | Cache array length outside of loop | 10 | - |
| [GAS-22](#GAS-22) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 1 | - |
| [GAS-23](#GAS-23) | Don't initialize variables with default value | 13 | - |
| [GAS-24](#GAS-24) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 14 | 770 |
| [GAS-25](#GAS-25) | Constructors can be marked as `payable` to save deployment gas | 2 | 42 |
| [GAS-26](#GAS-26) | Functions guaranteed to revert when called by normal users can be marked `payable` | 3 | 63 |
| [GAS-27](#GAS-27) | `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too) | 13 | 65 |
| [GAS-28](#GAS-28) | Using `private` rather than `public` for constants, saves gas | 4 | - |
| [GAS-29](#GAS-29) | Use `!= 0` instead of `> 0` for unsigned integer comparison | 11 | 44 |
| [GAS-30](#GAS-30) | Using assembly to check for zero can save gas | 35 | 210 |
| [GAS-31](#GAS-31) | `internal` functions not called by the contract should be removed | 8 | - |

## Medium Issues

<a name="M-1"></a> 
### [M-1] Centralization Risk for trusted owners
Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

118:     function initializeTokens(address[] calldata tokens_) external onlyOwner {

177:     function setPrimeToken(address prime_) external onlyOwner {

216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

```
*Github:* [[118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L118), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177), [216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216)]


---


## Low Issues

<a name="L-1"></a> 
### [L-1] Array is `push()`ed but not `pop()`ed
There is no limit specified on the amount of gas used, so the recipient can use up all of the remaining gas (`gasleft()`), causing it to revert. Therefore, when calling an external contract, it is necessary to specify a limited amount of gas to forward.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

303:         allMarkets.push(vToken);

```
*Github:* [[303](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L303)]


---

<a name="L-2"></a> 
### [L-2] Check division by zero is prevented

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
*Github:* [[501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501), [585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585), [654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885), [886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886), [889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889), [893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893), [922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972), [1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004), [1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009), [1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010), [1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012), [1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
*Github:* [[25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37), [49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
*Github:* [[75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163), [164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167), [168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168), [169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170), [171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172), [173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174), [175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177), [178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178), [179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179), [180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180), [181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183), [184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184), [185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186), [187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188), [189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190), [191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192), [193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193), [194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194), [195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195), [196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196), [197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198), [199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199), [200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208), [214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214), [220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220), [226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226), [232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232), [238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238), [244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244), [250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250), [256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
*Github:* [[59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59)]


</details>

---

<a name="L-3"></a> 
### [L-3] Consider implementing two-step procedure for updating protocol addresses
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must "accept" the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the "set" functions ensure that the recipient is of the right interface type.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

177:     function setPrimeToken(address prime_) external onlyOwner {

```
*Github:* [[177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177)]


---

<a name="L-4"></a> 
### [L-4] Constructor / initialization function lacks parameter validation
Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `_xvsVaultPoolId` not validated
/// @audit `_alphaNumerator` not validated
/// @audit `_alphaDenominator` not validated
/// @audit `_accessControlManager` not validated
/// @audit `_loopsLimit` not validated
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

```
*Github:* [[130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit `accessControlManager_` not validated
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

```
*Github:* [[90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90)]


---

<a name="L-5"></a> 
### [L-5] Enum values should be used instead of constant array indexes
Create a commented enum value to use instead of constant array indexes, this makes the code far easier to understand.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

684:             assets[0] = address(asset);

```
*Github:* [[684](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L684)]


---

<a name="L-6"></a> 
### [L-6] Governance functions should be controlled by time locks
Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

177:     function setPrimeToken(address prime_) external onlyOwner {

```
*Github:* [[177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177)]


---

<a name="L-7"></a> 
### [L-7] Loss of precision in divisions
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator.

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
*Github:* [[501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501), [585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585), [654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885), [886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886), [889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889), [893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893), [922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972), [1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004), [1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009), [1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010), [1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012), [1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
*Github:* [[25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37), [49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
*Github:* [[75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163), [164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167), [168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168), [169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170), [171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172), [173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174), [175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177), [178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178), [179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179), [180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180), [181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183), [184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184), [185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186), [187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188), [189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190), [191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192), [193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193), [194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194), [195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195), [196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196), [197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198), [199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199), [200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208), [214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214), [220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220), [226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226), [232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232), [238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238), [244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244), [250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250), [256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
*Github:* [[59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59)]


</details>

---

<a name="L-8"></a> 
### [L-8] Check storage gap for upgradable contracts
Each upgradable contract should include a state variable (usually named `__gap`) to provide reserved space in storage. This allows the team to freely add new state variables in the future upgrades without compromising the storage compatibility with existing deployments.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


---

<a name="L-9"></a> 
### [L-9] Prevent re-setting a state variable with the same value
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

181:         prime = prime_;

```
*Github:* [[181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L181)]


---

<a name="L-10"></a> 
### [L-10] Timestamp may be manipulation
The `block.timestamp` can be manipulated by miners to perform MEV profiting or other time-based attacks.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

378:             stakedAt[user] = block.timestamp;

399:         if (block.timestamp - stakedAt[msg.sender] < STAKING_PERIOD) revert WaitMoreTime();

481:         uint256 totalTimeStaked = block.timestamp - stakedAt[user];

```
*Github:* [[378](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L378), [399](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L399), [481](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L481)]


---

<a name="L-11"></a> 
### [L-11] Missing zero address check in initializer

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing zero check for `_accessControlManager`
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

```
*Github:* [[130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Missing zero check for `accessControlManager_`
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

```
*Github:* [[90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90)]


---

<a name="L-12"></a> 
### [L-12] Initializers could be front-run
Initializers could be front-run, allowing an attacker to either set their own values, take ownership of the contract, and in the best case forcing a re-deployment

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

130:     function initialize(

```
*Github:* [[130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

90:     function initialize(

```
*Github:* [[90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90)]


---


## Non Critical Issues

<a name="NC-1"></a> 
### [NC-1] Contract declarations should have NatSpec `@author` annotations

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
*Github:* [[6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
*Github:* [[13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
*Github:* [[38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
*Github:* [[10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10)]


---

<a name="NC-2"></a> 
### [NC-2] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
*Github:* [[67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67), [88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88)]


---

<a name="NC-3"></a> 
### [NC-3] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
*Github:* [[6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6)]


---

<a name="NC-4"></a> 
### [NC-4] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```

---

<a name="NC-5"></a> 
### [NC-5] Consider bounding input array length
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to require() that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Consider length check for `users`
204:         for (uint256 i = 0; i < users.length; ) {

/// @audit Consider length check for `users`
335:             for (uint256 i = 0; i < users.length; ) {

```
*Github:* [[204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204), [335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Consider length check for `tokens_`
119:         for (uint256 i; i < tokens_.length; ) {

```
*Github:* [[119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119)]


---

<a name="NC-6"></a> 
### [NC-6] Consider using `AccessControlDefaultAdminRules` rather than `AccessControl`
`AccessControlDefaultAdminRules` implements multiple [security best practices](https://docs.openzeppelin.com/contracts/4.x/api/access#AccessControlDefaultAdminRules) on top of the normal `AccessControl` rules, so consider using it instead.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


---

<a name="NC-7"></a> 
### [NC-7] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>
There are <b>36</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

104:         if (_wbnb == address(0)) revert InvalidAddress();

105:         if (_vbnb == address(0)) revert InvalidAddress();

106:         if (_blocksPerYear == 0) revert InvalidBlocksPerYear();

143:         if (_xvsVault == address(0)) revert InvalidAddress();

144:         if (_xvsVaultRewardToken == address(0)) revert InvalidAddress();

145:         if (_protocolShareReserve == address(0)) revert InvalidAddress();

146:         if (_comptroller == address(0)) revert InvalidAddress();

147:         if (_oracle == address(0)) revert InvalidAddress();

148:         if (_primeLiquidityProvider == address(0)) revert InvalidAddress();

201:         if (pendingScoreUpdates == 0) revert NoScoreUpdatesRequired();

202:         if (nextScoreUpdateRoundId == 0) revert NoScoreUpdatesRequired();

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

398:         if (stakedAt[msg.sender] == 0) revert IneligibleToClaim();

457:         if (vToken == address(0)) revert MarketNotSupported();

479:         if (stakedAt[user] == 0) return STAKING_PERIOD;

576:         if (distributionIncome == 0) {

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

1002:         if (totalScore == 0) return (0, 0);

1007:         if (totalCappedValue == 0) return (0, 0);

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
*Github:* [[104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L104), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L105), [106](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L106), [143](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L143), [144](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L144), [145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L145), [146](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L146), [147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L147), [148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L148), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L201), [202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L202), [377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377), [398](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L398), [457](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L457), [479](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L479), [576](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L576), [810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810), [1002](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1002), [1007](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1007), [1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012), [1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

335:         if (lastBlockAccrued == 0) {

345:         if (address_ == address(0)) {

```
*Github:* [[335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L335), [345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L345)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

55:         if (x <= 0) {

145:         if (x == 0) {

206:         if ((x & int256(0x0000000000000000000000000000001000000000000000000000000000000000)) != 0) {

212:         if ((x & int256(0x0000000000000000000000000000000800000000000000000000000000000000)) != 0) {

218:         if ((x & int256(0x0000000000000000000000000000000400000000000000000000000000000000)) != 0) {

224:         if ((x & int256(0x0000000000000000000000000000000200000000000000000000000000000000)) != 0) {

230:         if ((x & int256(0x0000000000000000000000000000000100000000000000000000000000000000)) != 0) {

236:         if ((x & int256(0x0000000000000000000000000000000080000000000000000000000000000000)) != 0) {

242:         if ((x & int256(0x0000000000000000000000000000000040000000000000000000000000000000)) != 0) {

248:         if ((x & int256(0x0000000000000000000000000000000020000000000000000000000000000000)) != 0) {

254:         if ((x & int256(0x0000000000000000000000000000000010000000000000000000000000000000)) != 0) {

```
*Github:* [[55](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L55), [145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L145), [206](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L206), [212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L212), [218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L218), [224](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L224), [230](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L230), [236](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L236), [242](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L242), [248](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L248), [254](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L254)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

44:         if (xvs == 0 || capital == 0) return 0;

44:         if (xvs == 0 || capital == 0) return 0;

```
*Github:* [[44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44)]


</details>

---

<a name="NC-8"></a> 
### [NC-8] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```

---

<a name="NC-9"></a> 
### [NC-9] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>15</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

228:             emit UserScoreUpdated(user);

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
*Github:* [[228](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L228), [241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241), [308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308), [320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320), [462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462), [694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694), [718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718), [755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755), [771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

267:                 emit TokensAccrued(token_, tokenAccrued);

300:         emit TokenDistributionInitialized(token_);

324:             emit TokenDistributionSpeedUpdated(token_, distributionSpeed_);

```
*Github:* [[180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180), [202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202), [222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222), [267](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L267), [300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300), [324](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L324)]


</details>

---

<a name="NC-10"></a> 
### [NC-10] Custom errors has no error details
Consider adding parameters to the error to indicate which user or values caused the failure.

<details>
<summary>
There are <b>17</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

20: error MarketNotSupported();

21: error InvalidLimit();

22: error IneligibleToClaim();

23: error WaitMoreTime();

24: error UserHasNoPrimeToken();

25: error InvalidCaller();

26: error InvalidComptroller();

27: error NoScoreUpdatesRequired();

28: error MarketAlreadyExists();

29: error InvalidAddress();

30: error InvalidBlocksPerYear();

31: error InvalidAlphaArguments();

32: error InvalidVToken();

```
*Github:* [[20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L20), [21](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L21), [22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L22), [23](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L23), [24](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L24), [25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L25), [26](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L26), [27](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L27), [28](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L28), [29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L29), [30](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L30), [31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L31), [32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L32)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

57:     error InvalidArguments();

63:     error InvalidCaller();

72:     error FundsTransferIsPaused();

```
*Github:* [[57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L57), [63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L63), [72](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L72)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

11: error InvalidFixedPoint();

```
*Github:* [[11](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L11)]


</details>

---

<a name="NC-11"></a> 
### [NC-11] Duplicated `require()`/`revert()` checks should be refactored
Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Duplicated on line 158
100:             revert InvalidArguments();

```
*Github:* [[100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L100)]


---

<a name="NC-12"></a> 
### [NC-12] `else` block not required
One level of nesting can be removed by not having an `else` block when the `if`-block always jumps at the end. For example:
```solidity
if (condition) {
	body1...
	return x;
} else {
	body2...
}
```
can be changed to:
```solidity
if (condition) {
	body1...
	return x;
}
body2...
```

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

482:         if (totalTimeStaked < STAKING_PERIOD) {
                 return STAKING_PERIOD - totalTimeStaked;
             } else {

855:         if (xvs > MAXIMUM_XVS_CAP) {
                 return MAXIMUM_XVS_CAP;
             } else {

931:         if (vToken == VBNB) {
                 return WBNB;
             } else {

```
*Github:* [[482](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L482), [855](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L855), [931](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L931)]


---

<a name="NC-13"></a> 
### [NC-13] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```

---

<a name="NC-14"></a> 
### [NC-14] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

269:         emit MultiplierUpdated(

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
*Github:* [[241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241), [269](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L269), [308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308), [320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320), [462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462), [694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694), [718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718), [755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755), [771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

300:         emit TokenDistributionInitialized(token_);

```
*Github:* [[180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180), [202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202), [222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222), [300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300)]


</details>

---

<a name="NC-15"></a> 
### [NC-15]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit public function `accrueInterest` came earlier from this external function
397:     function claim() external {

/// @audit public function `accrueInterest` came earlier from this external function
411:     function burn(address user) external {

/// @audit public function `accrueInterest` came earlier from this external function
419:     function togglePause() external {

/// @audit public function `accrueInterest` came earlier from this external function
433:     function claimInterest(address vToken) external whenNotPaused returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
443:     function claimInterest(address vToken, address user) external whenNotPaused returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
452:     function updateAssetsState(address _comptroller, address asset) external {

/// @audit public function `accrueInterest` came earlier from this external function
469:     function getAllMarkets() external view returns (address[] memory) {

/// @audit public function `accrueInterest` came earlier from this external function
478:     function claimTimeRemaining(address user) external view returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit public function `accrueInterest` came earlier from this external function
527:     function estimateAPR(

```
*Github:* [[397](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L397), [411](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L411), [419](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L419), [433](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L433), [443](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L443), [452](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L452), [469](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L469), [478](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L478), [496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496), [527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527)]


---

<a name="NC-16"></a> 
### [NC-16] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```

---

<a name="NC-17"></a> 
### [NC-17] Long functions should be refactored into multiple, smaller, functions

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit 86 lines
51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

/// @audit 119 lines
140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51), [140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140)]


---

<a name="NC-18"></a> 
### [NC-18] Magic numbers should be replaced with constants
Magic numbers are hard-coded values in code that can make it difficult for developers and maintainers to understand the code, and can also cause confusion or errors. To improve the readability and maintainability of code, it is recommended to replace magic numbers with constants that have good readability.

<details>
<summary>
There are <b>19</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

78:         if (x <= int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000)) {

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

113:         if (x <= int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) {

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

209:                 int256(0x0000000000000000000000000043cbaf42a000812488fc5c220ad7b97bf6e99e); // * e ^ -32

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

221:                 int256(0x0000000000000000000000000000001b4c902e273a58678d6d3bfdb93db96d02); // * e ^ -8

233:                 int256(0x000000000000000000000000000000015bf0a8b1457695355fb8ac404e7a79e3); // * e ^ -2

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

245:                 int256(0x00000000000000000000000000000000a45af1e1f40c333b3de1db4dd55f29a7); // * e ^ -0.5

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

257:                 int256(0x0000000000000000000000000000000088415abbe9a76bead8d00cf112e4d4a8); // * e ^ -0.125

```
*Github:* [[78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L78), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [113](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L113), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130), [132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132), [164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208), [209](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L209), [220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220), [221](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L221), [233](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L233), [244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244), [245](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L245), [250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250), [257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L257)]


</details>

---

<a name="NC-19"></a> 
### [NC-19] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>42</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing zero check for `_wbnb`
/// @audit Missing zero check for `_vbnb`
103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

/// @audit Missing zero check for `_accessControlManager`
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

/// @audit Missing zero check for `user`
174:     function getPendingInterests(address user) external returns (PendingInterest[] memory pendingInterests) {

/// @audit Missing zero check for `market`
263:     function updateMultipliers(address market, uint256 supplyMultiplier, uint256 borrowMultiplier) external {

/// @audit Missing zero check for `vToken`
288:     function addMarket(address vToken, uint256 supplyMultiplier, uint256 borrowMultiplier) external {

/// @audit Missing zero check for `user`
365:     function xvsUpdated(address user) external {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `market`
389:     function accrueInterestAndUpdateScore(address user, address market) external {

/// @audit Missing zero check for `user`
411:     function burn(address user) external {

/// @audit Missing zero check for `vToken`
433:     function claimInterest(address vToken) external whenNotPaused returns (uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
443:     function claimInterest(address vToken, address user) external whenNotPaused returns (uint256) {

/// @audit Missing zero check for `_comptroller`
/// @audit Missing zero check for `asset`
452:     function updateAssetsState(address _comptroller, address asset) external {

/// @audit Missing zero check for `user`
478:     function claimTimeRemaining(address user) external view returns (uint256) {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit Missing zero check for `vToken`
554:     function accrueInterest(address vToken) public {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
597:     function getInterestAccrued(address vToken, address user) public returns (uint256) {

/// @audit Missing zero check for `user`
607:     function _accrueInterestAndUpdateScore(address user) internal {

/// @audit Missing zero check for `account`
623:     function _initializeMarkets(address account) internal {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
647:     function _calculateScore(address market, address user) internal returns (uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
672:     function _claimInterest(address vToken, address user) internal returns (uint256) {

/// @audit Missing zero check for `user`
704:     function _mint(bool isIrrevocable, address user) internal {

/// @audit Missing zero check for `user`
725:     function _burn(address user) internal {

/// @audit Missing zero check for `user`
762:     function _upgrade(address user) internal {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `vToken`
779:     function _executeBoost(address user, address vToken) internal {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `market`
794:     function _updateScore(address user, address market) internal {

/// @audit Missing zero check for `user`
827:     function _updateRoundAfterTokenBurned(address user) internal {

/// @audit Missing zero check for `user`
840:     function _xvsBalanceOfUser(address user) internal view returns (uint256) {

/// @audit Missing zero check for `market`
872:     function _capitalForScore(
             uint256 xvs,
             uint256 borrow,
             uint256 supply,
             address market
         ) internal view returns (uint256, uint256, uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
918:     function _interestAccrued(address vToken, address user) internal view returns (uint256) {

/// @audit Missing zero check for `vToken`
930:     function _getUnderlying(address vToken) internal view returns (address) {

/// @audit Missing zero check for `vToken`
947:     function _incomePerBlock(address vToken) internal view returns (uint256) {

/// @audit Missing zero check for `vToken`
970:     function _incomeDistributionYearly(address vToken) internal view returns (uint256 amount) {

/// @audit Missing zero check for `vToken`
993:     function _calculateUserAPR(
             address vToken,
             uint256 totalSupply,
             uint256 totalBorrow,
             uint256 totalCappedSupply,
             uint256 totalCappedBorrow,
             uint256 userScore,
             uint256 totalScore
         ) internal view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
*Github:* [[103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L174), [263](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L263), [288](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L288), [365](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L365), [389](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L389), [411](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L411), [433](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L433), [443](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L443), [452](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L452), [478](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L478), [496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496), [527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527), [554](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L554), [597](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L597), [607](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L607), [623](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L623), [647](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L647), [672](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L672), [704](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L704), [725](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L725), [762](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L762), [779](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L779), [794](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L794), [827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827), [840](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L840), [872](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L872), [918](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L918), [930](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L930), [947](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L947), [970](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L970), [993](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L993)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Missing zero check for `accessControlManager_`
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

/// @audit Missing zero check for `prime_`
177:     function setPrimeToken(address prime_) external onlyOwner {

/// @audit Missing zero check for `token_`
192:     function releaseFunds(address token_) external {

/// @audit Missing zero check for `to_`
216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

/// @audit Missing zero check for `token_`
232:     function getEffectiveDistributionSpeed(address token_) external view returns (uint256) {

/// @audit Missing zero check for `token_`
249:     function accrueTokens(address token_) public {

/// @audit Missing zero check for `token_`
286:     function _initializeToken(address token_) internal {

/// @audit Missing zero check for `token_`
310:     function _setTokenDistributionSpeed(address token_, uint256 distributionSpeed_) internal {

/// @audit Missing zero check for `token_`
332:     function _ensureTokenInitialized(address token_) internal view {

```
*Github:* [[90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L192), [216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216), [232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L232), [249](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L249), [286](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L286), [310](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L310), [332](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L332)]


</details>

---

<a name="NC-20"></a> 
### [NC-20] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

<details>
<summary>
There are <b>11</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

21:     mapping(address => uint256) public tokenDistributionSpeeds;

24:     mapping(address => uint256) public lastAccruedBlock;

27:     mapping(address => uint256) public tokenAmountAccrued;

```
*Github:* [[21](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L21), [24](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L24), [27](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L27)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

46:     mapping(address => Token) public tokens;

61:     mapping(address => uint256) public stakedAt;

64:     mapping(address => Market) public markets;

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

100:     mapping(address => address) public vTokenForAsset;

110:     mapping(address => uint256) public unreleasedPSRIncome;

114:     mapping(address => uint256) public unreleasedPLPIncome;

```
*Github:* [[46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L46), [61](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L61), [64](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L64), [67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67), [88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L100), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L110), [114](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L114)]


</details>

---

<a name="NC-21"></a> 
### [NC-21] NatSpec documentation for contract is missing
e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
*Github:* [[6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
*Github:* [[13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
*Github:* [[38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
*Github:* [[10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10)]


---

<a name="NC-22"></a> 
### [NC-22] Missing NatSpec `@param`
Some functions have an incomplete NatSpec: add a `@param` notation to describe the function parameters to improve the code documentation.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing @param for _wbnb
/// @audit Missing @param for _vbnb
/// @audit Missing @param for _blocksPerYear
103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

/// @audit Missing @param for user
827:     function _updateRoundAfterTokenBurned(address user) internal {

```
*Github:* [[103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103), [827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit Missing @param for x
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit Missing @param for x
58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit Missing @param for x
51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

/// @audit Missing @param for x
140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51), [140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140)]


---

<a name="NC-23"></a> 
### [NC-23] NatSpec `@return` is missing
It is recommended that Solidity contracts are fully annotated using NatSpec

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51), [140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140)]


---

<a name="NC-24"></a> 
### [NC-24] There is no need to initialize variables with 0
Since the variables are automatically set to 0 when created, it is redundant to initialize it with 0 again.

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

677:         interests[vToken][user].accrued = 0;

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
*Github:* [[178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178), [204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246), [335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335), [349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349), [609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609), [625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625), [677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677), [730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730), [736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736), [737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

46:     int256 private constant EXP_MAX_VAL = 0;

```
*Github:* [[46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46)]


</details>

---

<a name="NC-25"></a> 
### [NC-25] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
*Github:* [[12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

```
*Github:* [[31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37), [40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
*Github:* [[40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48)]


</details>

---

<a name="NC-26"></a> 
### [NC-26] State variables should include comments
Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

```
*Github:* [[31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31)]


---

<a name="NC-27"></a> 
### [NC-27] Contract declarations should have NatSpec `@title` annotations
Some contract definitions have an incomplete NatSpec: add a `@title` notation to describe the contract to improve the code documentation.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
*Github:* [[8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
*Github:* [[6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
*Github:* [[13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
*Github:* [[38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
*Github:* [[10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10)]


---

<a name="NC-28"></a> 
### [NC-28] Lines are too long
The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

4: import { SafeERC20Upgradeable, IERC20Upgradeable } from "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L4)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

4: import { SafeERC20Upgradeable, IERC20Upgradeable } from "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

```
*Github:* [[105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136)]


---

<a name="NC-29"></a> 
### [NC-29] Typos

<details>
<summary>
There are <b>589</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `BSD-3-Clause`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `@custom:security-contact`
34: /// @custom:security-contact https://github.com/VenusProtocol/venus-protocol

/// @audit `https://github.com/VenusProtocol/venus-protocol`
34: /// @custom:security-contact https://github.com/VenusProtocol/venus-protocol

/// @audit `@notice`
38:     /// @notice total blocks per year

/// @audit `@custom:oz-upgrades-unsafe-allow`
39:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `state-variable-immutable`
39:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `@notice`
42:     /// @notice address of WBNB contract

/// @audit `@custom:oz-upgrades-unsafe-allow`
43:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `state-variable-immutable`
43:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `@notice`
46:     /// @notice address of VBNB contract

/// @audit `@custom:oz-upgrades-unsafe-allow`
47:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `state-variable-immutable`
47:     /// @custom:oz-upgrades-unsafe-allow state-variable-immutable

/// @audit `@notice`
50:     /// @notice Emitted when prime token is minted

/// @audit `@notice`
53:     /// @notice Emitted when prime token is burned

/// @audit `@notice`
56:     /// @notice Emitted asset state is update by protocol share reserve

/// @audit `@notice`
59:     /// @notice Emitted when a market is added to prime program

/// @audit `@notice`
62:     /// @notice Emitted when mint limits are updated

/// @audit `@notice`
70:     /// @notice Emitted when user score is updated

/// @audit `@notice`
73:     /// @notice Emitted when alpha is updated

/// @audit `@notice`
81:     /// @notice Emitted when multiplier is updated

/// @audit `@notice`
90:     /// @notice Emitted when interest is claimed

/// @audit `@notice`
93:     /// @notice Emitted when revocable token is upgraded to irrevocable token

/// @audit `@notice`
97:      * @notice Prime constructor

/// @audit `@param`
98:      * @param _wbnb Address of WBNB

/// @audit `_wbnb`
98:      * @param _wbnb Address of WBNB

/// @audit `@param`
99:      * @param _vbnb Address of VBNB

/// @audit `_vbnb`
99:      * @param _vbnb Address of VBNB

/// @audit `@param`
100:      * @param _blocksPerYear total blocks per year

/// @audit `_blocksPerYear`
100:      * @param _blocksPerYear total blocks per year

/// @audit `@custom:oz-upgrades-unsafe-allow`
102:     /// @custom:oz-upgrades-unsafe-allow constructor

/// @audit `upgradeable.`
111:         // Note that the contract is upgradeable. Use initialize() or reinitializers

/// @audit `initialize()`
111:         // Note that the contract is upgradeable. Use initialize() or reinitializers

/// @audit `reinitializers`
111:         // Note that the contract is upgradeable. Use initialize() or reinitializers

/// @audit `variables.`
112:         // to set the state variables.

/// @audit `@notice`
117:      * @notice Prime initializer

/// @audit `@param`
118:      * @param _xvsVault Address of XVSVault

/// @audit `_xvsVault`
118:      * @param _xvsVault Address of XVSVault

/// @audit `XVSVault`
118:      * @param _xvsVault Address of XVSVault

/// @audit `@param`
119:      * @param _xvsVaultRewardToken Address of XVSVault reward token

/// @audit `_xvsVaultRewardToken`
119:      * @param _xvsVaultRewardToken Address of XVSVault reward token

/// @audit `XVSVault`
119:      * @param _xvsVaultRewardToken Address of XVSVault reward token

/// @audit `@param`
120:      * @param _xvsVaultPoolId Pool id of XVSVault

/// @audit `_xvsVaultPoolId`
120:      * @param _xvsVaultPoolId Pool id of XVSVault

/// @audit `XVSVault`
120:      * @param _xvsVaultPoolId Pool id of XVSVault

/// @audit `@param`
121:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `_alphaNumerator`
121:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `alpha.`
121:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `@param`
122:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `_alphaDenominator`
122:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `alpha.`
122:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `@param`
123:      * @param _accessControlManager Address of AccessControlManager

/// @audit `_accessControlManager`
123:      * @param _accessControlManager Address of AccessControlManager

/// @audit `AccessControlManager`
123:      * @param _accessControlManager Address of AccessControlManager

/// @audit `@param`
124:      * @param _protocolShareReserve Address of ProtocolShareReserve

/// @audit `_protocolShareReserve`
124:      * @param _protocolShareReserve Address of ProtocolShareReserve

/// @audit `ProtocolShareReserve`
124:      * @param _protocolShareReserve Address of ProtocolShareReserve

/// @audit `@param`
125:      * @param _primeLiquidityProvider Address of PrimeLiquidityProvider

/// @audit `_primeLiquidityProvider`
125:      * @param _primeLiquidityProvider Address of PrimeLiquidityProvider

/// @audit `PrimeLiquidityProvider`
125:      * @param _primeLiquidityProvider Address of PrimeLiquidityProvider

/// @audit `@param`
126:      * @param _comptroller Address of Comptroller

/// @audit `_comptroller`
126:      * @param _comptroller Address of Comptroller

/// @audit `@param`
127:      * @param _oracle Address of Oracle

/// @audit `_oracle`
127:      * @param _oracle Address of Oracle

/// @audit `@param`
128:      * @param _loopsLimit Maximum number of loops allowed in a single transaction

/// @audit `_loopsLimit`
128:      * @param _loopsLimit Maximum number of loops allowed in a single transaction

/// @audit `@notice`
170:      * @notice Returns boosted pending interest accrued for a user for all markets

/// @audit `@param`
171:      * @param user the account for which to get the accrued interests

/// @audit `@return`
172:      * @return pendingInterests the number of underlying tokens accrued by the user for all markets

/// @audit `pendingInterests`
172:      * @return pendingInterests the number of underlying tokens accrued by the user for all markets

/// @audit `@notice`
197:      * @notice Update total score of multiple users and market

/// @audit `@param`
198:      * @param users accounts for which we need to update score

/// @audit `@notice`
233:      * @notice Update value of alpha

/// @audit `@param`
234:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `_alphaNumerator`
234:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `alpha.`
234:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `@param`
235:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `_alphaDenominator`
235:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `alpha.`
235:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `@notice`
258:      * @notice Update multipliers for a market

/// @audit `@param`
259:      * @param market address of the market vToken

/// @audit `vToken`
259:      * @param market address of the market vToken

/// @audit `@param`
260:      * @param supplyMultiplier new supply multiplier for the market, scaled by 1e18

/// @audit `supplyMultiplier`
260:      * @param supplyMultiplier new supply multiplier for the market, scaled by 1e18

/// @audit `market,`
260:      * @param supplyMultiplier new supply multiplier for the market, scaled by 1e18

/// @audit `@param`
261:      * @param borrowMultiplier new borrow multiplier for the market, scaled by 1e18

/// @audit `borrowMultiplier`
261:      * @param borrowMultiplier new borrow multiplier for the market, scaled by 1e18

/// @audit `market,`
261:      * @param borrowMultiplier new borrow multiplier for the market, scaled by 1e18

/// @audit `@notice`
283:      * @notice Add a market to prime program

/// @audit `@param`
284:      * @param vToken address of the market vToken

/// @audit `vToken`
284:      * @param vToken address of the market vToken

/// @audit `vToken`
284:      * @param vToken address of the market vToken

/// @audit `@param`
285:      * @param supplyMultiplier the multiplier for supply cap. It should be converted to 1e18

/// @audit `supplyMultiplier`
285:      * @param supplyMultiplier the multiplier for supply cap. It should be converted to 1e18

/// @audit `@param`
286:      * @param borrowMultiplier the multiplier for borrow cap. It should be converted to 1e18

/// @audit `borrowMultiplier`
286:      * @param borrowMultiplier the multiplier for borrow cap. It should be converted to 1e18

/// @audit `@notice`
312:      * @notice Set limits for total tokens that can be minted

/// @audit `@param`
313:      * @param _irrevocableLimit total number of irrevocable tokens that can be minted

/// @audit `_irrevocableLimit`
313:      * @param _irrevocableLimit total number of irrevocable tokens that can be minted

/// @audit `@param`
314:      * @param _revocableLimit total number of revocable tokens that can be minted

/// @audit `_revocableLimit`
314:      * @param _revocableLimit total number of revocable tokens that can be minted

/// @audit `@notice`
327:      * @notice Directly issue prime tokens to users

/// @audit `@param`
328:      * @param isIrrevocable are the tokens being issued

/// @audit `isIrrevocable`
328:      * @param isIrrevocable are the tokens being issued

/// @audit `@param`
329:      * @param users list of address to issue tokens to

/// @audit `@notice`
362:      * @notice Executed by XVSVault whenever user's XVSVault balance changes

/// @audit `XVSVault`
362:      * @notice Executed by XVSVault whenever user's XVSVault balance changes

/// @audit `XVSVault`
362:      * @notice Executed by XVSVault whenever user's XVSVault balance changes

/// @audit `@param`
363:      * @param user the account address whose balance was updated

/// @audit `@notice`
385:      * @notice accrues interes and updates score for an user for a specific market

/// @audit `interes`
385:      * @notice accrues interes and updates score for an user for a specific market

/// @audit `@param`
386:      * @param user the account address for which to accrue interest and update score

/// @audit `@param`
387:      * @param market the market for which to accrue interest and update score

/// @audit `@notice`
395:      * @notice For claiming prime token when staking period is completed

/// @audit `@notice`
408:      * @notice For burning any prime token

/// @audit `@param`
409:      * @param user the account address for which the prime token will be burned

/// @audit `@notice`
417:      * @notice To pause or unpause claiming of interest

/// @audit `unpause`
417:      * @notice To pause or unpause claiming of interest

/// @audit `@notice`
429:      * @notice For user to claim boosted yield

/// @audit `@param`
430:      * @param vToken the market for which claim the accrued interest

/// @audit `vToken`
430:      * @param vToken the market for which claim the accrued interest

/// @audit `@return`
431:      * @return amount the amount of tokens transferred to the user

/// @audit `@notice`
438:      * @notice For user to claim boosted yield

/// @audit `@param`
439:      * @param vToken the market for which claim the accrued interest

/// @audit `vToken`
439:      * @param vToken the market for which claim the accrued interest

/// @audit `@param`
440:      * @param user the user for which claim the accrued interest

/// @audit `@return`
441:      * @return amount the amount of tokens transferred to the user

/// @audit `@notice`
448:      * @notice Callback by ProtocolShareReserve to update assets state when funds are released to this contract

/// @audit `ProtocolShareReserve`
448:      * @notice Callback by ProtocolShareReserve to update assets state when funds are released to this contract

/// @audit `@param`
449:      * @param _comptroller The address of the Comptroller whose income is distributed

/// @audit `_comptroller`
449:      * @param _comptroller The address of the Comptroller whose income is distributed

/// @audit `@param`
450:      * @param asset The address of the asset whose income is distributed

/// @audit `@notice`
466:      * @notice Retrieves an array of all available markets

/// @audit `@return`
467:      * @return an array of addresses representing all available markets

/// @audit `@notice`
474:      * @notice fetch the numbers of seconds remaining for staking period to complete

/// @audit `@param`
475:      * @param user the account address for which we are checking the remaining time

/// @audit `@return`
476:      * @return timeRemaining the number of seconds the user needs to wait to claim prime token

/// @audit `timeRemaining`
476:      * @return timeRemaining the number of seconds the user needs to wait to claim prime token

/// @audit `@notice`
490:      * @notice Returns supply and borrow APR for user for a given market

/// @audit `@param`
491:      * @param market the market for which to fetch the APR

/// @audit `@param`
492:      * @param user the account for which to get the APR

/// @audit `@return`
493:      * @return supplyAPR supply APR of the user in BPS

/// @audit `supplyAPR`
493:      * @return supplyAPR supply APR of the user in BPS

/// @audit `@return`
494:      * @return borrowAPR borrow APR of the user in BPS

/// @audit `borrowAPR`
494:      * @return borrowAPR borrow APR of the user in BPS

/// @audit `@notice`
518:      * @notice Returns supply and borrow APR for estimated supply, borrow and XVS staked

/// @audit `supply,`
518:      * @notice Returns supply and borrow APR for estimated supply, borrow and XVS staked

/// @audit `@param`
519:      * @param market the market for which to fetch the APR

/// @audit `@param`
520:      * @param user the account for which to get the APR

/// @audit `@param`
521:      * @param borrow hypothetical borrow amount

/// @audit `@param`
522:      * @param supply hypothetical supply amount

/// @audit `@param`
523:      * @param xvsStaked hypothetical staked XVS amount

/// @audit `xvsStaked`
523:      * @param xvsStaked hypothetical staked XVS amount

/// @audit `@return`
524:      * @return supplyAPR supply APR of the user in BPS

/// @audit `supplyAPR`
524:      * @return supplyAPR supply APR of the user in BPS

/// @audit `@return`
525:      * @return borrowAPR borrow APR of the user in BPS

/// @audit `borrowAPR`
525:      * @return borrowAPR borrow APR of the user in BPS

/// @audit `@notice`
551:      * @notice Distributes income from market since last distribution

/// @audit `@param`
552:      * @param vToken the market for which to distribute the income

/// @audit `vToken`
552:      * @param vToken the market for which to distribute the income

/// @audit `@notice`
592:      * @notice Returns boosted interest accrued for a user

/// @audit `@param`
593:      * @param vToken the market for which to fetch the accrued interest

/// @audit `vToken`
593:      * @param vToken the market for which to fetch the accrued interest

/// @audit `@param`
594:      * @param user the account for which to get the accrued interest

/// @audit `@return`
595:      * @return interestAccrued the number of underlying tokens accrued by the user since the last accrual

/// @audit `interestAccrued`
595:      * @return interestAccrued the number of underlying tokens accrued by the user since the last accrual

/// @audit `@notice`
604:      * @notice accrues interes and updates score of all markets for an user

/// @audit `interes`
604:      * @notice accrues interes and updates score of all markets for an user

/// @audit `@param`
605:      * @param user the account address for which to accrue interest and update score

/// @audit `@notice`
620:      * @notice Initializes all the markets for the user when a prime token is minted

/// @audit `@param`
621:      * @param account the account address for which markets needs to be initialized

/// @audit `@notice`
642:      * @notice calculate the current score of user

/// @audit `@param`
643:      * @param market the market for which to calculate the score

/// @audit `@param`
644:      * @param user the account for which to calculate the score

/// @audit `@return`
645:      * @return score the score of the user

/// @audit `@notice`
667:      * @notice To transfer the accrued interest to user

/// @audit `@param`
668:      * @param vToken the market for which to claim

/// @audit `vToken`
668:      * @param vToken the market for which to claim

/// @audit `@param`
669:      * @param user the account for which to get the accrued interest

/// @audit `@return`
670:      * @return amount the amount of tokens transferred to the user

/// @audit `@notice`
700:      * @notice Used to mint a new prime token

/// @audit `@param`
701:      * @param isIrrevocable is the tokens being issued is irrevocable

/// @audit `isIrrevocable`
701:      * @param isIrrevocable is the tokens being issued is irrevocable

/// @audit `@param`
702:      * @param user token owner

/// @audit `@notice`
722:      * @notice Used to burn a new prime token

/// @audit `@param`
723:      * @param user owner whose prime token to burn

/// @audit `@notice`
759:      * @notice Used to upgrade an token

/// @audit `@param`
760:      * @param user owner whose prime token to upgrade

/// @audit `@notice`
775:      * @notice Accrue rewards for the user. Must be called by Comptroller before changing account's borrow or supply balance.

/// @audit `user.`
775:      * @notice Accrue rewards for the user. Must be called by Comptroller before changing account's borrow or supply balance.

/// @audit `balance.`
775:      * @notice Accrue rewards for the user. Must be called by Comptroller before changing account's borrow or supply balance.

/// @audit `@param`
776:      * @param user account for which we need to accrue rewards

/// @audit `@param`
777:      * @param vToken the market for which we need to accrue rewards

/// @audit `vToken`
777:      * @param vToken the market for which we need to accrue rewards

/// @audit `@notice`
790:      * @notice Update total score of user and market. Must be called after changing account's borrow or supply balance.

/// @audit `market.`
790:      * @notice Update total score of user and market. Must be called after changing account's borrow or supply balance.

/// @audit `balance.`
790:      * @notice Update total score of user and market. Must be called after changing account's borrow or supply balance.

/// @audit `@param`
791:      * @param user account for which we need to update score

/// @audit `@param`
792:      * @param market the market for which we need to score

/// @audit `@notice`
805:      * @notice Verify new alpha arguments

/// @audit `@param`
806:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `_alphaNumerator`
806:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `alpha.`
806:      * @param _alphaNumerator numerator of alpha. If alpha is 0.5 then numerator is 1

/// @audit `@param`
807:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `_alphaDenominator`
807:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `alpha.`
807:      * @param _alphaDenominator denominator of alpha. If alpha is 0.5 then denominator is 2

/// @audit `@notice`
816:      * @notice starts round to update scores of a particular or all markets

/// @audit `@notice`
825:      * @notice update the required score updates when token is burned before round is completed

/// @audit `@notice`
836:      * @notice fetch the current XVS balance of user in the XVSVault

/// @audit `XVSVault`
836:      * @notice fetch the current XVS balance of user in the XVSVault

/// @audit `@param`
837:      * @param user the account address

/// @audit `@return`
838:      * @return xvsBalance the XVS balance of user

/// @audit `xvsBalance`
838:      * @return xvsBalance the XVS balance of user

/// @audit `@notice`
850:      * @notice calculate the current XVS balance that will be used in calculation of score

/// @audit `@param`
851:      * @param xvs the actual XVS balance of user

/// @audit `@return`
852:      * @return xvsBalanceForScore the XVS balance to use in score

/// @audit `xvsBalanceForScore`
852:      * @return xvsBalanceForScore the XVS balance to use in score

/// @audit `@notice`
863:      * @notice calculate the capital for calculation of score

/// @audit `@param`
864:      * @param xvs the actual XVS balance of user

/// @audit `@param`
865:      * @param borrow the borrow balance of user

/// @audit `@param`
866:      * @param supply the supply balance of user

/// @audit `@param`
867:      * @param market the market vToken address

/// @audit `vToken`
867:      * @param market the market vToken address

/// @audit `@return`
868:      * @return capital the capital to use in calculation of score

/// @audit `@return`
869:      * @return cappedSupply the capped supply of user

/// @audit `cappedSupply`
869:      * @return cappedSupply the capped supply of user

/// @audit `@return`
870:      * @return cappedBorrow the capped borrow of user

/// @audit `cappedBorrow`
870:      * @return cappedBorrow the capped borrow of user

/// @audit `@notice`
900:      * @notice Used to get if the XVS balance is eligible for prime token

/// @audit `@param`
901:      * @param amount amount of XVS

/// @audit `@return`
902:      * @return isEligible true if the staked XVS amount is enough to consider the associated user eligible for a Prime token, false otherwise

/// @audit `isEligible`
902:      * @return isEligible true if the staked XVS amount is enough to consider the associated user eligible for a Prime token, false otherwise

/// @audit `token,`
902:      * @return isEligible true if the staked XVS amount is enough to consider the associated user eligible for a Prime token, false otherwise

/// @audit `@notice`
913:      * @notice Calculate the interests accrued by the user in the market, since the last accrual

/// @audit `market,`
913:      * @notice Calculate the interests accrued by the user in the market, since the last accrual

/// @audit `@param`
914:      * @param vToken the market for which calculate the accrued interest

/// @audit `vToken`
914:      * @param vToken the market for which calculate the accrued interest

/// @audit `@param`
915:      * @param user the user for which calculate the accrued interest

/// @audit `@return`
916:      * @return interestAccrued the number of underlying tokens accrued by the user since the last accrual

/// @audit `interestAccrued`
916:      * @return interestAccrued the number of underlying tokens accrued by the user since the last accrual

/// @audit `@notice`
926:      * @notice Returns the underlying token associated with the VToken, or WBNB if the market is VBNB

/// @audit `VToken,`
926:      * @notice Returns the underlying token associated with the VToken, or WBNB if the market is VBNB

/// @audit `@param`
927:      * @param vToken the market whose underlying token will be returned

/// @audit `vToken`
927:      * @param vToken the market whose underlying token will be returned

/// @audit `@return`
928:      * @return underlying The address of the underlying token associated with the VToken, or the address of the WBNB token if the market is VBNB

/// @audit `VToken,`
928:      * @return underlying The address of the underlying token associated with the VToken, or the address of the WBNB token if the market is VBNB

/// @audit `//////////////////////////////////////////////////`
938:     //////////////////////////////////////////////////

/// @audit `////////////////`
939:     //////////////// APR Calculation ////////////////

/// @audit `////////////////`
939:     //////////////// APR Calculation ////////////////

/// @audit `////////////////////////////////////////////////`
940:     ////////////////////////////////////////////////

/// @audit `@notice`
943:      * @notice Returns the income the market generates per block

/// @audit `@param`
944:      * @param vToken the market for which to fetch the income per block

/// @audit `vToken`
944:      * @param vToken the market for which to fetch the income per block

/// @audit `@return`
945:      * @return income the amount of tokens generated as income per block

/// @audit `@notice`
954:      * @notice the percentage of income we distribute among the prime token holders

/// @audit `@return`
955:      * @return percentage the percentage returned without mantissa

/// @audit `@notice`
966:      * @notice the total income that's going to be distributed in a year to prime token holders

/// @audit `@param`
967:      * @param vToken the market for which to fetch the total income that's going to distributed in a year

/// @audit `vToken`
967:      * @param vToken the market for which to fetch the total income that's going to distributed in a year

/// @audit `@return`
968:      * @return amount the total income

/// @audit `@notice`
982:      * @notice used to calculate the supply and borrow APR of the user

/// @audit `@param`
983:      * @param vToken the market for which to fetch the APR

/// @audit `vToken`
983:      * @param vToken the market for which to fetch the APR

/// @audit `@param`
984:      * @param totalSupply the total token supply of the user

/// @audit `totalSupply`
984:      * @param totalSupply the total token supply of the user

/// @audit `@param`
985:      * @param totalBorrow the total tokens borrowed by the user

/// @audit `totalBorrow`
985:      * @param totalBorrow the total tokens borrowed by the user

/// @audit `@param`
986:      * @param totalCappedSupply the total token capped supply of the user

/// @audit `totalCappedSupply`
986:      * @param totalCappedSupply the total token capped supply of the user

/// @audit `@param`
987:      * @param totalCappedBorrow the total capped tokens borrowed by the user

/// @audit `totalCappedBorrow`
987:      * @param totalCappedBorrow the total capped tokens borrowed by the user

/// @audit `@param`
988:      * @param userScore the score of the user

/// @audit `userScore`
988:      * @param userScore the score of the user

/// @audit `@param`
989:      * @param totalScore the total market score

/// @audit `totalScore`
989:      * @param totalScore the total market score

/// @audit `@return`
990:      * @return supplyAPR the supply APR of the user

/// @audit `supplyAPR`
990:      * @return supplyAPR the supply APR of the user

/// @audit `@return`
991:      * @return borrowAPR the borrow APR of the user

/// @audit `borrowAPR`
991:      * @return borrowAPR the borrow APR of the user

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1), [1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L34), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L34), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L38), [39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L39), [39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L39), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L42), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L43), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L43), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L46), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L47), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L47), [50](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L50), [53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L53), [56](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L56), [59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L59), [62](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L62), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L70), [73](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L73), [81](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L81), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L90), [93](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L93), [97](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L97), [98](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L98), [98](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L98), [99](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L99), [99](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L99), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L100), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L100), [102](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L102), [111](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L111), [111](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L111), [111](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L111), [112](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L112), [117](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L117), [118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L118), [118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L118), [118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L118), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L119), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L119), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L119), [120](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L120), [120](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L120), [120](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L120), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L121), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L121), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L121), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L122), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L122), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L122), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L123), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L124), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L124), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L124), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L125), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L126), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L126), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L127), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L128), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L128), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L170), [171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L171), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L172), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L172), [197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L197), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L198), [233](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L233), [234](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L234), [234](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L234), [234](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L234), [235](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L235), [235](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L235), [235](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L235), [258](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L258), [259](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L259), [259](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L259), [260](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L260), [260](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L260), [260](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L260), [261](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L261), [261](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L261), [261](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L261), [283](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L283), [284](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L284), [284](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L284), [284](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L284), [285](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L285), [285](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L285), [286](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L286), [286](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L286), [312](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L312), [313](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L313), [313](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L313), [314](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L314), [314](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L314), [327](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L327), [328](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L328), [328](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L328), [329](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L329), [362](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L362), [362](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L362), [362](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L362), [363](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L363), [385](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L385), [385](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L385), [386](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L386), [387](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L387), [395](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L395), [408](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L408), [409](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L409), [417](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L417), [417](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L417), [429](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L429), [430](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L430), [430](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L430), [431](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L431), [438](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L438), [439](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L439), [439](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L439), [440](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L440), [441](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L441), [448](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L448), [448](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L448), [449](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L449), [449](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L449), [450](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L450), [466](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L466), [467](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L467), [474](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L474), [475](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L475), [476](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L476), [476](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L476), [490](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L490), [491](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L491), [492](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L492), [493](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L493), [493](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L493), [494](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L494), [494](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L494), [518](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L518), [518](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L518), [519](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L519), [520](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L520), [521](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L521), [522](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L522), [523](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L523), [523](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L523), [524](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L524), [524](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L524), [525](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L525), [525](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L525), [551](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L551), [552](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L552), [552](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L552), [592](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L592), [593](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L593), [593](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L593), [594](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L594), [595](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L595), [595](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L595), [604](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L604), [604](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L604), [605](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L605), [620](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L620), [621](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L621), [642](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L642), [643](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L643), [644](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L644), [645](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L645), [667](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L667), [668](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L668), [668](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L668), [669](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L669), [670](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L670), [700](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L700), [701](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L701), [701](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L701), [702](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L702), [722](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L722), [723](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L723), [759](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L759), [760](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L760), [775](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L775), [775](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L775), [775](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L775), [776](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L776), [777](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L777), [777](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L777), [790](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L790), [790](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L790), [790](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L790), [791](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L791), [792](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L792), [805](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L805), [806](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L806), [806](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L806), [806](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L806), [807](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L807), [807](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L807), [807](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L807), [816](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L816), [825](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L825), [836](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L836), [836](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L836), [837](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L837), [838](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L838), [838](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L838), [850](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L850), [851](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L851), [852](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L852), [852](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L852), [863](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L863), [864](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L864), [865](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L865), [866](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L866), [867](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L867), [867](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L867), [868](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L868), [869](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L869), [869](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L869), [870](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L870), [870](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L870), [900](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L900), [901](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L901), [902](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L902), [902](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L902), [902](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L902), [913](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L913), [913](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L913), [914](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L914), [914](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L914), [915](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L915), [916](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L916), [916](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L916), [926](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L926), [926](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L926), [927](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L927), [927](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L927), [928](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L928), [928](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L928), [938](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L938), [939](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L939), [939](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L939), [940](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L940), [943](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L943), [944](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L944), [944](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L944), [945](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L945), [954](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L954), [955](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L955), [966](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L966), [967](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L967), [967](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L967), [968](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L968), [982](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L982), [983](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L983), [983](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L983), [984](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L984), [984](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L984), [985](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L985), [985](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L985), [986](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L986), [986](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L986), [987](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L987), [987](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L987), [988](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L988), [988](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L988), [989](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L989), [989](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L989), [990](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L990), [990](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L990), [991](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L991), [991](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L991)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `BSD-3-Clause`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `@notice`
11:     /// @notice The max token distribution speed

/// @audit `@notice`
14:     /// @notice exp scale

/// @audit `@notice`
17:     /// @notice Address of the Prime contract

/// @audit `@notice`
20:     /// @notice The rate at which token is distributed (per block)

/// @audit `block)`
20:     /// @notice The rate at which token is distributed (per block)

/// @audit `@notice`
23:     /// @notice The rate at which token is distributed to the Prime contract

/// @audit `@notice`
26:     /// @notice The token accrued but not yet transferred to prime contract

/// @audit `@notice`
29:     /// @notice Emitted when a token distribution is initialized

/// @audit `@notice`
32:     /// @notice Emitted when a new token distribution speed is set

/// @audit `@notice`
35:     /// @notice Emitted when prime token contract address is changed

/// @audit `@notice`
38:     /// @notice Emitted when distribution state(Index and block) is updated

/// @audit `state(Index`
38:     /// @notice Emitted when distribution state(Index and block) is updated

/// @audit `block)`
38:     /// @notice Emitted when distribution state(Index and block) is updated

/// @audit `@notice`
41:     /// @notice Emitted when token is transferred to the prime contract

/// @audit `@notice`
44:     /// @notice Emitted on sweep token success

/// @audit `@notice`
47:     /// @notice Emitted on updation of initial balance for token

/// @audit `updation`
47:     /// @notice Emitted on updation of initial balance for token

/// @audit `@notice`
50:     /// @notice Emitted when funds transfer is paused

/// @audit `@notice`
53:     /// @notice Emitted when funds transfer is resumed

/// @audit `@notice`
56:     /// @notice Thrown when arguments are passed are invalid

/// @audit `@notice`
59:     /// @notice Thrown when distribution speed is greater than MAX_DISTRIBUTION_SPEED

/// @audit `MAX_DISTRIBUTION_SPEED`
59:     /// @notice Thrown when distribution speed is greater than MAX_DISTRIBUTION_SPEED

/// @audit `@notice`
62:     /// @notice Thrown when caller is not the desired caller

/// @audit `@notice`
65:     /// @notice Thrown when token is initialized

/// @audit `///@notice`
68:     ///@notice Error thrown when PrimeLiquidityProvider's balance is less than sweep amount

/// @audit `PrimeLiquidityProvider's`
68:     ///@notice Error thrown when PrimeLiquidityProvider's balance is less than sweep amount

/// @audit `@notice`
71:     /// @notice Error thrown when funds transfer is paused

/// @audit `@notice`
74:     /// @notice Error thrown when intrest accrue is called for not initialized token

/// @audit `intrest`
74:     /// @notice Error thrown when intrest accrue is called for not initialized token

/// @audit `@custom:oz-upgrades-unsafe-allow`
77:     /// @custom:oz-upgrades-unsafe-allow constructor

/// @audit `@notice`
83:      * @notice PrimeLiquidityProvider initializer

/// @audit `PrimeLiquidityProvider`
83:      * @notice PrimeLiquidityProvider initializer

/// @audit `deployer`
84:      * @dev Initializes the deployer to owner

/// @audit `@param`
85:      * @param accessControlManager_ AccessControlManager contract address

/// @audit `accessControlManager_`
85:      * @param accessControlManager_ AccessControlManager contract address

/// @audit `AccessControlManager`
85:      * @param accessControlManager_ AccessControlManager contract address

/// @audit `@param`
86:      * @param tokens_ Array of addresses of the tokens

/// @audit `tokens_`
86:      * @param tokens_ Array of addresses of the tokens

/// @audit `@param`
87:      * @param distributionSpeeds_ New distribution speeds for tokens

/// @audit `distributionSpeeds_`
87:      * @param distributionSpeeds_ New distribution speeds for tokens

/// @audit `@custom:error`
88:      * @custom:error Throw InvalidArguments on different length of tokens and speeds array

/// @audit `InvalidArguments`
88:      * @custom:error Throw InvalidArguments on different length of tokens and speeds array

/// @audit `@notice`
114:      * @notice Initialize the distribution of the token

/// @audit `@param`
115:      * @param tokens_ Array of addresses of the tokens to be intialized

/// @audit `tokens_`
115:      * @param tokens_ Array of addresses of the tokens to be intialized

/// @audit `intialized`
115:      * @param tokens_ Array of addresses of the tokens to be intialized

/// @audit `@custom:access`
116:      * @custom:access Only Governance

/// @audit `@notice`
129:      * @notice Pause fund transfer of tokens to Prime contract

/// @audit `@custom:access`
130:      * @custom:access Controlled by ACM

/// @audit `@notice`
138:      * @notice Resume fund transfer of tokens to Prime contract

/// @audit `@custom:access`
139:      * @custom:access Controlled by ACM

/// @audit `@notice`
147:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `(amount`
147:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `block)`
147:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `@param`
148:      * @param tokens_ Array of addresses of the tokens

/// @audit `tokens_`
148:      * @param tokens_ Array of addresses of the tokens

/// @audit `@param`
149:      * @param distributionSpeeds_ New distribution speeds for tokens

/// @audit `distributionSpeeds_`
149:      * @param distributionSpeeds_ New distribution speeds for tokens

/// @audit `@custom:access`
150:      * @custom:access Controlled by ACM

/// @audit `@custom:error`
151:      * @custom:error Throw InvalidArguments on different length of tokens and speeds array

/// @audit `InvalidArguments`
151:      * @custom:error Throw InvalidArguments on different length of tokens and speeds array

/// @audit `@notice`
172:      * @notice Set the prime token contract address

/// @audit `@param`
173:      * @param prime_ The new address of the prime token contract

/// @audit `prime_`
173:      * @param prime_ The new address of the prime token contract

/// @audit `@custom:event`
174:      * @custom:event Emits PrimeTokenUpdated event

/// @audit `PrimeTokenUpdated`
174:      * @custom:event Emits PrimeTokenUpdated event

/// @audit `@custom:access`
175:      * @custom:access Only owner

/// @audit `@notice`
185:      * @notice Claim all the token accrued till last block

/// @audit `@param`
186:      * @param token_ The token to release to the Prime contract

/// @audit `token_`
186:      * @param token_ The token to release to the Prime contract

/// @audit `@custom:event`
187:      * @custom:event Emits TokenTransferredToPrime event

/// @audit `TokenTransferredToPrime`
187:      * @custom:event Emits TokenTransferredToPrime event

/// @audit `@custom:error`
188:      * @custom:error Throw InvalidArguments on Zero address(token)

/// @audit `InvalidArguments`
188:      * @custom:error Throw InvalidArguments on Zero address(token)

/// @audit `address(token)`
188:      * @custom:error Throw InvalidArguments on Zero address(token)

/// @audit `@custom:error`
189:      * @custom:error Throw FundsTransferIsPaused is paused

/// @audit `FundsTransferIsPaused`
189:      * @custom:error Throw FundsTransferIsPaused is paused

/// @audit `@custom:error`
190:      * @custom:error Throw InvalidCaller if the sender is not the Prime contract

/// @audit `InvalidCaller`
190:      * @custom:error Throw InvalidCaller if the sender is not the Prime contract

/// @audit `@notice`
208:      * @notice A public function to sweep accidental ERC-20 transfers to this contract. Tokens are sent to user

/// @audit `ERC-20`
208:      * @notice A public function to sweep accidental ERC-20 transfers to this contract. Tokens are sent to user

/// @audit `contract.`
208:      * @notice A public function to sweep accidental ERC-20 transfers to this contract. Tokens are sent to user

/// @audit `@param`
209:      * @param token_ The address of the ERC-20 token to sweep

/// @audit `token_`
209:      * @param token_ The address of the ERC-20 token to sweep

/// @audit `ERC-20`
209:      * @param token_ The address of the ERC-20 token to sweep

/// @audit `@param`
210:      * @param to_ The address of the recipient

/// @audit `@param`
211:      * @param amount_ The amount of tokens needs to transfer

/// @audit `amount_`
211:      * @param amount_ The amount of tokens needs to transfer

/// @audit `@custom:event`
212:      * @custom:event Emits SweepToken event

/// @audit `SweepToken`
212:      * @custom:event Emits SweepToken event

/// @audit `@custom:error`
213:      * @custom:error Throw InsufficientBalance if amount_ is greater than the available balance of the token in the contract

/// @audit `InsufficientBalance`
213:      * @custom:error Throw InsufficientBalance if amount_ is greater than the available balance of the token in the contract

/// @audit `amount_`
213:      * @custom:error Throw InsufficientBalance if amount_ is greater than the available balance of the token in the contract

/// @audit `@custom:access`
214:      * @custom:access Only Governance

/// @audit `@notice`
228:      * @notice Get rewards per block for token

/// @audit `@param`
229:      * @param token_ Address of the token

/// @audit `token_`
229:      * @param token_ Address of the token

/// @audit `@return`
230:      * @return speed returns the per block reward

/// @audit `@notice`
245:      * @notice Accrue token by updating the distribution state

/// @audit `@param`
246:      * @param token_ Address of the token

/// @audit `token_`
246:      * @param token_ Address of the token

/// @audit `@custom:event`
247:      * @custom:event Emits TokensAccrued event

/// @audit `TokensAccrued`
247:      * @custom:event Emits TokensAccrued event

/// @audit `@notice`
274:     /// @notice Get the latest block number

/// @audit `@return`
275:     /// @return blockNumber returns the block number

/// @audit `blockNumber`
275:     /// @return blockNumber returns the block number

/// @audit `@notice`
281:      * @notice Initialize the distribution of the token

/// @audit `@param`
282:      * @param token_ Address of the token to be intialized

/// @audit `token_`
282:      * @param token_ Address of the token to be intialized

/// @audit `intialized`
282:      * @param token_ Address of the token to be intialized

/// @audit `@custom:event`
283:      * @custom:event Emits TokenDistributionInitialized event

/// @audit `TokenDistributionInitialized`
283:      * @custom:event Emits TokenDistributionInitialized event

/// @audit `@custom:error`
284:      * @custom:error Throw TokenAlreadyInitialized if token is already initialized

/// @audit `TokenAlreadyInitialized`
284:      * @custom:error Throw TokenAlreadyInitialized if token is already initialized

/// @audit `@notice`
304:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `(amount`
304:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `block)`
304:      * @notice Set distribution speed (amount of token distribute per block)

/// @audit `@param`
305:      * @param token_ Address of the token

/// @audit `token_`
305:      * @param token_ Address of the token

/// @audit `@param`
306:      * @param distributionSpeed_ New distribution speed for token

/// @audit `distributionSpeed_`
306:      * @param distributionSpeed_ New distribution speed for token

/// @audit `@custom:event`
307:      * @custom:event Emits TokenDistributionSpeedUpdated event

/// @audit `TokenDistributionSpeedUpdated`
307:      * @custom:event Emits TokenDistributionSpeedUpdated event

/// @audit `@custom:error`
308:      * @custom:error Throw InvalidDistributionSpeed if speed is greater than max speed

/// @audit `InvalidDistributionSpeed`
308:      * @custom:error Throw InvalidDistributionSpeed if speed is greater than max speed

/// @audit `speed,`
317:             //  1. Token accrued properly for the old speed, and

/// @audit `block.`
318:             //  2. Token accrued at the new speed starts after this block.

/// @audit `@notice`
329:      * @notice Revert on non initialized token

/// @audit `@param`
330:      * @param token_ Token Address to be verified for

/// @audit `token_`
330:      * @param token_ Token Address to be verified for

/// @audit `@notice`
341:      * @notice Revert on zero address

/// @audit `@param`
342:      * @param address_ Address to be verified

/// @audit `address_`
342:      * @param address_ Address to be verified

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L1), [1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L1), [11](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L11), [14](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L14), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L17), [20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L20), [20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L20), [23](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L23), [26](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L26), [29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L29), [32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L32), [35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L35), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L38), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L38), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L38), [41](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L41), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L44), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L47), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L47), [50](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L50), [53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L53), [56](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L56), [59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L59), [59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L59), [62](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L62), [65](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L65), [68](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L68), [68](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L68), [71](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L71), [74](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L74), [74](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L74), [77](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L77), [83](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L83), [83](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L83), [84](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L84), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L85), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L85), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L85), [86](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L86), [86](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L86), [87](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L87), [87](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L87), [88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L88), [88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L88), [114](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L114), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L115), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L115), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L115), [116](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L116), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L129), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L130), [138](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L138), [139](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L139), [147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L147), [147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L147), [147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L147), [148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L148), [148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L148), [149](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L149), [149](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L149), [150](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L150), [151](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L151), [151](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L151), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L172), [173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L173), [173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L173), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L174), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L174), [175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L175), [185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L185), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L186), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L186), [187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L187), [187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L187), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L188), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L188), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L188), [189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L189), [189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L189), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L190), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L190), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L208), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L208), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L208), [209](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L209), [209](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L209), [209](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L209), [210](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L210), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L211), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L211), [212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L212), [212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L212), [213](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L213), [213](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L213), [213](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L213), [214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L214), [228](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L228), [229](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L229), [229](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L229), [230](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L230), [245](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L245), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L246), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L246), [247](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L247), [247](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L247), [274](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L274), [275](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L275), [275](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L275), [281](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L281), [282](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L282), [282](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L282), [282](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L282), [283](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L283), [283](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L283), [284](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L284), [284](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L284), [304](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L304), [304](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L304), [304](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L304), [305](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L305), [305](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L305), [306](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L306), [306](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L306), [307](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L307), [307](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L307), [308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L308), [308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L308), [317](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L317), [318](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L318), [329](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L329), [330](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L330), [330](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L330), [341](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L341), [342](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L342), [342](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L342)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `BSD-3-Clause`
1: // SPDX-License-Identifier: BSD-3-Clause

/// @audit `@notice`
33:     /// @notice minimum amount of XVS user needs to stake to become a prime member

/// @audit `@notice`
36:     /// @notice maximum XVS taken in account when calculating user score

/// @audit `@notice`
39:     /// @notice number of days user need to stake to claim prime token

/// @audit `@notice`
42:     /// @notice maxmimum BPS = 100%

/// @audit `maxmimum`
42:     /// @notice maxmimum BPS = 100%

/// @audit `@notice`
45:     /// @notice Mapping to get prime token's metadata

/// @audit `metadata`
45:     /// @notice Mapping to get prime token's metadata

/// @audit `@notice`
48:     /// @notice  Tracks total irrevocable tokens minted

/// @audit `@notice`
51:     /// @notice  Tracks total revocable tokens minted

/// @audit `@notice`
54:     /// @notice  Indicates maximum revocable tokens that can be minted

/// @audit `@notice`
57:     /// @notice  Indicates maximum irrevocable tokens that can be minted

/// @audit `@notice`
60:     /// @notice Tracks when prime token eligible users started staking for claiming prime token

/// @audit `@notice`
63:     /// @notice vToken to market configuration

/// @audit `vToken`
63:     /// @notice vToken to market configuration

/// @audit `@notice`
66:     /// @notice vToken to user to user index

/// @audit `vToken`
66:     /// @notice vToken to user to user index

/// @audit `@notice`
69:     /// @notice A list of boosted markets

/// @audit `@notice`
72:     /// @notice numberator of alpha. Ex: if alpha is 0.5 then this will be 1

/// @audit `numberator`
72:     /// @notice numberator of alpha. Ex: if alpha is 0.5 then this will be 1

/// @audit `alpha.`
72:     /// @notice numberator of alpha. Ex: if alpha is 0.5 then this will be 1

/// @audit `@notice`
75:     /// @notice denominator of alpha. Ex: if alpha is 0.5 then this will be 2

/// @audit `alpha.`
75:     /// @notice denominator of alpha. Ex: if alpha is 0.5 then this will be 2

/// @audit `@notice`
78:     /// @notice address of XVS vault

/// @audit `@notice`
81:     /// @notice address of XVS vault reward token

/// @audit `@notice`
84:     /// @notice address of XVS vault pool id

/// @audit `@notice`
87:     /// @notice mapping to check if a account's score was updated in the round

/// @audit `@notice`
90:     /// @notice unique id for next round

/// @audit `@notice`
93:     /// @notice total number of accounts whose score needs to be updated

/// @audit `@notice`
96:     /// @notice total number of accounts whose score is yet to be updated

/// @audit `@notice`
99:     /// @notice mapping used to find if an asset is part of prime markets

/// @audit `@notice`
102:     /// @notice address of protocol share reserve contract

/// @audit `@notice`
105:     /// @notice address of core pool comptroller contract

/// @audit `@notice`
108:     /// @notice unreleased income from PSR that's already distributed to prime holders

/// @audit `adress`
109:     /// @dev mapping of asset adress => amount

/// @audit `@notice`
112:     /// @notice unreleased income from PLP that's already distributed to prime holders

/// @audit `adress`
113:     /// @dev mapping of asset adress => amount

/// @audit `@notice`
116:     /// @notice The address of PLP contract

/// @audit `@notice`
119:     /// @notice The address of ResilientOracle contract

/// @audit `ResilientOracle`
119:     /// @notice The address of ResilientOracle contract

/// @audit `chain.`
123:     /// variables without shifting down storage in the inheritance chain.

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L1), [1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L1), [33](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L33), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L36), [39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L39), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L42), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L42), [45](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L45), [45](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L45), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L48), [51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L51), [54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L54), [57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L57), [60](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L60), [63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L63), [63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L63), [66](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L66), [66](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L66), [69](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L69), [72](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L72), [72](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L72), [72](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L72), [75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L75), [75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L75), [78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L78), [81](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L81), [84](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L84), [87](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L87), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L90), [93](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L93), [96](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L96), [99](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L99), [102](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L102), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L105), [108](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L108), [109](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L109), [112](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L112), [113](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L113), [116](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L116), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L119), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L119), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L123)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: MIT

/// @audit `solhint-disable`
2: // solhint-disable var-name-mixedcase

/// @audit `var-name-mixedcase`
2: // solhint-disable var-name-mixedcase

/// @audit `@notice`
17:      * @notice Convert some uint256 fraction `n` numerator / `d` denominator to a fixed-point number `f`.

/// @audit `uint256`
17:      * @notice Convert some uint256 fraction `n` numerator / `d` denominator to a fixed-point number `f`.

/// @audit `fixed-point`
17:      * @notice Convert some uint256 fraction `n` numerator / `d` denominator to a fixed-point number `f`.

/// @audit `@param`
18:      * @param n numerator

/// @audit `@param`
19:      * @param d denominator

/// @audit `@return`
20:      * @return fixed-point number

/// @audit `fixed-point`
20:      * @return fixed-point number

/// @audit `@notice`
29:      * @notice Divide some unsigned int `u` by a fixed point number `f`

/// @audit `@param`
30:      * @param u unsigned dividend

/// @audit `@param`
31:      * @param f fixed point divisor, in FIXED_1 units

/// @audit `divisor,`
31:      * @param f fixed point divisor, in FIXED_1 units

/// @audit `FIXED_1`
31:      * @param f fixed point divisor, in FIXED_1 units

/// @audit `@return`
32:      * @return unsigned int quotient

/// @audit `FIXED_1`
36:         // multiply `u` by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `built-in`
36:         // multiply `u` by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `FIXED_1`
36:         // multiply `u` by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `@notice`
41:      * @notice Multiply some unsigned int `u` by a fixed point number `f`

/// @audit `@param`
42:      * @param u unsigned multiplicand

/// @audit `@param`
43:      * @param f fixed point multiplier, in FIXED_1 units

/// @audit `multiplier,`
43:      * @param f fixed point multiplier, in FIXED_1 units

/// @audit `FIXED_1`
43:      * @param f fixed point multiplier, in FIXED_1 units

/// @audit `@return`
44:      * @return unsigned int product

/// @audit `FIXED_1`
48:         // divide the product by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `built-in`
48:         // divide the product by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `FIXED_1`
48:         // divide the product by FIXED_1 to cancel out the built-in FIXED_1 in f

/// @audit `@notice`
52:     /// @notice see FixedMath0x

/// @audit `FixedMath0x`
52:     /// @notice see FixedMath0x

/// @audit `@notice`
57:     /// @notice see FixedMath0x

/// @audit `FixedMath0x`
57:     /// @notice see FixedMath0x

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L1), [2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L2), [2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L2), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L17), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L17), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L17), [18](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L18), [19](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L19), [20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L20), [20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L20), [29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L29), [30](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L30), [31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L31), [31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L31), [31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L31), [32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L32), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L36), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L36), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L36), [41](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L41), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L42), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L43), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L43), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L43), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L44), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L48), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L48), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L48), [52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L52), [52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L52), [57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L57), [57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L57)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: MIT

/// @audit `solhint-disable`
2: // solhint-disable max-line-length

/// @audit `max-line-length`
2: // solhint-disable max-line-length

/// @audit `LibFixedMath.sol.`
6: // Below is code from 0x's LibFixedMath.sol. Changes:

/// @audit `Changes:`
6: // Below is code from 0x's LibFixedMath.sol. Changes:

/// @audit `0.8-style`
7: // - addition of 0.8-style errors

/// @audit `https://github.com/0xProject/exchange-v3/blob/aae46bef841bfd1cc31028f41793db4fe7197084/contracts/staking/contracts/src/libs/LibFixedMath.sol`
10: // https://github.com/0xProject/exchange-v3/blob/aae46bef841bfd1cc31028f41793db4fe7197084/contracts/staking/contracts/src/libs/LibFixedMath.sol

/// @audit `(this`
39:     // Base for the fixed point numbers (this is our 1)

/// @audit `argument.`
43:     // Minimum ln argument. Notice this is related to EXP_MIN_VAL (e ^ -63.875)

/// @audit `EXP_MIN_VAL`
43:     // Minimum ln argument. Notice this is related to EXP_MIN_VAL (e ^ -63.875)

/// @audit `-63.875)`
43:     // Minimum ln argument. Notice this is related to EXP_MIN_VAL (e ^ -63.875)

/// @audit `argument.`
47:     // Minimum exp argument. Notice this is related to LN_MIN_VAL (-63.875)

/// @audit `LN_MIN_VAL`
47:     // Minimum exp argument. Notice this is related to LN_MIN_VAL (-63.875)

/// @audit `(-63.875)`
47:     // Minimum exp argument. Notice this is related to LN_MIN_VAL (-63.875)

/// @audit `fixed-point`
50:     /// @dev Get the natural logarithm of a fixed-point number 0 < `x` <= LN_MAX_VAL

/// @audit `LN_MAX_VAL`
50:     /// @dev Get the natural logarithm of a fixed-point number 0 < `x` <= LN_MAX_VAL

/// @audit `example:`
70:         // For example: log(0.3) = log(e^-1 * e^-0.25 * 1.0471028872385522)

/// @audit `log(0.3)`
70:         // For example: log(0.3) = log(e^-1 * e^-0.25 * 1.0471028872385522)

/// @audit `log(e^-1`
70:         // For example: log(0.3) = log(e^-1 * e^-0.25 * 1.0471028872385522)

/// @audit `e^-0.25`
70:         // For example: log(0.3) = log(e^-1 * e^-0.25 * 1.0471028872385522)

/// @audit `1.0471028872385522)`
70:         // For example: log(0.3) = log(e^-1 * e^-0.25 * 1.0471028872385522)

/// @audit `log(1`
71:         //              = 1 - 0.25 - log(1 + 0.0471028872385522)

/// @audit `0.0471028872385522)`
71:         //              = 1 - 0.25 - log(1 + 0.0471028872385522)

/// @audit `-0.25`
107:         // e ^ -0.25

/// @audit `-0.125`
112:         // e ^ -0.125

/// @audit `enough).`
117:         // `x` is now our residual in the range of 1 <= x <= 2 (or close enough).

/// @audit `taylor`
119:         // Add the taylor series for log(1 + z), where z = x - 1

/// @audit `log(1`
119:         // Add the taylor series for log(1 + z), where z = x - 1

/// @audit `fixed-point`
139:     /// @dev Compute the natural exponent for a fixed-point number EXP_MIN_VAL <= `x` <= 1

/// @audit `EXP_MIN_VAL`
139:     /// @dev Compute the natural exponent for a fixed-point number EXP_MIN_VAL <= `x` <= 1

/// @audit `EXP_MIN_VAL.`
142:             // Saturate to zero below EXP_MIN_VAL.

/// @audit `magnitude.`
153:         // single residual q, where q is a number of small magnitude.

/// @audit `example:`
154:         // For example: e^-34.419 = e^(-32 - 2 - 0.25 - 0.125 - 0.044)

/// @audit `e^-34.419`
154:         // For example: e^-34.419 = e^(-32 - 2 - 0.25 - 0.125 - 0.044)

/// @audit `e^(-32`
154:         // For example: e^-34.419 = e^(-32 - 2 - 0.25 - 0.125 - 0.044)

/// @audit `0.125`
154:         // For example: e^-34.419 = e^(-32 - 2 - 0.25 - 0.125 - 0.044)

/// @audit `0.044)`
154:         // For example: e^-34.419 = e^(-32 - 2 - 0.25 - 0.125 - 0.044)

/// @audit `e^-32`
155:         //              = e^-32 * e^-2 * e^-0.25 * e^-0.125 * e^-0.044

/// @audit `e^-0.25`
155:         //              = e^-32 * e^-2 * e^-0.25 * e^-0.125 * e^-0.044

/// @audit `e^-0.125`
155:         //              = e^-32 * e^-2 * e^-0.25 * e^-0.125 * e^-0.044

/// @audit `e^-0.044`
155:         //              = e^-32 * e^-2 * e^-0.25 * e^-0.125 * e^-0.044

/// @audit `-0.044`
156:         //              -> q = -0.044

/// @audit `taylor`
158:         // Multiply with the taylor series for e^q

/// @audit `0.125`
161:         // q = x % 0.125 (the residual)

/// @audit `residual)`
161:         // q = x % 0.125 (the residual)

/// @audit `non-residual`
203:         // Multiply with the non-residual terms.

/// @audit `terms.`
203:         // Multiply with the non-residual terms.

/// @audit `-0.25`
247:         // e ^ -0.25

/// @audit `-0.125`
253:         // e ^ -0.125

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L1), [2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L2), [2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L2), [6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L6), [6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L6), [7](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L7), [10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L10), [39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L39), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L43), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L43), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L43), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L47), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L47), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L47), [50](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L50), [50](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L50), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L70), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L70), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L70), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L70), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L70), [71](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L71), [71](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L71), [107](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L107), [112](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L112), [117](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L117), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L119), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L119), [139](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L139), [139](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L139), [142](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L142), [153](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L153), [154](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L154), [154](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L154), [154](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L154), [154](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L154), [154](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L154), [155](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L155), [155](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L155), [155](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L155), [155](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L155), [156](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L156), [158](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L158), [161](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L161), [161](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L161), [203](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L203), [203](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L203), [247](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L247), [253](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L253)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

/// @audit `SPDX-License-Identifier:`
1: // SPDX-License-Identifier: MIT

/// @audit `@notice`
12:      * @notice Calculate a membership score given some amount of `xvs` and `capital`, along

/// @audit ``xvs``
12:      * @notice Calculate a membership score given some amount of `xvs` and `capital`, along

/// @audit ``capital`,`
12:      * @notice Calculate a membership score given some amount of `xvs` and `capital`, along

/// @audit ``alphaNumerator``
13:      *  with some  = `alphaNumerator` / `alphaDenominator`.

/// @audit ``alphaDenominator`.`
13:      *  with some  = `alphaNumerator` / `alphaDenominator`.

/// @audit `@param`
14:      * @param xvs amount of xvs (xvs, 1e18 decimal places)

/// @audit `(xvs,`
14:      * @param xvs amount of xvs (xvs, 1e18 decimal places)

/// @audit `places)`
14:      * @param xvs amount of xvs (xvs, 1e18 decimal places)

/// @audit `@param`
15:      * @param capital amount of capital (1e18 decimal places)

/// @audit `(1e18`
15:      * @param capital amount of capital (1e18 decimal places)

/// @audit `places)`
15:      * @param capital amount of capital (1e18 decimal places)

/// @audit `@param`
16:      * @param alphaNumerator alpha param numerator

/// @audit `alphaNumerator`
16:      * @param alphaNumerator alpha param numerator

/// @audit `param`
16:      * @param alphaNumerator alpha param numerator

/// @audit `@param`
17:      * @param alphaDenominator alpha param denominator

/// @audit `alphaDenominator`
17:      * @param alphaDenominator alpha param denominator

/// @audit `param`
17:      * @param alphaDenominator alpha param denominator

/// @audit `@return`
18:      * @return membership score with 1e18 decimal places

/// @audit `xvs^`
29:         // xvs^ * capital^(1-)

/// @audit `capital^(1-)`
29:         // xvs^ * capital^(1-)

/// @audit `capital^(-)`
30:         //    = capital * capital^(-) * xvs^

/// @audit `xvs^`
30:         //    = capital * capital^(-) * xvs^

/// @audit `capital)^`
31:         //    = capital * (xvs / capital)^

/// @audit `(ln(xvs`
32:         //    = capital * (e ^ (ln(xvs / capital))) ^ 

/// @audit `capital)))`
32:         //    = capital * (e ^ (ln(xvs / capital))) ^ 

/// @audit `ln(xvs`
33:         //    = capital * e ^ ( * ln(xvs / capital))     (1)

/// @audit `capital))`
33:         //    = capital * e ^ ( * ln(xvs / capital))     (1)

/// @audit `ln(xvs`
35:         //    = capital / ( 1 / e ^ ( * ln(xvs / capital)))

/// @audit `capital)))`
35:         //    = capital / ( 1 / e ^ ( * ln(xvs / capital)))

/// @audit `ln(xvs`
36:         //    = capital / (e ^ ( * ln(xvs / capital)) ^ -1)

/// @audit `capital))`
36:         //    = capital / (e ^ ( * ln(xvs / capital)) ^ -1)

/// @audit `ln(xvs`
37:         //    = capital / e ^ ( * -1 * ln(xvs / capital))

/// @audit `capital))`
37:         //    = capital / e ^ ( * -1 * ln(xvs / capital))

/// @audit `ln(capital`
38:         //    = capital / e ^ ( * ln(capital / xvs))     (2)

/// @audit `xvs))`
38:         //    = capital / e ^ ( * ln(capital / xvs))     (2)

/// @audit `overflows,`
40:         // To avoid overflows, use (1) when xvs < capital and

/// @audit `equal,`
46:         // If both sides are equal, we have:

/// @audit `have:`
46:         // If both sides are equal, we have:

/// @audit `xvs^`
47:         // xvs^ * capital^(1-)

/// @audit `capital^(1-)`
47:         // xvs^ * capital^(1-)

/// @audit `xvs^`
48:         //    = xvs^ * xvs^(1-)

/// @audit `xvs^(1-)`
48:         //    = xvs^ * xvs^(1-)

/// @audit `xvs^(`
49:         //    = xvs^( + 1 - )     = xvs

/// @audit `capital)`
54:         // (xvs / capital) or (capital / xvs), always in range (0, 1)

/// @audit `(capital`
54:         // (xvs / capital) or (capital / xvs), always in range (0, 1)

/// @audit `xvs),`
54:         // (xvs / capital) or (capital / xvs), always in range (0, 1)

/// @audit `ln(ratio)`
57:         // e ^ ( ln(ratio) *  )

/// @audit `ln(xvs`
63:             // capital * e ^ ( * ln(xvs / capital))

/// @audit `capital))`
63:             // capital * e ^ ( * ln(xvs / capital))

/// @audit `ln(capital`
67:         // capital / e ^ ( * ln(capital / xvs))

/// @audit `xvs))`
67:         // capital / e ^ ( * ln(capital / xvs))

```
*Github:* [[1](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L1), [12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L12), [12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L12), [12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L12), [13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L13), [13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L13), [14](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L14), [14](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L14), [14](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L14), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L15), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L15), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L15), [16](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L16), [16](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L16), [16](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L16), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L17), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L17), [17](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L17), [18](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L18), [29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L29), [29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L29), [30](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L30), [30](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L30), [31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L31), [32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L32), [32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L32), [33](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L33), [33](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L33), [35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L35), [35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L35), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L36), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L36), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L37), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L37), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L38), [38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L38), [40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L40), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L46), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L46), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L47), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L47), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L48), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L48), [49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L49), [54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L54), [54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L54), [54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L54), [57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L57), [63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L63), [63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L63), [67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L67), [67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L67)]


</details>

---

<a name="NC-30"></a> 
### [NC-30] Unused errors
The following `error`s are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion. Note that there may be cases where an error appears to be used because it has multiple definitions in different files. In such cases, the definitions should be moved to a separate file.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

36: error UnsignedValueTooLarge(uint256 x);

```
*Github:* [[36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L36)]


---

<a name="NC-31"></a> 
### [NC-31] Unused `event` definition
Note that there may be cases where an event superficially appears to be used, but this is only because there are multiple definitions of the event in different files. In such cases, the event definition should be moved into a separate file. The instances below are the unused definitions.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

48:     event TokenInitialBalanceUpdated(address indexed token, uint256 balance);

51:     event FundsTransferPaused();

54:     event FundsTransferResumed();

```
*Github:* [[48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L48), [51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L51), [54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L54)]


---

<a name="NC-32"></a> 
### [NC-32] Unused named return
Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment. This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
*Github:* [[496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496), [527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit `r` not used
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit `r` not used
58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


---

<a name="NC-33"></a> 
### [NC-33] Consider using `delete` rather than assigning zero to clear values
The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

295:         markets[vToken].rewardIndex = 0;

298:         markets[vToken].sumOfMembersScore = 0;

677:         interests[vToken][user].accrued = 0;

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
*Github:* [[295](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L295), [298](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L298), [677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677), [736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736), [737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737)]


---

<a name="NC-34"></a> 
### [NC-34] Solidity compiler version is not fixed
To prevent the actual contracts deployed from behaving differently depending on the compiler version, it is recommended to use a fixed solidity version.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/IPrime.sol

2: pragma solidity ^0.5.16;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/IPrime.sol#L2)]


---

<a name="NC-35"></a> 
### [NC-35] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
*Github:* [[12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

```
*Github:* [[31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37), [40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
*Github:* [[40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48)]


</details>

---

<a name="NC-36"></a> 
### [NC-36] Use the latest solidity version for deployment
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
*Github:* [[3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3)]


---

<a name="NC-37"></a> 
### [NC-37] Whitespace in Expressions
See the [Whitespace in Expressions](https://docs.soliditylang.org/en/latest/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

660:         (uint256 capital, , ) = _capitalForScore(xvsBalanceForScore, borrow, supply, market);

```
*Github:* [[660](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L660)]


---

<a name="NC-38"></a> 
### [NC-38] Missing checks for `address(0)` when assigning values to address state variables

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

181:         prime = prime_;

```
*Github:* [[181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L181)]


---

<a name="NC-39"></a> 
### [NC-39] Names of `private`/`internal` functions should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are <b>9</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

904:     function isEligible(uint256 amount) internal view returns (bool) {

```
*Github:* [[904](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L904)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

22:     function toFixed(uint256 n, uint256 d) internal pure returns (int256) {

34:     function uintDiv(uint256 u, int256 f) internal pure returns (uint256) {

46:     function uintMul(uint256 u, int256 f) internal pure returns (uint256) {

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L22), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L34), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L46), [53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51), [140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

22:     function calculateScore(
            uint256 xvs,
            uint256 capital,
            uint256 alphaNumerator,
            uint256 alphaDenominator
        ) internal pure returns (uint256) {
            // Score function is:

```
*Github:* [[22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L22)]


---

<a name="NC-40"></a> 
### [NC-40] Names of `private`/`internal` state variables should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

15:     uint256 internal constant EXP_SCALE = 1e18;

```
*Github:* [[15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

70:     address[] internal allMarkets;

79:     address internal xvsVault;

82:     address internal xvsVaultRewardToken;

85:     uint256 internal xvsVaultPoolId;

```
*Github:* [[31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43), [70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L70), [79](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L79), [82](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L82), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L85)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
*Github:* [[40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48)]


</details>

---

<a name="NC-41"></a> 
### [NC-41] Variables should be named in mixedCase style
As the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) suggests: arguments, local variables and mutable state variables should be named in mixedCase style.

<details>
<summary>
There are <b>16</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

40:     uint256 public immutable BLOCKS_PER_YEAR;

42:     /// @notice address of WBNB contract

46:     /// @notice address of VBNB contract

```
*Github:* [[40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L40), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L42), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L46)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
*Github:* [[12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12), [15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

124:     uint256[25] private __gap;

```
*Github:* [[31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37), [40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L124)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

43:     // Minimum ln argument. Notice this is related to EXP_MIN_VAL (e ^ -63.875)

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

```
*Github:* [[40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42), [43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L43), [44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46)]


</details>

---

<a name="NC-42"></a> 
### [NC-42] Event is missing `indexed` fields
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

51:     event Mint(address indexed user, bool isIrrevocable);

91:     event InterestClaimed(address indexed user, address indexed market, uint256 amount);

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L51), [91](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L91)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

33:     event TokenDistributionSpeedUpdated(address indexed token, uint256 newSpeed);

36:     event PrimeTokenUpdated(address oldPrimeToken, address newPrimeToken);

39:     event TokensAccrued(address indexed token, uint256 amount);

42:     event TokenTransferredToPrime(address indexed token, uint256 amount);

45:     event SweepToken(address indexed token, address indexed to, uint256 sweepAmount);

48:     event TokenInitialBalanceUpdated(address indexed token, uint256 balance);

```
*Github:* [[33](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L33), [36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L36), [39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L39), [42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L42), [45](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L45), [48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L48)]


---

<a name="NC-43"></a> 
### [NC-43] Constants should be defined rather than using magic numbers

<details>
<summary>
There are <b>20</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

661:         capital = capital * (10 ** (18 - vToken.decimals()));

```
*Github:* [[661](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L661)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

```
*Github:* [[164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178), [180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192), [194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194), [196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198), [200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200)]


</details>

---


## Gas Optimizations

<a name="GAS-1"></a> 
### [GAS-1] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate
Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot. Finally, if both fields are accessed in the same function, can save ~42 gas per access due to not having to [recalculate the key's keccak256 hash](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0) (Gkeccak256 - 30 gas) and that calculation's associated stack operations.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
*Github:* [[67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67), [88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88)]


---

<a name="GAS-2"></a> 
### [GAS-2] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```

---

<a name="GAS-3"></a> 
### [GAS-3] Divisions can be `unchecked` to save gas
The expression `type(int).min/(-1)` is the only case where division causes an overflow. Therefore, uncheck can be used to [save gas](https://gist.github.com/DadeKuma/3bc597338ae774b8b3bd43280d55271f) in scenarios where it is certain that such an overflow will not occur.

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
*Github:* [[501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501), [585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585), [654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882), [885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885), [886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886), [889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889), [893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893), [922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949), [972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972), [1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004), [1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009), [1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010), [1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012), [1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
*Github:* [[25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37), [49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
*Github:* [[75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115), [121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131), [132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133), [134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163), [164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167), [168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168), [169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170), [171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172), [173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174), [175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177), [178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178), [179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179), [180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180), [181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183), [184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184), [185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186), [187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188), [189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190), [191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192), [193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193), [194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194), [195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195), [196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196), [197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198), [199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199), [200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201), [208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208), [214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214), [220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220), [226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226), [232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232), [238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238), [244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244), [250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250), [256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
*Github:* [[59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59)]


</details>

---

<a name="GAS-4"></a> 
### [GAS-4] Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables

<details>
<summary>
There are <b>41</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

574:         distributionIncome += unreleasedPLPAccruedInterest;

674:         amount += interests[vToken][user].accrued;

785:         interests[vToken][user].accrued += _interestAccrued(vToken, user);

978:         amount += BLOCKS_PER_YEAR * totalIncomePerBlockFromPLP;

```
*Github:* [[574](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L574), [674](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L674), [785](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L785), [978](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L978)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

266:                 tokenAmountAccrued[token_] += tokenAccrued;

```
*Github:* [[266](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L266)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

74:             r -= int256(0x0000000000000000000000000000001000000000000000000000000000000000); // - 32

79:             r -= int256(0x0000000000000000000000000000000800000000000000000000000000000000); // - 16

84:             r -= int256(0x0000000000000000000000000000000400000000000000000000000000000000); // - 8

89:             r -= int256(0x0000000000000000000000000000000200000000000000000000000000000000); // - 4

94:             r -= int256(0x0000000000000000000000000000000100000000000000000000000000000000); // - 2

99:             r -= int256(0x0000000000000000000000000000000080000000000000000000000000000000); // - 1

104:             r -= int256(0x0000000000000000000000000000000040000000000000000000000000000000); // - 0.5

109:             r -= int256(0x0000000000000000000000000000000020000000000000000000000000000000); // - 0.25

114:             r -= int256(0x0000000000000000000000000000000010000000000000000000000000000000); // - 0.125

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

```
*Github:* [[74](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L74), [79](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L79), [84](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L84), [89](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L89), [94](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L94), [99](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L99), [104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L104), [109](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L109), [114](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L114), [122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122), [124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124), [126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126), [128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128), [130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130), [132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132), [134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134), [136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136), [164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166), [168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168), [170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170), [172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172), [174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174), [176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176), [178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178), [180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180), [182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182), [184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184), [186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186), [188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188), [190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190), [192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192), [194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194), [196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196), [198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198), [200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200)]


</details>

---

<a name="GAS-5"></a> 
### [GAS-5] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas
Saves deployment costs.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Duplicated on line 158
100:             revert InvalidArguments();

```
*Github:* [[100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L100)]


---

<a name="GAS-6"></a> 
### [GAS-6] Increments can be `unchecked` to save gas
Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save 30-40 gas per iteration. So it is recommended to use unchecked increments when overflow is not possible.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

108:                 ++i;

123:                 ++i;

166:                 ++i;

```
*Github:* [[108](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L108), [123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L123), [166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L166)]


---

<a name="GAS-7"></a> 
### [GAS-7] Initializers can be marked as payable to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. Initializers can be safely marked as payable, because only the deployer or the factory contract would call the function without carrying any funds.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

130:     function initialize(

```
*Github:* [[130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

90:     function initialize(

```
*Github:* [[90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90)]


---

<a name="GAS-8"></a> 
### [GAS-8] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `_upgrade` is used only once
762:     function _upgrade(address user) internal {

/// @audit `_updateRoundAfterTokenBurned` is used only once
827:     function _updateRoundAfterTokenBurned(address user) internal {

/// @audit `isEligible` is used only once
904:     function isEligible(uint256 amount) internal view returns (bool) {

/// @audit `_incomePerBlock` is used only once
947:     function _incomePerBlock(address vToken) internal view returns (uint256) {

/// @audit `_distributionPercentage` is used only once
957:     function _distributionPercentage() internal view returns (uint256) {

/// @audit `_incomeDistributionYearly` is used only once
970:     function _incomeDistributionYearly(address vToken) internal view returns (uint256 amount) {

```
*Github:* [[762](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L762), [827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827), [904](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L904), [947](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L947), [957](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L957), [970](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L970)]


---

<a name="GAS-9"></a> 
### [GAS-9] Multiple accesses of the same mapping/array key/index should be cached
The instances below point to the second+ access of a value inside a mapping/array, within a function. Caching a mapping's value in a local `storage` or `calldata` variable when the value is accessed [multiple times](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0), saves ~42 gas per access due to not having to recalculate the key's keccak256 hash (Gkeccak256 - 30 gas) and that calculation's associated stack operations. Caching an array's struct avoids recalculating the array offsets into memory/calldata

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit `tokenAmountAccrued[token_]` is also accessed on line 199
200:         tokenAmountAccrued[token_] = 0;

/// @audit `tokenAmountAccrued[token_]` is also accessed on line 261
266:                 tokenAmountAccrued[token_] += tokenAccrued;

/// @audit `lastAccruedBlock[token_]` is also accessed on line 255
270:             lastAccruedBlock[token_] = blockNumber;

/// @audit `lastAccruedBlock[token_]` is also accessed on line 289
298:         lastAccruedBlock[token_] = blockNumber;

/// @audit `tokenDistributionSpeeds[token_]` is also accessed on line 315
322:             tokenDistributionSpeeds[token_] = distributionSpeed_;

```
*Github:* [[200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L200), [266](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L266), [270](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L270), [298](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L298), [322](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L322)]


---

<a name="GAS-10"></a> 
### [GAS-10] Newer versions of solidity are more gas efficient
The solidity language continues to pursue more efficient gas optimization schemes. Adopting a newer version of solidity can be more gas efficient.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
*Github:* [[3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3)]


---

<a name="GAS-11"></a> 
### [GAS-11] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

<details>
<summary>
There are <b>40</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

318:         if (_irrevocableLimit < totalIrrevocable || _revocableLimit < totalRevocable) revert InvalidLimit();

318:         if (_irrevocableLimit < totalIrrevocable || _revocableLimit < totalRevocable) revert InvalidLimit();

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

482:         if (totalTimeStaked < STAKING_PERIOD) {

584:         if (markets[vToken].sumOfMembersScore > 0) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

682:         if (amount > asset.balanceOf(address(this))) {

686:             if (amount > asset.balanceOf(address(this))) {

716:         if (totalIrrevocable > irrevocableLimit || totalRevocable > revocableLimit) revert InvalidLimit();

716:         if (totalIrrevocable > irrevocableLimit || totalRevocable > revocableLimit) revert InvalidLimit();

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

769:         if (totalIrrevocable > irrevocableLimit) revert InvalidLimit();

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

828:         if (totalScoreUpdatesRequired > 0) totalScoreUpdatesRequired--;

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

855:         if (xvs > MAXIMUM_XVS_CAP) {

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

```
*Github:* [[178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178), [204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246), [318](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L318), [318](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L318), [335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335), [349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349), [482](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L482), [584](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L584), [609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609), [625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625), [682](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L682), [686](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L686), [716](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L716), [716](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L716), [730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730), [769](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L769), [810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810), [828](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L828), [830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830), [855](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L855), [889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889), [893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

103:         for (uint256 i; i < numTokens; ) {

119:         for (uint256 i; i < tokens_.length; ) {

161:         for (uint256 i; i < numTokens; ) {

218:         if (amount_ > balance) {

237:         if (balance - accrued > 0) {

257:         if (deltaBlocks > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

291:         if (initializedBlock > 0) {

311:         if (distributionSpeed_ > MAX_DISTRIBUTION_SPEED) {

```
*Github:* [[103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L103), [119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119), [161](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L161), [218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L218), [237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L237), [257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L257), [262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262), [262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262), [291](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L291), [311](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L311)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

35:         if (f < 0) revert InvalidFixedPoint();

47:         if (f < 0) revert InvalidFixedPoint();

```
*Github:* [[35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L35), [47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L47)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

52:         if (x > LN_MAX_VAL) {

141:         if (x < EXP_MIN_VAL) {

148:         if (x > EXP_MAX_VAL) {

```
*Github:* [[52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L52), [141](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L141), [148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L148)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

52:         bool lessxvsThanCapital = xvs < capital;

```
*Github:* [[52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L52)]


</details>

---

<a name="GAS-12"></a> 
### [GAS-12] Reduce gas usage by moving to Solidity 0.8.19 or later
Solidity version 0.8.19 introduced a number of gas optimizations, refer to the [Solidity 0.8.19 Release Announcement](https://soliditylang.org/blog/2023/02/22/solidity-0.8.19-release-announcement/) for details.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
*Github:* [[3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3)]


---

<a name="GAS-13"></a> 
### [GAS-13] Remove or replace unused state variables
Saves a storage slot. If the variable is assigned a non-zero value, saves Gsset (20000 gas). If it's assigned a zero value, saves Gsreset (2900 gas). If the variable remains unassigned, there is no gas savings unless the variable is `public`, in which case the compiler-generated non-payable getter deployment cost is saved. If the state variable is overriding an interface's public function, mark the variable as `constant` or `immutable` so that it does not use a storage slot.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

124:     uint256[25] private __gap;

```
*Github:* [[124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L124)]


---

<a name="GAS-14"></a> 
### [GAS-14] Unused named return variables without optimizer waste gas
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
*Github:* [[496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496), [527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit `r` not used
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit `r` not used
58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


---

<a name="GAS-15"></a> 
### [GAS-15] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>16</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

228:             emit UserScoreUpdated(user);

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

269:         emit MultiplierUpdated(

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
*Github:* [[228](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L228), [241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241), [269](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L269), [308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308), [320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320), [462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462), [694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694), [718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718), [755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755), [771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

267:                 emit TokensAccrued(token_, tokenAccrued);

300:         emit TokenDistributionInitialized(token_);

324:             emit TokenDistributionSpeedUpdated(token_, distributionSpeed_);

```
*Github:* [[180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180), [202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202), [222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222), [267](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L267), [300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300), [324](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L324)]


</details>

---

<a name="GAS-16"></a> 
### [GAS-16] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

*There are <b>9</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

337:                 if (userToken.exists && !userToken.isIrrevocable) {

369:         if (tokens[user].exists && !isAccountEligible) {

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

379:         } else if (tokens[user].exists && isAccountEligible) {

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

```
*Github:* [[337](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L337), [369](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L369), [375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375), [375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375), [377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377), [377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377), [379](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L379), [830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

```
*Github:* [[262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262)]


---

<a name="GAS-17"></a> 
### [GAS-17] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
*Github:* [[2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
*Github:* [[4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
*Github:* [[3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3)]


---

<a name="GAS-18"></a> 
### [GAS-18] Use `unchecked` block for safe subtractions
If it can be confirmed that the subtraction operation will not overflow, using an unchecked block can save gas. For example, `require(x <= y); z = y - x;` can be optimized to `require(x <= y); unchecked { z = y - x; }`

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Checked on line 482
483:             return STAKING_PERIOD - totalTimeStaked;

```
*Github:* [[483](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L483)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit Checked on line 58
120:         z = y = x - FIXED_1;

```
*Github:* [[120](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L120)]


---

<a name="GAS-19"></a> 
### [GAS-19] Using bitmap to store bool states can save gas
Using a bitmap instead of a bool array or a bool mapping to store boolean states can save gas fees. This is because the bitmap can store 256 boolean values in a single slot instead of 256 slots, which can save gas when writing bool values or when reading multiple bool values from the same slot.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
*Github:* [[88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88)]


---

<a name="GAS-20"></a> 
### [GAS-20] Using bools for storage incurs overhead
Use uint256(1) and uint256(2) for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from false to true, after having been true in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
*Github:* [[88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88)]


---

<a name="GAS-21"></a> 
### [GAS-21] Cache array length outside of loop
If not cached, the solidity compiler will always read the length of the array during each iteration. That is, if it is a storage array, this is an extra sload operation (100 additional extra gas for each iteration except for the first) and if it is a memory array, this is an extra mload operation (3 additional gas for each iteration except for the first).

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

```
*Github:* [[178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178), [204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246), [335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335), [349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349), [609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609), [625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625), [730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

119:         for (uint256 i; i < tokens_.length; ) {

```
*Github:* [[119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119)]


---

<a name="GAS-22"></a> 
### [GAS-22] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

200:     function updateScores(address[] memory users) external {

```
*Github:* [[200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L200)]


---

<a name="GAS-23"></a> 
### [GAS-23] Don't initialize variables with default value

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

677:         interests[vToken][user].accrued = 0;

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
*Github:* [[178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178), [204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204), [211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211), [246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246), [335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335), [349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349), [609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609), [625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625), [677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677), [730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730), [736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736), [737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

46:     int256 private constant EXP_MAX_VAL = 0;

```
*Github:* [[46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46)]


</details>

---

<a name="GAS-24"></a> 
### [GAS-24] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

<details>
<summary>
There are <b>14</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

75:         uint128 indexed oldNumerator,

76:         uint128 indexed oldDenominator,

77:         uint128 indexed newNumerator,

78:         uint128 newDenominator

134:         uint128 _alphaNumerator,

135:         uint128 _alphaDenominator,

237:     function updateAlpha(uint128 _alphaNumerator, uint128 _alphaDenominator) external {

237:     function updateAlpha(uint128 _alphaNumerator, uint128 _alphaDenominator) external {

238:         _checkAccessAllowed("updateAlpha(uint128,uint128)");

238:         _checkAccessAllowed("updateAlpha(uint128,uint128)");

809:     function _checkAlphaArguments(uint128 _alphaNumerator, uint128 _alphaDenominator) internal {

809:     function _checkAlphaArguments(uint128 _alphaNumerator, uint128 _alphaDenominator) internal {

```
*Github:* [[75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L75), [76](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L76), [77](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L77), [78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L78), [134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L134), [135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L135), [237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L237), [237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L237), [238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L238), [238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L238), [809](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L809), [809](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L809)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

73:     uint128 public alphaNumerator;

76:     uint128 public alphaDenominator;

```
*Github:* [[73](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L73), [76](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L76)]


</details>

---

<a name="GAS-25"></a> 
### [GAS-25] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

```
*Github:* [[103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

78:     constructor() {

```
*Github:* [[78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L78)]


---

<a name="GAS-26"></a> 
### [GAS-26] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

118:     function initializeTokens(address[] calldata tokens_) external onlyOwner {

177:     function setPrimeToken(address prime_) external onlyOwner {

216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

```
*Github:* [[118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L118), [177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177), [216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216)]


---

<a name="GAS-27"></a> 
### [GAS-27] `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too)
*Saves 5 gas per loop*

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

189:                 i++;

217:                     j++;

225:                 i++;

250:                 i++;

345:                     i++;

355:                     i++;

614:                 i++;

636:                 i++;

711:             totalIrrevocable++;

713:             totalRevocable++;

740:                 i++;

766:         totalIrrevocable++;

819:         nextScoreUpdateRoundId++;

```
*Github:* [[189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L189), [217](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L217), [225](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L225), [250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L250), [345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L345), [355](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L355), [614](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L614), [636](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L636), [711](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L711), [713](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L713), [740](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L740), [766](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L766), [819](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L819)]


</details>

---

<a name="GAS-28"></a> 
### [GAS-28] Using `private` rather than `public` for constants, saves gas
If needed, the values can be read from the verified contract source code, or if there are multiple values there can be a single getter function that [returns a tuple](https://github.com/code-423n4/2022-08-frax/blob/90f55a9ce4e25bceed3a74290b854341d8de6afa/src/contracts/FraxlendPair.sol#L156-L178) of the values of all currently-public constants. Saves **3406-3606 gas** in deployment gas due to the compiler not having to create non-payable getter functions for deployment calldata, not having to store the bytes of the value outside of where it's used, and not adding another entry to the method ID table

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

```
*Github:* [[12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12)]


```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

```
*Github:* [[34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34), [37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37), [40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40)]


---

<a name="GAS-29"></a> 
### [GAS-29] Use `!= 0` instead of `> 0` for unsigned integer comparison
Using `== 0`, `!= 0` instead of `> 0`, `>= 1`, `< 1`, `<= 0` can save gas.

<details>
<summary>
There are <b>11</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

584:         if (markets[vToken].sumOfMembersScore > 0) {

828:         if (totalScoreUpdatesRequired > 0) totalScoreUpdatesRequired--;

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

```
*Github:* [[375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375), [584](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L584), [828](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L828), [830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830), [889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889), [893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

237:         if (balance - accrued > 0) {

257:         if (deltaBlocks > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

291:         if (initializedBlock > 0) {

```
*Github:* [[237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L237), [257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L257), [262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262), [262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262), [291](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L291)]


</details>

---

<a name="GAS-30"></a> 
### [GAS-30] Using assembly to check for zero can save gas
Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

<details>
<summary>
There are <b>35</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

104:         if (_wbnb == address(0)) revert InvalidAddress();

105:         if (_vbnb == address(0)) revert InvalidAddress();

106:         if (_blocksPerYear == 0) revert InvalidBlocksPerYear();

143:         if (_xvsVault == address(0)) revert InvalidAddress();

144:         if (_xvsVaultRewardToken == address(0)) revert InvalidAddress();

145:         if (_protocolShareReserve == address(0)) revert InvalidAddress();

146:         if (_comptroller == address(0)) revert InvalidAddress();

147:         if (_oracle == address(0)) revert InvalidAddress();

148:         if (_primeLiquidityProvider == address(0)) revert InvalidAddress();

201:         if (pendingScoreUpdates == 0) revert NoScoreUpdatesRequired();

202:         if (nextScoreUpdateRoundId == 0) revert NoScoreUpdatesRequired();

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

398:         if (stakedAt[msg.sender] == 0) revert IneligibleToClaim();

457:         if (vToken == address(0)) revert MarketNotSupported();

479:         if (stakedAt[user] == 0) return STAKING_PERIOD;

576:         if (distributionIncome == 0) {

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

1002:         if (totalScore == 0) return (0, 0);

1007:         if (totalCappedValue == 0) return (0, 0);

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
*Github:* [[104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L104), [105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L105), [106](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L106), [143](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L143), [144](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L144), [145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L145), [146](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L146), [147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L147), [148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L148), [201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L201), [202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L202), [377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377), [398](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L398), [457](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L457), [479](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L479), [576](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L576), [810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810), [1002](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1002), [1007](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1007), [1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012), [1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013)]


```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

335:         if (lastBlockAccrued == 0) {

345:         if (address_ == address(0)) {

```
*Github:* [[335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L335), [345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L345)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

145:         if (x == 0) {

206:         if ((x & int256(0x0000000000000000000000000000001000000000000000000000000000000000)) != 0) {

212:         if ((x & int256(0x0000000000000000000000000000000800000000000000000000000000000000)) != 0) {

218:         if ((x & int256(0x0000000000000000000000000000000400000000000000000000000000000000)) != 0) {

224:         if ((x & int256(0x0000000000000000000000000000000200000000000000000000000000000000)) != 0) {

230:         if ((x & int256(0x0000000000000000000000000000000100000000000000000000000000000000)) != 0) {

236:         if ((x & int256(0x0000000000000000000000000000000080000000000000000000000000000000)) != 0) {

242:         if ((x & int256(0x0000000000000000000000000000000040000000000000000000000000000000)) != 0) {

248:         if ((x & int256(0x0000000000000000000000000000000020000000000000000000000000000000)) != 0) {

254:         if ((x & int256(0x0000000000000000000000000000000010000000000000000000000000000000)) != 0) {

```
*Github:* [[145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L145), [206](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L206), [212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L212), [218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L218), [224](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L224), [230](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L230), [236](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L236), [242](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L242), [248](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L248), [254](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L254)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

44:         if (xvs == 0 || capital == 0) return 0;

46:         // If both sides are equal, we have:

```
*Github:* [[44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L46)]


</details>

---

<a name="GAS-31"></a> 
### [GAS-31] `internal` functions not called by the contract should be removed
If the functions are required by an interface, the contract should inherit from that interface and use the `override` keyword

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

22:     function toFixed(uint256 n, uint256 d) internal pure returns (int256) {

34:     function uintDiv(uint256 u, int256 f) internal pure returns (uint256) {

46:     function uintMul(uint256 u, int256 f) internal pure returns (uint256) {

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L22), [34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L34), [46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L46), [53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53), [58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58)]


```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {

140:     function exp(int256 x) internal pure returns (int256 r) {

```
*Github:* [[51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51), [140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140)]


```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

22:     function calculateScore(

```
*Github:* [[22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L22)]


---

