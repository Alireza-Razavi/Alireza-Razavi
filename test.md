# Report

Audit report for **2023-10-brahma** generated by *ubl4nk_bot*.

## Low Issues


*Total <b>46</b> instances over <b>9</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Missing zero address check in functions with address parameters | 20 |
| [L-2](#L-2) | Array is `push()`ed but not `pop()`ed | 1 |
| [L-3](#L-3) | Enum values should be used instead of constant array indexes | 4 |
| [L-4](#L-4) | Numbers downcast to `address`es may result in collisions | 2 |
| [L-5](#L-5) | Prevent re-setting a state variable with the same value | 2 |
| [L-6](#L-6) | Timestamp may be manipulation | 1 |
| [L-7](#L-7) | Unsafe downcast | 1 |
| [L-8](#L-8) |  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()` | 2 |
| [L-9](#L-9) | Empty Function Body - Consider commenting why | 13 |

## Non Critical Issues


*Total <b>526</b> instances over <b>61</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | Assembly blocks should have extensive comments | 2 |
| [NC-2](#NC-2) | `abi.encodePacked()` should be replaced with `bytes.concat()` | 6 |
| [NC-3](#NC-3) | Contract declarations should have NatSpec `@author` annotations | 1 |
| [NC-4](#NC-4) | Avoid the use of sensitive terms | 1 |
| [NC-5](#NC-5) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 1 |
| [NC-6](#NC-6) | Complex casting | 2 |
| [NC-7](#NC-7) | Consider adding a block/deny-list | 14 |
| [NC-8](#NC-8) | Consider adding formal verification proofs | 1 |
| [NC-9](#NC-9) | Consider using descriptive `constant`s when passing zero as a function argument | 1 |
| [NC-10](#NC-10) | Constant redefined elsewhere | 3 |
| [NC-11](#NC-11) | Constants should be put on the left side of comparisons | 19 |
| [NC-12](#NC-12) | Contract does not follow the Solidity Style Guide's suggested layout ordering | 25 |
| [NC-13](#NC-13) | Contract should expose an `interface` | 41 |
| [NC-14](#NC-14) | Contract timekeeping will break earlier than the Ethereum network itself will stop working | 1 |
| [NC-15](#NC-15) | Contract uses both `require()`/`revert()` as well as custom errors | 1 |
| [NC-16](#NC-16) | Contracts should have full test coverage | 1 |
| [NC-17](#NC-17) | Convert simple `if` statements to ternary expressions | 1 |
| [NC-18](#NC-18) | Events that mark critical parameter changes should contain both the old and the new value | 14 |
| [NC-19](#NC-19) | Custom errors has no error details | 30 |
| [NC-20](#NC-20) | Custom errors should be used rather than `revert()`/`require()` | 4 |
| [NC-21](#NC-21) | Polymorphic functions make security audits more time-consuming and error-prone | 3 |
| [NC-22](#NC-22) | Duplicated `require()`/`revert()` checks should be refactored | 3 |
| [NC-23](#NC-23) | Empty bytes check is missing | 17 |
| [NC-24](#NC-24) | Enable IR-based code generation | 1 |
| [NC-25](#NC-25) | Events are emitted without the sender information | 8 |
| [NC-26](#NC-26) | Events may be emitted out of order due to reentrancy | 19 |
| [NC-27](#NC-27) |  Function ordering does not follow the Solidity Style Guide | 2 |
| [NC-28](#NC-28) | Functions with array parameters should have length checks in place | 5 |
| [NC-29](#NC-29) | Variable names for `immutable`s should use CONSTANT_CASE | 2 |
| [NC-30](#NC-30) | Import declarations should import specific identifiers, rather than the whole file | 3 |
| [NC-31](#NC-31) | Imports could be organized more systematically | 1 |
| [NC-32](#NC-32) | Inconsistent spacing in comments | 2 |
| [NC-33](#NC-33) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-34](#NC-34) | Long functions should be refactored into multiple, smaller, functions | 1 |
| [NC-35](#NC-35) | Consider moving `msg.sender` checks to `modifier`s | 1 |
| [NC-36](#NC-36) | Named mappings are recommended | 3 |
| [NC-37](#NC-37) | Named imports of parent contracts are missing | 1 |
| [NC-38](#NC-38) | Error declarations should have NatSpec descriptions | 36 |
| [NC-39](#NC-39) | Event declarations should have NatSpec descriptions | 15 |
| [NC-40](#NC-40) | NatSpec documentation for function is missing | 13 |
| [NC-41](#NC-41) | Missing NatSpec `@param` | 14 |
| [NC-42](#NC-42) | NatSpec `@return` is missing | 4 |
| [NC-43](#NC-43) | Function declarations should have @notice tags | 20 |
| [NC-44](#NC-44) | There is no need to initialize variables with 0 | 2 |
| [NC-45](#NC-45) | Put all system-wide constants in one file | 37 |
| [NC-46](#NC-46) | Lines are too long | 7 |
| [NC-47](#NC-47) | Typos | 4 |
| [NC-48](#NC-48) | Unnecessary cast | 1 |
| [NC-49](#NC-49) | Unused `error` definition | 1 |
| [NC-50](#NC-50) | Unused `event` definition | 1 |
| [NC-51](#NC-51) | Unused import | 33 |
| [NC-52](#NC-52) | Unused named return | 2 |
| [NC-53](#NC-53) | Unused contract variables | 8 |
| [NC-54](#NC-54) | Expressions for constant values should use `immutable` rather than `constant` | 37 |
| [NC-55](#NC-55) | Use `@inheritdoc` for overridden functions | 6 |
| [NC-56](#NC-56) | Use the latest solidity version for deployment | 16 |
| [NC-57](#NC-57) | Use of `override` is unnecessary | 10 |
| [NC-58](#NC-58) | Common functions should be refactored to a common base contract | 4 |
| [NC-59](#NC-59) | Names of `private`/`internal` state variables should be prefixed with an underscore | 5 |
| [NC-60](#NC-60) | Event is missing `indexed` fields | 4 |
| [NC-61](#NC-61) | Functions not used internally could be marked `external` | 4 |

## Gas Optimizations


*Total <b>200</b> instances over <b>29</b> issues:*

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate | 1 | - |
| [GAS-2](#GAS-2) | Consider activating via-ir for deploying | 1 | - |
| [GAS-3](#GAS-3) | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas | 3 | - |
| [GAS-4](#GAS-4) | Increments can be `unchecked` to save gas | 1 | 60 |
| [GAS-5](#GAS-5) | `internal` functions only called once can be inlined to save gas | 6 | 180 |
| [GAS-6](#GAS-6) | `keccak256()` hash of literals should only be computed once | 1 | 42 |
| [GAS-7](#GAS-7) | Multiple accesses of the same mapping/array key/index should be cached | 4 | 168 |
| [GAS-8](#GAS-8) | Newer versions of solidity are more gas efficient | 16 | - |
| [GAS-9](#GAS-9) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 3 | 9 |
| [GAS-10](#GAS-10) | Remove or replace unused state variables | 8 | - |
| [GAS-11](#GAS-11) | The result of a function call should be cached rather than re-calling the function | 5 | 500 |
| [GAS-12](#GAS-12) | Unused named return variables without optimizer waste gas | 2 | 18 |
| [GAS-13](#GAS-13) | Use assembly to compute hashes to save gas | 12 | 960 |
| [GAS-14](#GAS-14) | Use assembly to emit events | 14 | 532 |
| [GAS-15](#GAS-15) | Use assembly to write address/contract type storage values | 7 | 350 |
| [GAS-16](#GAS-16) | Using a double `if` statement instead of a logical AND (`&&`) | 7 | 210 |
| [GAS-17](#GAS-17) | Use a more recent version of solidity | 16 | - |
| [GAS-18](#GAS-18) | Using bitmap to store bool states can save gas | 1 | - |
| [GAS-19](#GAS-19) | Using bools for storage incurs overhead | 1 | - |
| [GAS-20](#GAS-20) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 14 | - |
| [GAS-21](#GAS-21) | Use Custom Errors | 4 | 200 |
| [GAS-22](#GAS-22) | Don't initialize variables with default value | 2 | - |
| [GAS-23](#GAS-23) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 17 | 935 |
| [GAS-24](#GAS-24) | Constructors can be marked as `payable` to save deployment gas | 13 | 273 |
| [GAS-25](#GAS-25) | `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too) | 2 | 10 |
| [GAS-26](#GAS-26) | Using `private` rather than `public` for constants, saves gas | 4 | - |
| [GAS-27](#GAS-27) | Splitting require() statements that use && saves gas | 1 | - |
| [GAS-28](#GAS-28) | Using assembly to check for zero can save gas | 24 | 144 |
| [GAS-29](#GAS-29) | `internal` functions not called by the contract should be removed | 10 | - |

## Low Issues

<a name="L-1"></a> 
### [L-1] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit missing zero check for `safe`
68:     function getMessageHashForSafe(GnosisSafe safe, bytes memory message) public view returns (bytes32) {

/// @audit missing zero check for `targetContract`
104:     function simulate(address targetContract, bytes calldata calldataPayload)
             external
             returns (bytes memory response)
         {

```
*Github:* [[68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L68), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit missing zero check for `to`
54:     function isPolicySignatureValid(
            address account,
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            bytes calldata signatures
        ) external view returns (bool) {

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L54)]


```solidity
File: src/core/SafeModerator.sol

/// @audit missing zero check for `to`
/// @audit missing zero check for `gasToken`
/// @audit missing zero check for `refundReceiver`
/// @audit missing zero check for `msgSender`
33:     function checkTransaction(
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            uint256 safeTxGas,
            uint256 baseGas,
            uint256 gasPrice,
            address gasToken,
            address payable refundReceiver,
            bytes memory signatures,
            address msgSender
        ) external view override {

/// @audit missing zero check for ``
/// @audit missing zero check for ``
80:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L33), [80](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L80)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit missing zero check for `to`
/// @audit missing zero check for `gasToken`
/// @audit missing zero check for `refundReceiver`
/// @audit missing zero check for `msgSender`
39:     function checkTransaction(
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            uint256 safeTxGas,
            uint256 baseGas,
            uint256 gasPrice,
            address gasToken,
            address payable refundReceiver,
            bytes memory signatures,
            address msgSender
        ) external view override {

/// @audit missing zero check for ``
/// @audit missing zero check for ``
86:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L39), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L86)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit missing zero check for ``
81:     function validatePostTransactionOverridable(bytes32, /*txHash */ bool, /*success */ address /*console */ )
            external
            view
        {}
        /* solhint-enable no-empty-blocks */
    
        /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/

/// @audit missing zero check for ``
/// @audit missing zero check for `from`
125:         _validatePolicySignature(from, transactionStructHash, signatures);
         }
     
         /**
          * @notice Provides on-chain guarantees on security critical expected states of subAccount for executor plugin
          * @param subAccount address of subAccount to validate

/// @audit missing zero check for ``
136:     /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/
         /*                   INTERNAL METHODS                         */
         /*.•°:°.´+˚.*°.˚:*.´•*.+°.•°:´*.´•*.•°.•°:°.´:•˚°.*°.˚:*.´+°.•*/

/// @audit missing zero check for `_from`
/// @audit missing zero check for `_to`
157:          * Following conditions validate if the transaction aims to remove guard or fallback handler on Safe
              *         from == to (safe sending txn to itself)
              *         value == 0
              *         data == abi.encodeCall(IGnosisSafe.setGuard, (address(0))) || abi.encodeCall(IGnosisSafe.setFallbackHandler, (address(0)))

/// @audit missing zero check for `_from`
/// @audit missing zero check for `_to`
219:             !PolicyValidator(AddressProviderService._getAuthorizedAddress(_POLICY_VALIDATOR_HASH)).isPolicySignatureValid(
                     _from, _to, _value, _data, _operation, _signatures
                 )
             ) {
                 revert TxnUnAuthorized();
             }
         }
     
         /**
          * @notice Internal helper to validate policy signature for a module txn

/// @audit missing zero check for `_from`
240:                 _from, _transactionStructHash, _signatures
                 )
             ) {
                 revert TxnUnAuthorized();
             }
         }
     }
     

```
*Github:* [[81](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L81), [125](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L125), [136](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L136), [157](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L157), [219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L219), [240](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L240)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

/// @audit missing zero check for `_subAccount`
38:     function registerExecutor(address _subAccount, address _executor) external {

/// @audit missing zero check for `_subAccount`
67:     function isExecutor(address _subAccount, address _executor) external view returns (bool) {

/// @audit missing zero check for `_subAccount`
75:     function getExecutorsForSubAccount(address _subAccount) external view returns (address[] memory) {

```
*Github:* [[38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L38), [67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L67), [75](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L75)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit missing zero check for `account`
66:     function _updatePolicy(address account, bytes32 policyCommit) internal {

```
*Github:* [[66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L66)]


```solidity
File: src/core/registries/WalletRegistry.sol

/// @audit missing zero check for `_wallet`
49:     function registerSubAccount(address _wallet, address _subAccount) external {

/// @audit missing zero check for `_wallet`
63:     function getSubAccountsForWallet(address _wallet) external view returns (address[] memory) {

/// @audit missing zero check for `_wallet`
/// @audit missing zero check for `_subAccount`
73:     function isOwner(address _wallet, address _subAccount) external view returns (bool) {

```
*Github:* [[49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L49), [63](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L63), [73](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L73)]


</details>


<a name="L-2"></a> 
### [L-2] Array is `push()`ed but not `pop()`ed
There is no limit specified on the amount of gas used, so the recipient can use up all of the remaining gas (`gasleft()`), causing it to revert. Therefore, when calling an external contract, it is necessary to specify a limited amount of gas to forward.

*There is one instance of this issue:*
```solidity
File: src/core/registries/WalletRegistry.sol

53:         walletToSubAccountList[_wallet].push(_subAccount);

```
*Github:* [[53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L53)]



<a name="L-3"></a> 
### [L-3] Enum values should be used instead of constant array indexes
Create a commented enum value to use instead of constant array indexes, this makes the code far easier to understand.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/SafeDeployer.sol

123:             txns[1] = Types.Executable({

140:         txns[0] = Types.Executable({

177:         txns[0] = Types.Executable({

185:         txns[1] = Types.Executable({

```
*Github:* [[123](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L123), [140](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L140), [177](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L177), [185](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L185)]



<a name="L-4"></a> 
### [L-4] Numbers downcast to `address`es may result in collisions
If a number is downcast to an `address` the upper bytes are truncated, which may mean that more than one value will map to the `address`.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

144:         return address(uint160(uint256(bytes32(guardAddress))));

154:         return address(uint160(uint256(bytes32(fallbackHandlerAddress))));

```
*Github:* [[144](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L144), [154](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L154)]



<a name="L-5"></a> 
### [L-5] Prevent re-setting a state variable with the same value
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

45:         governance = _governance;

```
*Github:* [[45](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L45)]


```solidity
File: src/core/AddressProviderService.sol

29:         addressProvider = AddressProvider(_addressProvider);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L29)]



<a name="L-6"></a> 
### [L-6] Timestamp may be manipulation
The `block.timestamp` can be manipulated by miners to perform MEV profiting or other time-based attacks.

*There is one instance of this issue:*
```solidity
File: src/core/PolicyValidator.sol

116:         if (expiryEpoch < uint32(block.timestamp)) {

```
*Github:* [[116](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L116)]



<a name="L-7"></a> 
### [L-7] Unsafe downcast
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs.

*There is one instance of this issue:*
```solidity
File: src/core/PolicyValidator.sol

116:         if (expiryEpoch < uint32(block.timestamp)) {

```
*Github:* [[116](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L116)]



<a name="L-8"></a> 
### [L-8]  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`
Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

70:         return keccak256(abi.encodePacked(bytes1(0x19), bytes1(0x01), safe.domainSeparator(), safeMessageHash));

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L70)]


```solidity
File: src/core/SafeDeployer.sol

254:         return uint256(keccak256(abi.encodePacked(_ownersHash, ownerSafeCount[_ownersHash]++, _salt, VERSION)));

```
*Github:* [[254](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L254)]



<a name="L-9"></a> 
### [L-9] Empty Function Body - Consider commenting why

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L29)]


```solidity
File: src/core/ExecutorPlugin.sol

60:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L60)]


```solidity
File: src/core/PolicyValidator.sol

30:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L30)]


```solidity
File: src/core/SafeDeployer.sol

42:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L42)]


```solidity
File: src/core/SafeModerator.sol

17:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

86:     ) external override {}

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L17), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L86)]


```solidity
File: src/core/SafeModeratorOverridable.sol

23:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

92:     ) external override {}

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L23), [92](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L92)]


```solidity
File: src/core/TransactionValidator.sol

54:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

84:     {}

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L54), [84](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L84)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L29)]


```solidity
File: src/core/registries/PolicyRegistry.sol

24:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L24)]


```solidity
File: src/core/registries/WalletRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L29)]


</details>



## Non Critical Issues

<a name="NC-1"></a> 
### [NC-1] Assembly blocks should have extensive comments
Assembly blocks take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code, and describe why assembly is being used instead of Solidity.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

115:         assembly {

```
*Github:* [[115](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L115)]


```solidity
File: src/core/SafeEnabler.sol

71:         assembly {

```
*Github:* [[71](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L71)]



<a name="NC-2"></a> 
### [NC-2] `abi.encodePacked()` should be replaced with `bytes.concat()`
Solidity version 0.8.4 introduces `bytes.concat()`, which can be used to replace `abi.encodePacked()` on bytes/strings. It can make the intended operation clearer, leading to less reviewer confusion.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

70:         return keccak256(abi.encodePacked(bytes1(0x19), bytes1(0x01), safe.domainSeparator(), safeMessageHash));

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L70)]


```solidity
File: src/core/SafeDeployer.sol

144:             data: abi.encodePacked(WalletRegistry.registerWallet.selector)

254:         return uint256(keccak256(abi.encodePacked(_ownersHash, ownerSafeCount[_ownersHash]++, _salt, VERSION)));

```
*Github:* [[144](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L144), [254](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L254)]


```solidity
File: src/libraries/SafeHelper.sol

88:         bytes memory signatures = abi.encodePacked(

119:             bytes memory encodedTxn = abi.encodePacked(

125:                 packedTxns = abi.encodePacked(packedTxns, encodedTxn);

```
*Github:* [[88](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L88), [119](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L119), [125](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L125)]



<a name="NC-3"></a> 
### [NC-3] Contract declarations should have NatSpec `@author` annotations

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

20: contract ConsoleFallbackHandler is AddressProviderService, DefaultCallbackHandler, ISignatureValidator {

```
*Github:* [[20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L20)]



<a name="NC-4"></a> 
### [NC-4] Avoid the use of sensitive terms
Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist

*There is one instance of this issue:*
```solidity
File: src/core/SafeEnabler.sol

41:      * @param module Module to be whitelisted.

```
*Github:* [[41](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L41)]



<a name="NC-5"></a> 
### [NC-5] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There is one instance of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

58:     mapping(address account => mapping(address executor => uint256 nonce)) public executorNonce;

```
*Github:* [[58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L58)]



<a name="NC-6"></a> 
### [NC-6] Complex casting
Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

144:         return address(uint160(uint256(bytes32(guardAddress))));

154:         return address(uint160(uint256(bytes32(fallbackHandlerAddress))));

```
*Github:* [[144](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L144), [154](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L154)]



<a name="NC-7"></a> 
### [NC-7] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

14: contract AddressProvider {

```
*Github:* [[14](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L14)]


```solidity
File: src/core/AddressProviderService.sol

18: abstract contract AddressProviderService is IAddressProviderService, Constants {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L18)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

20: contract ConsoleFallbackHandler is AddressProviderService, DefaultCallbackHandler, ISignatureValidator {

```
*Github:* [[20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L20)]


```solidity
File: src/core/Constants.sol

13: abstract contract Constants {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L13)]


```solidity
File: src/core/ExecutorPlugin.sol

24: contract ExecutorPlugin is AddressProviderService, ReentrancyGuard, EIP712 {

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L24)]


```solidity
File: src/core/PolicyValidator.sol

19: contract PolicyValidator is AddressProviderService, EIP712 {

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L19)]


```solidity
File: src/core/SafeDeployer.sol

21: contract SafeDeployer is AddressProviderService, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L21)]


```solidity
File: src/core/SafeEnabler.sol

16: contract SafeEnabler is GnosisSafeStorage {

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L16)]


```solidity
File: src/core/SafeModerator.sol

16: contract SafeModerator is AddressProviderService, IGuard {

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L16)]


```solidity
File: src/core/SafeModeratorOverridable.sol

16: contract SafeModeratorOverridable is AddressProviderService, IGuard {

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L16)]


```solidity
File: src/core/TransactionValidator.sol

18: contract TransactionValidator is AddressProviderService {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L18)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

16: contract ExecutorRegistry is AddressProviderService {

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L16)]


```solidity
File: src/core/registries/PolicyRegistry.sol

15: contract PolicyRegistry is AddressProviderService {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L15)]


```solidity
File: src/core/registries/WalletRegistry.sol

14: contract WalletRegistry is AddressProviderService {

```
*Github:* [[14](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L14)]


</details>


<a name="NC-8"></a> 
### [NC-8] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```


<a name="NC-9"></a> 
### [NC-9] Consider using descriptive `constant`s when passing zero as a function argument
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

*There is one instance of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

64:         bool success = IGnosisSafe(safe).execTransaction(
                address(target), // to
                0, // value

```
*Github:* [[64](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L64)]



<a name="NC-10"></a> 
### [NC-10] Constant redefined elsewhere
Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/PolicyValidator.sol

/// @audit also seen in src/core/ExecutorPlugin.sol
26:     string private constant _NAME = "PolicyValidator";

/// @audit also seen in src/core/ExecutorPlugin.sol
28:     string private constant _VERSION = "1.0";

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L26), [28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L28)]


```solidity
File: src/libraries/SafeHelper.sol

/// @audit also seen in src/core/SafeEnabler.sol
23:     uint256 internal constant _GUARD_STORAGE_SLOT =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L23)]



<a name="NC-11"></a> 
### [NC-11] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

84:             if (_authorizedAddress.code.length != 0) _ensureAddressProvider(_authorizedAddress);

101:         if (registries[_key] != address(0)) revert RegistryAlreadyExists();

148:         if (addr == address(0)) revert NullAddress();

```
*Github:* [[84](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L84), [101](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L101), [148](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L148)]


```solidity
File: src/core/AddressProviderService.sol

28:         if (_addressProvider == address(0)) revert InvalidAddressProvider();

73:         if (_addr == address(0)) revert InvalidAddress();

```
*Github:* [[28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L28), [73](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L73)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

43:         if (_signature.length == 0) {

44:             require(safe.signedMessages(messageHash) != 0, "Hash not approved");

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L43), [44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L44)]


```solidity
File: src/core/ExecutorPlugin.sol

117:         if (execRequest.executor.code.length == 0 && execRequest.executorSignature.length == 0) {

117:         if (execRequest.executor.code.length == 0 && execRequest.executorSignature.length == 0) {

```
*Github:* [[117](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L117), [117](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L117)]


```solidity
File: src/core/PolicyValidator.sol

135:         if (trustedValidator.code.length == 0 && validatorSignature.length == 0) {

135:         if (trustedValidator.code.length == 0 && validatorSignature.length == 0) {

```
*Github:* [[135](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L135), [135](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L135)]


```solidity
File: src/core/SafeDeployer.sol

244:         } while (_safe == address(0));

```
*Github:* [[244](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L244)]


```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

52:         require(modules[module] == address(0), "GS102");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L52)]


```solidity
File: src/core/TransactionValidator.sol

165:         if (_from == _to && _value == 0 && _operation == Enum.Operation.Call) {

```
*Github:* [[165](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L165)]


```solidity
File: src/core/registries/WalletRegistry.sol

37:         if (subAccountToWallet[msg.sender] != address(0)) revert IsSubAccount();

51:         if (subAccountToWallet[_subAccount] != address(0)) revert AlreadyRegistered();

```
*Github:* [[37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L37), [51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L51)]


```solidity
File: src/libraries/SafeHelper.sol

105:         if (len == 0) revert InvalidMultiSendInput();

123:             if (i != 0) {

```
*Github:* [[105](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L105), [123](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L123)]


</details>


<a name="NC-12"></a> 
### [NC-12] Contract does not follow the Solidity Style Guide's suggested layout ordering
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be `1) Type declarations`, 2) State variables, 3) Events, 4) Modifiers, and 5) Functions, but the contract(s) below do not follow this ordering

<details>
<summary>
There are <b>25</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

/// @audit event/error `RegistryInitialised` came earlier
/// @audit event/error `AuthorizedAddressInitialised` came earlier
/// @audit event/error `GovernanceTransferRequested` came earlier
/// @audit event/error `GovernanceTransferred` came earlier
/// @audit event/error `RegistryAlreadyExists` came earlier
/// @audit event/error `AddressProviderUnsupported` came earlier
/// @audit event/error `NotGovernance` came earlier
/// @audit event/error `NotPendingGovernance` came earlier
/// @audit event/error `NullAddress` came earlier
27:     address public governance;

/// @audit event/error `RegistryInitialised` came earlier
/// @audit event/error `AuthorizedAddressInitialised` came earlier
/// @audit event/error `GovernanceTransferRequested` came earlier
/// @audit event/error `GovernanceTransferred` came earlier
/// @audit event/error `RegistryAlreadyExists` came earlier
/// @audit event/error `AddressProviderUnsupported` came earlier
/// @audit event/error `NotGovernance` came earlier
/// @audit event/error `NotPendingGovernance` came earlier
/// @audit event/error `NullAddress` came earlier
29:     address public pendingGovernance;

/// @audit event/error `RegistryInitialised` came earlier
/// @audit event/error `AuthorizedAddressInitialised` came earlier
/// @audit event/error `GovernanceTransferRequested` came earlier
/// @audit event/error `GovernanceTransferred` came earlier
/// @audit event/error `RegistryAlreadyExists` came earlier
/// @audit event/error `AddressProviderUnsupported` came earlier
/// @audit event/error `NotGovernance` came earlier
/// @audit event/error `NotPendingGovernance` came earlier
/// @audit event/error `NullAddress` came earlier
35:     mapping(bytes32 => address) public authorizedAddresses;

/// @audit event/error `RegistryInitialised` came earlier
/// @audit event/error `AuthorizedAddressInitialised` came earlier
/// @audit event/error `GovernanceTransferRequested` came earlier
/// @audit event/error `GovernanceTransferred` came earlier
/// @audit event/error `RegistryAlreadyExists` came earlier
/// @audit event/error `AddressProviderUnsupported` came earlier
/// @audit event/error `NotGovernance` came earlier
/// @audit event/error `NotPendingGovernance` came earlier
/// @audit event/error `NullAddress` came earlier
41:     mapping(bytes32 => address) public registries;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L27), [29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L29), [35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L35), [41](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L41)]


```solidity
File: src/core/AddressProviderService.sol

/// @audit event/error `InvalidAddressProvider` came earlier
/// @audit event/error `NotGovernance` came earlier
/// @audit event/error `InvalidAddress` came earlier
25:     AddressProvider public immutable addressProvider;

```
*Github:* [[25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L25)]


```solidity
File: src/core/ExecutorPlugin.sol

/// @audit event/error `InvalidExecutor` came earlier
/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `ModuleExecutionFailed` came earlier
44:     struct ExecutionRequest {

/// @audit event/error `InvalidExecutor` came earlier
/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `ModuleExecutionFailed` came earlier
53:     string private constant _NAME = "ExecutorPlugin";

/// @audit event/error `InvalidExecutor` came earlier
/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `ModuleExecutionFailed` came earlier
55:     string private constant _VERSION = "1.0";

/// @audit event/error `InvalidExecutor` came earlier
/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `ModuleExecutionFailed` came earlier
58:     mapping(address account => mapping(address executor => uint256 nonce)) public executorNonce;

```
*Github:* [[44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L44), [53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L53), [55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L55), [58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L58)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `NoPolicyCommit` came earlier
/// @audit event/error `TxnExpired` came earlier
/// @audit event/error `InvalidSignatures` came earlier
26:     string private constant _NAME = "PolicyValidator";

/// @audit event/error `InvalidSignature` came earlier
/// @audit event/error `NoPolicyCommit` came earlier
/// @audit event/error `TxnExpired` came earlier
/// @audit event/error `InvalidSignatures` came earlier
28:     string private constant _VERSION = "1.0";

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L26), [28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L28)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit event/error `SafeProxyCreationFailure` came earlier
/// @audit event/error `ConsoleAccountDeployed` came earlier
/// @audit event/error `SubAccountDeployed` came earlier
/// @audit event/error `PreComputeAccount` came earlier
/// @audit event/error `InvalidCommitment` came earlier
/// @audit event/error `NotWallet` came earlier
/// @audit event/error `PreComputedAccount` came earlier
/// @audit event/error `SafeProxyCreationFailed` came earlier
/// @audit function `` came earlier
45:     mapping(bytes32 ownersHash => uint256 count) public ownerSafeCount;

```
*Github:* [[45](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L45)]


```solidity
File: src/core/SafeEnabler.sol

/// @audit event/error `EnabledModule` came earlier
/// @audit event/error `ChangedGuard` came earlier
/// @audit event/error `OnlyDelegateCall` came earlier
23:     address internal immutable _self;

/// @audit event/error `EnabledModule` came earlier
/// @audit event/error `ChangedGuard` came earlier
/// @audit event/error `OnlyDelegateCall` came earlier
26:     address internal constant _SENTINEL_MODULES = address(0x1);

/// @audit event/error `EnabledModule` came earlier
/// @audit event/error `ChangedGuard` came earlier
/// @audit event/error `OnlyDelegateCall` came earlier
30:     bytes32 internal constant _GUARD_STORAGE_SLOT = 0x4a204f620c8c5ccdca3fd54d003badd85ba500436a431f0cbda4f558c93c34c8;

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L23), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L26), [30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L30)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit event/error `TxnUnAuthorized` came earlier
/// @audit event/error `InvalidGuard` came earlier
/// @audit event/error `InvalidFallbackHandler` came earlier
/// @audit event/error `InvalidModule` came earlier
39:     struct SafeTransactionParams {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L39)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

/// @audit event/error `RegisterExecutor` came earlier
/// @audit event/error `DeRegisterExecutor` came earlier
/// @audit event/error `NotOwnerWallet` came earlier
/// @audit event/error `AlreadyExists` came earlier
/// @audit event/error `DoesNotExist` came earlier
27:     mapping(address subAccount => EnumerableSet.AddressSet) private subAccountToExecutors;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L27)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit event/error `UpdatedPolicyCommit` came earlier
/// @audit event/error `PolicyCommitInvalid` came earlier
/// @audit event/error `UnauthorizedPolicyUpdate` came earlier
22:     mapping(address account => bytes32 policyCommit) public commitments;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L22)]


```solidity
File: src/core/registries/WalletRegistry.sol

/// @audit event/error `RegisterWallet` came earlier
/// @audit event/error `RegisterSubAccount` came earlier
/// @audit event/error `AlreadyRegistered` came earlier
/// @audit event/error `InvalidSender` came earlier
/// @audit event/error `IsSubAccount` came earlier
23:     mapping(address subAccount => address wallet) public subAccountToWallet;

/// @audit event/error `RegisterWallet` came earlier
/// @audit event/error `RegisterSubAccount` came earlier
/// @audit event/error `AlreadyRegistered` came earlier
/// @audit event/error `InvalidSender` came earlier
/// @audit event/error `IsSubAccount` came earlier
25:     mapping(address wallet => address[] subAccountList) public walletToSubAccountList;

/// @audit event/error `RegisterWallet` came earlier
/// @audit event/error `RegisterSubAccount` came earlier
/// @audit event/error `AlreadyRegistered` came earlier
/// @audit event/error `InvalidSender` came earlier
/// @audit event/error `IsSubAccount` came earlier
27:     mapping(address => bool) public isWallet;

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L23), [25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L25), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L27)]


```solidity
File: src/libraries/SafeHelper.sol

/// @audit event/error `InvalidMultiSendCall` came earlier
/// @audit event/error `InvalidMultiSendInput` came earlier
/// @audit event/error `SafeExecTransactionFailed` came earlier
/// @audit event/error `UnableToParseOperation` came earlier
23:     uint256 internal constant _GUARD_STORAGE_SLOT =

/// @audit event/error `InvalidMultiSendCall` came earlier
/// @audit event/error `InvalidMultiSendInput` came earlier
/// @audit event/error `SafeExecTransactionFailed` came earlier
/// @audit event/error `UnableToParseOperation` came earlier
27:     uint256 internal constant _FALLBACK_HANDLER_STORAGE_SLOT =

/// @audit event/error `InvalidMultiSendCall` came earlier
/// @audit event/error `InvalidMultiSendInput` came earlier
/// @audit event/error `SafeExecTransactionFailed` came earlier
/// @audit event/error `UnableToParseOperation` came earlier
37:     bytes32 internal constant _GUARD_REMOVAL_CALLDATA_HASH =

/// @audit event/error `InvalidMultiSendCall` came earlier
/// @audit event/error `InvalidMultiSendInput` came earlier
/// @audit event/error `SafeExecTransactionFailed` came earlier
/// @audit event/error `UnableToParseOperation` came earlier
47:     bytes32 internal constant _FALLBACK_REMOVAL_CALLDATA_HASH =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L23), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L27), [37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L37), [47](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L47)]


</details>


<a name="NC-13"></a> 
### [NC-13] Contract should expose an `interface`
All `external`/`public` functions should extend an `interface`. This is useful to make sure that the whole API is extracted.

*Note:* It is possible that the interface is out-of-scope and has not been seen by the bot.

<details>
<summary>
There are <b>41</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

52:     function setGovernance(address _newGovernance) external {

62:     function acceptGovernance() external {

77:     function setAuthorizedAddress(bytes32 _key, address _authorizedAddress, bool _overrideCheck) external {

97:     function setRegistry(bytes32 _key, address _registry) external {

112:     function getAuthorizedAddress(bytes32 _key) external view returns (address) {

121:     function getRegistry(bytes32 _key) external view returns (address) {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L52), [62](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L62), [77](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L77), [97](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L97), [112](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L112), [121](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L121)]


```solidity
File: src/core/AddressProviderService.sol

35:     function addressProviderTarget() external view override returns (address) {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L35)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

60:     function getMessageHash(bytes memory message) public view returns (bytes32) {

68:     function getMessageHashForSafe(GnosisSafe safe, bytes memory message) public view returns (bytes32) {

83:     function isValidSignature(bytes32 _dataHash, bytes calldata _signature) external view returns (bytes4) {

91:     function getModules() external view returns (address[] memory) {

104:     function simulate(address targetContract, bytes calldata calldataPayload)

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L60), [68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L68), [83](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L83), [91](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L91), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]


```solidity
File: src/core/ExecutorPlugin.sol

68:     function executeTransaction(ExecutionRequest calldata execRequest) external nonReentrant returns (bytes memory) {

```
*Github:* [[68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L68)]


```solidity
File: src/core/PolicyValidator.sol

54:     function isPolicySignatureValid(

100:     function isPolicySignatureValid(address account, bytes32 transactionStructHash, bytes calldata signatures)

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L54), [100](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L100)]


```solidity
File: src/core/SafeDeployer.sol

56:     function deployConsoleAccount(address[] calldata _owners, uint256 _threshold, bytes32 _policyCommit, bytes32 _salt)

82:     function deploySubAccount(address[] calldata _owners, uint256 _threshold, bytes32 _policyCommit, bytes32 _salt)

```
*Github:* [[56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L56), [82](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L82)]


```solidity
File: src/core/SafeEnabler.sol

43:     function enableModule(address module) public {

66:     function setGuard(address guard) public {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L43), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L66)]


```solidity
File: src/core/SafeModerator.sol

33:     function checkTransaction(

70:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

80:     function checkModuleTransaction(

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L33), [70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L70), [80](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L80)]


```solidity
File: src/core/SafeModeratorOverridable.sol

39:     function checkTransaction(

76:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

86:     function checkModuleTransaction(

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L39), [76](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L76), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L86)]


```solidity
File: src/core/TransactionValidator.sol

64:     function validatePreTransactionOverridable(SafeTransactionParams memory txParams) external view {

81:     function validatePostTransactionOverridable(bytes32, /*txHash */ bool, /*success */ address /*console */ )

97:             txParams.from, txParams.to, txParams.value, txParams.data, txParams.operation, txParams.signatures

106:         _checkSubAccountSecurityConfig(subAccount);

125:         _validatePolicySignature(from, transactionStructHash, signatures);

136:     /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/

```
*Github:* [[64](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L64), [81](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L81), [97](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L97), [106](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L106), [125](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L125), [136](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L136)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

38:     function registerExecutor(address _subAccount, address _executor) external {

53:     function deRegisterExecutor(address _subAccount, address _executor) external {

67:     function isExecutor(address _subAccount, address _executor) external view returns (bool) {

75:     function getExecutorsForSubAccount(address _subAccount) external view returns (address[] memory) {

```
*Github:* [[38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L38), [53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L53), [67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L67), [75](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L75)]


```solidity
File: src/core/registries/PolicyRegistry.sol

35:     function updatePolicy(address account, bytes32 policyCommit) external {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L35)]


```solidity
File: src/core/registries/WalletRegistry.sol

35:     function registerWallet() external {

49:     function registerSubAccount(address _wallet, address _subAccount) external {

63:     function getSubAccountsForWallet(address _wallet) external view returns (address[] memory) {

73:     function isOwner(address _wallet, address _subAccount) external view returns (bool) {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L35), [49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L49), [63](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L63), [73](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L73)]


</details>


<a name="NC-14"></a> 
### [NC-14] Contract timekeeping will break earlier than the Ethereum network itself will stop working
When a timestamp is downcast from `uint256` to `uint32`, the value will wrap in the year 2106, and the contracts will break. Other downcasts will have different endpoints. Consider whether your contract is intended to live past the size of the type being used.

*There is one instance of this issue:*
```solidity
File: src/core/PolicyValidator.sol

116:         if (expiryEpoch < uint32(block.timestamp)) {

```
*Github:* [[116](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L116)]



<a name="NC-15"></a> 
### [NC-15] Contract uses both `require()`/`revert()` as well as custom errors
Consider using just one method in a single file.

*There is one instance of this issue:*
```solidity
File: src/core/SafeEnabler.sol

16: contract SafeEnabler is GnosisSafeStorage {

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L16)]



<a name="NC-16"></a> 
### [NC-16] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```


<a name="NC-17"></a> 
### [NC-17] Convert simple `if` statements to ternary expressions
Converting some if statements to ternaries (such as `z = (a < b) ? x : y`) can make the code more concise and easier to read.

*There is one instance of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

123:             if (i != 0) {
                     // If not first transaction, append to packedTxns
                     packedTxns = abi.encodePacked(packedTxns, encodedTxn);
                 } else {
                     // If first transaction, set packedTxns to encodedTxn
                     packedTxns = encodedTxn;

```
*Github:* [[123](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L123)]



<a name="NC-18"></a> 
### [NC-18] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

55:         emit GovernanceTransferRequested(governance, _newGovernance);

66:         emit GovernanceTransferred(governance, msg.sender);

89:         emit AuthorizedAddressInitialised(_authorizedAddress, _key);

104:         emit RegistryInitialised(_registry, _key);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L55), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L66), [89](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L89), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L104)]


```solidity
File: src/core/SafeDeployer.sol

70:         emit ConsoleAccountDeployed(_safe);

102:         emit SubAccountDeployed(_subAcc, msg.sender);

239:                 emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L70), [102](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L102), [239](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L239)]


```solidity
File: src/core/SafeEnabler.sol

55:         emit EnabledModule(module);

74:         emit ChangedGuard(guard);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L55), [74](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L74)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

43:         emit RegisterExecutor(_subAccount, msg.sender, _executor);

58:         emit DeRegisterExecutor(_subAccount, msg.sender, _executor);

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L43), [58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L58)]


```solidity
File: src/core/registries/PolicyRegistry.sol

67:         emit UpdatedPolicyCommit(account, policyCommit, commitments[account]);

```
*Github:* [[67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L67)]


```solidity
File: src/core/registries/WalletRegistry.sol

39:         emit RegisterWallet(msg.sender);

54:         emit RegisterSubAccount(_wallet, _subAccount);

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L39), [54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L54)]


</details>


<a name="NC-19"></a> 
### [NC-19] Custom errors has no error details
Consider adding parameters to the error to indicate which user or values caused the failure.

<details>
<summary>
There are <b>30</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

15:     error RegistryAlreadyExists();

16:     error AddressProviderUnsupported();

19:     error NullAddress();

```
*Github:* [[15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L15), [16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L16), [19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L19)]


```solidity
File: src/core/AddressProviderService.sol

19:     error InvalidAddressProvider();

21:     error InvalidAddress();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L19), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L21)]


```solidity
File: src/core/ExecutorPlugin.sol

25:     error InvalidExecutor();

26:     error InvalidSignature();

27:     error ModuleExecutionFailed();

```
*Github:* [[25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L25), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L26), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L27)]


```solidity
File: src/core/PolicyValidator.sol

20:     error InvalidSignature();

21:     error NoPolicyCommit();

23:     error InvalidSignatures();

```
*Github:* [[20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L21), [23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L23)]


```solidity
File: src/core/SafeDeployer.sol

37:     error InvalidCommitment();

38:     error NotWallet();

40:     error SafeProxyCreationFailed();

```
*Github:* [[37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L37), [38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L38), [40](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L40)]


```solidity
File: src/core/SafeEnabler.sol

17:     error OnlyDelegateCall();

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L17)]


```solidity
File: src/core/TransactionValidator.sol

19:     error TxnUnAuthorized();

20:     error InvalidGuard();

21:     error InvalidFallbackHandler();

22:     error InvalidModule();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L21), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L22)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

19:     error NotOwnerWallet();

20:     error AlreadyExists();

21:     error DoesNotExist();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L21)]


```solidity
File: src/core/registries/PolicyRegistry.sol

16:     error PolicyCommitInvalid();

17:     error UnauthorizedPolicyUpdate();

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L17)]


```solidity
File: src/core/registries/WalletRegistry.sol

15:     error AlreadyRegistered();

16:     error InvalidSender();

17:     error IsSubAccount();

```
*Github:* [[15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L15), [16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L17)]


```solidity
File: src/libraries/SafeHelper.sol

17:     error InvalidMultiSendInput();

18:     error SafeExecTransactionFailed();

19:     error UnableToParseOperation();

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L17), [18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L18), [19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L19)]


</details>


<a name="NC-20"></a> 
### [NC-20] Custom errors should be used rather than `revert()`/`require()`
Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

44:             require(safe.signedMessages(messageHash) != 0, "Hash not approved");

51:             require(policyValidator.isPolicySignatureValid(msg.sender, messageHash, _signature), "Policy not approved");

```
*Github:* [[44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L44), [51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L51)]


```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

52:         require(modules[module] == address(0), "GS102");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L52)]



<a name="NC-21"></a> 
### [NC-21] Polymorphic functions make security audits more time-consuming and error-prone
The instances below point to one of two functions with the same name. Consider naming each function differently, in order to make code navigation and analysis easier.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit also found on line 83
39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit also found on line 100
54:     function isPolicySignatureValid(

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L54)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit also found on line 240
219:             !PolicyValidator(AddressProviderService._getAuthorizedAddress(_POLICY_VALIDATOR_HASH)).isPolicySignatureValid(

```
*Github:* [[219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L219)]



<a name="NC-22"></a> 
### [NC-22] Duplicated `require()`/`revert()` checks should be refactored
Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit duplicated on line 144
113:             revert InvalidExecutor();

```
*Github:* [[113](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L113)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit duplicated on line 237
242:                 revert SafeProxyCreationFailed();

```
*Github:* [[242](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L242)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit duplicated on line 243
223:             revert TxnUnAuthorized();

```
*Github:* [[223](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L223)]



<a name="NC-23"></a> 
### [NC-23] Empty bytes check is missing
Passing empty bytes to a function can cause unexpected behavior, such as certain operations failing, producing incorrect results, or wasting gas. It is recommended to check that all byte parameters are not empty.

<details>
<summary>
There are <b>17</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit Missing empty check for `_data`
39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

/// @audit Missing empty check for `message`
60:     function getMessageHash(bytes memory message) public view returns (bytes32) {

/// @audit Missing empty check for `message`
68:     function getMessageHashForSafe(GnosisSafe safe, bytes memory message) public view returns (bytes32) {

/// @audit Missing empty check for `calldataPayload`
104:     function simulate(address targetContract, bytes calldata calldataPayload)
             external
             returns (bytes memory response)
         {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L60), [68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L68), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit Missing empty check for `data`
/// @audit Missing empty check for `signatures`
54:     function isPolicySignatureValid(
            address account,
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            bytes calldata signatures
        ) external view returns (bool) {

/// @audit Missing empty check for `signatures`
100:     function isPolicySignatureValid(address account, bytes32 transactionStructHash, bytes calldata signatures)
             public
             view
             returns (bool)
         {

/// @audit Missing empty check for `_signatures`
156:     function _decompileSignatures(bytes calldata _signatures)
             internal
             pure
             returns (uint32 expiryEpoch, bytes memory validatorSignature)
         {

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L54), [100](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L100), [156](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L156)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit Missing empty check for `_initializer`
219:     function _createSafe(address[] calldata _owners, bytes memory _initializer, bytes32 _salt)
             private
             returns (address _safe)
         {

```
*Github:* [[219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L219)]


```solidity
File: src/core/SafeModerator.sol

/// @audit Missing empty check for `data`
/// @audit Missing empty check for `signatures`
33:     function checkTransaction(
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            uint256 safeTxGas,
            uint256 baseGas,
            uint256 gasPrice,
            address gasToken,
            address payable refundReceiver,
            bytes memory signatures,
            address msgSender
        ) external view override {

/// @audit Missing empty check for ``
80:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L33), [80](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L80)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit Missing empty check for `data`
/// @audit Missing empty check for `signatures`
39:     function checkTransaction(
            address to,
            uint256 value,
            bytes memory data,
            Enum.Operation operation,
            uint256 safeTxGas,
            uint256 baseGas,
            uint256 gasPrice,
            address gasToken,
            address payable refundReceiver,
            bytes memory signatures,
            address msgSender
        ) external view override {

/// @audit Missing empty check for ``
86:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L39), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L86)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit Missing empty check for `signatures`
125:         _validatePolicySignature(from, transactionStructHash, signatures);
         }
     
         /**
          * @notice Provides on-chain guarantees on security critical expected states of subAccount for executor plugin
          * @param subAccount address of subAccount to validate

/// @audit Missing empty check for `_data`
157:          * Following conditions validate if the transaction aims to remove guard or fallback handler on Safe
              *         from == to (safe sending txn to itself)
              *         value == 0
              *         data == abi.encodeCall(IGnosisSafe.setGuard, (address(0))) || abi.encodeCall(IGnosisSafe.setFallbackHandler, (address(0)))

/// @audit Missing empty check for `_data`
/// @audit Missing empty check for `_signatures`
219:             !PolicyValidator(AddressProviderService._getAuthorizedAddress(_POLICY_VALIDATOR_HASH)).isPolicySignatureValid(
                     _from, _to, _value, _data, _operation, _signatures
                 )
             ) {
                 revert TxnUnAuthorized();
             }
         }
     
         /**
          * @notice Internal helper to validate policy signature for a module txn

/// @audit Missing empty check for `_signatures`
240:                 _from, _transactionStructHash, _signatures
                 )
             ) {
                 revert TxnUnAuthorized();
             }
         }
     }
     

```
*Github:* [[125](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L125), [157](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L157), [219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L219), [240](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L240)]


```solidity
File: src/libraries/SafeHelper.sol

/// @audit Missing empty check for `data`
63:     function _executeOnSafe(address safe, address target, Enum.Operation op, bytes memory data) internal {

```
*Github:* [[63](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L63)]


</details>


<a name="NC-24"></a> 
### [NC-24] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```


<a name="NC-25"></a> 
### [NC-25] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

55:         emit GovernanceTransferRequested(governance, _newGovernance);

89:         emit AuthorizedAddressInitialised(_authorizedAddress, _key);

104:         emit RegistryInitialised(_registry, _key);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L55), [89](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L89), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L104)]


```solidity
File: src/core/SafeDeployer.sol

70:         emit ConsoleAccountDeployed(_safe);

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L70)]


```solidity
File: src/core/SafeEnabler.sol

55:         emit EnabledModule(module);

74:         emit ChangedGuard(guard);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L55), [74](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L74)]


```solidity
File: src/core/registries/PolicyRegistry.sol

67:         emit UpdatedPolicyCommit(account, policyCommit, commitments[account]);

```
*Github:* [[67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L67)]


```solidity
File: src/core/registries/WalletRegistry.sol

54:         emit RegisterSubAccount(_wallet, _subAccount);

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L54)]



<a name="NC-26"></a> 
### [NC-26] Events may be emitted out of order due to reentrancy
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: src/core/SafeDeployer.sol

/// @audit `.updatePolicy(..)` is called before emit
66:             PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(
                    _safe, _policyCommit
                );
            }
            emit ConsoleAccountDeployed(_safe);

/// @audit `._getRegistry(..)` is called before emit
66:             PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(
                    _safe, _policyCommit
                );
            }
            emit ConsoleAccountDeployed(_safe);

/// @audit `._getRegistry(..)` is called before emit
91:         WalletRegistry _walletRegistry = WalletRegistry(AddressProviderService._getRegistry(_WALLET_REGISTRY_HASH));
            if (!_walletRegistry.isWallet(msg.sender)) revert NotWallet();
    
            // Deploy sub account
            _subAcc = _createSafe(_owners, _setupSubAccount(_owners, _threshold, msg.sender), _salt);
    
            // Register sub account to wallet
            _walletRegistry.registerSubAccount(msg.sender, _subAcc);
    
            // Update policy commit for sub account
            PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(_subAcc, _policyCommit);
            emit SubAccountDeployed(_subAcc, msg.sender);

/// @audit `.isWallet(..)` is called before emit
92:         if (!_walletRegistry.isWallet(msg.sender)) revert NotWallet();
    
            // Deploy sub account
            _subAcc = _createSafe(_owners, _setupSubAccount(_owners, _threshold, msg.sender), _salt);
    
            // Register sub account to wallet
            _walletRegistry.registerSubAccount(msg.sender, _subAcc);
    
            // Update policy commit for sub account
            PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(_subAcc, _policyCommit);
            emit SubAccountDeployed(_subAcc, msg.sender);

/// @audit `.registerSubAccount(..)` is called before emit
98:         _walletRegistry.registerSubAccount(msg.sender, _subAcc);
    
            // Update policy commit for sub account
            PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(_subAcc, _policyCommit);
            emit SubAccountDeployed(_subAcc, msg.sender);

/// @audit `.updatePolicy(..)` is called before emit
101:         PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(_subAcc, _policyCommit);
             emit SubAccountDeployed(_subAcc, msg.sender);

/// @audit `._getRegistry(..)` is called before emit
101:         PolicyRegistry(AddressProviderService._getRegistry(_POLICY_REGISTRY_HASH)).updatePolicy(_subAcc, _policyCommit);
             emit SubAccountDeployed(_subAcc, msg.sender);

/// @audit `._getAuthorizedAddress(..)` is called before emit
223:         address gnosisProxyFactory = AddressProviderService._getAuthorizedAddress(_GNOSIS_PROXY_FACTORY_HASH);
             address gnosisSafeSingleton = AddressProviderService._getAuthorizedAddress(_GNOSIS_SINGLETON_HASH);
             bytes32 ownersHash = keccak256(abi.encode(_owners));
     
             // Generate nonce based on owners and user provided salt
             uint256 nonce = _genNonce(ownersHash, _salt);
             do {
                 try IGnosisProxyFactory(gnosisProxyFactory).createProxyWithNonce(gnosisSafeSingleton, _initializer, nonce)
                 returns (address _deployedSafe) {
                     _safe = _deployedSafe;
                 } catch Error(string memory reason) {
                     // KEK
                     if (keccak256(bytes(reason)) != _SAFE_CREATION_FAILURE_REASON) {
                         // A safe is already deployed with the same salt, retry with bumped nonce
                         revert SafeProxyCreationFailed();
                     }
                     emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

/// @audit `._getAuthorizedAddress(..)` is called before emit
224:         address gnosisSafeSingleton = AddressProviderService._getAuthorizedAddress(_GNOSIS_SINGLETON_HASH);
             bytes32 ownersHash = keccak256(abi.encode(_owners));
     
             // Generate nonce based on owners and user provided salt
             uint256 nonce = _genNonce(ownersHash, _salt);
             do {
                 try IGnosisProxyFactory(gnosisProxyFactory).createProxyWithNonce(gnosisSafeSingleton, _initializer, nonce)
                 returns (address _deployedSafe) {
                     _safe = _deployedSafe;
                 } catch Error(string memory reason) {
                     // KEK
                     if (keccak256(bytes(reason)) != _SAFE_CREATION_FAILURE_REASON) {
                         // A safe is already deployed with the same salt, retry with bumped nonce
                         revert SafeProxyCreationFailed();
                     }
                     emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

/// @audit `.encode(..)` is called before emit
225:         bytes32 ownersHash = keccak256(abi.encode(_owners));
     
             // Generate nonce based on owners and user provided salt
             uint256 nonce = _genNonce(ownersHash, _salt);
             do {
                 try IGnosisProxyFactory(gnosisProxyFactory).createProxyWithNonce(gnosisSafeSingleton, _initializer, nonce)
                 returns (address _deployedSafe) {
                     _safe = _deployedSafe;
                 } catch Error(string memory reason) {
                     // KEK
                     if (keccak256(bytes(reason)) != _SAFE_CREATION_FAILURE_REASON) {
                         // A safe is already deployed with the same salt, retry with bumped nonce
                         revert SafeProxyCreationFailed();
                     }
                     emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

/// @audit `.createProxyWithNonce(..)` is called before emit
230:             try IGnosisProxyFactory(gnosisProxyFactory).createProxyWithNonce(gnosisSafeSingleton, _initializer, nonce)
                 returns (address _deployedSafe) {
                     _safe = _deployedSafe;
                 } catch Error(string memory reason) {
                     // KEK
                     if (keccak256(bytes(reason)) != _SAFE_CREATION_FAILURE_REASON) {
                         // A safe is already deployed with the same salt, retry with bumped nonce
                         revert SafeProxyCreationFailed();
                     }
                     emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

```
*Github:* [[66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L66), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L66), [91](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L91), [92](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L92), [98](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L98), [101](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L101), [101](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L101), [223](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L223), [224](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L224), [225](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L225), [230](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L230)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

/// @audit `._getRegistry(..)` is called before emit
39:         WalletRegistry _walletRegistry = WalletRegistry(AddressProviderService._getRegistry(_WALLET_REGISTRY_HASH));
            if (!_walletRegistry.isOwner(msg.sender, _subAccount)) revert NotOwnerWallet();
    
            if (!subAccountToExecutors[_subAccount].add(_executor)) revert AlreadyExists();
            emit RegisterExecutor(_subAccount, msg.sender, _executor);

/// @audit `.isOwner(..)` is called before emit
40:         if (!_walletRegistry.isOwner(msg.sender, _subAccount)) revert NotOwnerWallet();
    
            if (!subAccountToExecutors[_subAccount].add(_executor)) revert AlreadyExists();
            emit RegisterExecutor(_subAccount, msg.sender, _executor);

/// @audit `.add(..)` is called before emit
42:         if (!subAccountToExecutors[_subAccount].add(_executor)) revert AlreadyExists();
            emit RegisterExecutor(_subAccount, msg.sender, _executor);

/// @audit `._getRegistry(..)` is called before emit
54:         WalletRegistry _walletRegistry = WalletRegistry(AddressProviderService._getRegistry(_WALLET_REGISTRY_HASH));
            if (_walletRegistry.subAccountToWallet(_subAccount) != msg.sender) revert NotOwnerWallet();
    
            if (!subAccountToExecutors[_subAccount].remove(_executor)) revert DoesNotExist();
            emit DeRegisterExecutor(_subAccount, msg.sender, _executor);

/// @audit `.subAccountToWallet(..)` is called before emit
55:         if (_walletRegistry.subAccountToWallet(_subAccount) != msg.sender) revert NotOwnerWallet();
    
            if (!subAccountToExecutors[_subAccount].remove(_executor)) revert DoesNotExist();
            emit DeRegisterExecutor(_subAccount, msg.sender, _executor);

/// @audit `.remove(..)` is called before emit
57:         if (!subAccountToExecutors[_subAccount].remove(_executor)) revert DoesNotExist();
            emit DeRegisterExecutor(_subAccount, msg.sender, _executor);

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L39), [40](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L40), [42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L42), [54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L54), [55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L55), [57](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L57)]


```solidity
File: src/core/registries/WalletRegistry.sol

/// @audit `._getAuthorizedAddress(..)` is called before emit
50:         if (msg.sender != AddressProviderService._getAuthorizedAddress(_SAFE_DEPLOYER_HASH)) revert InvalidSender();
            if (subAccountToWallet[_subAccount] != address(0)) revert AlreadyRegistered();
            subAccountToWallet[_subAccount] = _wallet;
            walletToSubAccountList[_wallet].push(_subAccount);
            emit RegisterSubAccount(_wallet, _subAccount);

/// @audit `.push(..)` is called before emit
53:         walletToSubAccountList[_wallet].push(_subAccount);
            emit RegisterSubAccount(_wallet, _subAccount);

```
*Github:* [[50](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L50), [53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L53)]


</details>


<a name="NC-27"></a> 
### [NC-27]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit public function `isValidSignature` came earlier from this external function
/// @audit public function `getMessageHash` came earlier from this external function
/// @audit public function `getMessageHashForSafe` came earlier from this external function
91:     function getModules() external view returns (address[] memory) {

/// @audit public function `isValidSignature` came earlier from this external function
/// @audit public function `getMessageHash` came earlier from this external function
/// @audit public function `getMessageHashForSafe` came earlier from this external function
104:     function simulate(address targetContract, bytes calldata calldataPayload)

```
*Github:* [[91](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L91), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]



<a name="NC-28"></a> 
### [NC-28] Functions with array parameters should have length checks in place

*There are <b>5</b> instances of this issue:*
```solidity
File: src/core/SafeDeployer.sol

/// @audit `_owners`
56:     function deployConsoleAccount(address[] calldata _owners, uint256 _threshold, bytes32 _policyCommit, bytes32 _salt)

/// @audit `_owners`
82:     function deploySubAccount(address[] calldata _owners, uint256 _threshold, bytes32 _policyCommit, bytes32 _salt)

/// @audit `_owners`
110:     function _setupConsoleAccount(address[] memory _owners, uint256 _threshold, bool _policyHashValid)

/// @audit `_owners`
168:     function _setupSubAccount(address[] memory _owners, uint256 _threshold, address _consoleAccount)

/// @audit `_owners`
219:     function _createSafe(address[] calldata _owners, bytes memory _initializer, bytes32 _salt)

```
*Github:* [[56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L56), [82](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L82), [110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L110), [168](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L168), [219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L219)]



<a name="NC-29"></a> 
### [NC-29] Variable names for `immutable`s should use CONSTANT_CASE
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/AddressProviderService.sol

25:     AddressProvider public immutable addressProvider;

```
*Github:* [[25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L25)]


```solidity
File: src/core/SafeEnabler.sol

23:     address internal immutable _self;

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L23)]



<a name="NC-30"></a> 
### [NC-30] Import declarations should import specific identifiers, rather than the whole file
Using import declarations of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas).

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

7: import "safe-contracts/handler/DefaultCallbackHandler.sol";

8: import "safe-contracts/interfaces/ISignatureValidator.sol";

9: import "safe-contracts/GnosisSafe.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L7), [8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L8), [9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L9)]



<a name="NC-31"></a> 
### [NC-31] Imports could be organized more systematically
The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

8: import "safe-contracts/interfaces/ISignatureValidator.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L8)]



<a name="NC-32"></a> 
### [NC-32] Inconsistent spacing in comments
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

21:     //keccak256("SafeMessage(bytes message)");

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L21)]


```solidity
File: src/core/registries/PolicyRegistry.sol

51:             //In case invoker is updating on behalf of sub account

```
*Github:* [[51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L51)]



<a name="NC-33"></a> 
### [NC-33] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```


<a name="NC-34"></a> 
### [NC-34] Long functions should be refactored into multiple, smaller, functions

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit 57 lines
104:     function simulate(address targetContract, bytes calldata calldataPayload)
             external
             returns (bytes memory response)
         {

```
*Github:* [[104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]



<a name="NC-35"></a> 
### [NC-35] Consider moving `msg.sender` checks to `modifier`s
If some functions are only allowed to be called by some specific users, consider using a modifier instead of checking with a require statement, especially if this check is done in multiple functions.

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

51:             require(policyValidator.isPolicySignatureValid(msg.sender, messageHash, _signature), "Policy not approved");

```
*Github:* [[51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L51)]



<a name="NC-36"></a> 
### [NC-36] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

35:     mapping(bytes32 => address) public authorizedAddresses;

41:     mapping(bytes32 => address) public registries;

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L35), [41](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L41)]


```solidity
File: src/core/registries/WalletRegistry.sol

27:     mapping(address => bool) public isWallet;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L27)]



<a name="NC-37"></a> 
### [NC-37] Named imports of parent contracts are missing

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit `DefaultCallbackHandler`
/// @audit `ISignatureValidator`
20: contract ConsoleFallbackHandler is AddressProviderService, DefaultCallbackHandler, ISignatureValidator {

```
*Github:* [[20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L20)]



<a name="NC-38"></a> 
### [NC-38] Error declarations should have NatSpec descriptions

<details>
<summary>
There are <b>36</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

15:     error RegistryAlreadyExists();

16:     error AddressProviderUnsupported();

17:     error NotGovernance(address);

18:     error NotPendingGovernance(address);

19:     error NullAddress();

```
*Github:* [[15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L15), [16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L17), [18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L18), [19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L19)]


```solidity
File: src/core/AddressProviderService.sol

19:     error InvalidAddressProvider();

20:     error NotGovernance(address);

21:     error InvalidAddress();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L21)]


```solidity
File: src/core/ExecutorPlugin.sol

25:     error InvalidExecutor();

26:     error InvalidSignature();

27:     error ModuleExecutionFailed();

```
*Github:* [[25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L25), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L26), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L27)]


```solidity
File: src/core/PolicyValidator.sol

20:     error InvalidSignature();

21:     error NoPolicyCommit();

22:     error TxnExpired(uint32 expiryEpoch);

23:     error InvalidSignatures();

```
*Github:* [[20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L21), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L22), [23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L23)]


```solidity
File: src/core/SafeDeployer.sol

37:     error InvalidCommitment();

38:     error NotWallet();

39:     error PreComputedAccount(address addr);

40:     error SafeProxyCreationFailed();

```
*Github:* [[37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L37), [38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L38), [39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L39), [40](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L40)]


```solidity
File: src/core/SafeEnabler.sol

17:     error OnlyDelegateCall();

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L17)]


```solidity
File: src/core/TransactionValidator.sol

19:     error TxnUnAuthorized();

20:     error InvalidGuard();

21:     error InvalidFallbackHandler();

22:     error InvalidModule();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L21), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L22)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

19:     error NotOwnerWallet();

20:     error AlreadyExists();

21:     error DoesNotExist();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L20), [21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L21)]


```solidity
File: src/core/registries/PolicyRegistry.sol

16:     error PolicyCommitInvalid();

17:     error UnauthorizedPolicyUpdate();

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L17)]


```solidity
File: src/core/registries/WalletRegistry.sol

15:     error AlreadyRegistered();

16:     error InvalidSender();

17:     error IsSubAccount();

```
*Github:* [[15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L15), [16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L17)]


```solidity
File: src/libraries/SafeHelper.sol

16:     error InvalidMultiSendCall(uint256);

17:     error InvalidMultiSendInput();

18:     error SafeExecTransactionFailed();

19:     error UnableToParseOperation();

```
*Github:* [[16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L16), [17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L17), [18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L18), [19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L19)]


</details>


<a name="NC-39"></a> 
### [NC-39] Event declarations should have NatSpec descriptions

<details>
<summary>
There are <b>15</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

21:     event RegistryInitialised(address indexed registry, bytes32 indexed key);

22:     event AuthorizedAddressInitialised(address indexed authorizedAddress, bytes32 indexed key);

23:     event GovernanceTransferRequested(address indexed previousGovernance, address indexed newGovernance);

24:     event GovernanceTransferred(address indexed previousGovernance, address indexed newGovernance);

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L21), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L22), [23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L23), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L24)]


```solidity
File: src/core/SafeDeployer.sol

32:     event SafeProxyCreationFailure(address indexed singleton, uint256 indexed nonce, bytes initializer);

33:     event ConsoleAccountDeployed(address indexed consoleAddress);

34:     event SubAccountDeployed(address indexed subAccountAddress, address indexed consoleAddress);

35:     event PreComputeAccount(address[] indexed owners, uint256 indexed threshold);

```
*Github:* [[32](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L32), [33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L33), [34](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L34), [35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L35)]


```solidity
File: src/core/SafeEnabler.sol

19:     event EnabledModule(address module);

20:     event ChangedGuard(address guard);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L20)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

23:     event RegisterExecutor(address indexed _subAccount, address indexed _owner, address indexed _executor);

24:     event DeRegisterExecutor(address indexed _subAccount, address indexed _owner, address indexed _executor);

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L23), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L24)]


```solidity
File: src/core/registries/PolicyRegistry.sol

19:     event UpdatedPolicyCommit(address indexed account, bytes32 policyCommit, bytes32 oldPolicyCommit);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L19)]


```solidity
File: src/core/registries/WalletRegistry.sol

19:     event RegisterWallet(address indexed wallet);

20:     event RegisterSubAccount(address indexed wallet, address indexed subAccount);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L20)]


</details>


<a name="NC-40"></a> 
### [NC-40] NatSpec documentation for function is missing
It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as DeFi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

43:     constructor(address _governance) {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L43)]


```solidity
File: src/core/AddressProviderService.sol

27:     constructor(address _addressProvider) {

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L27)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L29)]


```solidity
File: src/core/ExecutorPlugin.sol

60:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L60)]


```solidity
File: src/core/PolicyValidator.sol

30:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L30)]


```solidity
File: src/core/SafeDeployer.sol

42:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L42)]


```solidity
File: src/core/SafeEnabler.sol

32:     constructor() {

```
*Github:* [[32](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L32)]


```solidity
File: src/core/SafeModerator.sol

17:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L17)]


```solidity
File: src/core/SafeModeratorOverridable.sol

23:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L23)]


```solidity
File: src/core/TransactionValidator.sol

54:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L54)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L29)]


```solidity
File: src/core/registries/PolicyRegistry.sol

24:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L24)]


```solidity
File: src/core/registries/WalletRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L29)]


</details>


<a name="NC-41"></a> 
### [NC-41] Missing NatSpec `@param`
Some functions have an incomplete NatSpec: add a `@param` notation to describe the function parameters to improve the code documentation.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

/// @audit Missing @param for `_governance`
43:     constructor(address _governance) {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L43)]


```solidity
File: src/core/AddressProviderService.sol

/// @audit Missing @param for `_addressProvider`
27:     constructor(address _addressProvider) {

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L27)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit Missing @param for `_addressProvider`
29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L29)]


```solidity
File: src/core/ExecutorPlugin.sol

/// @audit Missing @param for `_addressProvider`
60:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L60)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit Missing @param for `_addressProvider`
30:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L30)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit Missing @param for `_addressProvider`
42:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

/// @audit Missing @param for `_policyHashValid`
110:     function _setupConsoleAccount(address[] memory _owners, uint256 _threshold, bool _policyHashValid)
             private
             view
             returns (bytes memory)
         {

/// @audit Missing @param for `_initializer`
219:     function _createSafe(address[] calldata _owners, bytes memory _initializer, bytes32 _salt)
             private
             returns (address _safe)
         {

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L42), [110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L110), [219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L219)]


```solidity
File: src/core/SafeModerator.sol

/// @audit Missing @param for `_addressProvider`
17:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L17)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit Missing @param for `_addressProvider`
23:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L23)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit Missing @param for `_addressProvider`
54:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L54)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

/// @audit Missing @param for `_addressProvider`
29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L29)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit Missing @param for `_addressProvider`
24:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L24)]


```solidity
File: src/core/registries/WalletRegistry.sol

/// @audit Missing @param for `_addressProvider`
29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L29)]


</details>


<a name="NC-42"></a> 
### [NC-42] NatSpec `@return` is missing
It is recommended that Solidity contracts are fully annotated using NatSpec

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/AddressProviderService.sol

35:     function addressProviderTarget() external view override returns (address) {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L35)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

104:     function simulate(address targetContract, bytes calldata calldataPayload)
             external
             returns (bytes memory response)
         {

```
*Github:* [[104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]


```solidity
File: src/core/SafeDeployer.sol

110:     function _setupConsoleAccount(address[] memory _owners, uint256 _threshold, bool _policyHashValid)
             private
             view
             returns (bytes memory)
         {

168:     function _setupSubAccount(address[] memory _owners, uint256 _threshold, address _consoleAccount)
             private
             view
             returns (bytes memory)
         {

```
*Github:* [[110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L110), [168](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L168)]



<a name="NC-43"></a> 
### [NC-43] Function declarations should have @notice tags

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

43:     constructor(address _governance) {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L43)]


```solidity
File: src/core/AddressProviderService.sol

27:     constructor(address _addressProvider) {

35:     function addressProviderTarget() external view override returns (address) {

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L27), [35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L35)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

60:     function getMessageHash(bytes memory message) public view returns (bytes32) {

68:     function getMessageHashForSafe(GnosisSafe safe, bytes memory message) public view returns (bytes32) {

91:     function getModules() external view returns (address[] memory) {

104:     function simulate(address targetContract, bytes calldata calldataPayload)
             external
             returns (bytes memory response)
         {

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L29), [39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L60), [68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L68), [91](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L91), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L104)]


```solidity
File: src/core/ExecutorPlugin.sol

60:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L60)]


```solidity
File: src/core/PolicyValidator.sol

30:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L30)]


```solidity
File: src/core/SafeDeployer.sol

42:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L42)]


```solidity
File: src/core/SafeEnabler.sol

32:     constructor() {

```
*Github:* [[32](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L32)]


```solidity
File: src/core/SafeModerator.sol

17:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L17)]


```solidity
File: src/core/SafeModeratorOverridable.sol

23:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L23)]


```solidity
File: src/core/TransactionValidator.sol

54:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L54)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

75:     function getExecutorsForSubAccount(address _subAccount) external view returns (address[] memory) {

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L29), [75](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L75)]


```solidity
File: src/core/registries/PolicyRegistry.sol

24:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L24)]


```solidity
File: src/core/registries/WalletRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L29)]


</details>


<a name="NC-44"></a> 
### [NC-44] There is no need to initialize variables with 0
Since the variables are automatically set to 0 when created, it is redundant to initialize it with 0 again.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/SafeHelper.sol

107:         uint256 i = 0;

```
*Github:* [[107](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L107)]



<a name="NC-45"></a> 
### [NC-45] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

<details>
<summary>
There are <b>37</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

22:     bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

26:     address internal constant SENTINEL_MODULES = address(0x1);

27:     bytes4 internal constant UPDATED_MAGIC_VALUE = 0x1626ba7e;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L22), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L26), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L27)]


```solidity
File: src/core/Constants.sol

19:         0x165eedff3947ccfbe9739de5f67209b9935e684faef9ce859fb3dc46d33317f1;

22:     bytes32 internal constant _WALLET_REGISTRY_HASH = 0x75559f593e25c44cbf7547c1b715821f42da95df7f98cc735242e5e68111f75b;

25:     bytes32 internal constant _POLICY_REGISTRY_HASH = 0xbcf81d40f2af7491686907859b412c7908faa6fb0c2baa84d3a2f4ee8bddcac9;

33:     /// @notice keccak256("ConsoleFallbackHandler")

37:     /// @notice keccak256("GnosisFallbackHandler")

41:     /// @notice keccak256("GnosisMultiSend")

45:     /// @notice keccak256("GnosisProxyFactory")

49:     /// @notice keccak256("GnosisSafeSingleton")

53:     /// @notice keccak256("PolicyValidator")

57:     /// @notice keccak256("SafeDeployer")

60:     /// @notice keccak256("SafeEnabler")

63:     /// @notice keccak256("SafeModerator")

66:     /// @notice keccak256("SafeModeratorOverridable")

70:     /// @notice keccak256("TransactionValidator")

74:     /// @notice keccak256("ConsoleOpBuilder")

78:     /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/

86:         0xc8fab2cea6e498c7d5e11e57566a1bd0376d100edae95e1256aeb6072ee66f89;

88: 

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L19), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L22), [25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L25), [33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L33), [37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L37), [41](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L41), [45](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L45), [49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L49), [53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L53), [57](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L57), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L60), [63](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L63), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L66), [70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L70), [74](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L74), [78](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L78), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L86), [88](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L88)]


```solidity
File: src/core/ExecutorPlugin.sol

53:     string private constant _NAME = "ExecutorPlugin";

55:     string private constant _VERSION = "1.0";

```
*Github:* [[53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L53), [55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L55)]


```solidity
File: src/core/PolicyValidator.sol

26:     string private constant _NAME = "PolicyValidator";

28:     string private constant _VERSION = "1.0";

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L26), [28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L28)]


```solidity
File: src/core/SafeDeployer.sol

23:     string public constant VERSION = "1";

29:     bytes32 internal constant _SAFE_CREATION_FAILURE_REASON =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L23), [29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L29)]


```solidity
File: src/core/SafeEnabler.sol

26:     address internal constant _SENTINEL_MODULES = address(0x1);

30:     bytes32 internal constant _GUARD_STORAGE_SLOT = 0x4a204f620c8c5ccdca3fd54d003badd85ba500436a431f0cbda4f558c93c34c8;

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L26), [30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L30)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/SafeHelper.sol

23:     uint256 internal constant _GUARD_STORAGE_SLOT =

27:     uint256 internal constant _FALLBACK_HANDLER_STORAGE_SLOT =

37:     bytes32 internal constant _GUARD_REMOVAL_CALLDATA_HASH =

47:     bytes32 internal constant _FALLBACK_REMOVAL_CALLDATA_HASH =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L23), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L27), [37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L37), [47](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L47)]


```solidity
File: src/libraries/TypeHashHelper.sol

49:     bytes32 public constant TRANSACTION_PARAMS_TYPEHASH =

56:     bytes32 public constant VALIDATION_PARAMS_TYPEHASH =

```
*Github:* [[49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L49), [56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L56)]


</details>


<a name="NC-46"></a> 
### [NC-46] Lines are too long
The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/core/Constants.sol

22:     bytes32 internal constant _WALLET_REGISTRY_HASH = 0x75559f593e25c44cbf7547c1b715821f42da95df7f98cc735242e5e68111f75b;

25:     bytes32 internal constant _POLICY_REGISTRY_HASH = 0xbcf81d40f2af7491686907859b412c7908faa6fb0c2baa84d3a2f4ee8bddcac9;

31:     bytes32 internal constant _EXECUTOR_PLUGIN_HASH = 0x93ae17d63c11c26435c52b81ff53503650df80d35c62972110e64a0454badbec;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L22), [25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L25), [31](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L31)]


```solidity
File: src/core/SafeDeployer.sol

128:                     IGnosisSafe.setGuard, (AddressProviderService._getAuthorizedAddress(_SAFE_MODERATOR_OVERRIDABLE_HASH))

189:             data: abi.encodeCall(IGnosisSafe.setGuard, (AddressProviderService._getAuthorizedAddress(_SAFE_MODERATOR_HASH)))

```
*Github:* [[128](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L128), [189](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L189)]


```solidity
File: src/core/TransactionValidator.sol

219:             !PolicyValidator(AddressProviderService._getAuthorizedAddress(_POLICY_VALIDATOR_HASH)).isPolicySignatureValid(

239:             !PolicyValidator(AddressProviderService._getAuthorizedAddress(_POLICY_VALIDATOR_HASH)).isPolicySignatureValid(

```
*Github:* [[219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L219), [239](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L239)]



<a name="NC-47"></a> 
### [NC-47] Typos

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

/// @audit `updatable`
33:      * @dev authorizedAddresses are updatable by governance

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L33)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit `brahma`
153:      * @return expiryEpoch extracted expiry epoch signed by brahma backend

```
*Github:* [[153](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L153)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit `brahma`
19:  * @notice Deploys new brahma console accounts and sub accounts

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L19)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit `overriden`
14:  * @notice A guard that validates transactions and allows only policy abiding txns, on Brhma console account and can be overriden by removal of guard

```
*Github:* [[14](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L14)]



<a name="NC-48"></a> 
### [NC-48] Unnecessary cast
The variable is being cast to its own type.

*There is one instance of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

/// @audit no need to cast `target` into address
65:             address(target), // to

```
*Github:* [[65](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L65)]



<a name="NC-49"></a> 
### [NC-49] Unused `error` definition
The following `error`s are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion. Note that there may be cases where an error appears to be used because it has multiple definitions in different files. In such cases, the definitions should be moved to a separate file.

*There is one instance of this issue:*
```solidity
File: src/core/SafeDeployer.sol

39:     error PreComputedAccount(address addr);

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L39)]



<a name="NC-50"></a> 
### [NC-50] Unused `event` definition
Note that there may be cases where an event superficially appears to be used, but this is only because there are multiple definitions of the event in different files. In such cases, the event definition should be moved into a separate file. The instances below are the unused definitions.

*There is one instance of this issue:*
```solidity
File: src/core/SafeDeployer.sol

35:     event PreComputeAccount(address[] indexed owners, uint256 indexed threshold);

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L35)]



<a name="NC-51"></a> 
### [NC-51] Unused import
The identifier is imported but never used within the file.

<details>
<summary>
There are <b>33</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

/// @audit `IAddressProviderService`
7: import {IAddressProviderService} from "interfaces/IAddressProviderService.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L7)]


```solidity
File: src/core/AddressProviderService.sol

/// @audit `AddressProvider`
8: import {AddressProvider} from "../core/AddressProvider.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L8)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

/// @audit `PolicyValidator`
12: import {PolicyValidator} from "./PolicyValidator.sol";

```
*Github:* [[12](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L12)]


```solidity
File: src/core/ExecutorPlugin.sol

/// @audit `SignatureCheckerLib`
8: import {SignatureCheckerLib} from "solady/utils/SignatureCheckerLib.sol";

/// @audit `IGnosisSafe`
10: import {IGnosisSafe} from "interfaces/external/IGnosisSafe.sol";

/// @audit `TransactionValidator`
12: import {TransactionValidator} from "src/core/TransactionValidator.sol";

/// @audit `ExecutorRegistry`
13: import {ExecutorRegistry} from "src/core/registries/ExecutorRegistry.sol";

/// @audit `SafeHelper`
14: import {SafeHelper} from "src/libraries/SafeHelper.sol";

/// @audit `TypeHashHelper`
15: import {TypeHashHelper} from "src/libraries/TypeHashHelper.sol";

/// @audit `Types`
16: import {Types} from "interfaces/Types.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L8), [10](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L10), [12](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L12), [13](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L13), [14](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L14), [15](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L15), [16](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L16)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit `SignatureCheckerLib`
7: import {SignatureCheckerLib} from "solady/utils/SignatureCheckerLib.sol";

/// @audit `PolicyRegistry`
10: import {PolicyRegistry} from "src/core/registries/PolicyRegistry.sol";

/// @audit `TypeHashHelper`
11: import {TypeHashHelper} from "src/libraries/TypeHashHelper.sol";

/// @audit `IGnosisSafe`
/// @audit `Enum`
12: import {IGnosisSafe, Enum} from "interfaces/external/IGnosisSafe.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L7), [10](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L10), [11](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L11), [12](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L12)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit `WalletRegistry`
9: import {WalletRegistry} from "../core/registries/WalletRegistry.sol";

/// @audit `PolicyRegistry`
10: import {PolicyRegistry} from "../core/registries/PolicyRegistry.sol";

/// @audit `IGnosisProxyFactory`
11: import {IGnosisProxyFactory} from "../../interfaces/external/IGnosisProxyFactory.sol";

/// @audit `IGnosisSafe`
12: import {IGnosisSafe} from "../../interfaces/external/IGnosisSafe.sol";

/// @audit `Types`
/// @audit `SafeHelper`
13: import {Types, SafeHelper} from "../libraries/SafeHelper.sol";

/// @audit `IGnosisMultiSend`
14: import {IGnosisMultiSend} from "../../interfaces/external/IGnosisMultiSend.sol";

```
*Github:* [[9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L9), [10](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L10), [11](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L11), [12](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L12), [13](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L13), [14](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L14)]


```solidity
File: src/core/SafeModerator.sol

/// @audit `Enum`
7: import {IGuard, Enum} from "interfaces/external/IGnosisSafe.sol";

/// @audit `TransactionValidator`
9: import {TransactionValidator} from "src/core/TransactionValidator.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L7), [9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L9)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit `Enum`
7: import {IGuard, Enum} from "interfaces/external/IGnosisSafe.sol";

/// @audit `TransactionValidator`
9: import {TransactionValidator} from "src/core/TransactionValidator.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L7), [9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L9)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit `IGnosisSafe`
/// @audit `Enum`
7: import {IGnosisSafe, Enum} from "interfaces/external/IGnosisSafe.sol";

/// @audit `PolicyValidator`
8: import {PolicyValidator} from "src/core/PolicyValidator.sol";

/// @audit `SafeHelper`
9: import {SafeHelper} from "src/libraries/SafeHelper.sol";

/// @audit `WalletRegistry`
11: import {WalletRegistry} from "src/core/registries/WalletRegistry.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L7), [8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L8), [9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L9), [11](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L11)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

/// @audit `WalletRegistry`
8: import {WalletRegistry} from "./WalletRegistry.sol";

/// @audit `EnumerableSet`
9: import {EnumerableSet} from "openzeppelin-contracts/utils/structs/EnumerableSet.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L8), [9](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L9)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit `WalletRegistry`
8: import {WalletRegistry} from "src/core/registries/WalletRegistry.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L8)]


```solidity
File: src/libraries/SafeHelper.sol

/// @audit `Enum`
/// @audit `IGnosisSafe`
7: import {Enum, IGnosisSafe} from "interfaces/external/IGnosisSafe.sol";

/// @audit `Types`
8: import {Types} from "interfaces/Types.sol";

```
*Github:* [[7](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L7), [8](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L8)]


</details>


<a name="NC-52"></a> 
### [NC-52] Unused named return
Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment. This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit `version` not used
159:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L159)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit `version` not used
174:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[174](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L174)]



<a name="NC-53"></a> 
### [NC-53] Unused contract variables
The following state variables are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

22:     bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

27:     bytes4 internal constant UPDATED_MAGIC_VALUE = 0x1626ba7e;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L22), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L27)]


```solidity
File: src/core/Constants.sol

33:     /// @notice keccak256("ConsoleFallbackHandler")

78:     /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/

86:         0xc8fab2cea6e498c7d5e11e57566a1bd0376d100edae95e1256aeb6072ee66f89;

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L33), [78](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L78), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L86)]


```solidity
File: src/core/SafeEnabler.sol

23:     address internal immutable _self;

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L23)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]



<a name="NC-54"></a> 
### [NC-54] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary>
There are <b>37</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

22:     bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

26:     address internal constant SENTINEL_MODULES = address(0x1);

27:     bytes4 internal constant UPDATED_MAGIC_VALUE = 0x1626ba7e;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L22), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L26), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L27)]


```solidity
File: src/core/Constants.sol

18:     bytes32 internal constant _EXECUTOR_REGISTRY_HASH =

22:     bytes32 internal constant _WALLET_REGISTRY_HASH = 0x75559f593e25c44cbf7547c1b715821f42da95df7f98cc735242e5e68111f75b;

25:     bytes32 internal constant _POLICY_REGISTRY_HASH = 0xbcf81d40f2af7491686907859b412c7908faa6fb0c2baa84d3a2f4ee8bddcac9;

31:     bytes32 internal constant _EXECUTOR_PLUGIN_HASH = 0x93ae17d63c11c26435c52b81ff53503650df80d35c62972110e64a0454badbec;

34:     bytes32 internal constant _CONSOLE_FALLBACK_HANDLER_HASH =

38:     bytes32 internal constant _GNOSIS_FALLBACK_HANDLER_HASH =

42:     bytes32 internal constant _GNOSIS_MULTI_SEND_HASH =

46:     bytes32 internal constant _GNOSIS_PROXY_FACTORY_HASH =

50:     bytes32 internal constant _GNOSIS_SINGLETON_HASH =

54:     bytes32 internal constant _POLICY_VALIDATOR_HASH =

58:     bytes32 internal constant _SAFE_DEPLOYER_HASH = 0x6a361f18b7bdd4971167a9db369c1357f3ebc95ef7fca81cd1aebfaeb988666d;

61:     bytes32 internal constant _SAFE_ENABLER_HASH = 0xcfef2b3eaf4a23b5f44a9550982acf18e82082f6a9756b60ca375f7b497918ca;

64:     bytes32 internal constant _SAFE_MODERATOR_HASH = 0x1ba997699674cf2f5c633ee918b93d66618d3081db3e508721439eeef694efc7;

67:     bytes32 internal constant _SAFE_MODERATOR_OVERRIDABLE_HASH =

71:     bytes32 internal constant _TRANSACTION_VALIDATOR_HASH =

75:     bytes32 internal constant _CONSOLE_OP_BUILDER_HASH =

82:     bytes32 internal constant _GUARDIAN_HASH = 0x424560fc12b0242dae8bb63e27dad69d2589059728e8daf9b2ff8557998f3402;

85:     bytes32 internal constant _TRUSTED_VALIDATOR_HASH =

```
*Github:* [[18](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L18), [22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L22), [25](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L25), [31](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L31), [34](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L34), [38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L38), [42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L42), [46](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L46), [50](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L50), [54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L54), [58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L58), [61](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L61), [64](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L64), [67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L67), [71](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L71), [75](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L75), [82](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L82), [85](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L85)]


```solidity
File: src/core/ExecutorPlugin.sol

53:     string private constant _NAME = "ExecutorPlugin";

55:     string private constant _VERSION = "1.0";

```
*Github:* [[53](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L53), [55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L55)]


```solidity
File: src/core/PolicyValidator.sol

26:     string private constant _NAME = "PolicyValidator";

28:     string private constant _VERSION = "1.0";

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L26), [28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L28)]


```solidity
File: src/core/SafeDeployer.sol

23:     string public constant VERSION = "1";

29:     bytes32 internal constant _SAFE_CREATION_FAILURE_REASON =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L23), [29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L29)]


```solidity
File: src/core/SafeEnabler.sol

26:     address internal constant _SENTINEL_MODULES = address(0x1);

30:     bytes32 internal constant _GUARD_STORAGE_SLOT = 0x4a204f620c8c5ccdca3fd54d003badd85ba500436a431f0cbda4f558c93c34c8;

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L26), [30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L30)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/SafeHelper.sol

23:     uint256 internal constant _GUARD_STORAGE_SLOT =

27:     uint256 internal constant _FALLBACK_HANDLER_STORAGE_SLOT =

37:     bytes32 internal constant _GUARD_REMOVAL_CALLDATA_HASH =

47:     bytes32 internal constant _FALLBACK_REMOVAL_CALLDATA_HASH =

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L23), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L27), [37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L37), [47](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L47)]


```solidity
File: src/libraries/TypeHashHelper.sol

49:     bytes32 public constant TRANSACTION_PARAMS_TYPEHASH =

56:     bytes32 public constant VALIDATION_PARAMS_TYPEHASH =

```
*Github:* [[49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L49), [56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L56)]


</details>


<a name="NC-55"></a> 
### [NC-55] Use `@inheritdoc` for overridden functions

*There are <b>6</b> instances of this issue:*
```solidity
File: src/core/AddressProviderService.sol

35:     function addressProviderTarget() external view override returns (address) {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L35)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39)]


```solidity
File: src/core/ExecutorPlugin.sol

159:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L159)]


```solidity
File: src/core/PolicyValidator.sol

174:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[174](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L174)]


```solidity
File: src/core/SafeModerator.sol

70:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L70)]


```solidity
File: src/core/SafeModeratorOverridable.sol

76:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

```
*Github:* [[76](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L76)]



<a name="NC-56"></a> 
### [NC-56] Use the latest solidity version for deployment
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L5)]


```solidity
File: src/core/AddressProviderService.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L5)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L5)]


```solidity
File: src/core/Constants.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L5)]


```solidity
File: src/core/ExecutorPlugin.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L5)]


```solidity
File: src/core/PolicyValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L5)]


```solidity
File: src/core/SafeDeployer.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L5)]


```solidity
File: src/core/SafeEnabler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L5)]


```solidity
File: src/core/SafeModerator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L5)]


```solidity
File: src/core/SafeModeratorOverridable.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L5)]


```solidity
File: src/core/TransactionValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L5)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L5)]


```solidity
File: src/core/registries/PolicyRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L5)]


```solidity
File: src/core/registries/WalletRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L5)]


```solidity
File: src/libraries/SafeHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L5)]


```solidity
File: src/libraries/TypeHashHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L5)]


</details>


<a name="NC-57"></a> 
### [NC-57] Use of `override` is unnecessary
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*There are <b>10</b> instances of this issue:*
```solidity
File: src/core/AddressProviderService.sol

35:     function addressProviderTarget() external view override returns (address) {

```
*Github:* [[35](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L35)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39)]


```solidity
File: src/core/ExecutorPlugin.sol

159:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L159)]


```solidity
File: src/core/PolicyValidator.sol

174:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[174](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L174)]


```solidity
File: src/core/SafeModerator.sol

45:     ) external view override {

70:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

86:     ) external override {}

```
*Github:* [[45](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L45), [70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L70), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L86)]


```solidity
File: src/core/SafeModeratorOverridable.sol

51:     ) external view override {

76:     function checkAfterExecution(bytes32 txHash, bool success) external view override {

92:     ) external override {}

```
*Github:* [[51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L51), [76](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L76), [92](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L92)]



<a name="NC-58"></a> 
### [NC-58] Common functions should be refactored to a common base contract
The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit seen in src/core/PolicyValidator.sol
159:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L159)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit seen in src/core/ExecutorPlugin.sol
174:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[174](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L174)]


```solidity
File: src/core/SafeModerator.sol

/// @audit seen in src/core/SafeModeratorOverridable.sol
80:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[80](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L80)]


```solidity
File: src/core/SafeModeratorOverridable.sol

/// @audit seen in src/core/SafeModerator.sol
86:     function checkModuleTransaction(
            address, /* to */
            uint256, /* value */
            bytes memory, /* data */
            Enum.Operation, /* operation */
            address /* module */
        ) external override {}

```
*Github:* [[86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L86)]



<a name="NC-59"></a> 
### [NC-59] Names of `private`/`internal` state variables should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are <b>5</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

22:     bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

26:     address internal constant SENTINEL_MODULES = address(0x1);

27:     bytes4 internal constant UPDATED_MAGIC_VALUE = 0x1626ba7e;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L22), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L26), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L27)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

27:     mapping(address subAccount => EnumerableSet.AddressSet) private subAccountToExecutors;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L27)]



<a name="NC-60"></a> 
### [NC-60] Event is missing `indexed` fields
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/SafeDeployer.sol

32:     event SafeProxyCreationFailure(address indexed singleton, uint256 indexed nonce, bytes initializer);

```
*Github:* [[32](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L32)]


```solidity
File: src/core/SafeEnabler.sol

19:     event EnabledModule(address module);

20:     event ChangedGuard(address guard);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L19), [20](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L20)]


```solidity
File: src/core/registries/PolicyRegistry.sol

19:     event UpdatedPolicyCommit(address indexed account, bytes32 policyCommit, bytes32 oldPolicyCommit);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L19)]



<a name="NC-61"></a> 
### [NC-61] Functions not used internally could be marked `external`

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

60:     function getMessageHash(bytes memory message) public view returns (bytes32) {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L60)]


```solidity
File: src/core/SafeEnabler.sol

43:     function enableModule(address module) public {

66:     function setGuard(address guard) public {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L43), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L66)]




## Gas Optimizations

<a name="GAS-1"></a> 
### [GAS-1] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate
Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot. Finally, if both fields are accessed in the same function, can save ~42 gas per access due to not having to [recalculate the key's keccak256 hash](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0) (Gkeccak256 - 30 gas) and that calculation's associated stack operations.

*There is one instance of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

58:     mapping(address account => mapping(address executor => uint256 nonce)) public executorNonce;

```
*Github:* [[58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L58)]



<a name="GAS-2"></a> 
### [GAS-2] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```


<a name="GAS-3"></a> 
### [GAS-3] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas
Saves deployment costs.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit duplicated on line 144
113:             revert InvalidExecutor();

```
*Github:* [[113](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L113)]


```solidity
File: src/core/SafeDeployer.sol

/// @audit duplicated on line 237
242:                 revert SafeProxyCreationFailed();

```
*Github:* [[242](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L242)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit duplicated on line 243
223:             revert TxnUnAuthorized();

```
*Github:* [[223](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L223)]



<a name="GAS-4"></a> 
### [GAS-4] Increments can be `unchecked` to save gas
Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save 30-40 gas per iteration. So it is recommended to use unchecked increments when overflow is not possible.

*There is one instance of this issue:*
```solidity
File: src/libraries/SafeHelper.sol

132:                 ++i;

```
*Github:* [[132](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L132)]



<a name="GAS-5"></a> 
### [GAS-5] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit `_executeTxnAsModule` is used only once
86:     function _executeTxnAsModule(address _account, Types.Executable memory _executable)

/// @audit `_validateExecutionRequest` is used only once
106:     function _validateExecutionRequest(ExecutionRequest calldata execRequest) internal {

```
*Github:* [[86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L86), [106](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L106)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit `_decompileSignatures` is used only once
156:     function _decompileSignatures(bytes calldata _signatures)

```
*Github:* [[156](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L156)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit `_isConsoleBeingOverriden` is used only once
157:          * Following conditions validate if the transaction aims to remove guard or fallback handler on Safe

```
*Github:* [[157](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L157)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit `_updatePolicy` is used only once
66:     function _updatePolicy(address account, bytes32 policyCommit) internal {

```
*Github:* [[66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L66)]


```solidity
File: src/libraries/SafeHelper.sol

/// @audit `_generateSingleThresholdSignature` is used only once
87:     function _generateSingleThresholdSignature(address owner) internal pure returns (bytes memory) {

```
*Github:* [[87](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L87)]



<a name="GAS-6"></a> 
### [GAS-6] `keccak256()` hash of literals should only be computed once
The result of the hash should be stored in an immutable variable, and the variable should be used instead. If the hash is being used as a part of a function selector, the cast to `bytes4` should also only be done once.

*There is one instance of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24)]



<a name="GAS-7"></a> 
### [GAS-7] Multiple accesses of the same mapping/array key/index should be cached
The instances below point to the second+ access of a value inside a mapping/array, within a function. Caching a mapping's value in a local `storage` or `calldata` variable when the value is accessed [multiple times](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0), saves ~42 gas per access due to not having to recalculate the key's keccak256 hash (Gkeccak256 - 30 gas) and that calculation's associated stack operations. Caching an array's struct avoids recalculating the array offsets into memory/calldata

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

/// @audit `registries[_key]` is also accessed on line 101
102:         registries[_key] = _registry;

```
*Github:* [[102](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L102)]


```solidity
File: src/core/registries/PolicyRegistry.sol

/// @audit `commitments[account]` is also accessed on line 67
68:         commitments[account] = policyCommit;

```
*Github:* [[68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L68)]


```solidity
File: src/core/registries/WalletRegistry.sol

/// @audit `isWallet[msg.sender]` is also accessed on line 36
38:         isWallet[msg.sender] = true;

/// @audit `subAccountToWallet[_subAccount]` is also accessed on line 51
52:         subAccountToWallet[_subAccount] = _wallet;

```
*Github:* [[38](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L38), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L52)]



<a name="GAS-8"></a> 
### [GAS-8] Newer versions of solidity are more gas efficient
The solidity language continues to pursue more efficient gas optimization schemes. Adopting a newer version of solidity can be more gas efficient.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L5)]


```solidity
File: src/core/AddressProviderService.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L5)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L5)]


```solidity
File: src/core/Constants.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L5)]


```solidity
File: src/core/ExecutorPlugin.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L5)]


```solidity
File: src/core/PolicyValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L5)]


```solidity
File: src/core/SafeDeployer.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L5)]


```solidity
File: src/core/SafeEnabler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L5)]


```solidity
File: src/core/SafeModerator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L5)]


```solidity
File: src/core/SafeModeratorOverridable.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L5)]


```solidity
File: src/core/TransactionValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L5)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L5)]


```solidity
File: src/core/registries/PolicyRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L5)]


```solidity
File: src/core/registries/WalletRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L5)]


```solidity
File: src/libraries/SafeHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L5)]


```solidity
File: src/libraries/TypeHashHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L5)]


</details>


<a name="GAS-9"></a> 
### [GAS-9] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/core/PolicyValidator.sol

116:         if (expiryEpoch < uint32(block.timestamp)) {

162:         if (length < 8) revert InvalidSignatures();

```
*Github:* [[116](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L116), [162](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L162)]


```solidity
File: src/libraries/SafeHelper.sol

134:         } while (i < len);

```
*Github:* [[134](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L134)]



<a name="GAS-10"></a> 
### [GAS-10] Remove or replace unused state variables
Saves a storage slot. If the variable is assigned a non-zero value, saves Gsset (20000 gas). If it's assigned a zero value, saves Gsreset (2900 gas). If the variable remains unassigned, there is no gas savings unless the variable is `public`, in which case the compiler-generated non-payable getter deployment cost is saved. If the state variable is overriding an interface's public function, mark the variable as `constant` or `immutable` so that it does not use a storage slot.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

22:     bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

27:     bytes4 internal constant UPDATED_MAGIC_VALUE = 0x1626ba7e;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L22), [24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L27)]


```solidity
File: src/core/Constants.sol

33:     /// @notice keccak256("ConsoleFallbackHandler")

78:     /*´:°•.°+.*•´.*:˚.°*.˚•´.°:°•.°•.*•´.*:˚.°*.˚•´.°:°•.°+.*•´.*:*/

86:         0xc8fab2cea6e498c7d5e11e57566a1bd0376d100edae95e1256aeb6072ee66f89;

```
*Github:* [[33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L33), [78](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L78), [86](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L86)]


```solidity
File: src/core/SafeEnabler.sol

23:     address internal immutable _self;

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L23)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]



<a name="GAS-11"></a> 
### [GAS-11] The result of a function call should be cached rather than re-calling the function
The function calls in solidity are expensive. If the same result of the same function calls are to be used several times, the result should be cached to reduce the gas consumption of repeated calls.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/core/SafeDeployer.sol

/// @audit `getRegistry` is called 2 times
/// @audit `_getRegistry` is called 2 times
82:     function deploySubAccount(address[] calldata _owners, uint256 _threshold, bytes32 _policyCommit, bytes32 _salt)
            external
            nonReentrant
            returns (address _subAcc)
        {

/// @audit `getAuthorizedAddress` is called 5 times
/// @audit `_getAuthorizedAddress` is called 5 times
110:     function _setupConsoleAccount(address[] memory _owners, uint256 _threshold, bool _policyHashValid)
             private
             view
             returns (bytes memory)
         {

/// @audit `getAuthorizedAddress` is called 4 times
/// @audit `_getAuthorizedAddress` is called 4 times
168:     function _setupSubAccount(address[] memory _owners, uint256 _threshold, address _consoleAccount)
             private
             view
             returns (bytes memory)
         {

/// @audit `getAuthorizedAddress` is called 2 times
/// @audit `_getAuthorizedAddress` is called 2 times
/// @audit `_genNonce` is called 2 times
219:     function _createSafe(address[] calldata _owners, bytes memory _initializer, bytes32 _salt)
             private
             returns (address _safe)
         {

```
*Github:* [[82](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L82), [110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L110), [168](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L168), [219](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L219)]


```solidity
File: src/core/TransactionValidator.sol

/// @audit `getAuthorizedAddress` is called 2 times
/// @audit `_getAuthorizedAddress` is called 2 times
186:         if (guard != AddressProviderService._getAuthorizedAddress(_SAFE_MODERATOR_HASH)) revert InvalidGuard();
     
             // Ensure fallback handler has not been altered

```
*Github:* [[186](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L186)]



<a name="GAS-12"></a> 
### [GAS-12] Unused named return variables without optimizer waste gas
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

/// @audit `version` not used
159:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L159)]


```solidity
File: src/core/PolicyValidator.sol

/// @audit `version` not used
174:     function _domainNameAndVersion() internal pure override returns (string memory name, string memory version) {

```
*Github:* [[174](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L174)]



<a name="GAS-13"></a> 
### [GAS-13] Use assembly to compute hashes to save gas
If the arguments to the encode call can fit into the scratch space (two words or fewer), then it's more efficient to use assembly to generate the hash (80 gas):

`keccak256(abi.encodePacked(x, y)) -> assembly {mstore(0x00, a); mstore(0x20, b); let hash := keccak256(0x00, 0x40); }`

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

24:     bytes4 internal constant SIMULATE_SELECTOR = bytes4(keccak256("simulate(address,bytes)"));

69:         bytes32 safeMessageHash = keccak256(abi.encode(SAFE_MSG_TYPEHASH, keccak256(message)));

69:         bytes32 safeMessageHash = keccak256(abi.encode(SAFE_MSG_TYPEHASH, keccak256(message)));

70:         return keccak256(abi.encodePacked(bytes1(0x19), bytes1(0x01), safe.domainSeparator(), safeMessageHash));

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L24), [69](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L69), [69](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L69), [70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L70)]


```solidity
File: src/core/SafeDeployer.sol

225:         bytes32 ownersHash = keccak256(abi.encode(_owners));

235:                 if (keccak256(bytes(reason)) != _SAFE_CREATION_FAILURE_REASON) {

254:         return uint256(keccak256(abi.encodePacked(_ownersHash, ownerSafeCount[_ownersHash]++, _salt, VERSION)));

```
*Github:* [[225](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L225), [235](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L235), [254](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L254)]


```solidity
File: src/core/TransactionValidator.sol

166:             if (SafeHelper._GUARD_REMOVAL_CALLDATA_HASH == keccak256(_data)) {

168:             } else if (SafeHelper._FALLBACK_REMOVAL_CALLDATA_HASH == keccak256(_data)) {

```
*Github:* [[166](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L166), [168](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L168)]


```solidity
File: src/libraries/TypeHashHelper.sol

65:         return keccak256(

70:                 keccak256(txn.data),

85:         return keccak256(

```
*Github:* [[65](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L65), [70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L70), [85](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L85)]


</details>


<a name="GAS-14"></a> 
### [GAS-14] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

55:         emit GovernanceTransferRequested(governance, _newGovernance);

66:         emit GovernanceTransferred(governance, msg.sender);

89:         emit AuthorizedAddressInitialised(_authorizedAddress, _key);

104:         emit RegistryInitialised(_registry, _key);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L55), [66](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L66), [89](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L89), [104](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L104)]


```solidity
File: src/core/SafeDeployer.sol

70:         emit ConsoleAccountDeployed(_safe);

102:         emit SubAccountDeployed(_subAcc, msg.sender);

239:                 emit SafeProxyCreationFailure(gnosisSafeSingleton, nonce, _initializer);

```
*Github:* [[70](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L70), [102](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L102), [239](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L239)]


```solidity
File: src/core/SafeEnabler.sol

55:         emit EnabledModule(module);

74:         emit ChangedGuard(guard);

```
*Github:* [[55](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L55), [74](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L74)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

43:         emit RegisterExecutor(_subAccount, msg.sender, _executor);

58:         emit DeRegisterExecutor(_subAccount, msg.sender, _executor);

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L43), [58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L58)]


```solidity
File: src/core/registries/PolicyRegistry.sol

67:         emit UpdatedPolicyCommit(account, policyCommit, commitments[account]);

```
*Github:* [[67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L67)]


```solidity
File: src/core/registries/WalletRegistry.sol

39:         emit RegisterWallet(msg.sender);

54:         emit RegisterSubAccount(_wallet, _subAccount);

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L39), [54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L54)]


</details>


<a name="GAS-15"></a> 
### [GAS-15] Use assembly to write address/contract type storage values
Using `assembly { sstore(state.slot, addr)` instead of `state = addr` can save gas.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/core/AddressProvider.sol

45:         governance = _governance;

56:         pendingGovernance = _newGovernance;

67:         governance = msg.sender;

```
*Github:* [[45](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L45), [56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L56), [67](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L67)]


```solidity
File: src/core/AddressProviderService.sol

29:         addressProvider = AddressProvider(_addressProvider);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L29)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

26:     address internal constant SENTINEL_MODULES = address(0x1);

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L26)]


```solidity
File: src/core/SafeEnabler.sol

26:     address internal constant _SENTINEL_MODULES = address(0x1);

33:         _self = address(this);

```
*Github:* [[26](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L26), [33](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L33)]



<a name="GAS-16"></a> 
### [GAS-16] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

*There are <b>7</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

117:         if (execRequest.executor.code.length == 0 && execRequest.executorSignature.length == 0) {

```
*Github:* [[117](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L117)]


```solidity
File: src/core/PolicyValidator.sol

135:         if (trustedValidator.code.length == 0 && validatorSignature.length == 0) {

```
*Github:* [[135](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L135)]


```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48)]


```solidity
File: src/core/TransactionValidator.sol

165:         if (_from == _to && _value == 0 && _operation == Enum.Operation.Call) {

165:         if (_from == _to && _value == 0 && _operation == Enum.Operation.Call) {

```
*Github:* [[165](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L165), [165](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L165)]


```solidity
File: src/core/registries/PolicyRegistry.sol

47:                 && msg.sender == AddressProviderService._getAuthorizedAddress(_SAFE_DEPLOYER_HASH)

52:         } else if (msg.sender == account && walletRegistry.isWallet(account)) {

```
*Github:* [[47](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L47), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L52)]



<a name="GAS-17"></a> 
### [GAS-17] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L5)]


```solidity
File: src/core/AddressProviderService.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L5)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L5)]


```solidity
File: src/core/Constants.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/Constants.sol#L5)]


```solidity
File: src/core/ExecutorPlugin.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L5)]


```solidity
File: src/core/PolicyValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L5)]


```solidity
File: src/core/SafeDeployer.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L5)]


```solidity
File: src/core/SafeEnabler.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L5)]


```solidity
File: src/core/SafeModerator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L5)]


```solidity
File: src/core/SafeModeratorOverridable.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L5)]


```solidity
File: src/core/TransactionValidator.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L5)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L5)]


```solidity
File: src/core/registries/PolicyRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L5)]


```solidity
File: src/core/registries/WalletRegistry.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L5)]


```solidity
File: src/libraries/SafeHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L5)]


```solidity
File: src/libraries/TypeHashHelper.sol

5: pragma solidity 0.8.19;

```
*Github:* [[5](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L5)]


</details>


<a name="GAS-18"></a> 
### [GAS-18] Using bitmap to store bool states can save gas
Using a bitmap instead of a bool array or a bool mapping to store boolean states can save gas fees. This is because the bitmap can store 256 boolean values in a single slot instead of 256 slots, which can save gas when writing bool values or when reading multiple bool values from the same slot.

*There is one instance of this issue:*
```solidity
File: src/core/registries/WalletRegistry.sol

27:     mapping(address => bool) public isWallet;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L27)]



<a name="GAS-19"></a> 
### [GAS-19] Using bools for storage incurs overhead
Use uint256(1) and uint256(2) for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from ‘false’ to ‘true’, after having been ‘true’ in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*There is one instance of this issue:*
```solidity
File: src/core/registries/WalletRegistry.sol

27:     mapping(address => bool) public isWallet;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L27)]



<a name="GAS-20"></a> 
### [GAS-20] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/core/ConsoleFallbackHandler.sol

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

39:     function isValidSignature(bytes memory _data, bytes memory _signature) public view override returns (bytes4) {

60:     function getMessageHash(bytes memory message) public view returns (bytes32) {

68:     function getMessageHashForSafe(GnosisSafe safe, bytes memory message) public view returns (bytes32) {

```
*Github:* [[39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [39](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L39), [60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L60), [68](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L68)]


```solidity
File: src/core/PolicyValidator.sol

58:         bytes memory data,

```
*Github:* [[58](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L58)]


```solidity
File: src/core/SafeModerator.sol

36:         bytes memory data,

43:         bytes memory signatures,

83:         bytes memory, /* data */

```
*Github:* [[36](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L36), [43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L43), [83](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L83)]


```solidity
File: src/core/SafeModeratorOverridable.sol

42:         bytes memory data,

49:         bytes memory signatures,

89:         bytes memory, /* data */

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L42), [49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L49), [89](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L89)]


```solidity
File: src/core/TransactionValidator.sol

65:         // Check if guard or fallback handler is being removed, if yes, skip policy validation

97:             txParams.from, txParams.to, txParams.value, txParams.data, txParams.operation, txParams.signatures

129:      * @notice Provides on-chain guarantees on security critical expected states of subAccount for executor plugin

```
*Github:* [[65](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L65), [97](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L97), [129](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L129)]


</details>


<a name="GAS-21"></a> 
### [GAS-21] Use Custom Errors
[Source](https://blog.soliditylang.org/2021/04/21/custom-errors/)
Instead of using error strings, to reduce deployment and runtime cost, you should use Custom Errors. This would save both deployment and runtime cost.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/ConsoleFallbackHandler.sol

44:             require(safe.signedMessages(messageHash) != 0, "Hash not approved");

51:             require(policyValidator.isPolicySignatureValid(msg.sender, messageHash, _signature), "Policy not approved");

```
*Github:* [[44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L44), [51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L51)]


```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

52:         require(modules[module] == address(0), "GS102");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L52)]



<a name="GAS-22"></a> 
### [GAS-22] Don't initialize variables with default value

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/SafeHelper.sol

107:         uint256 i = 0;

```
*Github:* [[107](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L107)]



<a name="GAS-23"></a> 
### [GAS-23] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

<details>
<summary>
There are <b>17</b> instances (click to show):
</summary>

```solidity
File: src/core/ExecutorPlugin.sol

128:                 operation: uint8(SafeHelper._parseOperationEnum(execRequest.exec.callType)),

```
*Github:* [[128](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L128)]


```solidity
File: src/core/PolicyValidator.sol

22:     error TxnExpired(uint32 expiryEpoch);

71:                 operation: uint8(operation),

113:         (uint32 expiryEpoch, bytes memory validatorSignature) = _decompileSignatures(signatures);

116:         if (expiryEpoch < uint32(block.timestamp)) {

159:         returns (uint32 expiryEpoch, bytes memory validatorSignature)

164:         uint32 sigLength = uint32(bytes4(_signatures[length - 8:length - 4]));

164:         uint32 sigLength = uint32(bytes4(_signatures[length - 8:length - 4]));

165:         expiryEpoch = uint32(bytes4(_signatures[length - 4:length]));

```
*Github:* [[22](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L22), [71](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L71), [113](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L113), [116](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L116), [159](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L159), [164](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L164), [164](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L164), [165](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L165)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/SafeHelper.sol

110:             uint8 call = uint8(Enum.Operation.Call);

110:             uint8 call = uint8(Enum.Operation.Call);

112:                 call = uint8(Enum.Operation.DelegateCall);

144:         return address(uint160(uint256(bytes32(guardAddress))));

154:         return address(uint160(uint256(bytes32(fallbackHandlerAddress))));

```
*Github:* [[110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L110), [110](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L110), [112](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L112), [144](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L144), [154](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L154)]


```solidity
File: src/libraries/TypeHashHelper.sol

24:         uint8 operation;

40:         uint32 expiryEpoch;

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L24), [40](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L40)]


</details>


<a name="GAS-24"></a> 
### [GAS-24] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

43:     constructor(address _governance) {

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L43)]


```solidity
File: src/core/AddressProviderService.sol

27:     constructor(address _addressProvider) {

```
*Github:* [[27](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L27)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L29)]


```solidity
File: src/core/ExecutorPlugin.sol

60:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[60](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L60)]


```solidity
File: src/core/PolicyValidator.sol

30:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[30](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L30)]


```solidity
File: src/core/SafeDeployer.sol

42:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[42](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L42)]


```solidity
File: src/core/SafeEnabler.sol

32:     constructor() {

```
*Github:* [[32](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L32)]


```solidity
File: src/core/SafeModerator.sol

17:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[17](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModerator.sol#L17)]


```solidity
File: src/core/SafeModeratorOverridable.sol

23:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L23)]


```solidity
File: src/core/TransactionValidator.sol

54:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L54)]


```solidity
File: src/core/registries/ExecutorRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/ExecutorRegistry.sol#L29)]


```solidity
File: src/core/registries/PolicyRegistry.sol

24:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[24](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L24)]


```solidity
File: src/core/registries/WalletRegistry.sol

29:     constructor(address _addressProvider) AddressProviderService(_addressProvider) {}

```
*Github:* [[29](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L29)]


</details>


<a name="GAS-25"></a> 
### [GAS-25] `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too)
*Saves 5 gas per loop*

*There are <b>2</b> instances of this issue:*
```solidity
File: src/core/ExecutorPlugin.sol

131:                 nonce: executorNonce[execRequest.account][execRequest.executor]++

```
*Github:* [[131](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L131)]


```solidity
File: src/core/SafeDeployer.sol

254:         return uint256(keccak256(abi.encodePacked(_ownersHash, ownerSafeCount[_ownersHash]++, _salt, VERSION)));

```
*Github:* [[254](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L254)]



<a name="GAS-26"></a> 
### [GAS-26] Using `private` rather than `public` for constants, saves gas
If needed, the values can be read from the verified contract source code, or if there are multiple values there can be a single getter function that [returns a tuple](https://github.com/code-423n4/2022-08-frax/blob/90f55a9ce4e25bceed3a74290b854341d8de6afa/src/contracts/FraxlendPair.sol#L156-L178) of the values of all currently-public constants. Saves **3406-3606 gas** in deployment gas due to the compiler not having to create non-payable getter functions for deployment calldata, not having to store the bytes of the value outside of where it's used, and not adding another entry to the method ID table

*There are <b>4</b> instances of this issue:*
```solidity
File: src/core/SafeDeployer.sol

23:     string public constant VERSION = "1";

```
*Github:* [[23](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L23)]


```solidity
File: src/core/SafeModeratorOverridable.sol

21:     uint8 public constant DIFFER_SAFE_MOD = 0;

```
*Github:* [[21](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeModeratorOverridable.sol#L21)]


```solidity
File: src/libraries/TypeHashHelper.sol

49:     bytes32 public constant TRANSACTION_PARAMS_TYPEHASH =

56:     bytes32 public constant VALIDATION_PARAMS_TYPEHASH =

```
*Github:* [[49](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L49), [56](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L56)]



<a name="GAS-27"></a> 
### [GAS-27] Splitting require() statements that use && saves gas

*There is one instance of this issue:*
```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48)]



<a name="GAS-28"></a> 
### [GAS-28] Using assembly to check for zero can save gas
Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

<details>
<summary>
There are <b>24</b> instances (click to show):
</summary>

```solidity
File: src/core/AddressProvider.sol

84:             if (_authorizedAddress.code.length != 0) _ensureAddressProvider(_authorizedAddress);

101:         if (registries[_key] != address(0)) revert RegistryAlreadyExists();

148:         if (addr == address(0)) revert NullAddress();

```
*Github:* [[84](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L84), [101](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L101), [148](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProvider.sol#L148)]


```solidity
File: src/core/AddressProviderService.sol

28:         if (_addressProvider == address(0)) revert InvalidAddressProvider();

73:         if (_addr == address(0)) revert InvalidAddress();

```
*Github:* [[28](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L28), [73](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L73)]


```solidity
File: src/core/ConsoleFallbackHandler.sol

43:         if (_signature.length == 0) {

44:             require(safe.signedMessages(messageHash) != 0, "Hash not approved");

```
*Github:* [[43](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L43), [44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ConsoleFallbackHandler.sol#L44)]


```solidity
File: src/core/ExecutorPlugin.sol

117:         if (execRequest.executor.code.length == 0 && execRequest.executorSignature.length == 0) {

117:         if (execRequest.executor.code.length == 0 && execRequest.executorSignature.length == 0) {

```
*Github:* [[117](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L117), [117](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/ExecutorPlugin.sol#L117)]


```solidity
File: src/core/PolicyValidator.sol

108:         if (policyHash == bytes32(0)) {

135:         if (trustedValidator.code.length == 0 && validatorSignature.length == 0) {

135:         if (trustedValidator.code.length == 0 && validatorSignature.length == 0) {

```
*Github:* [[108](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L108), [135](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L135), [135](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/PolicyValidator.sol#L135)]


```solidity
File: src/core/SafeDeployer.sol

61:         bool _policyHashValid = _policyCommit != bytes32(0);

88:         if (_policyCommit == bytes32(0)) revert InvalidCommitment();

244:         } while (_safe == address(0));

```
*Github:* [[61](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L61), [88](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L88), [244](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeDeployer.sol#L244)]


```solidity
File: src/core/SafeEnabler.sol

48:         require(module != address(0) && module != _SENTINEL_MODULES, "GS101");

52:         require(modules[module] == address(0), "GS102");

```
*Github:* [[48](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L48), [52](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/SafeEnabler.sol#L52)]


```solidity
File: src/core/TransactionValidator.sol

171:         }

```
*Github:* [[171](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/TransactionValidator.sol#L171)]


```solidity
File: src/core/registries/PolicyRegistry.sol

36:         if (policyCommit == bytes32(0)) {

46:             currentCommit == bytes32(0)

```
*Github:* [[36](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L36), [46](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/PolicyRegistry.sol#L46)]


```solidity
File: src/core/registries/WalletRegistry.sol

37:         if (subAccountToWallet[msg.sender] != address(0)) revert IsSubAccount();

51:         if (subAccountToWallet[_subAccount] != address(0)) revert AlreadyRegistered();

```
*Github:* [[37](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L37), [51](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/registries/WalletRegistry.sol#L51)]


```solidity
File: src/libraries/SafeHelper.sol

105:         if (len == 0) revert InvalidMultiSendInput();

123:             if (i != 0) {

```
*Github:* [[105](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L105), [123](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L123)]


</details>


<a name="GAS-29"></a> 
### [GAS-29] `internal` functions not called by the contract should be removed
If the functions are required by an interface, the contract should inherit from that interface and use the `override` keyword

*There are <b>10</b> instances of this issue:*
```solidity
File: src/core/AddressProviderService.sol

44:     function _getRegistry(bytes32 _key) internal view returns (address registry) {

54:     function _getAuthorizedAddress(bytes32 _key) internal view returns (address authorizedAddress) {

62:     function _onlyGov() internal view {

```
*Github:* [[44](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L44), [54](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L54), [62](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/core/AddressProviderService.sol#L62)]


```solidity
File: src/libraries/SafeHelper.sol

63:     function _executeOnSafe(address safe, address target, Enum.Operation op, bytes memory data) internal {

103:     function _packMultisendTxns(Types.Executable[] memory _txns) internal pure returns (bytes memory packedTxns) {

142:     function _getGuard(address safe) internal view returns (address) {

152:     function _getFallbackHandler(address safe) internal view returns (address) {

163:     function _parseOperationEnum(Types.CallType callType) internal pure returns (Enum.Operation operation) {

```
*Github:* [[63](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L63), [103](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L103), [142](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L142), [152](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L152), [163](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/SafeHelper.sol#L163)]


```solidity
File: src/libraries/TypeHashHelper.sol

64:     function _buildTransactionStructHash(Transaction memory txn) internal pure returns (bytes32) {

84:     function _buildValidationStructHash(Validation memory validation) internal pure returns (bytes32) {

```
*Github:* [[64](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L64), [84](https://github.com/code-423n4/2023-10-brahma/blob/c217699448ffd7ec0253472bf0d156e52d45ca71/contracts/src/libraries/TypeHashHelper.sol#L84)]



