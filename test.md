# Report

Audit report for **2023-09-venus** generated by *ubl4nk_bot*.

## Medium Issues


Total <b>3</b> instances over <b>1</b> issue:

|ID|Issue|Instances|
|-|:-|:-:|
| [M-1](#M-1) | Centralization Risk for trusted owners | 3 |

## Low Issues


Total <b>263</b> instances over <b>11</b> issues:

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Array is `push()`ed but not `pop()`ed | 1 |
| [L-2](#L-2) | Check division by zero is prevented | 124 |
| [L-3](#L-3) | Consider implementing two-step procedure for updating protocol addresses | 1 |
| [L-4](#L-4) | Constructor / initialization function lacks parameter validation | 2 |
| [L-5](#L-5) | Governance functions should be controlled by time locks | 1 |
| [L-6](#L-6) | Loss of precision in divisions | 124 |
| [L-7](#L-7) | Check storage gap for upgradable contracts | 2 |
| [L-8](#L-8) | Prevent re-setting a state variable with the same value | 1 |
| [L-9](#L-9) | Timestamp may be manipulation | 3 |
| [L-10](#L-10) | Missing zero address check in initializer | 2 |
| [L-11](#L-11) | Initializers could be front-run | 2 |

## Non Critical Issues


Total <b>342</b> instances over <b>42</b> issues:

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | Contract declarations should have NatSpec `@author` annotations | 6 |
| [NC-2](#NC-2) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 2 |
| [NC-3](#NC-3) | Consider adding a block/deny-list | 3 |
| [NC-4](#NC-4) | Consider adding formal verification proofs | 1 |
| [NC-5](#NC-5) | Consider bounding input array length | 3 |
| [NC-6](#NC-6) | Consider using `AccessControlDefaultAdminRules` rather than `AccessControl` | 2 |
| [NC-7](#NC-7) | Constants should be put on the left side of comparisons | 36 |
| [NC-8](#NC-8) | Contracts should have full test coverage | 1 |
| [NC-9](#NC-9) | Events that mark critical parameter changes should contain both the old and the new value | 15 |
| [NC-10](#NC-10) | Custom errors has no error details | 17 |
| [NC-11](#NC-11) | Duplicated `require()`/`revert()` checks should be refactored | 1 |
| [NC-12](#NC-12) | `else` block not required | 3 |
| [NC-13](#NC-13) | Enable IR-based code generation | 1 |
| [NC-14](#NC-14) | Events are emitted without the sender information | 13 |
| [NC-15](#NC-15) |  Function ordering does not follow the Solidity Style Guide | 10 |
| [NC-16](#NC-16) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-17](#NC-17) | Long functions should be refactored into multiple, smaller, functions | 2 |
| [NC-18](#NC-18) | Magic numbers should be replaced with constants | 19 |
| [NC-19](#NC-19) | Missing zero address check in functions with address parameters | 42 |
| [NC-20](#NC-20) | Named mappings are recommended | 11 |
| [NC-21](#NC-21) | NatSpec documentation for contract is missing | 6 |
| [NC-22](#NC-22) | Missing NatSpec `@param` | 6 |
| [NC-23](#NC-23) | NatSpec `@return` is missing | 4 |
| [NC-24](#NC-24) | There is no need to initialize variables with 0 | 13 |
| [NC-25](#NC-25) | Put all system-wide constants in one file | 12 |
| [NC-26](#NC-26) | State variables should include comments | 1 |
| [NC-27](#NC-27) | Contract declarations should have NatSpec `@title` annotations | 6 |
| [NC-28](#NC-28) | Lines are too long | 6 |
| [NC-29](#NC-29) | Unused errors | 1 |
| [NC-30](#NC-30) | Unused `event` definition | 3 |
| [NC-31](#NC-31) | Unused named return | 4 |
| [NC-32](#NC-32) | Consider using `delete` rather than assigning zero to clear values | 5 |
| [NC-33](#NC-33) | Solidity compiler version is not fixed | 1 |
| [NC-34](#NC-34) | Expressions for constant values should use `immutable` rather than `constant` | 12 |
| [NC-35](#NC-35) | Use the latest solidity version for deployment | 6 |
| [NC-36](#NC-36) | Whitespace in Expressions | 1 |
| [NC-37](#NC-37) | Missing checks for `address(0)` when assigning values to address state variables | 1 |
| [NC-38](#NC-38) | Names of `private`/`internal` functions should be prefixed with an underscore | 9 |
| [NC-39](#NC-39) | Names of `private`/`internal` state variables should be prefixed with an underscore | 12 |
| [NC-40](#NC-40) | Variables should be named in mixedCase style | 16 |
| [NC-41](#NC-41) | Event is missing `indexed` fields | 8 |
| [NC-42](#NC-42) | Constants should be defined rather than using magic numbers | 20 |

## Gas Optimizations


Total <b>391</b> instances over <b>31</b> issues:

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate | 2 | - |
| [GAS-2](#GAS-2) | Consider activating via-ir for deploying | 1 | - |
| [GAS-3](#GAS-3) | Divisions can be `unchecked` to save gas | 124 | 2480 |
| [GAS-4](#GAS-4) | Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables | 41 | 4633 |
| [GAS-5](#GAS-5) | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas | 1 | - |
| [GAS-6](#GAS-6) | Increments can be `unchecked` to save gas | 3 | 180 |
| [GAS-7](#GAS-7) | Initializers can be marked as payable to save deployment gas | 2 | 42 |
| [GAS-8](#GAS-8) | `internal` functions only called once can be inlined to save gas | 6 | 180 |
| [GAS-9](#GAS-9) | Multiple accesses of the same mapping/array key/index should be cached | 5 | 210 |
| [GAS-10](#GAS-10) | Newer versions of solidity are more gas efficient | 6 | - |
| [GAS-11](#GAS-11) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 40 | 120 |
| [GAS-12](#GAS-12) | Reduce gas usage by moving to Solidity 0.8.19 or later | 6 | 6000 |
| [GAS-13](#GAS-13) | Remove or replace unused state variables | 1 | - |
| [GAS-14](#GAS-14) | Unused named return variables without optimizer waste gas | 4 | 36 |
| [GAS-15](#GAS-15) | Use assembly to emit events | 16 | 608 |
| [GAS-16](#GAS-16) | Using a double `if` statement instead of a logical AND (`&&`) | 9 | 270 |
| [GAS-17](#GAS-17) | Use a more recent version of solidity | 6 | - |
| [GAS-18](#GAS-18) | Use `unchecked` block for safe subtractions | 2 | 170 |
| [GAS-19](#GAS-19) | Using bitmap to store bool states can save gas | 1 | - |
| [GAS-20](#GAS-20) | Using bools for storage incurs overhead | 1 | - |
| [GAS-21](#GAS-21) | Cache array length outside of loop | 10 | - |
| [GAS-22](#GAS-22) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 1 | - |
| [GAS-23](#GAS-23) | Don't initialize variables with default value | 13 | - |
| [GAS-24](#GAS-24) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 14 | 770 |
| [GAS-25](#GAS-25) | Constructors can be marked as `payable` to save deployment gas | 2 | 42 |
| [GAS-26](#GAS-26) | Functions guaranteed to revert when called by normal users can be marked `payable` | 3 | 63 |
| [GAS-27](#GAS-27) | `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too) | 13 | 65 |
| [GAS-28](#GAS-28) | Using `private` rather than `public` for constants, saves gas | 4 | - |
| [GAS-29](#GAS-29) | Use `!= 0` instead of `> 0` for unsigned integer comparison | 11 | 44 |
| [GAS-30](#GAS-30) | Using assembly to check for zero can save gas | 35 | 210 |
| [GAS-31](#GAS-31) | `internal` functions not called by the contract should be removed | 8 | - |

## Medium Issues

<a name="M-1"></a> 
### [M-1] Centralization Risk for trusted owners
Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

118:     function initializeTokens(address[] calldata tokens_) external onlyOwner {

177:     function setPrimeToken(address prime_) external onlyOwner {

216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

```
[#L118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L118) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177) [#L216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216) 

---


## Low Issues

<a name="L-1"></a> 
### [L-1] Array is `push()`ed but not `pop()`ed
There is no limit specified on the amount of gas used, so the recipient can use up all of the remaining gas (`gasleft()`), causing it to revert. Therefore, when calling an external contract, it is necessary to specify a limited amount of gas to forward.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

303:         allMarkets.push(vToken);

```
[#L303](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L303) 

---

<a name="L-2"></a> 
### [L-2] Check division by zero is prevented

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
[#L501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501) [#L585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585) [#L654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885) [#L886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886) [#L889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889) [#L893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893) [#L922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972) [#L1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004) [#L1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009) [#L1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010) [#L1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012) [#L1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
[#L25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37) [#L49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
[#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121) [#L122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163) [#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167) [#L168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168) [#L169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169) [#L170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170) [#L171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171) [#L172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172) [#L173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174) [#L175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177) [#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178) [#L179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179) [#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180) [#L181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183) [#L184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184) [#L185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185) [#L186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186) [#L187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187) [#L188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188) [#L189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189) [#L190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190) [#L191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192) [#L193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193) [#L194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194) [#L195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195) [#L196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196) [#L197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197) [#L198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198) [#L199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199) [#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208) [#L214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214) [#L220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220) [#L226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226) [#L232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232) [#L238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238) [#L244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244) [#L250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250) [#L256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
[#L59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59) 

</details>

---

<a name="L-3"></a> 
### [L-3] Consider implementing two-step procedure for updating protocol addresses
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must "accept" the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the "set" functions ensure that the recipient is of the right interface type.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

177:     function setPrimeToken(address prime_) external onlyOwner {

```
[#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177) 

---

<a name="L-4"></a> 
### [L-4] Constructor / initialization function lacks parameter validation
Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `_xvsVaultPoolId` not validated
/// @audit `_alphaNumerator` not validated
/// @audit `_alphaDenominator` not validated
/// @audit `_accessControlManager` not validated
/// @audit `_loopsLimit` not validated
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

```
[#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit `accessControlManager_` not validated
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

```
[#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90) 

---

<a name="L-5"></a> 
### [L-5] Governance functions should be controlled by time locks
Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

177:     function setPrimeToken(address prime_) external onlyOwner {

```
[#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177) 

---

<a name="L-6"></a> 
### [L-6] Loss of precision in divisions
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator.

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
[#L501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501) [#L585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585) [#L654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885) [#L886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886) [#L889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889) [#L893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893) [#L922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972) [#L1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004) [#L1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009) [#L1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010) [#L1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012) [#L1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
[#L25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37) [#L49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
[#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121) [#L122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163) [#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167) [#L168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168) [#L169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169) [#L170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170) [#L171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171) [#L172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172) [#L173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174) [#L175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177) [#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178) [#L179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179) [#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180) [#L181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183) [#L184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184) [#L185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185) [#L186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186) [#L187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187) [#L188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188) [#L189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189) [#L190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190) [#L191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192) [#L193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193) [#L194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194) [#L195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195) [#L196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196) [#L197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197) [#L198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198) [#L199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199) [#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208) [#L214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214) [#L220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220) [#L226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226) [#L232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232) [#L238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238) [#L244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244) [#L250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250) [#L256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
[#L59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59) 

</details>

---

<a name="L-7"></a> 
### [L-7] Check storage gap for upgradable contracts
Each upgradable contract should include a state variable (usually named `__gap`) to provide reserved space in storage. This allows the team to freely add new state variables in the future upgrades without compromising the storage compatibility with existing deployments.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

---

<a name="L-8"></a> 
### [L-8] Prevent re-setting a state variable with the same value
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

181:         prime = prime_;

```
[#L181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L181) 

---

<a name="L-9"></a> 
### [L-9] Timestamp may be manipulation
The `block.timestamp` can be manipulated by miners to perform MEV profiting or other time-based attacks.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

378:             stakedAt[user] = block.timestamp;

399:         if (block.timestamp - stakedAt[msg.sender] < STAKING_PERIOD) revert WaitMoreTime();

481:         uint256 totalTimeStaked = block.timestamp - stakedAt[user];

```
[#L378](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L378) [#L399](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L399) [#L481](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L481) 

---

<a name="L-10"></a> 
### [L-10] Missing zero address check in initializer

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing zero check for `_accessControlManager`
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

```
[#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Missing zero check for `accessControlManager_`
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

```
[#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90) 

---

<a name="L-11"></a> 
### [L-11] Initializers could be front-run
Initializers could be front-run, allowing an attacker to either set their own values, take ownership of the contract, and in the best case forcing a re-deployment

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

130:     function initialize(

```
[#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

90:     function initialize(

```
[#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90) 

---


## Non Critical Issues

<a name="NC-1"></a> 
### [NC-1] Contract declarations should have NatSpec `@author` annotations

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
[#L6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
[#L13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
[#L38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
[#L10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10) 

---

<a name="NC-2"></a> 
### [NC-2] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
[#L67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67) [#L88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88) 

---

<a name="NC-3"></a> 
### [NC-3] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
[#L6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6) 

---

<a name="NC-4"></a> 
### [NC-4] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```


---

<a name="NC-5"></a> 
### [NC-5] Consider bounding input array length
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to require() that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Consider length check for `users`
204:         for (uint256 i = 0; i < users.length; ) {

/// @audit Consider length check for `users`
335:             for (uint256 i = 0; i < users.length; ) {

```
[#L204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204) [#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Consider length check for `tokens_`
119:         for (uint256 i; i < tokens_.length; ) {

```
[#L119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119) 

---

<a name="NC-6"></a> 
### [NC-6] Consider using `AccessControlDefaultAdminRules` rather than `AccessControl`
`AccessControlDefaultAdminRules` implements multiple [security best practices](https://docs.openzeppelin.com/contracts/4.x/api/access#AccessControlDefaultAdminRules) on top of the normal `AccessControl` rules, so consider using it instead.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

---

<a name="NC-7"></a> 
### [NC-7] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>
There are <b>36</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

104:         if (_wbnb == address(0)) revert InvalidAddress();

105:         if (_vbnb == address(0)) revert InvalidAddress();

106:         if (_blocksPerYear == 0) revert InvalidBlocksPerYear();

143:         if (_xvsVault == address(0)) revert InvalidAddress();

144:         if (_xvsVaultRewardToken == address(0)) revert InvalidAddress();

145:         if (_protocolShareReserve == address(0)) revert InvalidAddress();

146:         if (_comptroller == address(0)) revert InvalidAddress();

147:         if (_oracle == address(0)) revert InvalidAddress();

148:         if (_primeLiquidityProvider == address(0)) revert InvalidAddress();

201:         if (pendingScoreUpdates == 0) revert NoScoreUpdatesRequired();

202:         if (nextScoreUpdateRoundId == 0) revert NoScoreUpdatesRequired();

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

398:         if (stakedAt[msg.sender] == 0) revert IneligibleToClaim();

457:         if (vToken == address(0)) revert MarketNotSupported();

479:         if (stakedAt[user] == 0) return STAKING_PERIOD;

576:         if (distributionIncome == 0) {

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

1002:         if (totalScore == 0) return (0, 0);

1007:         if (totalCappedValue == 0) return (0, 0);

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
[#L104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L104) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L105) [#L106](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L106) [#L143](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L143) [#L144](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L144) [#L145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L145) [#L146](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L146) [#L147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L147) [#L148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L148) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L201) [#L202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L202) [#L377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377) [#L398](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L398) [#L457](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L457) [#L479](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L479) [#L576](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L576) [#L810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810) [#L1002](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1002) [#L1007](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1007) [#L1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012) [#L1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

335:         if (lastBlockAccrued == 0) {

345:         if (address_ == address(0)) {

```
[#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L335) [#L345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L345) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

55:         if (x <= 0) {

145:         if (x == 0) {

206:         if ((x & int256(0x0000000000000000000000000000001000000000000000000000000000000000)) != 0) {

212:         if ((x & int256(0x0000000000000000000000000000000800000000000000000000000000000000)) != 0) {

218:         if ((x & int256(0x0000000000000000000000000000000400000000000000000000000000000000)) != 0) {

224:         if ((x & int256(0x0000000000000000000000000000000200000000000000000000000000000000)) != 0) {

230:         if ((x & int256(0x0000000000000000000000000000000100000000000000000000000000000000)) != 0) {

236:         if ((x & int256(0x0000000000000000000000000000000080000000000000000000000000000000)) != 0) {

242:         if ((x & int256(0x0000000000000000000000000000000040000000000000000000000000000000)) != 0) {

248:         if ((x & int256(0x0000000000000000000000000000000020000000000000000000000000000000)) != 0) {

254:         if ((x & int256(0x0000000000000000000000000000000010000000000000000000000000000000)) != 0) {

```
[#L55](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L55) [#L145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L145) [#L206](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L206) [#L212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L212) [#L218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L218) [#L224](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L224) [#L230](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L230) [#L236](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L236) [#L242](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L242) [#L248](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L248) [#L254](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L254) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

44:         if (xvs == 0 || capital == 0) return 0;

44:         if (xvs == 0 || capital == 0) return 0;

```
[#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44) [#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44) 

</details>

---

<a name="NC-8"></a> 
### [NC-8] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```


---

<a name="NC-9"></a> 
### [NC-9] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>15</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

228:             emit UserScoreUpdated(user);

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
[#L228](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L228) [#L241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241) [#L308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308) [#L320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320) [#L462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462) [#L694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694) [#L718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718) [#L755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755) [#L771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

267:                 emit TokensAccrued(token_, tokenAccrued);

300:         emit TokenDistributionInitialized(token_);

324:             emit TokenDistributionSpeedUpdated(token_, distributionSpeed_);

```
[#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180) [#L202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202) [#L222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222) [#L267](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L267) [#L300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300) [#L324](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L324) 

</details>

---

<a name="NC-10"></a> 
### [NC-10] Custom errors has no error details
Consider adding parameters to the error to indicate which user or values caused the failure.

<details>
<summary>
There are <b>17</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

20: error MarketNotSupported();

21: error InvalidLimit();

22: error IneligibleToClaim();

23: error WaitMoreTime();

24: error UserHasNoPrimeToken();

25: error InvalidCaller();

26: error InvalidComptroller();

27: error NoScoreUpdatesRequired();

28: error MarketAlreadyExists();

29: error InvalidAddress();

30: error InvalidBlocksPerYear();

31: error InvalidAlphaArguments();

32: error InvalidVToken();

```
[#L20](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L20) [#L21](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L21) [#L22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L22) [#L23](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L23) [#L24](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L24) [#L25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L25) [#L26](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L26) [#L27](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L27) [#L28](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L28) [#L29](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L29) [#L30](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L30) [#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L31) [#L32](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L32) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

57:     error InvalidArguments();

63:     error InvalidCaller();

72:     error FundsTransferIsPaused();

```
[#L57](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L57) [#L63](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L63) [#L72](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L72) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

11: error InvalidFixedPoint();

```
[#L11](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L11) 

</details>

---

<a name="NC-11"></a> 
### [NC-11] Duplicated `require()`/`revert()` checks should be refactored
Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Duplicated on line 158
100:             revert InvalidArguments();

```
[#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L100) 

---

<a name="NC-12"></a> 
### [NC-12] `else` block not required
One level of nesting can be removed by not having an `else` block when the `if`-block always jumps at the end. For example:
```solidity
if (condition) {
	body1...
	return x;
} else {
	body2...
}
```
can be changed to:
```solidity
if (condition) {
	body1...
	return x;
}
body2...
```

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

482:         if (totalTimeStaked < STAKING_PERIOD) {
                 return STAKING_PERIOD - totalTimeStaked;
             } else {

855:         if (xvs > MAXIMUM_XVS_CAP) {
                 return MAXIMUM_XVS_CAP;
             } else {

931:         if (vToken == VBNB) {
                 return WBNB;
             } else {

```
[#L482](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L482) [#L855](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L855) [#L931](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L931) 

---

<a name="NC-13"></a> 
### [NC-13] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```


---

<a name="NC-14"></a> 
### [NC-14] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

269:         emit MultiplierUpdated(

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
[#L241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241) [#L269](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L269) [#L308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308) [#L320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320) [#L462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462) [#L694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694) [#L718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718) [#L755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755) [#L771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

300:         emit TokenDistributionInitialized(token_);

```
[#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180) [#L202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202) [#L222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222) [#L300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300) 

</details>

---

<a name="NC-15"></a> 
### [NC-15]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit public function `accrueInterest` came earlier from this external function
397:     function claim() external {

/// @audit public function `accrueInterest` came earlier from this external function
411:     function burn(address user) external {

/// @audit public function `accrueInterest` came earlier from this external function
419:     function togglePause() external {

/// @audit public function `accrueInterest` came earlier from this external function
433:     function claimInterest(address vToken) external whenNotPaused returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
443:     function claimInterest(address vToken, address user) external whenNotPaused returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
452:     function updateAssetsState(address _comptroller, address asset) external {

/// @audit public function `accrueInterest` came earlier from this external function
469:     function getAllMarkets() external view returns (address[] memory) {

/// @audit public function `accrueInterest` came earlier from this external function
478:     function claimTimeRemaining(address user) external view returns (uint256) {

/// @audit public function `accrueInterest` came earlier from this external function
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit public function `accrueInterest` came earlier from this external function
527:     function estimateAPR(

```
[#L397](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L397) [#L411](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L411) [#L419](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L419) [#L433](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L433) [#L443](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L443) [#L452](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L452) [#L469](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L469) [#L478](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L478) [#L496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496) [#L527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527) 

---

<a name="NC-16"></a> 
### [NC-16] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```


---

<a name="NC-17"></a> 
### [NC-17] Long functions should be refactored into multiple, smaller, functions

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit 86 lines
51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

/// @audit 119 lines
140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51) [#L140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140) 

---

<a name="NC-18"></a> 
### [NC-18] Magic numbers should be replaced with constants
Magic numbers are hard-coded values in code that can make it difficult for developers and maintainers to understand the code, and can also cause confusion or errors. To improve the readability and maintainability of code, it is recommended to replace magic numbers with constants that have good readability.

<details>
<summary>
There are <b>19</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

78:         if (x <= int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000)) {

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

113:         if (x <= int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) {

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

209:                 int256(0x0000000000000000000000000043cbaf42a000812488fc5c220ad7b97bf6e99e); // * e ^ -32

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

221:                 int256(0x0000000000000000000000000000001b4c902e273a58678d6d3bfdb93db96d02); // * e ^ -8

233:                 int256(0x000000000000000000000000000000015bf0a8b1457695355fb8ac404e7a79e3); // * e ^ -2

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

245:                 int256(0x00000000000000000000000000000000a45af1e1f40c333b3de1db4dd55f29a7); // * e ^ -0.5

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

257:                 int256(0x0000000000000000000000000000000088415abbe9a76bead8d00cf112e4d4a8); // * e ^ -0.125

```
[#L78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L78) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L113](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L113) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130) [#L132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132) [#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208) [#L209](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L209) [#L220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220) [#L221](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L221) [#L233](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L233) [#L244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244) [#L245](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L245) [#L250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250) [#L257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L257) 

</details>

---

<a name="NC-19"></a> 
### [NC-19] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>42</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing zero check for `_wbnb`
/// @audit Missing zero check for `_vbnb`
103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

/// @audit Missing zero check for `_accessControlManager`
130:     function initialize(
             address _xvsVault,
             address _xvsVaultRewardToken,
             uint256 _xvsVaultPoolId,
             uint128 _alphaNumerator,
             uint128 _alphaDenominator,
             address _accessControlManager,
             address _protocolShareReserve,
             address _primeLiquidityProvider,
             address _comptroller,
             address _oracle,
             uint256 _loopsLimit
         ) external virtual initializer {

/// @audit Missing zero check for `user`
174:     function getPendingInterests(address user) external returns (PendingInterest[] memory pendingInterests) {

/// @audit Missing zero check for `market`
263:     function updateMultipliers(address market, uint256 supplyMultiplier, uint256 borrowMultiplier) external {

/// @audit Missing zero check for `vToken`
288:     function addMarket(address vToken, uint256 supplyMultiplier, uint256 borrowMultiplier) external {

/// @audit Missing zero check for `user`
365:     function xvsUpdated(address user) external {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `market`
389:     function accrueInterestAndUpdateScore(address user, address market) external {

/// @audit Missing zero check for `user`
411:     function burn(address user) external {

/// @audit Missing zero check for `vToken`
433:     function claimInterest(address vToken) external whenNotPaused returns (uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
443:     function claimInterest(address vToken, address user) external whenNotPaused returns (uint256) {

/// @audit Missing zero check for `_comptroller`
/// @audit Missing zero check for `asset`
452:     function updateAssetsState(address _comptroller, address asset) external {

/// @audit Missing zero check for `user`
478:     function claimTimeRemaining(address user) external view returns (uint256) {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit Missing zero check for `vToken`
554:     function accrueInterest(address vToken) public {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
597:     function getInterestAccrued(address vToken, address user) public returns (uint256) {

/// @audit Missing zero check for `user`
607:     function _accrueInterestAndUpdateScore(address user) internal {

/// @audit Missing zero check for `account`
623:     function _initializeMarkets(address account) internal {

/// @audit Missing zero check for `market`
/// @audit Missing zero check for `user`
647:     function _calculateScore(address market, address user) internal returns (uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
672:     function _claimInterest(address vToken, address user) internal returns (uint256) {

/// @audit Missing zero check for `user`
704:     function _mint(bool isIrrevocable, address user) internal {

/// @audit Missing zero check for `user`
725:     function _burn(address user) internal {

/// @audit Missing zero check for `user`
762:     function _upgrade(address user) internal {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `vToken`
779:     function _executeBoost(address user, address vToken) internal {

/// @audit Missing zero check for `user`
/// @audit Missing zero check for `market`
794:     function _updateScore(address user, address market) internal {

/// @audit Missing zero check for `user`
827:     function _updateRoundAfterTokenBurned(address user) internal {

/// @audit Missing zero check for `user`
840:     function _xvsBalanceOfUser(address user) internal view returns (uint256) {

/// @audit Missing zero check for `market`
872:     function _capitalForScore(
             uint256 xvs,
             uint256 borrow,
             uint256 supply,
             address market
         ) internal view returns (uint256, uint256, uint256) {

/// @audit Missing zero check for `vToken`
/// @audit Missing zero check for `user`
918:     function _interestAccrued(address vToken, address user) internal view returns (uint256) {

/// @audit Missing zero check for `vToken`
930:     function _getUnderlying(address vToken) internal view returns (address) {

/// @audit Missing zero check for `vToken`
947:     function _incomePerBlock(address vToken) internal view returns (uint256) {

/// @audit Missing zero check for `vToken`
970:     function _incomeDistributionYearly(address vToken) internal view returns (uint256 amount) {

/// @audit Missing zero check for `vToken`
993:     function _calculateUserAPR(
             address vToken,
             uint256 totalSupply,
             uint256 totalBorrow,
             uint256 totalCappedSupply,
             uint256 totalCappedBorrow,
             uint256 userScore,
             uint256 totalScore
         ) internal view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
[#L103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L174) [#L263](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L263) [#L288](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L288) [#L365](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L365) [#L389](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L389) [#L411](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L411) [#L433](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L433) [#L443](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L443) [#L452](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L452) [#L478](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L478) [#L496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496) [#L527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527) [#L554](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L554) [#L597](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L597) [#L607](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L607) [#L623](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L623) [#L647](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L647) [#L672](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L672) [#L704](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L704) [#L725](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L725) [#L762](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L762) [#L779](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L779) [#L794](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L794) [#L827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827) [#L840](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L840) [#L872](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L872) [#L918](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L918) [#L930](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L930) [#L947](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L947) [#L970](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L970) [#L993](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L993) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Missing zero check for `accessControlManager_`
90:     function initialize(
            address accessControlManager_,
            address[] calldata tokens_,
            uint256[] calldata distributionSpeeds_
        ) external initializer {

/// @audit Missing zero check for `prime_`
177:     function setPrimeToken(address prime_) external onlyOwner {

/// @audit Missing zero check for `token_`
192:     function releaseFunds(address token_) external {

/// @audit Missing zero check for `to_`
216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

/// @audit Missing zero check for `token_`
232:     function getEffectiveDistributionSpeed(address token_) external view returns (uint256) {

/// @audit Missing zero check for `token_`
249:     function accrueTokens(address token_) public {

/// @audit Missing zero check for `token_`
286:     function _initializeToken(address token_) internal {

/// @audit Missing zero check for `token_`
310:     function _setTokenDistributionSpeed(address token_, uint256 distributionSpeed_) internal {

/// @audit Missing zero check for `token_`
332:     function _ensureTokenInitialized(address token_) internal view {

```
[#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L192) [#L216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216) [#L232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L232) [#L249](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L249) [#L286](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L286) [#L310](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L310) [#L332](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L332) 

</details>

---

<a name="NC-20"></a> 
### [NC-20] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

<details>
<summary>
There are <b>11</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

21:     mapping(address => uint256) public tokenDistributionSpeeds;

24:     mapping(address => uint256) public lastAccruedBlock;

27:     mapping(address => uint256) public tokenAmountAccrued;

```
[#L21](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L21) [#L24](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L24) [#L27](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L27) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

46:     mapping(address => Token) public tokens;

61:     mapping(address => uint256) public stakedAt;

64:     mapping(address => Market) public markets;

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

100:     mapping(address => address) public vTokenForAsset;

110:     mapping(address => uint256) public unreleasedPSRIncome;

114:     mapping(address => uint256) public unreleasedPLPIncome;

```
[#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L46) [#L61](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L61) [#L64](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L64) [#L67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67) [#L88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L100) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L110) [#L114](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L114) 

</details>

---

<a name="NC-21"></a> 
### [NC-21] NatSpec documentation for contract is missing
e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
[#L6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
[#L13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
[#L38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
[#L10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10) 

---

<a name="NC-22"></a> 
### [NC-22] Missing NatSpec `@param`
Some functions have an incomplete NatSpec: add a `@param` notation to describe the function parameters to improve the code documentation.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Missing @param for _wbnb
/// @audit Missing @param for _vbnb
/// @audit Missing @param for _blocksPerYear
103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

/// @audit Missing @param for user
827:     function _updateRoundAfterTokenBurned(address user) internal {

```
[#L103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103) [#L827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit Missing @param for x
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit Missing @param for x
58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit Missing @param for x
51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

/// @audit Missing @param for x
140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51) [#L140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140) 

---

<a name="NC-23"></a> 
### [NC-23] NatSpec `@return` is missing
It is recommended that Solidity contracts are fully annotated using NatSpec

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51) [#L140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140) 

---

<a name="NC-24"></a> 
### [NC-24] There is no need to initialize variables with 0
Since the variables are automatically set to 0 when created, it is redundant to initialize it with 0 again.

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

677:         interests[vToken][user].accrued = 0;

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
[#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178) [#L204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204) [#L211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211) [#L246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246) [#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335) [#L349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349) [#L609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609) [#L625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625) [#L677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677) [#L730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730) [#L736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736) [#L737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

46:     int256 private constant EXP_MAX_VAL = 0;

```
[#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) 

</details>

---

<a name="NC-25"></a> 
### [NC-25] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
[#L12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12) [#L15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

```
[#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31) [#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37) [#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40) [#L43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
[#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42) [#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) [#L48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48) 

</details>

---

<a name="NC-26"></a> 
### [NC-26] State variables should include comments
Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

```
[#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31) 

---

<a name="NC-27"></a> 
### [NC-27] Contract declarations should have NatSpec `@title` annotations
Some contract definitions have an incomplete NatSpec: add a `@title` notation to describe the contract to improve the code documentation.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

35: contract Prime is IIncomeDestination, AccessControlledV8, PausableUpgradeable, MaxLoopsLimitHelper, PrimeStorageV1 {

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L35) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

8: contract PrimeLiquidityProvider is AccessControlledV8, PausableUpgradeable {

```
[#L8](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L8) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

6: contract PrimeStorageV1 {

```
[#L6](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L6) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

13: library FixedMath {

```
[#L13](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L13) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

38: library FixedMath0x {

```
[#L38](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L38) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

10: library Scores {

```
[#L10](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L10) 

---

<a name="NC-28"></a> 
### [NC-28] Lines are too long
The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

4: import { SafeERC20Upgradeable, IERC20Upgradeable } from "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L4) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

4: import { SafeERC20Upgradeable, IERC20Upgradeable } from "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

```
[#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) 

---

<a name="NC-29"></a> 
### [NC-29] Unused errors
The following `error`s are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion. Note that there may be cases where an error appears to be used because it has multiple definitions in different files. In such cases, the definitions should be moved to a separate file.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

36: error UnsignedValueTooLarge(uint256 x);

```
[#L36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L36) 

---

<a name="NC-30"></a> 
### [NC-30] Unused `event` definition
Note that there may be cases where an event superficially appears to be used, but this is only because there are multiple definitions of the event in different files. In such cases, the event definition should be moved into a separate file. The instances below are the unused definitions.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

48:     event TokenInitialBalanceUpdated(address indexed token, uint256 balance);

51:     event FundsTransferPaused();

54:     event FundsTransferResumed();

```
[#L48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L48) [#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L51) [#L54](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L54) 

---

<a name="NC-31"></a> 
### [NC-31] Unused named return
Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment. This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
[#L496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496) [#L527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit `r` not used
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit `r` not used
58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

---

<a name="NC-32"></a> 
### [NC-32] Consider using `delete` rather than assigning zero to clear values
The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

295:         markets[vToken].rewardIndex = 0;

298:         markets[vToken].sumOfMembersScore = 0;

677:         interests[vToken][user].accrued = 0;

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
[#L295](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L295) [#L298](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L298) [#L677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677) [#L736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736) [#L737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737) 

---

<a name="NC-33"></a> 
### [NC-33] Solidity compiler version is not fixed
To prevent the actual contracts deployed from behaving differently depending on the compiler version, it is recommended to use a fixed solidity version.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/IPrime.sol

2: pragma solidity ^0.5.16;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/IPrime.sol#L2) 

---

<a name="NC-34"></a> 
### [NC-34] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
[#L12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12) [#L15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

```
[#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31) [#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37) [#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40) [#L43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
[#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42) [#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) [#L48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48) 

</details>

---

<a name="NC-35"></a> 
### [NC-35] Use the latest solidity version for deployment
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
[#L3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3) 

---

<a name="NC-36"></a> 
### [NC-36] Whitespace in Expressions
See the [Whitespace in Expressions](https://docs.soliditylang.org/en/latest/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

660:         (uint256 capital, , ) = _capitalForScore(xvsBalanceForScore, borrow, supply, market);

```
[#L660](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L660) 

---

<a name="NC-37"></a> 
### [NC-37] Missing checks for `address(0)` when assigning values to address state variables

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

181:         prime = prime_;

```
[#L181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L181) 

---

<a name="NC-38"></a> 
### [NC-38] Names of `private`/`internal` functions should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are <b>9</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

904:     function isEligible(uint256 amount) internal view returns (bool) {

```
[#L904](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L904) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

22:     function toFixed(uint256 n, uint256 d) internal pure returns (int256) {

34:     function uintDiv(uint256 u, int256 f) internal pure returns (uint256) {

46:     function uintMul(uint256 u, int256 f) internal pure returns (uint256) {

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L22) [#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L34) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L46) [#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {
            if (x > LN_MAX_VAL) {

140:     function exp(int256 x) internal pure returns (int256 r) {
             if (x < EXP_MIN_VAL) {

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51) [#L140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

22:     function calculateScore(
            uint256 xvs,
            uint256 capital,
            uint256 alphaNumerator,
            uint256 alphaDenominator
        ) internal pure returns (uint256) {
            // Score function is:

```
[#L22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L22) 

---

<a name="NC-39"></a> 
### [NC-39] Names of `private`/`internal` state variables should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

<details>
<summary>
There are <b>12</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

15:     uint256 internal constant EXP_SCALE = 1e18;

```
[#L15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

70:     address[] internal allMarkets;

79:     address internal xvsVault;

82:     address internal xvsVaultRewardToken;

85:     uint256 internal xvsVaultPoolId;

```
[#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31) [#L43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43) [#L70](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L70) [#L79](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L79) [#L82](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L82) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L85) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

48:     int256 private constant EXP_MIN_VAL = -int256(0x0000000000000000000000000000001ff0000000000000000000000000000000);

```
[#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42) [#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) [#L48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L48) 

</details>

---

<a name="NC-40"></a> 
### [NC-40] Variables should be named in mixedCase style
As the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) suggests: arguments, local variables and mutable state variables should be named in mixedCase style.

<details>
<summary>
There are <b>16</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

40:     uint256 public immutable BLOCKS_PER_YEAR;

42:     /// @notice address of WBNB contract

46:     /// @notice address of VBNB contract

```
[#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L40) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L42) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L46) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

15:     uint256 internal constant EXP_SCALE = 1e18;

```
[#L12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12) [#L15](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L15) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

31:     uint256 internal constant EXP_SCALE = 1e18;

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

43:     uint256 internal constant MAXIMUM_BPS = 10000;

124:     uint256[25] private __gap;

```
[#L31](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L31) [#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37) [#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40) [#L43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L43) [#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L124) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

40:     int256 internal constant FIXED_1 = int256(0x0000000000000000000000000000000080000000000000000000000000000000);

42:     int256 private constant LN_MAX_VAL = FIXED_1;

43:     // Minimum ln argument. Notice this is related to EXP_MIN_VAL (e ^ -63.875)

44:     int256 private constant LN_MIN_VAL = int256(0x0000000000000000000000000000000000000000000000000000000733048c5a);

46:     int256 private constant EXP_MAX_VAL = 0;

```
[#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L40) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L42) [#L43](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L43) [#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L44) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) 

</details>

---

<a name="NC-41"></a> 
### [NC-41] Event is missing `indexed` fields
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

51:     event Mint(address indexed user, bool isIrrevocable);

91:     event InterestClaimed(address indexed user, address indexed market, uint256 amount);

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L51) [#L91](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L91) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

33:     event TokenDistributionSpeedUpdated(address indexed token, uint256 newSpeed);

36:     event PrimeTokenUpdated(address oldPrimeToken, address newPrimeToken);

39:     event TokensAccrued(address indexed token, uint256 amount);

42:     event TokenTransferredToPrime(address indexed token, uint256 amount);

45:     event SweepToken(address indexed token, address indexed to, uint256 sweepAmount);

48:     event TokenInitialBalanceUpdated(address indexed token, uint256 balance);

```
[#L33](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L33) [#L36](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L36) [#L39](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L39) [#L42](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L42) [#L45](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L45) [#L48](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L48) 

---

<a name="NC-42"></a> 
### [NC-42] Constants should be defined rather than using magic numbers

<details>
<summary>
There are <b>20</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

661:         capital = capital * (10 ** (18 - vToken.decimals()));

```
[#L661](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L661) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

```
[#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168) [#L170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170) [#L172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178) [#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184) [#L186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186) [#L188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188) [#L190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192) [#L194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194) [#L196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196) [#L198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198) [#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200) 

</details>

---


## Gas Optimizations

<a name="GAS-1"></a> 
### [GAS-1] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate
Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot. Finally, if both fields are accessed in the same function, can save ~42 gas per access due to not having to [recalculate the key's keccak256 hash](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0) (Gkeccak256 - 30 gas) and that calculation's associated stack operations.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

67:     mapping(address => mapping(address => Interest)) public interests;

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
[#L67](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L67) [#L88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88) 

---

<a name="GAS-2"></a> 
### [GAS-2] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```


---

<a name="GAS-3"></a> 
### [GAS-3] Divisions can be `unchecked` to save gas
The expression `type(int).min/(-1)` is the only case where division causes an overflow. Therefore, uncheck can be used to [save gas](https://gist.github.com/DadeKuma/3bc597338ae774b8b3bd43280d55271f) in scenarios where it is certain that such an overflow will not occur.

<details>
<summary>
There are <b>124</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

501:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

585:             delta = ((distributionIncome * EXP_SCALE) / markets[vToken].sumOfMembersScore);

654:         uint256 supply = (exchangeRate * balanceOfAccount) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

881:         uint256 borrowCapUSD = (xvsPrice * ((xvs * markets[market].borrowMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

882:         uint256 supplyCapUSD = (xvsPrice * ((xvs * markets[market].supplyMultiplier) / EXP_SCALE)) / EXP_SCALE;

885:         uint256 supplyUSD = (tokenPrice * supply) / EXP_SCALE;

886:         uint256 borrowUSD = (tokenPrice * borrow) / EXP_SCALE;

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

922:         return (index * score) / EXP_SCALE;

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

949:         return ((((market.totalBorrows() * market.borrowRatePerBlock()) / EXP_SCALE) * market.reserveFactorMantissa()) /

972:         uint256 incomePerBlockForDistributionFromMarket = (totalIncomePerBlockFromMarket * _distributionPercentage()) /

1004:         uint256 userYearlyIncome = (userScore * _incomeDistributionYearly(vToken)) / totalScore;

1009:         uint256 userSupplyIncomeYearly = (userYearlyIncome * totalCappedSupply) / totalCappedValue;

1010:         uint256 userBorrowIncomeYearly = (userYearlyIncome * totalCappedBorrow) / totalCappedValue;

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
[#L501](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L501) [#L585](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L585) [#L654](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L654) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L881](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L881) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L882](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L882) [#L885](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L885) [#L886](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L886) [#L889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889) [#L893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893) [#L922](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L922) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L949](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L949) [#L972](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L972) [#L1004](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1004) [#L1009](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1009) [#L1010](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1010) [#L1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012) [#L1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

25:         return (n.toInt256() * FixedMath0x.FIXED_1) / int256(d.toInt256());

37:         return uint256((u.toInt256() * FixedMath0x.FIXED_1) / f);

49:         return uint256((u.toInt256() * f) / FixedMath0x.FIXED_1);

```
[#L25](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L25) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L37) [#L49](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L49) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

75:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000000001c8464f76164760000000); // / e ^ -32

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

80:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000000f1aaddd7742e90000000000000); // / e ^ -16

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

85:             x = (x * FIXED_1) / int256(0x00000000000000000000000000000000000afe10820813d78000000000000000); // / e ^ -8

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

90:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000002582ab704279ec00000000000000000); // / e ^ -4

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

95:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000001152aaa3bf81cc000000000000000000); // / e ^ -2

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

100:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000002f16ac6c59de70000000000000000000); // / e ^ -1

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

105:             x = (x * FIXED_1) / int256(0x000000000000000000000000000000004da2cbf1be5828000000000000000000); // / e ^ -0.5

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

110:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000063afbe7ab2082c000000000000000000); // / e ^ -0.25

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

115:             x = (x * FIXED_1) / int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d); // / e ^ -0.125

121:         w = (y * y) / FIXED_1;

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

123:         z = (z * w) / FIXED_1; // add y^01 / 01 - y^02 / 02

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

125:         z = (z * w) / FIXED_1; // add y^03 / 03 - y^04 / 04

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

127:         z = (z * w) / FIXED_1; // add y^05 / 05 - y^06 / 06

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

129:         z = (z * w) / FIXED_1; // add y^07 / 07 - y^08 / 08

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

131:         z = (z * w) / FIXED_1; // add y^09 / 09 - y^10 / 10

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

133:         z = (z * w) / FIXED_1; // add y^11 / 11 - y^12 / 12

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

135:         z = (z * w) / FIXED_1; // add y^13 / 13 - y^14 / 14

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

163:         z = (z * y) / FIXED_1;

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

165:         z = (z * y) / FIXED_1;

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

167:         z = (z * y) / FIXED_1;

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

169:         z = (z * y) / FIXED_1;

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

171:         z = (z * y) / FIXED_1;

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

173:         z = (z * y) / FIXED_1;

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

175:         z = (z * y) / FIXED_1;

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

177:         z = (z * y) / FIXED_1;

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

179:         z = (z * y) / FIXED_1;

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

181:         z = (z * y) / FIXED_1;

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

183:         z = (z * y) / FIXED_1;

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

185:         z = (z * y) / FIXED_1;

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

187:         z = (z * y) / FIXED_1;

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

189:         z = (z * y) / FIXED_1;

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

191:         z = (z * y) / FIXED_1;

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

193:         z = (z * y) / FIXED_1;

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

195:         z = (z * y) / FIXED_1;

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

197:         z = (z * y) / FIXED_1;

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

199:         z = (z * y) / FIXED_1;

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

201:         r = r / 0x21c3677c82b40000 + y + FIXED_1; // divide by 20! and then add y^1 / 1! + y^0 / 0!

208:                 (r * int256(0x00000000000000000000000000000000000000f1aaddd7742e56d32fb9f99744)) /

214:                 (r * int256(0x00000000000000000000000000000000000afe10820813d65dfe6a33c07f738f)) /

220:                 (r * int256(0x0000000000000000000000000000000002582ab704279e8efd15e0265855c47a)) /

226:                 (r * int256(0x000000000000000000000000000000001152aaa3bf81cb9fdb76eae12d029571)) /

232:                 (r * int256(0x000000000000000000000000000000002f16ac6c59de6f8d5d6f63c1482a7c86)) /

238:                 (r * int256(0x000000000000000000000000000000004da2cbf1be5827f9eb3ad1aa9866ebb3)) /

244:                 (r * int256(0x0000000000000000000000000000000063afbe7ab2082ba1a0ae5e4eb1b479dc)) /

250:                 (r * int256(0x0000000000000000000000000000000070f5a893b608861e1f58934f97aea57d)) /

256:                 (r * int256(0x00000000000000000000000000000000783eafef1c0a8f3978c7f81824d62ebf)) /

```
[#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L75) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L80](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L80) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L85](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L85) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L90) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L95](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L95) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L100) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L105) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L110](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L110) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L115](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L115) [#L121](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L121) [#L122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L123) [#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L125](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L125) [#L126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L127](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L127) [#L128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L129](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L129) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L131](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L131) [#L132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L133](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L133) [#L134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L135) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L163](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L163) [#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L165](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L165) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L167](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L167) [#L168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168) [#L169](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L169) [#L170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170) [#L171](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L171) [#L172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172) [#L173](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L173) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174) [#L175](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L175) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L177) [#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178) [#L179](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L179) [#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180) [#L181](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L181) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L183](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L183) [#L184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184) [#L185](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L185) [#L186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186) [#L187](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L187) [#L188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188) [#L189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L189) [#L190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190) [#L191](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L191) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192) [#L193](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L193) [#L194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194) [#L195](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L195) [#L196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196) [#L197](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L197) [#L198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198) [#L199](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L199) [#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L201) [#L208](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L208) [#L214](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L214) [#L220](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L220) [#L226](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L226) [#L232](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L232) [#L238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L238) [#L244](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L244) [#L250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L250) [#L256](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L256) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

59:             (FixedMath.ln(ratio) * alphaNumerator.toInt256()) / alphaDenominator.toInt256()

```
[#L59](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L59) 

</details>

---

<a name="GAS-4"></a> 
### [GAS-4] Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables

<details>
<summary>
There are <b>41</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

574:         distributionIncome += unreleasedPLPAccruedInterest;

674:         amount += interests[vToken][user].accrued;

785:         interests[vToken][user].accrued += _interestAccrued(vToken, user);

978:         amount += BLOCKS_PER_YEAR * totalIncomePerBlockFromPLP;

```
[#L574](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L574) [#L674](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L674) [#L785](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L785) [#L978](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L978) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

266:                 tokenAmountAccrued[token_] += tokenAccrued;

```
[#L266](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L266) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

74:             r -= int256(0x0000000000000000000000000000001000000000000000000000000000000000); // - 32

79:             r -= int256(0x0000000000000000000000000000000800000000000000000000000000000000); // - 16

84:             r -= int256(0x0000000000000000000000000000000400000000000000000000000000000000); // - 8

89:             r -= int256(0x0000000000000000000000000000000200000000000000000000000000000000); // - 4

94:             r -= int256(0x0000000000000000000000000000000100000000000000000000000000000000); // - 2

99:             r -= int256(0x0000000000000000000000000000000080000000000000000000000000000000); // - 1

104:             r -= int256(0x0000000000000000000000000000000040000000000000000000000000000000); // - 0.5

109:             r -= int256(0x0000000000000000000000000000000020000000000000000000000000000000); // - 0.25

114:             r -= int256(0x0000000000000000000000000000000010000000000000000000000000000000); // - 0.125

122:         r += (z * (0x100000000000000000000000000000000 - y)) / 0x100000000000000000000000000000000;

124:         r += (z * (0x0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa - y)) / 0x200000000000000000000000000000000;

126:         r += (z * (0x099999999999999999999999999999999 - y)) / 0x300000000000000000000000000000000;

128:         r += (z * (0x092492492492492492492492492492492 - y)) / 0x400000000000000000000000000000000;

130:         r += (z * (0x08e38e38e38e38e38e38e38e38e38e38e - y)) / 0x500000000000000000000000000000000;

132:         r += (z * (0x08ba2e8ba2e8ba2e8ba2e8ba2e8ba2e8b - y)) / 0x600000000000000000000000000000000;

134:         r += (z * (0x089d89d89d89d89d89d89d89d89d89d89 - y)) / 0x700000000000000000000000000000000;

136:         r += (z * (0x088888888888888888888888888888888 - y)) / 0x800000000000000000000000000000000; // add y^15 / 15 - y^16 / 16

164:         r += z * 0x10e1b3be415a0000; // add y^02 * (20! / 02!)

166:         r += z * 0x05a0913f6b1e0000; // add y^03 * (20! / 03!)

168:         r += z * 0x0168244fdac78000; // add y^04 * (20! / 04!)

170:         r += z * 0x004807432bc18000; // add y^05 * (20! / 05!)

172:         r += z * 0x000c0135dca04000; // add y^06 * (20! / 06!)

174:         r += z * 0x0001b707b1cdc000; // add y^07 * (20! / 07!)

176:         r += z * 0x000036e0f639b800; // add y^08 * (20! / 08!)

178:         r += z * 0x00000618fee9f800; // add y^09 * (20! / 09!)

180:         r += z * 0x0000009c197dcc00; // add y^10 * (20! / 10!)

182:         r += z * 0x0000000e30dce400; // add y^11 * (20! / 11!)

184:         r += z * 0x000000012ebd1300; // add y^12 * (20! / 12!)

186:         r += z * 0x0000000017499f00; // add y^13 * (20! / 13!)

188:         r += z * 0x0000000001a9d480; // add y^14 * (20! / 14!)

190:         r += z * 0x00000000001c6380; // add y^15 * (20! / 15!)

192:         r += z * 0x000000000001c638; // add y^16 * (20! / 16!)

194:         r += z * 0x0000000000001ab8; // add y^17 * (20! / 17!)

196:         r += z * 0x000000000000017c; // add y^18 * (20! / 18!)

198:         r += z * 0x0000000000000014; // add y^19 * (20! / 19!)

200:         r += z * 0x0000000000000001; // add y^20 * (20! / 20!)

```
[#L74](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L74) [#L79](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L79) [#L84](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L84) [#L89](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L89) [#L94](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L94) [#L99](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L99) [#L104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L104) [#L109](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L109) [#L114](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L114) [#L122](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L122) [#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L124) [#L126](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L126) [#L128](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L128) [#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L130) [#L132](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L132) [#L134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L134) [#L136](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L136) [#L164](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L164) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L166) [#L168](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L168) [#L170](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L170) [#L172](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L172) [#L174](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L174) [#L176](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L176) [#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L178) [#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L180) [#L182](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L182) [#L184](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L184) [#L186](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L186) [#L188](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L188) [#L190](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L190) [#L192](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L192) [#L194](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L194) [#L196](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L196) [#L198](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L198) [#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L200) 

</details>

---

<a name="GAS-5"></a> 
### [GAS-5] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas
Saves deployment costs.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit Duplicated on line 158
100:             revert InvalidArguments();

```
[#L100](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L100) 

---

<a name="GAS-6"></a> 
### [GAS-6] Increments can be `unchecked` to save gas
Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save 30-40 gas per iteration. So it is recommended to use unchecked increments when overflow is not possible.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

108:                 ++i;

123:                 ++i;

166:                 ++i;

```
[#L108](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L108) [#L123](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L123) [#L166](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L166) 

---

<a name="GAS-7"></a> 
### [GAS-7] Initializers can be marked as payable to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. Initializers can be safely marked as payable, because only the deployer or the factory contract would call the function without carrying any funds.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

130:     function initialize(

```
[#L130](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L130) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

90:     function initialize(

```
[#L90](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L90) 

---

<a name="GAS-8"></a> 
### [GAS-8] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `_upgrade` is used only once
762:     function _upgrade(address user) internal {

/// @audit `_updateRoundAfterTokenBurned` is used only once
827:     function _updateRoundAfterTokenBurned(address user) internal {

/// @audit `isEligible` is used only once
904:     function isEligible(uint256 amount) internal view returns (bool) {

/// @audit `_incomePerBlock` is used only once
947:     function _incomePerBlock(address vToken) internal view returns (uint256) {

/// @audit `_distributionPercentage` is used only once
957:     function _distributionPercentage() internal view returns (uint256) {

/// @audit `_incomeDistributionYearly` is used only once
970:     function _incomeDistributionYearly(address vToken) internal view returns (uint256 amount) {

```
[#L762](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L762) [#L827](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L827) [#L904](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L904) [#L947](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L947) [#L957](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L957) [#L970](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L970) 

---

<a name="GAS-9"></a> 
### [GAS-9] Multiple accesses of the same mapping/array key/index should be cached
The instances below point to the second+ access of a value inside a mapping/array, within a function. Caching a mapping's value in a local `storage` or `calldata` variable when the value is accessed [multiple times](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0), saves ~42 gas per access due to not having to recalculate the key's keccak256 hash (Gkeccak256 - 30 gas) and that calculation's associated stack operations. Caching an array's struct avoids recalculating the array offsets into memory/calldata

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

/// @audit `tokenAmountAccrued[token_]` is also accessed on line 199
200:         tokenAmountAccrued[token_] = 0;

/// @audit `tokenAmountAccrued[token_]` is also accessed on line 261
266:                 tokenAmountAccrued[token_] += tokenAccrued;

/// @audit `lastAccruedBlock[token_]` is also accessed on line 255
270:             lastAccruedBlock[token_] = blockNumber;

/// @audit `lastAccruedBlock[token_]` is also accessed on line 289
298:         lastAccruedBlock[token_] = blockNumber;

/// @audit `tokenDistributionSpeeds[token_]` is also accessed on line 315
322:             tokenDistributionSpeeds[token_] = distributionSpeed_;

```
[#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L200) [#L266](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L266) [#L270](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L270) [#L298](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L298) [#L322](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L322) 

---

<a name="GAS-10"></a> 
### [GAS-10] Newer versions of solidity are more gas efficient
The solidity language continues to pursue more efficient gas optimization schemes. Adopting a newer version of solidity can be more gas efficient.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
[#L3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3) 

---

<a name="GAS-11"></a> 
### [GAS-11] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

<details>
<summary>
There are <b>40</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

318:         if (_irrevocableLimit < totalIrrevocable || _revocableLimit < totalRevocable) revert InvalidLimit();

318:         if (_irrevocableLimit < totalIrrevocable || _revocableLimit < totalRevocable) revert InvalidLimit();

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

482:         if (totalTimeStaked < STAKING_PERIOD) {

584:         if (markets[vToken].sumOfMembersScore > 0) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

682:         if (amount > asset.balanceOf(address(this))) {

686:             if (amount > asset.balanceOf(address(this))) {

716:         if (totalIrrevocable > irrevocableLimit || totalRevocable > revocableLimit) revert InvalidLimit();

716:         if (totalIrrevocable > irrevocableLimit || totalRevocable > revocableLimit) revert InvalidLimit();

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

769:         if (totalIrrevocable > irrevocableLimit) revert InvalidLimit();

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

828:         if (totalScoreUpdatesRequired > 0) totalScoreUpdatesRequired--;

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

855:         if (xvs > MAXIMUM_XVS_CAP) {

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

```
[#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178) [#L204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204) [#L211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211) [#L246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246) [#L318](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L318) [#L318](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L318) [#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335) [#L349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349) [#L482](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L482) [#L584](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L584) [#L609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609) [#L625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625) [#L682](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L682) [#L686](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L686) [#L716](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L716) [#L716](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L716) [#L730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730) [#L769](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L769) [#L810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810) [#L828](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L828) [#L830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830) [#L855](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L855) [#L889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889) [#L893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

103:         for (uint256 i; i < numTokens; ) {

119:         for (uint256 i; i < tokens_.length; ) {

161:         for (uint256 i; i < numTokens; ) {

218:         if (amount_ > balance) {

237:         if (balance - accrued > 0) {

257:         if (deltaBlocks > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

291:         if (initializedBlock > 0) {

311:         if (distributionSpeed_ > MAX_DISTRIBUTION_SPEED) {

```
[#L103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L103) [#L119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119) [#L161](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L161) [#L218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L218) [#L237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L237) [#L257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L257) [#L262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262) [#L262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262) [#L291](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L291) [#L311](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L311) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

35:         if (f < 0) revert InvalidFixedPoint();

47:         if (f < 0) revert InvalidFixedPoint();

```
[#L35](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L35) [#L47](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L47) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

52:         if (x > LN_MAX_VAL) {

141:         if (x < EXP_MIN_VAL) {

148:         if (x > EXP_MAX_VAL) {

```
[#L52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L52) [#L141](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L141) [#L148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L148) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

52:         bool lessxvsThanCapital = xvs < capital;

```
[#L52](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L52) 

</details>

---

<a name="GAS-12"></a> 
### [GAS-12] Reduce gas usage by moving to Solidity 0.8.19 or later
Solidity version 0.8.19 introduced a number of gas optimizations, refer to the [Solidity 0.8.19 Release Announcement](https://soliditylang.org/blog/2023/02/22/solidity-0.8.19-release-announcement/) for details.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
[#L3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3) 

---

<a name="GAS-13"></a> 
### [GAS-13] Remove or replace unused state variables
Saves a storage slot. If the variable is assigned a non-zero value, saves Gsset (20000 gas). If it's assigned a zero value, saves Gsreset (2900 gas). If the variable remains unassigned, there is no gas savings unless the variable is `public`, in which case the compiler-generated non-payable getter deployment cost is saved. If the state variable is overriding an interface's public function, mark the variable as `constant` or `immutable` so that it does not use a storage slot.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

124:     uint256[25] private __gap;

```
[#L124](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L124) 

---

<a name="GAS-14"></a> 
### [GAS-14] Unused named return variables without optimizer waste gas
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
496:     function calculateAPR(address market, address user) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

/// @audit `supplyAPR` not used
/// @audit `borrowAPR` not used
527:     function estimateAPR(
             address market,
             address user,
             uint256 borrow,
             uint256 supply,
             uint256 xvsStaked
         ) external view returns (uint256 supplyAPR, uint256 borrowAPR) {

```
[#L496](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L496) [#L527](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L527) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

/// @audit `r` not used
53:     function ln(int256 x) internal pure returns (int256 r) {

/// @audit `r` not used
58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

---

<a name="GAS-15"></a> 
### [GAS-15] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>16</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

228:             emit UserScoreUpdated(user);

241:         emit AlphaUpdated(alphaNumerator, alphaDenominator, _alphaNumerator, _alphaDenominator);

269:         emit MultiplierUpdated(

308:         emit MarketAdded(vToken, supplyMultiplier, borrowMultiplier);

320:         emit MintLimitsUpdated(irrevocableLimit, revocableLimit, _irrevocableLimit, _revocableLimit);

462:         emit UpdatedAssetsState(comptroller, asset);

694:         emit InterestClaimed(user, vToken, amount);

718:         emit Mint(user, isIrrevocable);

755:         emit Burn(user);

771:         emit TokenUpgraded(user);

```
[#L228](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L228) [#L241](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L241) [#L269](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L269) [#L308](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L308) [#L320](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L320) [#L462](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L462) [#L694](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L694) [#L718](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L718) [#L755](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L755) [#L771](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L771) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

180:         emit PrimeTokenUpdated(prime, prime_);

202:         emit TokenTransferredToPrime(token_, accruedAmount);

222:         emit SweepToken(address(token_), to_, amount_);

267:                 emit TokensAccrued(token_, tokenAccrued);

300:         emit TokenDistributionInitialized(token_);

324:             emit TokenDistributionSpeedUpdated(token_, distributionSpeed_);

```
[#L180](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L180) [#L202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L202) [#L222](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L222) [#L267](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L267) [#L300](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L300) [#L324](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L324) 

</details>

---

<a name="GAS-16"></a> 
### [GAS-16] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

*There are <b>9</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

337:                 if (userToken.exists && !userToken.isIrrevocable) {

369:         if (tokens[user].exists && !isAccountEligible) {

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

379:         } else if (tokens[user].exists && isAccountEligible) {

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

```
[#L337](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L337) [#L369](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L369) [#L375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375) [#L375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375) [#L377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377) [#L377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377) [#L379](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L379) [#L830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

```
[#L262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262) 

---

<a name="GAS-17"></a> 
### [GAS-17] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L2) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

2: pragma solidity 0.8.13;

```
[#L2](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L2) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

4: pragma solidity 0.8.13;

```
[#L4](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L4) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

3: pragma solidity 0.8.13;

```
[#L3](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L3) 

---

<a name="GAS-18"></a> 
### [GAS-18] Use `unchecked` block for safe subtractions
If it can be confirmed that the subtraction operation will not overflow, using an unchecked block can save gas. For example, `require(x <= y); z = y - x;` can be optimized to `require(x <= y); unchecked { z = y - x; }`

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

/// @audit Checked on line 482
483:             return STAKING_PERIOD - totalTimeStaked;

```
[#L483](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L483) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

/// @audit Checked on line 58
120:         z = y = x - FIXED_1;

```
[#L120](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L120) 

---

<a name="GAS-19"></a> 
### [GAS-19] Using bitmap to store bool states can save gas
Using a bitmap instead of a bool array or a bool mapping to store boolean states can save gas fees. This is because the bitmap can store 256 boolean values in a single slot instead of 256 slots, which can save gas when writing bool values or when reading multiple bool values from the same slot.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
[#L88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88) 

---

<a name="GAS-20"></a> 
### [GAS-20] Using bools for storage incurs overhead
Use uint256(1) and uint256(2) for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from false to true, after having been true in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

88:     mapping(uint256 => mapping(address => bool)) public isScoreUpdated;

```
[#L88](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L88) 

---

<a name="GAS-21"></a> 
### [GAS-21] Cache array length outside of loop
If not cached, the solidity compiler will always read the length of the array during each iteration. That is, if it is a storage array, this is an extra sload operation (100 additional extra gas for each iteration except for the first) and if it is a memory array, this is an extra mload operation (3 additional gas for each iteration except for the first).

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

```
[#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178) [#L204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204) [#L211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211) [#L246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246) [#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335) [#L349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349) [#L609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609) [#L625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625) [#L730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

119:         for (uint256 i; i < tokens_.length; ) {

```
[#L119](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L119) 

---

<a name="GAS-22"></a> 
### [GAS-22] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*There is one instance of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

200:     function updateScores(address[] memory users) external {

```
[#L200](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L200) 

---

<a name="GAS-23"></a> 
### [GAS-23] Don't initialize variables with default value

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

178:         for (uint256 i = 0; i < _allMarkets.length; ) {

204:         for (uint256 i = 0; i < users.length; ) {

211:             for (uint256 j = 0; j < _allMarkets.length; ) {

246:         for (uint256 i = 0; i < allMarkets.length; ) {

335:             for (uint256 i = 0; i < users.length; ) {

349:             for (uint256 i = 0; i < users.length; ) {

609:         for (uint256 i = 0; i < _allMarkets.length; ) {

625:         for (uint256 i = 0; i < _allMarkets.length; ) {

677:         interests[vToken][user].accrued = 0;

730:         for (uint256 i = 0; i < _allMarkets.length; ) {

736:             interests[_allMarkets[i]][user].score = 0;

737:             interests[_allMarkets[i]][user].rewardIndex = 0;

```
[#L178](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L178) [#L204](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L204) [#L211](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L211) [#L246](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L246) [#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L335) [#L349](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L349) [#L609](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L609) [#L625](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L625) [#L677](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L677) [#L730](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L730) [#L736](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L736) [#L737](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L737) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

46:     int256 private constant EXP_MAX_VAL = 0;

```
[#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L46) 

</details>

---

<a name="GAS-24"></a> 
### [GAS-24] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

<details>
<summary>
There are <b>14</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

75:         uint128 indexed oldNumerator,

76:         uint128 indexed oldDenominator,

77:         uint128 indexed newNumerator,

78:         uint128 newDenominator

134:         uint128 _alphaNumerator,

135:         uint128 _alphaDenominator,

237:     function updateAlpha(uint128 _alphaNumerator, uint128 _alphaDenominator) external {

237:     function updateAlpha(uint128 _alphaNumerator, uint128 _alphaDenominator) external {

238:         _checkAccessAllowed("updateAlpha(uint128,uint128)");

238:         _checkAccessAllowed("updateAlpha(uint128,uint128)");

809:     function _checkAlphaArguments(uint128 _alphaNumerator, uint128 _alphaDenominator) internal {

809:     function _checkAlphaArguments(uint128 _alphaNumerator, uint128 _alphaDenominator) internal {

```
[#L75](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L75) [#L76](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L76) [#L77](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L77) [#L78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L78) [#L134](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L134) [#L135](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L135) [#L237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L237) [#L237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L237) [#L238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L238) [#L238](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L238) [#L809](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L809) [#L809](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L809) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

73:     uint128 public alphaNumerator;

76:     uint128 public alphaDenominator;

```
[#L73](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L73) [#L76](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L76) 

</details>

---

<a name="GAS-25"></a> 
### [GAS-25] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/Prime.sol

103:     constructor(address _wbnb, address _vbnb, uint256 _blocksPerYear) {

```
[#L103](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L103) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

78:     constructor() {

```
[#L78](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L78) 

---

<a name="GAS-26"></a> 
### [GAS-26] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

118:     function initializeTokens(address[] calldata tokens_) external onlyOwner {

177:     function setPrimeToken(address prime_) external onlyOwner {

216:     function sweepToken(IERC20Upgradeable token_, address to_, uint256 amount_) external onlyOwner {

```
[#L118](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L118) [#L177](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L177) [#L216](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L216) 

---

<a name="GAS-27"></a> 
### [GAS-27] `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too)
*Saves 5 gas per loop*

<details>
<summary>
There are <b>13</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

189:                 i++;

217:                     j++;

225:                 i++;

250:                 i++;

345:                     i++;

355:                     i++;

614:                 i++;

636:                 i++;

711:             totalIrrevocable++;

713:             totalRevocable++;

740:                 i++;

766:         totalIrrevocable++;

819:         nextScoreUpdateRoundId++;

```
[#L189](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L189) [#L217](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L217) [#L225](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L225) [#L250](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L250) [#L345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L345) [#L355](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L355) [#L614](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L614) [#L636](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L636) [#L711](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L711) [#L713](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L713) [#L740](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L740) [#L766](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L766) [#L819](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L819) 

</details>

---

<a name="GAS-28"></a> 
### [GAS-28] Using `private` rather than `public` for constants, saves gas
If needed, the values can be read from the verified contract source code, or if there are multiple values there can be a single getter function that [returns a tuple](https://github.com/code-423n4/2022-08-frax/blob/90f55a9ce4e25bceed3a74290b854341d8de6afa/src/contracts/FraxlendPair.sol#L156-L178) of the values of all currently-public constants. Saves **3406-3606 gas** in deployment gas due to the compiler not having to create non-payable getter functions for deployment calldata, not having to store the bytes of the value outside of where it's used, and not adding another entry to the method ID table

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

12:     uint256 public constant MAX_DISTRIBUTION_SPEED = 1e18;

```
[#L12](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L12) 

```solidity
File: contracts/Tokens/Prime/PrimeStorage.sol

34:     uint256 public constant MINIMUM_STAKED_XVS = 1000 * EXP_SCALE;

37:     uint256 public constant MAXIMUM_XVS_CAP = 100000 * EXP_SCALE;

40:     uint256 public constant STAKING_PERIOD = 90 * 24 * 60 * 60;

```
[#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L34) [#L37](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L37) [#L40](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeStorage.sol#L40) 

---

<a name="GAS-29"></a> 
### [GAS-29] Use `!= 0` instead of `> 0` for unsigned integer comparison
Using `== 0`, `!= 0` instead of `> 0`, `>= 1`, `< 1`, `<= 0` can save gas.

<details>
<summary>
There are <b>11</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

375:         } else if (!isAccountEligible && !tokens[user].exists && stakedAt[user] > 0) {

584:         if (markets[vToken].sumOfMembersScore > 0) {

828:         if (totalScoreUpdatesRequired > 0) totalScoreUpdatesRequired--;

830:         if (pendingScoreUpdates > 0 && !isScoreUpdated[nextScoreUpdateRoundId][user]) {

889:             supply = supplyUSD > 0 ? (supply * supplyCapUSD) / supplyUSD : 0;

893:             borrow = borrowUSD > 0 ? (borrow * borrowCapUSD) / borrowUSD : 0;

```
[#L375](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L375) [#L584](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L584) [#L828](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L828) [#L830](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L830) [#L889](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L889) [#L893](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L893) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

237:         if (balance - accrued > 0) {

257:         if (deltaBlocks > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

262:             if (distributionSpeed > 0 && balanceDiff > 0) {

291:         if (initializedBlock > 0) {

```
[#L237](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L237) [#L257](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L257) [#L262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262) [#L262](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L262) [#L291](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L291) 

</details>

---

<a name="GAS-30"></a> 
### [GAS-30] Using assembly to check for zero can save gas
Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

<details>
<summary>
There are <b>35</b> instances of this issue (click to show):
</summary>

```solidity
File: contracts/Tokens/Prime/Prime.sol

104:         if (_wbnb == address(0)) revert InvalidAddress();

105:         if (_vbnb == address(0)) revert InvalidAddress();

106:         if (_blocksPerYear == 0) revert InvalidBlocksPerYear();

143:         if (_xvsVault == address(0)) revert InvalidAddress();

144:         if (_xvsVaultRewardToken == address(0)) revert InvalidAddress();

145:         if (_protocolShareReserve == address(0)) revert InvalidAddress();

146:         if (_comptroller == address(0)) revert InvalidAddress();

147:         if (_oracle == address(0)) revert InvalidAddress();

148:         if (_primeLiquidityProvider == address(0)) revert InvalidAddress();

201:         if (pendingScoreUpdates == 0) revert NoScoreUpdatesRequired();

202:         if (nextScoreUpdateRoundId == 0) revert NoScoreUpdatesRequired();

377:         } else if (stakedAt[user] == 0 && isAccountEligible && !tokens[user].exists) {

398:         if (stakedAt[msg.sender] == 0) revert IneligibleToClaim();

457:         if (vToken == address(0)) revert MarketNotSupported();

479:         if (stakedAt[user] == 0) return STAKING_PERIOD;

576:         if (distributionIncome == 0) {

810:         if (_alphaDenominator == 0 || _alphaNumerator > _alphaDenominator) {

1002:         if (totalScore == 0) return (0, 0);

1007:         if (totalCappedValue == 0) return (0, 0);

1012:         supplyAPR = totalSupply == 0 ? 0 : ((userSupplyIncomeYearly * MAXIMUM_BPS) / totalSupply);

1013:         borrowAPR = totalBorrow == 0 ? 0 : ((userBorrowIncomeYearly * MAXIMUM_BPS) / totalBorrow);

```
[#L104](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L104) [#L105](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L105) [#L106](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L106) [#L143](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L143) [#L144](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L144) [#L145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L145) [#L146](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L146) [#L147](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L147) [#L148](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L148) [#L201](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L201) [#L202](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L202) [#L377](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L377) [#L398](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L398) [#L457](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L457) [#L479](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L479) [#L576](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L576) [#L810](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L810) [#L1002](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1002) [#L1007](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1007) [#L1012](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1012) [#L1013](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/Prime.sol#L1013) 

```solidity
File: contracts/Tokens/Prime/PrimeLiquidityProvider.sol

335:         if (lastBlockAccrued == 0) {

345:         if (address_ == address(0)) {

```
[#L335](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L335) [#L345](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/PrimeLiquidityProvider.sol#L345) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

145:         if (x == 0) {

206:         if ((x & int256(0x0000000000000000000000000000001000000000000000000000000000000000)) != 0) {

212:         if ((x & int256(0x0000000000000000000000000000000800000000000000000000000000000000)) != 0) {

218:         if ((x & int256(0x0000000000000000000000000000000400000000000000000000000000000000)) != 0) {

224:         if ((x & int256(0x0000000000000000000000000000000200000000000000000000000000000000)) != 0) {

230:         if ((x & int256(0x0000000000000000000000000000000100000000000000000000000000000000)) != 0) {

236:         if ((x & int256(0x0000000000000000000000000000000080000000000000000000000000000000)) != 0) {

242:         if ((x & int256(0x0000000000000000000000000000000040000000000000000000000000000000)) != 0) {

248:         if ((x & int256(0x0000000000000000000000000000000020000000000000000000000000000000)) != 0) {

254:         if ((x & int256(0x0000000000000000000000000000000010000000000000000000000000000000)) != 0) {

```
[#L145](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L145) [#L206](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L206) [#L212](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L212) [#L218](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L218) [#L224](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L224) [#L230](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L230) [#L236](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L236) [#L242](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L242) [#L248](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L248) [#L254](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L254) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

44:         if (xvs == 0 || capital == 0) return 0;

46:         // If both sides are equal, we have:

```
[#L44](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L44) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L46) 

</details>

---

<a name="GAS-31"></a> 
### [GAS-31] `internal` functions not called by the contract should be removed
If the functions are required by an interface, the contract should inherit from that interface and use the `override` keyword

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/Tokens/Prime/libs/FixedMath.sol

22:     function toFixed(uint256 n, uint256 d) internal pure returns (int256) {

34:     function uintDiv(uint256 u, int256 f) internal pure returns (uint256) {

46:     function uintMul(uint256 u, int256 f) internal pure returns (uint256) {

53:     function ln(int256 x) internal pure returns (int256 r) {

58:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L22) [#L34](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L34) [#L46](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L46) [#L53](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L53) [#L58](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath.sol#L58) 

```solidity
File: contracts/Tokens/Prime/libs/FixedMath0x.sol

51:     function ln(int256 x) internal pure returns (int256 r) {

140:     function exp(int256 x) internal pure returns (int256 r) {

```
[#L51](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L51) [#L140](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/FixedMath0x.sol#L140) 

```solidity
File: contracts/Tokens/Prime/libs/Scores.sol

22:     function calculateScore(

```
[#L22](https://github.com/code-423n4/2023-09-venus/blob/b11d9ef9db8237678567e66759003138f2368d23/contracts/Tokens/Prime/libs/Scores.sol#L22) 

---

