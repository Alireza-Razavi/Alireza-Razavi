# Report

Audit report for **2024-03-pooltogether** generated by *ubl4nk_bot*.

## Medium Issues


*Total <b>5</b> instances over <b>2</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [M-1](#M-1) | Return values of `approve()` not checked | 2 |
| [M-2](#M-2) | Return values of `transfer()`/`transferFrom()` not checked | 3 |

## Low Issues


*Total <b>87</b> instances over <b>23</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Missing zero address check in functions with address parameters | 20 |
| [L-2](#L-2) | Use increase/decrease allowance instead of `approve()`/`safeApprove()` | 2 |
| [L-3](#L-3) | Array is `push()`ed but not `pop()`ed | 1 |
| [L-4](#L-4) | Consider implementing two-step procedure for updating protocol addresses | 1 |
| [L-5](#L-5) | Constructor / initialization function lacks parameter validation | 2 |
| [L-6](#L-6) | Code does not follow the best practice of check-effects-interaction | 5 |
| [L-7](#L-7) | Functions calling contracts/addresses with transfer hooks are missing reentrancy guards | 3 |
| [L-8](#L-8) | Governance functions should be controlled by time locks | 4 |
| [L-9](#L-9) | Large approvals may not work with some `ERC20` tokens | 2 |
| [L-10](#L-10) | Loss of precision in divisions | 1 |
| [L-11](#L-11) | Missing checks for state variable assignments | 9 |
| [L-12](#L-12) | Missing zero address check in constructor | 1 |
| [L-13](#L-13) | Consider some checks for `address(0)` when setting address state variables | 6 |
| [L-14](#L-14) | Owner can renounce ownership | 1 |
| [L-15](#L-15) | Solidity version 0.8.20 or above may not work on other chains due to PUSH0 | 6 |
| [L-16](#L-16) | Some tokens may revert when large transfers are made | 4 |
| [L-17](#L-17) | Some tokens may revert when zero value transfers are made | 4 |
| [L-18](#L-18) | Tokens may be minted to `address(0)` | 2 |
| [L-19](#L-19) | Unsafe downcast | 1 |
| [L-20](#L-20) | Use Ownable2Step instead of Ownable | 1 |
| [L-21](#L-21) | Using zero as a parameter | 2 |
| [L-22](#L-22) | Centralization Risk for trusted owners | 8 |
| [L-23](#L-23) | The call `abi.encodeWithSelector` is not type safe | 1 |

## Non Critical Issues


*Total <b>430</b> instances over <b>54</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | Add inline comments for unnamed variables | 4 |
| [NC-2](#NC-2) | Consider adding a block/deny-list | 5 |
| [NC-3](#NC-3) | Consider adding emergency-stop functionality | 3 |
| [NC-4](#NC-4) | Consider adding formal verification proofs | 1 |
| [NC-5](#NC-5) | Consider using descriptive `constant`s when passing zero as a function argument | 1 |
| [NC-6](#NC-6) | Constant decimal values | 2 |
| [NC-7](#NC-7) | Constants should be put on the left side of comparisons | 14 |
| [NC-8](#NC-8) | `Constructor` should emit an event | 3 |
| [NC-9](#NC-9) | Contract does not follow the Solidity Style Guide's suggested layout ordering | 5 |
| [NC-10](#NC-10) | Contract should expose an `interface` | 40 |
| [NC-11](#NC-11) | Contracts should have full test coverage | 1 |
| [NC-12](#NC-12) | Convert simple `if` statements to ternary expressions | 1 |
| [NC-13](#NC-13) | Events that mark critical parameter changes should contain both the old and the new value | 13 |
| [NC-14](#NC-14) | Custom errors has no error details | 14 |
| [NC-15](#NC-15) | Solidity version is different in some files | 2 |
| [NC-16](#NC-16) | Do not use underscore at the end of variable name | 26 |
| [NC-17](#NC-17) | `else` block not required | 7 |
| [NC-18](#NC-18) | Empty bytes check is missing | 1 |
| [NC-19](#NC-19) | Enable IR-based code generation | 1 |
| [NC-20](#NC-20) | Events are emitted without the sender information | 11 |
| [NC-21](#NC-21) | Events may be emitted out of order due to reentrancy | 6 |
| [NC-22](#NC-22) |  Function ordering does not follow the Solidity Style Guide | 16 |
| [NC-23](#NC-23) | Variable names for `immutable`s should use CONSTANT_CASE | 6 |
| [NC-24](#NC-24) | Inconsistent spacing in comments | 56 |
| [NC-25](#NC-25) | Incorrect withdraw declaration | 1 |
| [NC-26](#NC-26) | It is best practice to use linear inheritance | 3 |
| [NC-27](#NC-27) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-28](#NC-28) | Large multiples of ten should use scientific notation | 1 |
| [NC-29](#NC-29) | Magic numbers should be replaced with constants | 2 |
| [NC-30](#NC-30) | Named mappings are recommended | 1 |
| [NC-31](#NC-31) | Missing NatSpec `@dev` from contract/event/function/modifier declarations | 43 |
| [NC-32](#NC-32) | Missing NatSpec `@notice` from contract/event/function/modifier declarations | 25 |
| [NC-33](#NC-33) | Missing NatSpec `@param` from event/function/modifier declarations | 20 |
| [NC-34](#NC-34) | Missing NatSpec `@return` from function declaration | 24 |
| [NC-35](#NC-35) | Put all system-wide constants in one file | 4 |
| [NC-36](#NC-36) | Setters should prevent re-setting the same value | 5 |
| [NC-37](#NC-37) | State variables should include comments | 10 |
| [NC-38](#NC-38) | Unnecessary cast | 4 |
| [NC-39](#NC-39) | Unused `error` definition | 1 |
| [NC-40](#NC-40) | Unused arguments should be removed or implemented | 2 |
| [NC-41](#NC-41) | Unused import | 1 |
| [NC-42](#NC-42) | Use `abi.encodeCall()` instead of `abi.encodeWithSignature()`/`abi.encodeWithSelector()` | 1 |
| [NC-43](#NC-43) | Solidity compiler version is not fixed | 6 |
| [NC-44](#NC-44) | Expressions for constant values should use `immutable` rather than `constant` | 4 |
| [NC-45](#NC-45) | Use `@inheritdoc` for overridden functions | 3 |
| [NC-46](#NC-46) | Upgrade `openzeppelin` to the latest version (`5.0.1`) | 1 |
| [NC-47](#NC-47) | Use the latest solidity version for deployment (`0.8.24`) | 1 |
| [NC-48](#NC-48) | Use the Modern Upgradeable Contract Paradigm | 5 |
| [NC-49](#NC-49) | Consider using modifiers for address control | 4 |
| [NC-50](#NC-50) | Use of `override` is unnecessary | 3 |
| [NC-51](#NC-51) | Use a struct to encapsulate multiple function parameters | 1 |
| [NC-52](#NC-52) | Event is missing `indexed` fields | 4 |
| [NC-53](#NC-53) | Functions not used internally could be marked `external` | 7 |
| [NC-54](#NC-54) | Default address(0) can be returned | 3 |

## Gas Optimizations


*Total <b>171</b> instances over <b>39</b> issues:*

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Consider activating via-ir for deploying | 1 | - |
| [GAS-2](#GAS-2) | Divisions can be `unchecked` to save gas | 1 | 20 |
| [GAS-3](#GAS-3) | Don't caching global special variables | 1 | 12 |
| [GAS-4](#GAS-4) | Don't transfer with zero amount to save gas | 2 | - |
| [GAS-5](#GAS-5) | Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables | 2 | 226 |
| [GAS-6](#GAS-6) | Inline `modifier`s that are only used once, to save gas | 2 | - |
| [GAS-7](#GAS-7) | `internal` functions only called once can be inlined to save gas | 2 | 60 |
| [GAS-8](#GAS-8) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 8 | 24 |
| [GAS-9](#GAS-9) | Optimize names to save gas | 3 | 66 |
| [GAS-10](#GAS-10) | Reduce gas usage by moving to Solidity 0.8.19 or later | 1 | 1000 |
| [GAS-11](#GAS-11) | Redundant state variable getters | 1 | - |
| [GAS-12](#GAS-12) | The result of a function call should be cached rather than re-calling the function | 3 | 300 |
| [GAS-13](#GAS-13) | Optimize external calls with assembly for memory efficiency | 13 | 2860 |
| [GAS-14](#GAS-14) | Use assembly to compute hashes to save gas | 1 | 80 |
| [GAS-15](#GAS-15) | Use assembly to emit events | 14 | 532 |
| [GAS-16](#GAS-16) | Use assembly to validate `msg.sender` | 4 | - |
| [GAS-17](#GAS-17) | Use assembly to write address/contract type storage values | 7 | 350 |
| [GAS-18](#GAS-18) | Using a double `if` statement instead of a logical AND (`&&`) | 2 | 60 |
| [GAS-19](#GAS-19) | Use a more recent version of solidity | 1 | - |
| [GAS-20](#GAS-20) | Use != 0 instead of > 0 | 1 | 3 |
| [GAS-21](#GAS-21) | Consider Using Solady's Gas Optimized Lib for Math | 1 | - |
| [GAS-22](#GAS-22) | Use solady library where possible to save gas | 3 | 3000 |
| [GAS-23](#GAS-23) | Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes | 1 | 8550 |
| [GAS-24](#GAS-24) | Use `unchecked` block for safe subtractions | 4 | 340 |
| [GAS-25](#GAS-25) | Using bitmap to store bool states can save gas | 1 | - |
| [GAS-26](#GAS-26) | `abi.encodePacked` is more gas efficient than `abi.encode` | 1 | - |
| [GAS-27](#GAS-27) | Using bools for storage incurs overhead | 1 | 100 |
| [GAS-28](#GAS-28) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 6 | - |
| [GAS-29](#GAS-29) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 27 | 1485 |
| [GAS-30](#GAS-30) | Constructors can be marked as `payable` to save deployment gas | 1 | 21 |
| [GAS-31](#GAS-31) | Functions guaranteed to revert when called by normal users can be marked `payable` | 5 | 105 |
| [GAS-32](#GAS-32) | Using `private` rather than `public` for constants, saves gas | 4 | - |
| [GAS-33](#GAS-33) | Use assembly to check for `address(0)` | 7 | 42 |
| [GAS-34](#GAS-34) | Avoid updating storage when the value hasn't changed | 14 | - |
| [GAS-35](#GAS-35) | Cache address(this) when used more than once | 5 | - |
| [GAS-36](#GAS-36) | Unnecessary casting as variable is already of the same type | 4 | - |
| [GAS-37](#GAS-37) | Where a value is casted more than once, consider caching the result to save gas | 12 | - |
| [GAS-38](#GAS-38) | It is a waste of GAS to emit variable literals | 2 | - |
| [GAS-39](#GAS-39) | Only emit event in setter function if the state variable was changed | 2 | - |

## Medium Issues

<a name="M-1"></a> 
### [M-1] Return values of `approve()` not checked
Not all IERC20 implementations `revert()` when there's a failure in `approve()`. The function signature has a boolean return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually approving anything

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

862:         _asset.approve(address(yieldVault), _assetsWithDust);

869:             _asset.approve(address(yieldVault), 0);

```
*Github:* [[862](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L862), [869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869)]



<a name="M-2"></a> 
### [M-2] Return values of `transfer()`/`transferFrom()` not checked
Not all ERC20 implementations `revert()` when there's a failure in `transfer()` or `transferFrom()`. The function signature has a boolean return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually transfer anything.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

939:             _asset.transfer(_receiver, _assets);

```
*Github:* [[939](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L939)]


```solidity
File: src/PrizeVaultFactory.sol

118:         IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

```
*Github:* [[118](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L118)]


```solidity
File: src/TwabERC20.sol

101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]




## Low Issues

<a name="L-1"></a> 
### [L-1] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

/// @audit missing zero check for `_receiver`
475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

/// @audit missing zero check for `_receiver`
482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

/// @audit missing zero check for `_receiver`
/// @audit missing zero check for `_owner`
489:     function withdraw(
             uint256 _assets,
             address _receiver,
             address _owner
         ) external returns (uint256) {

/// @audit missing zero check for `_receiver`
/// @audit missing zero check for `_owner`
500:     function redeem(
             uint256 _shares,
             address _receiver,
             address _owner
         ) external returns (uint256) {

/// @audit missing zero check for `_owner`
524:     function depositWithPermit(
             uint256 _assets,
             address _owner,
             uint256 _deadline,
             uint8 _v,
             bytes32 _r,
             bytes32 _s
         ) external returns (uint256) {

/// @audit missing zero check for `_receiver`
659:     function transferTokensOut(
             address,
             address _receiver,
             address _tokenOut,
             uint256 _amountOut
         ) public virtual onlyLiquidationPair returns (bytes memory) {

/// @audit missing zero check for `_tokenIn`
703:     function verifyTokensIn(
             address _tokenIn,
             uint256 _amountIn,
             bytes calldata
         ) external onlyLiquidationPair {

/// @audit missing zero check for ``
717:     function targetOf(address) external view returns (address) {

/// @audit missing zero check for `_liquidationPair`
722:     function isLiquidationPair(
             address _tokenOut,
             address _liquidationPair
         ) external view returns (bool) {

/// @audit missing zero check for `_caller`
/// @audit missing zero check for `_receiver`
843:     function _depositAndMint(address _caller, address _receiver, uint256 _assets, uint256 _shares) internal {

/// @audit missing zero check for `_caller`
/// @audit missing zero check for `_receiver`
/// @audit missing zero check for `_owner`
887:     function _burnAndWithdraw(
             address _caller,
             address _receiver,
             address _owner,
             uint256 _shares,
             uint256 _assets
         ) internal {

```
*Github:* [[475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [524](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L524), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722), [843](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L843), [887](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L887)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit missing zero check for `_yieldVault`
/// @audit missing zero check for `_prizePool`
/// @audit missing zero check for `_claimer`
/// @audit missing zero check for `_yieldFeeRecipient`
/// @audit missing zero check for `_owner`
92:     function deployVault(
          string memory _name,
          string memory _symbol,
          IERC4626 _yieldVault,
          PrizePool _prizePool,
          address _claimer,
          address _yieldFeeRecipient,
          uint32 _yieldFeePercentage,
          address _owner
        ) external returns (PrizeVault) {

```
*Github:* [[92](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L92)]


```solidity
File: src/TwabERC20.sol

/// @audit missing zero check for `_account`
56:     function balanceOf(
            address _account
        ) public view virtual override(ERC20) returns (uint256) {

/// @audit missing zero check for `_receiver`
76:     function _mint(address _receiver, uint256 _amount) internal virtual override {

/// @audit missing zero check for `_owner`
87:     function _burn(address _owner, uint256 _amount) internal virtual override {

/// @audit missing zero check for `_from`
/// @audit missing zero check for `_to`
100:     function _transfer(address _from, address _to, uint256 _amount) internal virtual override {

```
*Github:* [[56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56), [76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L76), [87](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L87), [100](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L100)]


```solidity
File: src/abstract/Claimable.sol

/// @audit missing zero check for `_winner`
/// @audit missing zero check for `_rewardRecipient`
76:     function claimPrize(
            address _winner,
            uint8 _tier,
            uint32 _prizeIndex,
            uint96 _reward,
            address _rewardRecipient
        ) external onlyClaimer returns (uint256) {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]


```solidity
File: src/abstract/HookManager.sol

/// @audit missing zero check for `account`
22:     function getHooks(address account) external view returns (VaultHooks memory) {

```
*Github:* [[22](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L22)]


```solidity
File: src/interfaces/IVaultHooks.sol

/// @audit missing zero check for `winner`
/// @audit missing zero check for `rewardRecipient`
26:     function beforeClaimPrize(

/// @audit missing zero check for `winner`
/// @audit missing zero check for `recipient`
40:     function afterClaimPrize(

```
*Github:* [[26](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L26), [40](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L40)]


</details>


<a name="L-2"></a> 
### [L-2] Use increase/decrease allowance instead of `approve()`/`safeApprove()`
Changing an allowance with approve() brings the risk that someone may use both the old and the new allowance by unfortunate transaction ordering. Refer to [ERC20 API: An Attack Vector on the Approve/TransferFrom Methods](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM). It is recommended to use the `increaseAllowance()`/`decreaseAllowance()` to avoid this problem.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

862:         _asset.approve(address(yieldVault), _assetsWithDust);

869:             _asset.approve(address(yieldVault), 0);

```
*Github:* [[862](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L862), [869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869)]



<a name="L-3"></a> 
### [L-3] Array is `push()`ed but not `pop()`ed
There is no limit specified on the amount of gas used, so the recipient can use up all of the remaining gas (`gasleft()`), causing it to revert. Therefore, when calling an external contract, it is necessary to specify a limited amount of gas to forward.

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

120:         allVaults.push(_vault);

```
*Github:* [[120](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L120)]



<a name="L-4"></a> 
### [L-4] Consider implementing two-step procedure for updating protocol addresses
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must "accept" the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the "set" functions ensure that the recipient is of the right interface type.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `liquidationPair`
742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

```
*Github:* [[742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742)]



<a name="L-5"></a> 
### [L-5] Constructor / initialization function lacks parameter validation
Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `name_` not validated
/// @audit `symbol_` not validated
/// @audit `prizePool_` not validated
/// @audit `claimer_` not validated
/// @audit `yieldBuffer_` not validated
289:     constructor(

```
*Github:* [[289](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L289)]


```solidity
File: src/TwabERC20.sol

/// @audit `symbol_` not validated
42:     constructor(

```
*Github:* [[42](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L42)]



<a name="L-6"></a> 
### [L-6] Code does not follow the best practice of check-effects-interaction
Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `.asset(...)` is called on line 303
305:         _underlyingDecimals = success ? assetDecimals : 18;

/// @audit `.asset(...)` is called on line 303
306:         _asset = asset_;

/// @audit `.asset(...)` is called on line 303
308:         yieldVault = yieldVault_;

/// @audit `.asset(...)` is called on line 303
309:         yieldBuffer = yieldBuffer_;

```
*Github:* [[305](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L305), [306](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L306), [308](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L308), [309](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L309)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit `.transferFrom(...)` is called on line 118
/// @audit `.asset(...)` is called on line 118
121:         deployedVaults[address(_vault)] = true;

```
*Github:* [[121](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L121)]



<a name="L-7"></a> 
### [L-7] Functions calling contracts/addresses with transfer hooks are missing reentrancy guards
While adherence to the check-effects-interaction pattern is commendable, the absence of a reentrancy guard in functions, especially where transfer hooks might be present, can expose the protocol users to risks of read-only reentrancies. Such reentrancy vulnerabilities can be exploited to execute malicious actions even without altering the contract state. Without a reentrancy guard, the only potential mitigation would be to blocklist the entire protocol - an extreme and disruptive measure. Therefore, incorporating a reentrancy guard into these functions is vital to bolster security, as it helps protect against both traditional reentrancy attacks and read-only reentrancies, ensuring robust and safe protocol operations.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

489:     function withdraw(
             uint256 _assets,
             address _receiver,
             address _owner
         ) external returns (uint256) {
             uint256 _shares = previewWithdraw(_assets);
             _burnAndWithdraw(msg.sender, _receiver, _owner, _shares, _assets);

500:     function redeem(
             uint256 _shares,
             address _receiver,
             address _owner
         ) external returns (uint256) {
             uint256 _assets = previewRedeem(_shares);
             _burnAndWithdraw(msg.sender, _receiver, _owner, _shares, _assets);

```
*Github:* [[489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500)]


```solidity
File: src/PrizeVaultFactory.sol

92:     function deployVault(
          string memory _name,
          string memory _symbol,
          IERC4626 _yieldVault,
          PrizePool _prizePool,
          address _claimer,
          address _yieldFeeRecipient,
          uint32 _yieldFeePercentage,
          address _owner
        ) external returns (PrizeVault) {
            PrizeVault _vault = new PrizeVault{
                salt: keccak256(abi.encode(msg.sender, deployerNonces[msg.sender]++))
            }(
                _name,
                _symbol,
                _yieldVault,
                _prizePool,
                _claimer,
                _yieldFeeRecipient,
                _yieldFeePercentage,
                YIELD_BUFFER,
                _owner
            );
    
            // A donation to fill the yield buffer is made to ensure that early depositors have
            // rounding errors covered in the time before yield is actually generated.
            IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

```
*Github:* [[92](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L92)]



<a name="L-8"></a> 
### [L-8] Governance functions should be controlled by time locks
Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

735:     function setClaimer(address _claimer) external onlyOwner {

742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

```
*Github:* [[735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759)]



<a name="L-9"></a> 
### [L-9] Large approvals may not work with some `ERC20` tokens
Not all `IERC20` implementations are totally compliant, and some (e.g `UNI`, `COMP`) may fail if the valued passed to `approve` is larger than `uint96`. If the approval amount is `type(uint256).max`, which may cause issues with systems that expect the value passed to approve to be reflected in the allowances mapping.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

862:         _asset.approve(address(yieldVault), _assetsWithDust);

869:             _asset.approve(address(yieldVault), 0);

```
*Github:* [[862](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L862), [869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869)]



<a name="L-10"></a> 
### [L-10] Loss of precision in divisions
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

675:             _yieldFee = (_amountOut * FEE_PRECISION) / (FEE_PRECISION - _yieldFeePercentage) - _amountOut;

```
*Github:* [[675](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L675)]



<a name="L-11"></a> 
### [L-11] Missing checks for state variable assignments
There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

*There are <b>9</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `yieldVault_`
308:         yieldVault = yieldVault_;

/// @audit `yieldBuffer_`
309:         yieldBuffer = yieldBuffer_;

/// @audit `_liquidationPair`
745:         liquidationPair = _liquidationPair;

/// @audit `_yieldFeePercentage`
951:         yieldFeePercentage = _yieldFeePercentage;

/// @audit `_yieldFeeRecipient`
959:         yieldFeeRecipient = _yieldFeeRecipient;

```
*Github:* [[308](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L308), [309](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L309), [745](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L745), [951](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L951), [959](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L959)]


```solidity
File: src/TwabERC20.sol

/// @audit `twabController_`
48:         twabController = twabController_;

```
*Github:* [[48](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L48)]


```solidity
File: src/abstract/Claimable.sol

/// @audit `prizePool_`
66:         prizePool = prizePool_;

/// @audit `_claimer`
130:         claimer = _claimer;

```
*Github:* [[66](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L66), [130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L130)]


```solidity
File: src/abstract/HookManager.sol

/// @audit `hooks`
30:         _hooks[msg.sender] = hooks;

```
*Github:* [[30](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L30)]



<a name="L-12"></a> 
### [L-12] Missing zero address check in constructor
Constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a checking, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could be due to an error or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it will be irretrievable. It's therefore crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit missing zero check for `prizePool_`
/// @audit missing zero check for `claimer_`
289:     constructor(
             string memory name_,
             string memory symbol_,
             IERC4626 yieldVault_,
             PrizePool prizePool_,
             address claimer_,
             address yieldFeeRecipient_,
             uint32 yieldFeePercentage_,
             uint256 yieldBuffer_,
             address owner_
         ) TwabERC20(name_, symbol_, prizePool_.twabController()) Claimable(prizePool_, claimer_) Ownable(owner_) {

```
*Github:* [[289](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L289)]



<a name="L-13"></a> 
### [L-13] Consider some checks for `address(0)` when setting address state variables
Check for zero-address to avoid the risk of setting `address(0)` for state variables after an update.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `yieldVault_`
308:         yieldVault = yieldVault_;

/// @audit `_liquidationPair`
745:         liquidationPair = _liquidationPair;

/// @audit `_yieldFeeRecipient`
959:         yieldFeeRecipient = _yieldFeeRecipient;

```
*Github:* [[308](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L308), [745](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L745), [959](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L959)]


```solidity
File: src/TwabERC20.sol

/// @audit `twabController_`
48:         twabController = twabController_;

```
*Github:* [[48](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L48)]


```solidity
File: src/abstract/Claimable.sol

/// @audit `prizePool_`
66:         prizePool = prizePool_;

/// @audit `_claimer`
130:         claimer = _claimer;

```
*Github:* [[66](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L66), [130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L130)]



<a name="L-14"></a> 
### [L-14] Owner can renounce ownership
Each of the following contracts implements or inherits the `renounceOwnership()` function. This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]



<a name="L-15"></a> 
### [L-15] Solidity version 0.8.20 or above may not work on other chains due to PUSH0
Solidity version 0.8.20 or above uses the new [Shanghai EVM](https://blog.soliditylang.org/2023/05/10/solidity-0.8.20-release-announcement/#important-note) which introduces the PUSH0 opcode. This op code may not yet be implemented on all evm-chains or Layer2s, so deployment on these chains will fail. Consider using an earlier solidity version.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L2)]


```solidity
File: src/PrizeVaultFactory.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L2)]


```solidity
File: src/TwabERC20.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L2)]


```solidity
File: src/abstract/Claimable.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L2)]


```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]


```solidity
File: src/interfaces/IVaultHooks.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L2)]



<a name="L-16"></a> 
### [L-16] Some tokens may revert when large transfers are made
Tokens such as COMP or UNI will revert when an address' balance reaches `type(uint96).max`. Ensure that the calls below can be broken up into smaller batches if necessary.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

854:         _asset.safeTransferFrom(

939:             _asset.transfer(_receiver, _assets);

```
*Github:* [[854](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L854), [939](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L939)]


```solidity
File: src/PrizeVaultFactory.sol

118:         IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

```
*Github:* [[118](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L118)]


```solidity
File: src/TwabERC20.sol

101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]



<a name="L-17"></a> 
### [L-17] Some tokens may revert when zero value transfers are made
Despite the fact that [EIP-20 states](https://github.com/ethereum/EIPs/blob/7500ac4fc1bbdfaf684e7ef851f798f6b667b2fe/EIPS/eip-20.md?plain=1#L116) that zero-value transfers must be accepted, some tokens, such as LEND, will revert if this is attempted, which may cause transactions that involve other tokens (such as batch operations) to fully revert. Consider skipping the transfer if the amount is zero, which will also save gas.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

854:         _asset.safeTransferFrom(

939:             _asset.transfer(_receiver, _assets);

```
*Github:* [[854](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L854), [939](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L939)]


```solidity
File: src/PrizeVaultFactory.sol

118:         IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

```
*Github:* [[118](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L118)]


```solidity
File: src/TwabERC20.sol

101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]



<a name="L-18"></a> 
### [L-18] Tokens may be minted to `address(0)`

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {
             uint256 _assets = previewMint(_shares);
             _depositAndMint(msg.sender, _receiver, _assets, _shares);
             return _assets;
         }

```
*Github:* [[482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482)]


```solidity
File: src/TwabERC20.sol

76:     function _mint(address _receiver, uint256 _amount) internal virtual override {
            twabController.mint(_receiver, SafeCast.toUint96(_amount));
            emit Transfer(address(0), _receiver, _amount);
        }

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L76)]



<a name="L-19"></a> 
### [L-19] Unsafe downcast
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit uint256 -> uint8
779:                 return (true, uint8(returnedDecimals));

```
*Github:* [[779](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L779)]



<a name="L-20"></a> 
### [L-20] Use Ownable2Step instead of Ownable
`Ownable2Step` and `Ownable2StepUpgradeable` prevent the contract ownership from mistakenly being transferred to an address that cannot handle it (e.g. due to a typo in the address), by requiring that the recipient of the owner permissions actively accept via a contract call of its own.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]



<a name="L-21"></a> 
### [L-21] Using zero as a parameter
Taking `0` as a valid argument in Solidity without checks can lead to severe security issues. A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because 0 can be interpreted as an uninitialized `address`, leading to transfers to the 0x0 address, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code. It's important to always validate input and handle edge cases like `0` appropriately. Use `require()` statements to enforce conditions and provide clear error messages to facilitate debugging and safer code.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/TwabERC20.sol

78:         emit Transfer(address(0), _receiver, _amount);

89:         emit Transfer(_owner, address(0), _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89)]



<a name="L-22"></a> 
### [L-22] Centralization Risk for trusted owners
Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

611:     function claimYieldFeeShares(uint256 _shares) external onlyYieldFeeRecipient {

659:     function transferTokensOut(
             address,
             address _receiver,
             address _tokenOut,
             uint256 _amountOut
         ) public virtual onlyLiquidationPair returns (bytes memory) {

703:     function verifyTokensIn(
             address _tokenIn,
             uint256 _amountIn,
             bytes calldata
         ) external onlyLiquidationPair {

735:     function setClaimer(address _claimer) external onlyOwner {

742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

```
*Github:* [[611](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L611), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759)]


```solidity
File: src/abstract/Claimable.sol

76:     function claimPrize(
            address _winner,
            uint8 _tier,
            uint32 _prizeIndex,
            uint96 _reward,
            address _rewardRecipient
        ) external onlyClaimer returns (uint256) {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]



<a name="L-23"></a> 
### [L-23] The call `abi.encodeWithSelector` is not type safe
In Solidity, `abi.encodeWithSelector` is a function used for encoding data along with a function selector, but it is not type-safe. This means it does not enforce type checking at compile time, potentially leading to errors if arguments do not match the expected types. Starting from version 0.8.13, Solidity introduced `abi.encodeCall`, which offers a safer alternative. `abi.encodeCall` ensures type safety by performing a full type check, aligning the types of the arguments with the function signature. This reduces the risk of bugs caused by typographical errors or mismatched types. Using `abi.encodeCall` enhances the reliability and security of the code by ensuring that the encoded data strictly conforms to the specified types, making it a preferable choice in Solidity versions 0.8.13 and above.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

774:             abi.encodeWithSelector(IERC20Metadata.decimals.selector)

```
*Github:* [[774](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L774)]




## Non Critical Issues

<a name="NC-1"></a> 
### [NC-1] Add inline comments for unnamed variables
`function foo(address x, address)` -> `function foo(address x, address /* y */)`

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

374:     function maxDeposit(address) public view returns (uint256) {

659:     function transferTokensOut(
             address,
             address _receiver,
             address _tokenOut,
             uint256 _amountOut
         ) public virtual onlyLiquidationPair returns (bytes memory) {

703:     function verifyTokensIn(
             address _tokenIn,
             uint256 _amountIn,
             bytes calldata
         ) external onlyLiquidationPair {

717:     function targetOf(address) external view returns (address) {

```
*Github:* [[374](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L374), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717)]



<a name="NC-2"></a> 
### [NC-2] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]


```solidity
File: src/PrizeVaultFactory.sol

13: contract PrizeVaultFactory {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L13)]


```solidity
File: src/TwabERC20.sol

19: contract TwabERC20 is ERC20, ERC20Permit {

```
*Github:* [[19](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L19)]


```solidity
File: src/abstract/Claimable.sol

13: abstract contract Claimable is HookManager, IClaimable {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L13)]


```solidity
File: src/abstract/HookManager.sol

9: abstract contract HookManager {

```
*Github:* [[9](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L9)]



<a name="NC-3"></a> 
### [NC-3] Consider adding emergency-stop functionality
Consider adding `Pausable` to the following contracts so it's possible to stop them in case of an emergency.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]


```solidity
File: src/PrizeVaultFactory.sol

13: contract PrizeVaultFactory {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L13)]


```solidity
File: src/TwabERC20.sol

19: contract TwabERC20 is ERC20, ERC20Permit {

```
*Github:* [[19](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L19)]



<a name="NC-4"></a> 
### [NC-4] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="NC-5"></a> 
### [NC-5] Consider using descriptive `constant`s when passing zero as a function argument
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

869:             _asset.approve(address(yieldVault), 0);

```
*Github:* [[869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869)]



<a name="NC-6"></a> 
### [NC-6] Constant decimal values
The use of fixed decimal values such as 1e18 or 1e8 in Solidity contracts can lead to inaccuracies, bugs, and vulnerabilities, particularly when interacting with tokens having different decimal configurations. Not all ERC20 tokens follow the standard 18 decimal places, and assumptions about decimal places can lead to miscalculations.

Resolution: Always retrieve and use the decimals() function from the token contract itself when performing calculations involving token amounts. This ensures that your contract correctly handles tokens with any number of decimal places, mitigating the risk of numerical errors or under/overflows that could jeopardize contract integrity and user funds.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74)]


```solidity
File: src/PrizeVaultFactory.sol

63:     uint256 public constant YIELD_BUFFER = 1e5;

```
*Github:* [[63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L63)]



<a name="NC-7"></a> 
### [NC-7] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

300:         if (address(yieldVault_) == address(0)) revert YieldVaultZeroAddress();

301:         if (owner_ == address(0)) revert OwnerZeroAddress();

458:         if (_totalAssets == 0) revert ZeroTotalAssets();

612:         if (_shares == 0) revert MintZeroShares();

665:         if (_amountOut == 0) revert LiquidationAmountOutZero();

672:         if (_yieldFeePercentage != 0) {

743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

844:         if (_shares == 0) revert MintZeroShares();

845:         if (_assets == 0) revert DepositZeroAssets();

894:         if (_assets == 0) revert WithdrawZeroAssets();

895:         if (_shares == 0) revert BurnZeroShares();

```
*Github:* [[300](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L300), [301](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L301), [458](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L458), [612](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L612), [665](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L665), [672](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L672), [743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743), [844](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L844), [845](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L845), [894](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L894), [895](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L895)]


```solidity
File: src/abstract/Claimable.sol

65:         if (address(prizePool_) == address(0)) revert PrizePoolZeroAddress();

97:         if (recipient == address(0)) revert ClaimRecipientZeroAddress();

129:         if (_claimer == address(0)) revert ClaimerZeroAddress();

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L65), [97](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L97), [129](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L129)]


</details>


<a name="NC-8"></a> 
### [NC-8] `Constructor` should emit an event
Use events to signal significant changes to off-chain monitoring tools.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

289:     constructor(

```
*Github:* [[289](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L289)]


```solidity
File: src/TwabERC20.sol

42:     constructor(

```
*Github:* [[42](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L42)]


```solidity
File: src/abstract/Claimable.sol

64:     constructor(PrizePool prizePool_, address claimer_) {

```
*Github:* [[64](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L64)]



<a name="NC-9"></a> 
### [NC-9] Contract does not follow the Solidity Style Guide's suggested layout ordering
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be `1) Type declarations`, `2) State variables`, `3) Events`, `4) Modifiers`, and `5) Functions`, but the contract(s) below do not follow this ordering

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

/// @audit event/error `NewPrizeVault` came earlier
63:     uint256 public constant YIELD_BUFFER = 1e5;

/// @audit event/error `NewPrizeVault` came earlier
66:     PrizeVault[] public allVaults;

/// @audit event/error `NewPrizeVault` came earlier
69:     mapping(address vault => bool deployedByFactory) public deployedVaults;

/// @audit event/error `NewPrizeVault` came earlier
72:     mapping(address deployer => uint256 nonce) public deployerNonces;

```
*Github:* [[63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L63), [66](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L66), [69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L69), [72](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L72)]


```solidity
File: src/abstract/HookManager.sol

/// @audit event/error `SetHooks` came earlier
17:     mapping(address => VaultHooks) internal _hooks;

```
*Github:* [[17](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L17)]



<a name="NC-10"></a> 
### [NC-10] Contract should expose an `interface`
All `external`/`public` functions should extend an `interface`. This is useful to make sure that the whole API is extracted.

*Note:* It is possible that the interface is out-of-scope and has not been seen by the bot.

<details>
<summary>
There are <b>40</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

329:     function asset() external view returns (address) {

336:     function totalAssets() public view returns (uint256) {

341:     function convertToShares(uint256 _assets) public view returns (uint256) {

355:     function convertToAssets(uint256 _shares) public view returns (uint256) {

374:     function maxDeposit(address) public view returns (uint256) {

397:     function maxMint(address _owner) public view returns (uint256) {

404:     function maxWithdraw(address _owner) public view returns (uint256) {

415:     function maxRedeem(address _owner) public view returns (uint256) {

441:     function previewDeposit(uint256 _assets) public pure returns (uint256) {

447:     function previewMint(uint256 _shares) public pure returns (uint256) {

454:     function previewWithdraw(uint256 _assets) public view returns (uint256) {

470:     function previewRedeem(uint256 _shares) public view returns (uint256) {

475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

489:     function withdraw(

500:     function redeem(

524:     function depositWithPermit(

552:     function sponsor(uint256 _assets) external returns (uint256) {

573:     function totalDebt() public view returns (uint256) {

584:     function totalYieldBalance() public view returns (uint256) {

591:     function availableYieldBalance() public view returns (uint256) {

597:     function currentYieldBuffer() external view returns (uint256) {

611:     function claimYieldFeeShares(uint256 _shares) external onlyYieldFeeRecipient {

631:     function liquidatableBalanceOf(address _tokenOut) public view returns (uint256) {

659:     function transferTokensOut(

703:     function verifyTokensIn(

717:     function targetOf(address) external view returns (address) {

722:     function isLiquidationPair(

735:     function setClaimer(address _claimer) external onlyOwner {

742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

```
*Github:* [[320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [336](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L336), [341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [355](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L355), [374](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L374), [397](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L397), [404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [441](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L441), [447](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L447), [454](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L454), [470](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L470), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [524](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L524), [552](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L552), [573](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L573), [584](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L584), [591](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L591), [597](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L597), [611](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L611), [631](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L631), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722), [735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759)]


```solidity
File: src/PrizeVaultFactory.sol

92:     function deployVault(

136:     function totalVaults() external view returns (uint256) {

```
*Github:* [[92](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L92), [136](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L136)]


```solidity
File: src/TwabERC20.sol

56:     function balanceOf(

63:     function totalSupply() public view virtual override(ERC20) returns (uint256) {

```
*Github:* [[56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56), [63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

76:     function claimPrize(

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]


```solidity
File: src/abstract/HookManager.sol

22:     function getHooks(address account) external view returns (VaultHooks memory) {

29:     function setHooks(VaultHooks calldata hooks) external {

```
*Github:* [[22](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L22), [29](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L29)]


</details>


<a name="NC-11"></a> 
### [NC-11] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="NC-12"></a> 
### [NC-12] Convert simple `if` statements to ternary expressions
Converting some if statements to ternaries (such as `z = (a < b) ? x : y`) can make the code more concise and easier to read.

*There is one instance of this issue:*
```solidity
File: src/abstract/Claimable.sol

85:         if (_hooks[_winner].useBeforeClaimPrize) {
                recipient = _hooks[_winner].implementation.beforeClaimPrize{ gas: HOOK_GAS }(
                    _winner,
                    _tier,
                    _prizeIndex,
                    _reward,
                    _rewardRecipient
                );
            } else {
                recipient = _winner;

```
*Github:* [[85](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L85)]



<a name="NC-13"></a> 
### [NC-13] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

562:         emit Sponsor(_owner, _assets, _shares);

621:         emit ClaimYieldFeeShares(msg.sender, _shares);

697:         emit TransferYieldOut(msg.sender, _tokenOut, _receiver, _amountOut, _yieldFee);

747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

876:         emit Deposit(_caller, _receiver, _assets, _shares);

909:         emit Withdraw(_caller, _receiver, _owner, _assets, _shares);

952:         emit YieldFeePercentageSet(_yieldFeePercentage);

960:         emit YieldFeeRecipientSet(_yieldFeeRecipient);

```
*Github:* [[562](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L562), [621](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L621), [697](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L697), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [876](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L876), [909](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L909), [952](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L952), [960](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L960)]


```solidity
File: src/TwabERC20.sol

78:         emit Transfer(address(0), _receiver, _amount);

89:         emit Transfer(_owner, address(0), _amount);

102:         emit Transfer(_from, _to, _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89), [102](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L102)]


```solidity
File: src/abstract/Claimable.sol

131:         emit ClaimerSet(_claimer);

```
*Github:* [[131](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L131)]


```solidity
File: src/abstract/HookManager.sol

31:         emit SetHooks(msg.sender, hooks);

```
*Github:* [[31](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L31)]


</details>


<a name="NC-14"></a> 
### [NC-14] Custom errors has no error details
Consider adding parameters to the error to indicate which user or values caused the failure.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

182:     error YieldVaultZeroAddress();

185:     error OwnerZeroAddress();

188:     error WithdrawZeroAssets();

191:     error BurnZeroShares();

194:     error DepositZeroAssets();

197:     error MintZeroShares();

200:     error ZeroTotalAssets();

203:     error LPZeroAddress();

206:     error SweepZeroAssets();

209:     error LiquidationAmountOutZero();

```
*Github:* [[182](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L182), [185](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L185), [188](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L188), [191](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L191), [194](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L194), [197](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L197), [200](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L200), [203](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L203), [206](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L206), [209](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L209)]


```solidity
File: src/TwabERC20.sol

33:     error TwabControllerZeroAddress();

```
*Github:* [[33](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L33)]


```solidity
File: src/abstract/Claimable.sol

34:     error PrizePoolZeroAddress();

37:     error ClaimerZeroAddress();

40:     error ClaimRecipientZeroAddress();

```
*Github:* [[34](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L34), [37](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L37), [40](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L40)]


</details>


<a name="NC-15"></a> 
### [NC-15] Solidity version is different in some files

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L2)]


```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]



<a name="NC-16"></a> 
### [NC-16] Do not use underscore at the end of variable name
Adopting a consistent and clear naming convention enhances code readability and maintainability. In Solidity, appending an underscore at the end of a variable name is unconventional and can lead to confusion. It is generally advisable to stick to accepted naming practices to promote ease of understanding and use.

<details>
<summary>
There are <b>26</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

290:         string memory name_,

291:         string memory symbol_,

292:         IERC4626 yieldVault_,

293:         PrizePool prizePool_,

294:         address claimer_,

295:         address yieldFeeRecipient_,

296:         uint32 yieldFeePercentage_,

297:         uint256 yieldBuffer_,

298:         address owner_

303:         IERC20 asset_ = IERC20(yieldVault_.asset());

342:         uint256 totalDebt_ = totalDebt();

356:         uint256 totalDebt_ = totalDebt();

376:         uint256 totalDebt_ = _totalDebt(_totalSupply);

380:         uint256 twabSupplyLimit_ = _twabSupplyLimit(_totalSupply);

424:             uint256 totalDebt_ = totalDebt();

460:         uint256 totalDebt_ = totalDebt();

598:         uint256 totalYieldBalance_ = _totalYieldBalance(totalAssets(), totalDebt());

772:     function _tryGetAssetDecimals(IERC20 asset_) internal view returns (bool, uint8) {

808:     function _totalYieldBalance(uint256 _totalAssets, uint256 totalDebt_) internal pure returns (uint256) {

823:     function _availableYieldBalance(uint256 _totalAssets, uint256 totalDebt_) internal view returns (uint256) {

824:         uint256 totalYieldBalance_ = _totalYieldBalance(_totalAssets, totalDebt_);

```
*Github:* [[290](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L290), [291](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L291), [292](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L292), [293](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L293), [294](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L294), [295](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L295), [296](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L296), [297](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L297), [298](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L298), [303](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L303), [342](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L342), [356](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L356), [376](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L376), [380](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L380), [424](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L424), [460](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L460), [598](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L598), [772](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L772), [808](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L808), [823](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L823), [824](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L824)]


```solidity
File: src/TwabERC20.sol

43:         string memory name_,

44:         string memory symbol_,

45:         TwabController twabController_

```
*Github:* [[43](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L43), [44](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L44), [45](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L45)]


```solidity
File: src/abstract/Claimable.sol

64:     constructor(PrizePool prizePool_, address claimer_) {

64:     constructor(PrizePool prizePool_, address claimer_) {

```
*Github:* [[64](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L64), [64](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L64)]


</details>


<a name="NC-17"></a> 
### [NC-17] `else` block not required
One level of nesting can be removed by not having an `else` block when the `if`-block always jumps at the end. For example:
```solidity
if (condition) {
	body1...
	return x;
} else {
	body2...
}
```
can be changed to:
```solidity
if (condition) {
	body1...
	return x;
}
body2...
```

*There are <b>7</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

344:         if (_totalAssets >= totalDebt_) {
                 return _assets;
             } else {

358:         if (_totalAssets >= totalDebt_) {
                 return _shares;
             } else {

384:         if (_latentBalance >= _maxYieldVaultDeposit) {
                 return 0;
             } else {

425:             if (_totalAssets >= totalDebt_) {
                     return _maxWithdraw;
                 } else {

461:         if (_totalAssets >= totalDebt_) {
                 return _assets;
             } else {

600:         if (totalYieldBalance_ >= _yieldBuffer) {
                 return _yieldBuffer;
             } else {

809:         if (totalDebt_ >= _totalAssets) {
                 return 0;
             } else {

```
*Github:* [[344](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L344), [358](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L358), [384](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L384), [425](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L425), [461](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L461), [600](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L600), [809](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L809)]



<a name="NC-18"></a> 
### [NC-18] Empty bytes check is missing
Passing empty bytes to a function can cause unexpected behavior, such as certain operations failing, producing incorrect results, or wasting gas. It is recommended to check that all byte parameters are not empty.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit missing empty check for ``
703:     function verifyTokensIn(
             address _tokenIn,
             uint256 _amountIn,
             bytes calldata
         ) external onlyLiquidationPair {

```
*Github:* [[703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703)]



<a name="NC-19"></a> 
### [NC-19] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="NC-20"></a> 
### [NC-20] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

562:         emit Sponsor(_owner, _assets, _shares);

747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

876:         emit Deposit(_caller, _receiver, _assets, _shares);

909:         emit Withdraw(_caller, _receiver, _owner, _assets, _shares);

952:         emit YieldFeePercentageSet(_yieldFeePercentage);

960:         emit YieldFeeRecipientSet(_yieldFeeRecipient);

```
*Github:* [[562](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L562), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [876](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L876), [909](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L909), [952](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L952), [960](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L960)]


```solidity
File: src/PrizeVaultFactory.sol

123:         emit NewPrizeVault(

```
*Github:* [[123](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L123)]


```solidity
File: src/TwabERC20.sol

78:         emit Transfer(address(0), _receiver, _amount);

89:         emit Transfer(_owner, address(0), _amount);

102:         emit Transfer(_from, _to, _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89), [102](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L102)]


```solidity
File: src/abstract/Claimable.sol

131:         emit ClaimerSet(_claimer);

```
*Github:* [[131](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L131)]


</details>


<a name="NC-21"></a> 
### [NC-21] Events may be emitted out of order due to reentrancy
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `.delegateOf(...)` is called on line 558
/// @audit `.sponsor(...)` is called on line 559
562:         emit Sponsor(_owner, _assets, _shares);

/// @audit `.safeTransferFrom(...)` is called on line 854
/// @audit `.balanceOf(...)` is called on line 861
/// @audit `.approve(...)` is called on line 862
/// @audit `.previewDeposit(...)` is called on line 865
/// @audit `.mint(...)` is called on line 866
/// @audit `.approve(...)` is called on line 869
876:         emit Deposit(_caller, _receiver, _assets, _shares);

```
*Github:* [[562](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L562), [876](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L876)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit `.transferFrom(...)` is called on line 118
/// @audit `.asset(...)` is called on line 118
123:         emit NewPrizeVault(

```
*Github:* [[123](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L123)]


```solidity
File: src/TwabERC20.sol

/// @audit `.mint(...)` is called on line 77
78:         emit Transfer(address(0), _receiver, _amount);

/// @audit `.burn(...)` is called on line 88
89:         emit Transfer(_owner, address(0), _amount);

/// @audit `.transfer(...)` is called on line 101
102:         emit Transfer(_from, _to, _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89), [102](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L102)]



<a name="NC-22"></a> 
### [NC-22]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

/// @audit public function `decimals` came earlier from this external function
329:     function asset() external view returns (address) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
489:     function withdraw(

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
500:     function redeem(

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
524:     function depositWithPermit(

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
552:     function sponsor(uint256 _assets) external returns (uint256) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
597:     function currentYieldBuffer() external view returns (uint256) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
611:     function claimYieldFeeShares(uint256 _shares) external onlyYieldFeeRecipient {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
703:     function verifyTokensIn(

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
717:     function targetOf(address) external view returns (address) {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
722:     function isLiquidationPair(

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
735:     function setClaimer(address _claimer) external onlyOwner {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

/// @audit public function `decimals` came earlier from this external function
/// @audit public function `totalAssets` came earlier from this external function
/// @audit public function `convertToShares` came earlier from this external function
/// @audit public function `convertToAssets` came earlier from this external function
/// @audit public function `maxDeposit` came earlier from this external function
/// @audit public function `maxMint` came earlier from this external function
/// @audit public function `maxWithdraw` came earlier from this external function
/// @audit public function `maxRedeem` came earlier from this external function
/// @audit public function `previewDeposit` came earlier from this external function
/// @audit public function `previewMint` came earlier from this external function
/// @audit public function `previewWithdraw` came earlier from this external function
/// @audit public function `previewRedeem` came earlier from this external function
/// @audit public function `totalDebt` came earlier from this external function
/// @audit public function `totalYieldBalance` came earlier from this external function
/// @audit public function `availableYieldBalance` came earlier from this external function
/// @audit public function `liquidatableBalanceOf` came earlier from this external function
/// @audit public function `transferTokensOut` came earlier from this external function
759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

```
*Github:* [[329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [524](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L524), [552](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L552), [597](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L597), [611](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L611), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722), [735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759)]


</details>


<a name="NC-23"></a> 
### [NC-23] Variable names for `immutable`s should use CONSTANT_CASE
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

112:     uint256 public immutable yieldBuffer;

115:     IERC4626 public immutable yieldVault;

135:     IERC20 private immutable _asset;

138:     uint8 private immutable _underlyingDecimals;

```
*Github:* [[112](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L112), [115](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L115), [135](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L135), [138](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L138)]


```solidity
File: src/TwabERC20.sol

26:     TwabController public immutable twabController;

```
*Github:* [[26](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L26)]


```solidity
File: src/abstract/Claimable.sol

24:     PrizePool public immutable prizePool;

```
*Github:* [[24](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L24)]



<a name="NC-24"></a> 
### [NC-24] Inconsistent spacing in comments
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file

<details>
<summary>
There are <b>56</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

69:     ////////////////////////////////////////////////////////////////////////////////

71:     ////////////////////////////////////////////////////////////////////////////////

130:     ////////////////////////////////////////////////////////////////////////////////

132:     ////////////////////////////////////////////////////////////////////////////////

140:     ////////////////////////////////////////////////////////////////////////////////

142:     ////////////////////////////////////////////////////////////////////////////////

177:     ////////////////////////////////////////////////////////////////////////////////

179:     ////////////////////////////////////////////////////////////////////////////////

255:     ////////////////////////////////////////////////////////////////////////////////

257:     ////////////////////////////////////////////////////////////////////////////////

275:     ////////////////////////////////////////////////////////////////////////////////

277:     ////////////////////////////////////////////////////////////////////////////////

315:     ////////////////////////////////////////////////////////////////////////////////

317:     ////////////////////////////////////////////////////////////////////////////////

324:     ////////////////////////////////////////////////////////////////////////////////

326:     ////////////////////////////////////////////////////////////////////////////////

510:     ////////////////////////////////////////////////////////////////////////////////

512:     ////////////////////////////////////////////////////////////////////////////////

567:     ////////////////////////////////////////////////////////////////////////////////

569:     ////////////////////////////////////////////////////////////////////////////////

577:     ////////////////////////////////////////////////////////////////////////////////

579:     ////////////////////////////////////////////////////////////////////////////////

624:     ////////////////////////////////////////////////////////////////////////////////

626:     ////////////////////////////////////////////////////////////////////////////////

729:     ////////////////////////////////////////////////////////////////////////////////

731:     ////////////////////////////////////////////////////////////////////////////////

763:     ////////////////////////////////////////////////////////////////////////////////

765:     ////////////////////////////////////////////////////////////////////////////////

```
*Github:* [[69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L69), [71](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L71), [130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L130), [132](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L132), [140](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L140), [142](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L142), [177](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L177), [179](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L179), [255](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L255), [257](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L257), [275](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L275), [277](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L277), [315](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L315), [317](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L317), [324](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L324), [326](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L326), [510](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L510), [512](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L512), [567](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L567), [569](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L569), [577](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L577), [579](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L579), [624](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L624), [626](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L626), [729](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L729), [731](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L731), [763](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L763), [765](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L765)]


```solidity
File: src/PrizeVaultFactory.sol

15:     ////////////////////////////////////////////////////////////////////////////////

17:     ////////////////////////////////////////////////////////////////////////////////

33:     ////////////////////////////////////////////////////////////////////////////////

35:     ////////////////////////////////////////////////////////////////////////////////

74:     ////////////////////////////////////////////////////////////////////////////////

76:     ////////////////////////////////////////////////////////////////////////////////

```
*Github:* [[15](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L15), [17](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L17), [33](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L33), [35](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L35), [74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L74), [76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L76)]


```solidity
File: src/TwabERC20.sol

21:     ////////////////////////////////////////////////////////////////////////////////

23:     ////////////////////////////////////////////////////////////////////////////////

28:     ////////////////////////////////////////////////////////////////////////////////

30:     ////////////////////////////////////////////////////////////////////////////////

35:     ////////////////////////////////////////////////////////////////////////////////

37:     ////////////////////////////////////////////////////////////////////////////////

51:     ////////////////////////////////////////////////////////////////////////////////

53:     ////////////////////////////////////////////////////////////////////////////////

67:     ////////////////////////////////////////////////////////////////////////////////

69:     ////////////////////////////////////////////////////////////////////////////////

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L21), [23](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L23), [28](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L28), [30](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L30), [35](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L35), [37](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L37), [51](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L51), [53](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L53), [67](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L67), [69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L69)]


```solidity
File: src/abstract/Claimable.sol

15:     ////////////////////////////////////////////////////////////////////////////////

17:     ////////////////////////////////////////////////////////////////////////////////

29:     ////////////////////////////////////////////////////////////////////////////////

31:     ////////////////////////////////////////////////////////////////////////////////

47:     ////////////////////////////////////////////////////////////////////////////////

49:     ////////////////////////////////////////////////////////////////////////////////

57:     ////////////////////////////////////////////////////////////////////////////////

59:     ////////////////////////////////////////////////////////////////////////////////

70:     ////////////////////////////////////////////////////////////////////////////////

72:     ////////////////////////////////////////////////////////////////////////////////

121:     ////////////////////////////////////////////////////////////////////////////////

123:     ////////////////////////////////////////////////////////////////////////////////

```
*Github:* [[15](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L15), [17](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L17), [29](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L29), [31](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L31), [47](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L47), [49](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L49), [57](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L57), [59](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L59), [70](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L70), [72](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L72), [121](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L121), [123](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L123)]


</details>


<a name="NC-25"></a> 
### [NC-25] Incorrect withdraw declaration
In Solidity, it's essential for clarity and interoperability to correctly specify return types in function declarations. If the `withdraw` function is expected to return a `bool` to indicate success or failure, its omission could lead to ambiguity or unexpected behavior when interacting with or calling this function from other contracts or off-chain systems. Missing return values can mislead developers and potentially lead to contract integrations built on incorrect assumptions. To resolve this, the function declaration for withdraw should be modified to explicitly include the `bool` return type, ensuring clarity and correctness in contract interactions.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

928:     function _withdraw(address _receiver, uint256 _assets) internal {

```
*Github:* [[928](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L928)]



<a name="NC-26"></a> 
### [NC-26] It is best practice to use linear inheritance
In Solidity, complex inheritance structures can obfuscate code understanding, introducing potential security risks. Multiple inheritance, especially with overlapping function names or state variables, can cause unintentional overrides or ambiguous behavior. 

Resolution: Strive for linear and simple inheritance chains. Avoid diamond or circular inheritance patterns. Clearly document the purpose and relationships of base contracts, ensuring that overrides are intentional. Tools like Remix or Hardhat can visualize inheritance chains, assisting in verification. Keeping inheritance streamlined aids in better code readability, reduces potential errors, and ensures smoother audits and upgrades.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]


```solidity
File: src/TwabERC20.sol

19: contract TwabERC20 is ERC20, ERC20Permit {

```
*Github:* [[19](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L19)]


```solidity
File: src/abstract/Claimable.sol

13: abstract contract Claimable is HookManager, IClaimable {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L13)]



<a name="NC-27"></a> 
### [NC-27] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="NC-28"></a> 
### [NC-28] Large multiples of ten should use scientific notation
Use a scientific notation rather than decimal literals (e.g. `1e6` instead of `1000000`), for better code readability.

*There is one instance of this issue:*
```solidity
File: src/abstract/Claimable.sol

21:     uint24 public constant HOOK_GAS = 150_000;

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L21)]



<a name="NC-29"></a> 
### [NC-29] Magic numbers should be replaced with constants
Magic numbers are hard-coded values in code that can make it difficult for developers and maintainers to understand the code, and can also cause confusion or errors. To improve the readability and maintainability of code, it is recommended to replace magic numbers with constants that have good readability.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

// @audit `18`
305:         _underlyingDecimals = success ? assetDecimals : 18;

// @audit `32`
776:         if (success && encodedDecimals.length >= 32) {

```
*Github:* [[305](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L305), [776](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L776)]



<a name="NC-30"></a> 
### [NC-30] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

*There is one instance of this issue:*
```solidity
File: src/abstract/HookManager.sol

17:     mapping(address => VaultHooks) internal _hooks;

```
*Github:* [[17](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L17)]



<a name="NC-31"></a> 
### [NC-31] Missing NatSpec `@dev` from contract/event/function/modifier declarations
Some contract definitions have an incomplete NatSpec: add a `@dev` notation to improve the code documentation.

<details>
<summary>
There are <b>43</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

146:     event YieldFeeRecipientSet(address indexed yieldFeeRecipient);

150:     event YieldFeePercentageSet(uint256 yieldFeePercentage);

156:     event Sponsor(address indexed caller, uint256 assets, uint256 shares);

164:     event TransferYieldOut(

175:     event ClaimYieldFeeShares(address indexed recipient, uint256 shares);

260:     modifier onlyLiquidationPair() {

268:     modifier onlyYieldFeeRecipient() {

289:     constructor(

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

329:     function asset() external view returns (address) {

341:     function convertToShares(uint256 _assets) public view returns (uint256) {

355:     function convertToAssets(uint256 _shares) public view returns (uint256) {

441:     function previewDeposit(uint256 _assets) public pure returns (uint256) {

447:     function previewMint(uint256 _shares) public pure returns (uint256) {

470:     function previewRedeem(uint256 _shares) public view returns (uint256) {

475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

489:     function withdraw(

500:     function redeem(

573:     function totalDebt() public view returns (uint256) {

597:     function currentYieldBuffer() external view returns (uint256) {

703:     function verifyTokensIn(

717:     function targetOf(address) external view returns (address) {

722:     function isLiquidationPair(

735:     function setClaimer(address _claimer) external onlyOwner {

759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

808:     function _totalYieldBalance(uint256 _totalAssets, uint256 totalDebt_) internal pure returns (uint256) {

928:     function _withdraw(address _receiver, uint256 _assets) internal {

```
*Github:* [[146](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L146), [150](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L150), [156](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L156), [164](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L164), [175](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L175), [260](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L260), [268](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L268), [289](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L289), [320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [355](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L355), [441](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L441), [447](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L447), [470](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L470), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [573](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L573), [597](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L597), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722), [735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759), [808](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L808), [928](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L928)]


```solidity
File: src/PrizeVaultFactory.sol

13: contract PrizeVaultFactory {

25:     event NewPrizeVault(

136:     function totalVaults() external view returns (uint256) {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L13), [25](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L25), [136](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L136)]


```solidity
File: src/TwabERC20.sol

42:     constructor(

56:     function balanceOf(

63:     function totalSupply() public view virtual override(ERC20) returns (uint256) {

```
*Github:* [[42](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L42), [56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56), [63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

13: abstract contract Claimable is HookManager, IClaimable {

52:     modifier onlyClaimer() {

64:     constructor(PrizePool prizePool_, address claimer_) {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L13), [52](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L52), [64](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L64)]


```solidity
File: src/abstract/HookManager.sol

9: abstract contract HookManager {

14:     event SetHooks(address indexed account, VaultHooks hooks);

22:     function getHooks(address account) external view returns (VaultHooks memory) {

```
*Github:* [[9](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L9), [14](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L14), [22](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L22)]


```solidity
File: src/interfaces/IVaultHooks.sol

17: interface IVaultHooks {

26:     function beforeClaimPrize(

40:     function afterClaimPrize(

```
*Github:* [[17](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L17), [26](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L26), [40](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L40)]


</details>


<a name="NC-32"></a> 
### [NC-32] Missing NatSpec `@notice` from contract/event/function/modifier declarations
Some contract definitions have an incomplete NatSpec: add a `@notice` notation to improve the code documentation.

<details>
<summary>
There are <b>25</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

329:     function asset() external view returns (address) {

336:     function totalAssets() public view returns (uint256) {

341:     function convertToShares(uint256 _assets) public view returns (uint256) {

355:     function convertToAssets(uint256 _shares) public view returns (uint256) {

374:     function maxDeposit(address) public view returns (uint256) {

397:     function maxMint(address _owner) public view returns (uint256) {

404:     function maxWithdraw(address _owner) public view returns (uint256) {

415:     function maxRedeem(address _owner) public view returns (uint256) {

441:     function previewDeposit(uint256 _assets) public pure returns (uint256) {

447:     function previewMint(uint256 _shares) public pure returns (uint256) {

454:     function previewWithdraw(uint256 _assets) public view returns (uint256) {

470:     function previewRedeem(uint256 _shares) public view returns (uint256) {

475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

489:     function withdraw(

500:     function redeem(

631:     function liquidatableBalanceOf(address _tokenOut) public view returns (uint256) {

659:     function transferTokensOut(

703:     function verifyTokensIn(

717:     function targetOf(address) external view returns (address) {

722:     function isLiquidationPair(

```
*Github:* [[320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [336](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L336), [341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [355](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L355), [374](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L374), [397](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L397), [404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [441](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L441), [447](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L447), [454](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L454), [470](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L470), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [631](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L631), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722)]


```solidity
File: src/TwabERC20.sol

56:     function balanceOf(

63:     function totalSupply() public view virtual override(ERC20) returns (uint256) {

```
*Github:* [[56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56), [63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

76:     function claimPrize(

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]


</details>


<a name="NC-33"></a> 
### [NC-33] Missing NatSpec `@param` from event/function/modifier declarations
Some event definitions have an incomplete NatSpec: add a `@param` notation to improve the code documentation.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

/// @audit missing @param for `_assets`
341:     function convertToShares(uint256 _assets) public view returns (uint256) {

/// @audit missing @param for `_shares`
355:     function convertToAssets(uint256 _shares) public view returns (uint256) {

/// @audit missing @param for `_owner`
397:     function maxMint(address _owner) public view returns (uint256) {

/// @audit missing @param for `_owner`
404:     function maxWithdraw(address _owner) public view returns (uint256) {

/// @audit missing @param for `_owner`
415:     function maxRedeem(address _owner) public view returns (uint256) {

/// @audit missing @param for `_assets`
441:     function previewDeposit(uint256 _assets) public pure returns (uint256) {

/// @audit missing @param for `_shares`
447:     function previewMint(uint256 _shares) public pure returns (uint256) {

/// @audit missing @param for `_assets`
454:     function previewWithdraw(uint256 _assets) public view returns (uint256) {

/// @audit missing @param for `_shares`
470:     function previewRedeem(uint256 _shares) public view returns (uint256) {

/// @audit missing @param for `_assets`
/// @audit missing @param for `_receiver`
475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

/// @audit missing @param for `_shares`
/// @audit missing @param for `_receiver`
482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

/// @audit missing @param for `_assets`
/// @audit missing @param for `_receiver`
/// @audit missing @param for `_owner`
489:     function withdraw(
             uint256 _assets,
             address _receiver,
             address _owner
         ) external returns (uint256) {

/// @audit missing @param for `_shares`
/// @audit missing @param for `_receiver`
/// @audit missing @param for `_owner`
500:     function redeem(
             uint256 _shares,
             address _receiver,
             address _owner
         ) external returns (uint256) {

/// @audit missing @param for `_tokenOut`
631:     function liquidatableBalanceOf(address _tokenOut) public view returns (uint256) {

/// @audit missing @param for `_receiver`
/// @audit missing @param for `_tokenOut`
/// @audit missing @param for `_amountOut`
659:     function transferTokensOut(
             address,
             address _receiver,
             address _tokenOut,
             uint256 _amountOut
         ) public virtual onlyLiquidationPair returns (bytes memory) {

/// @audit missing @param for `_tokenIn`
/// @audit missing @param for `_amountIn`
703:     function verifyTokensIn(
             address _tokenIn,
             uint256 _amountIn,
             bytes calldata
         ) external onlyLiquidationPair {

/// @audit missing @param for `_tokenOut`
/// @audit missing @param for `_liquidationPair`
722:     function isLiquidationPair(
             address _tokenOut,
             address _liquidationPair
         ) external view returns (bool) {

```
*Github:* [[341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [355](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L355), [397](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L397), [404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [441](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L441), [447](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L447), [454](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L454), [470](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L470), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [631](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L631), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [703](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L703), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722)]


```solidity
File: src/TwabERC20.sol

/// @audit missing @param for `twabController_`
42:     constructor(
            string memory name_,
            string memory symbol_,
            TwabController twabController_
        ) ERC20(name_, symbol_) ERC20Permit(name_) {

/// @audit missing @param for `_account`
56:     function balanceOf(
            address _account
        ) public view virtual override(ERC20) returns (uint256) {

```
*Github:* [[42](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L42), [56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56)]


```solidity
File: src/abstract/Claimable.sol

/// @audit missing @param for `_winner`
/// @audit missing @param for `_tier`
/// @audit missing @param for `_prizeIndex`
/// @audit missing @param for `_reward`
/// @audit missing @param for `_rewardRecipient`
76:     function claimPrize(
            address _winner,
            uint8 _tier,
            uint32 _prizeIndex,
            uint96 _reward,
            address _rewardRecipient
        ) external onlyClaimer returns (uint256) {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]


</details>


<a name="NC-34"></a> 
### [NC-34] Missing NatSpec `@return` from function declaration
Some function definitions have an incomplete NatSpec: add a `@return` notation to improve the code documentation.

<details>
<summary>
There are <b>24</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

329:     function asset() external view returns (address) {

336:     function totalAssets() public view returns (uint256) {

341:     function convertToShares(uint256 _assets) public view returns (uint256) {

355:     function convertToAssets(uint256 _shares) public view returns (uint256) {

374:     function maxDeposit(address) public view returns (uint256) {

397:     function maxMint(address _owner) public view returns (uint256) {

404:     function maxWithdraw(address _owner) public view returns (uint256) {

415:     function maxRedeem(address _owner) public view returns (uint256) {

441:     function previewDeposit(uint256 _assets) public pure returns (uint256) {

447:     function previewMint(uint256 _shares) public pure returns (uint256) {

454:     function previewWithdraw(uint256 _assets) public view returns (uint256) {

470:     function previewRedeem(uint256 _shares) public view returns (uint256) {

475:     function deposit(uint256 _assets, address _receiver) external returns (uint256) {

482:     function mint(uint256 _shares, address _receiver) external returns (uint256) {

489:     function withdraw(
             uint256 _assets,
             address _receiver,
             address _owner
         ) external returns (uint256) {

500:     function redeem(
             uint256 _shares,
             address _receiver,
             address _owner
         ) external returns (uint256) {

631:     function liquidatableBalanceOf(address _tokenOut) public view returns (uint256) {

659:     function transferTokensOut(
             address,
             address _receiver,
             address _tokenOut,
             uint256 _amountOut
         ) public virtual onlyLiquidationPair returns (bytes memory) {

717:     function targetOf(address) external view returns (address) {

722:     function isLiquidationPair(
             address _tokenOut,
             address _liquidationPair
         ) external view returns (bool) {

```
*Github:* [[320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [336](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L336), [341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [355](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L355), [374](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L374), [397](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L397), [404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [441](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L441), [447](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L447), [454](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L454), [470](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L470), [475](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L475), [482](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L482), [489](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L489), [500](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L500), [631](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L631), [659](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L659), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717), [722](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L722)]


```solidity
File: src/TwabERC20.sol

56:     function balanceOf(
            address _account
        ) public view virtual override(ERC20) returns (uint256) {

63:     function totalSupply() public view virtual override(ERC20) returns (uint256) {

```
*Github:* [[56](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L56), [63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

76:     function claimPrize(
            address _winner,
            uint8 _tier,
            uint32 _prizeIndex,
            uint96 _reward,
            address _rewardRecipient
        ) external onlyClaimer returns (uint256) {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L76)]


</details>


<a name="NC-35"></a> 
### [NC-35] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

80:     uint32 public constant MAX_YIELD_FEE = 9e8;

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L80)]


```solidity
File: src/PrizeVaultFactory.sol

63:     uint256 public constant YIELD_BUFFER = 1e5;

```
*Github:* [[63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

21:     uint24 public constant HOOK_GAS = 150_000;

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L21)]



<a name="NC-36"></a> 
### [NC-36] Setters should prevent re-setting the same value
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

745:         liquidationPair = _liquidationPair;

951:         yieldFeePercentage = _yieldFeePercentage;

959:         yieldFeeRecipient = _yieldFeeRecipient;

```
*Github:* [[745](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L745), [951](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L951), [959](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L959)]


```solidity
File: src/abstract/Claimable.sol

130:         claimer = _claimer;

```
*Github:* [[130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L130)]


```solidity
File: src/abstract/HookManager.sol

30:         _hooks[msg.sender] = hooks;

```
*Github:* [[30](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L30)]



<a name="NC-37"></a> 
### [NC-37] State variables should include comments
Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There are <b>10</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

80:     uint32 public constant MAX_YIELD_FEE = 9e8;

112:     uint256 public immutable yieldBuffer;

119:     uint32 public yieldFeePercentage;

122:     address public yieldFeeRecipient;

125:     uint256 public yieldFeeBalance;

128:     address public liquidationPair;

138:     uint8 private immutable _underlyingDecimals;

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L80), [112](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L112), [119](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L119), [122](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L122), [125](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L125), [128](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L128), [138](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L138)]


```solidity
File: src/abstract/Claimable.sol

21:     uint24 public constant HOOK_GAS = 150_000;

27:     address public claimer;

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L21), [27](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L27)]



<a name="NC-38"></a> 
### [NC-38] Unnecessary cast
The variable is being cast to its own type.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit no need to cast `_liquidationPair` into address
743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

/// @audit no need to cast `_liquidationPair` into address
743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

/// @audit no need to cast `_liquidationPair` into address
747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

/// @audit no need to cast `_liquidationPair` into address
747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

```
*Github:* [[743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743), [743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747)]



<a name="NC-39"></a> 
### [NC-39] Unused `error` definition
The following `error`s are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion. Note that there may be cases where an error appears to be used because it has multiple definitions in different files. In such cases, the definitions should be moved to a separate file.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

206:     error SweepZeroAssets();

```
*Github:* [[206](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L206)]



<a name="NC-40"></a> 
### [NC-40] Unused arguments should be removed or implemented
Some arguments are never used: if this is intentional, consider removing these arguments from the function. Otherwise, implement the missing logic accordingly.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/interfaces/IVaultHooks.sol

/// @audit `winner`
/// @audit `tier`
/// @audit `prizeIndex`
/// @audit `reward`
/// @audit `rewardRecipient`
26:     function beforeClaimPrize(

/// @audit `winner`
/// @audit `tier`
/// @audit `prizeIndex`
/// @audit `prize`
/// @audit `recipient`
40:     function afterClaimPrize(

```
*Github:* [[26](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L26), [40](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L40)]



<a name="NC-41"></a> 
### [NC-41] Unused import
The identifier is imported but never used within the file.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `TwabController`
15: import { TwabController, SPONSORSHIP_ADDRESS } from "pt-v5-twab-controller/TwabController.sol";

```
*Github:* [[15](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L15)]



<a name="NC-42"></a> 
### [NC-42] Use `abi.encodeCall()` instead of `abi.encodeWithSignature()`/`abi.encodeWithSelector()`
`abi.encodeCall()` has compiler type safety, whereas the other two functions do not

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

774:             abi.encodeWithSelector(IERC20Metadata.decimals.selector)

```
*Github:* [[774](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L774)]



<a name="NC-43"></a> 
### [NC-43] Solidity compiler version is not fixed
To prevent the actual contracts deployed from behaving differently depending on the compiler version, it is recommended to use a fixed solidity version.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L2)]


```solidity
File: src/PrizeVaultFactory.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L2)]


```solidity
File: src/TwabERC20.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L2)]


```solidity
File: src/abstract/Claimable.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L2)]


```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]


```solidity
File: src/interfaces/IVaultHooks.sol

2: pragma solidity ^0.8.24;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L2)]



<a name="NC-44"></a> 
### [NC-44] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

80:     uint32 public constant MAX_YIELD_FEE = 9e8;

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L80)]


```solidity
File: src/PrizeVaultFactory.sol

63:     uint256 public constant YIELD_BUFFER = 1e5;

```
*Github:* [[63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

21:     uint24 public constant HOOK_GAS = 150_000;

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L21)]



<a name="NC-45"></a> 
### [NC-45] Use `@inheritdoc` for overridden functions

*There are <b>3</b> instances of this issue:*
```solidity
File: src/TwabERC20.sol

76:     function _mint(address _receiver, uint256 _amount) internal virtual override {

87:     function _burn(address _owner, uint256 _amount) internal virtual override {

100:     function _transfer(address _from, address _to, uint256 _amount) internal virtual override {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L76), [87](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L87), [100](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L100)]



<a name="NC-46"></a> 
### [NC-46] Upgrade `openzeppelin` to the latest version (`5.0.1`)
These contracts import contracts from openzeppelin contracts but they are not using the latest version. For more information, please visit: [OpenZeppelin GitHub Releases](https://github.com/OpenZeppelin/openzeppelin-contracts/releases) It is recommended to always use the latest version to take advantage of updates and security fixes.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="NC-47"></a> 
### [NC-47] Use the latest solidity version for deployment (`0.8.24`)
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

*There is one instance of this issue:*
```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]



<a name="NC-48"></a> 
### [NC-48] Use the Modern Upgradeable Contract Paradigm
Modern smart contract development often employs upgradeable contract structures, utilizing proxy patterns like OpenZeppelins Upgradeable Contracts. This paradigm separates logic and state, allowing developers to amend and enhance the contract's functionality without altering its state or the deployed contract address. Transitioning to this approach enhances long-term maintainability.

Resolution: Adopt a well-established proxy pattern for upgradeability, ensuring proper initialization and employing transparent proxies to mitigate potential risks. Embrace comprehensive testing and audit practices, particularly when updating contract logic, to ensure state consistency and security are preserved across upgrades. This ensures your contract remains robust and adaptable to future requirements.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]


```solidity
File: src/PrizeVaultFactory.sol

13: contract PrizeVaultFactory {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L13)]


```solidity
File: src/TwabERC20.sol

19: contract TwabERC20 is ERC20, ERC20Permit {

```
*Github:* [[19](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L19)]


```solidity
File: src/abstract/Claimable.sol

13: abstract contract Claimable is HookManager, IClaimable {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L13)]


```solidity
File: src/abstract/HookManager.sol

9: abstract contract HookManager {

```
*Github:* [[9](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L9)]



<a name="NC-49"></a> 
### [NC-49] Consider using modifiers for address control
Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

261:         if (msg.sender != liquidationPair) {

269:         if (msg.sender != yieldFeeRecipient) {

532:         if (_owner != msg.sender) {

```
*Github:* [[261](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L261), [269](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L269), [532](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L532)]


```solidity
File: src/abstract/Claimable.sol

53:         if (msg.sender != claimer) revert CallerNotClaimer(msg.sender, claimer);

```
*Github:* [[53](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L53)]



<a name="NC-50"></a> 
### [NC-50] Use of `override` is unnecessary
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/TwabERC20.sol

76:     function _mint(address _receiver, uint256 _amount) internal virtual override {

87:     function _burn(address _owner, uint256 _amount) internal virtual override {

100:     function _transfer(address _from, address _to, uint256 _amount) internal virtual override {

```
*Github:* [[76](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L76), [87](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L87), [100](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L100)]



<a name="NC-51"></a> 
### [NC-51] Use a struct to encapsulate multiple function parameters
If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

/// @audit 8 parameters
92:     function deployVault(
          string memory _name,
          string memory _symbol,
          IERC4626 _yieldVault,
          PrizePool _prizePool,
          address _claimer,
          address _yieldFeeRecipient,
          uint32 _yieldFeePercentage,
          address _owner
        ) external returns (PrizeVault) {

```
*Github:* [[92](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L92)]



<a name="NC-52"></a> 
### [NC-52] Event is missing `indexed` fields
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

150:     event YieldFeePercentageSet(uint256 yieldFeePercentage);

156:     event Sponsor(address indexed caller, uint256 assets, uint256 shares);

175:     event ClaimYieldFeeShares(address indexed recipient, uint256 shares);

```
*Github:* [[150](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L150), [156](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L156), [175](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L175)]


```solidity
File: src/abstract/HookManager.sol

14:     event SetHooks(address indexed account, VaultHooks hooks);

```
*Github:* [[14](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L14)]



<a name="NC-53"></a> 
### [NC-53] Functions not used internally could be marked `external`

*There are <b>7</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

341:     function convertToShares(uint256 _assets) public view returns (uint256) {

397:     function maxMint(address _owner) public view returns (uint256) {

404:     function maxWithdraw(address _owner) public view returns (uint256) {

415:     function maxRedeem(address _owner) public view returns (uint256) {

584:     function totalYieldBalance() public view returns (uint256) {

631:     function liquidatableBalanceOf(address _tokenOut) public view returns (uint256) {

```
*Github:* [[320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [341](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L341), [397](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L397), [404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [584](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L584), [631](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L631)]



<a name="NC-54"></a> 
### [NC-54] Default address(0) can be returned
Allowing a function in Solidity to return the default address (address(0)) can be problematic as it can represent uninitialized or invalid addresses. If such an address is utilized in transfer operations or other sensitive actions, it could lead to loss of funds or unpredicted behavior. It's prudent to include checks in your functions to prevent the return of the zero address, enhancing contract security.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `address `
329:     function asset() external view returns (address) {

/// @audit `address `
717:     function targetOf(address) external view returns (address) {

```
*Github:* [[329](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L329), [717](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L717)]


```solidity
File: src/interfaces/IVaultHooks.sol

/// @audit `address `
26:     function beforeClaimPrize(

```
*Github:* [[26](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L26)]




## Gas Optimizations

<a name="GAS-1"></a> 
### [GAS-1] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/)]



<a name="GAS-2"></a> 
### [GAS-2] Divisions can be `unchecked` to save gas
The expression `type(int).min/(-1)` is the only case where division causes an overflow. Therefore, uncheck can be used to [save gas](https://gist.github.com/DadeKuma/3bc597338ae774b8b3bd43280d55271f) in scenarios where it is certain that such an overflow will not occur.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

675:             _yieldFee = (_amountOut * FEE_PRECISION) / (FEE_PRECISION - _yieldFeePercentage) - _amountOut;

```
*Github:* [[675](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L675)]



<a name="GAS-3"></a> 
### [GAS-3] Don't caching global special variables
It's better not to cache the global special variables, because it's cheaper to use them directly (e.g. `msg.sender`).

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

553:         address _owner = msg.sender;

```
*Github:* [[553](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L553)]



<a name="GAS-4"></a> 
### [GAS-4] Don't transfer with zero amount to save gas
In Solidity, unnecessary operations can waste gas. For example, a transfer function without a zero amount check uses gas even if called with a zero amount, since the contract state remains unchanged. Implementing a zero amount check avoids these unnecessary function calls, saving gas and improving efficiency.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

939:             _asset.transfer(_receiver, _assets);

```
*Github:* [[939](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L939)]


```solidity
File: src/TwabERC20.sol

101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]



<a name="GAS-5"></a> 
### [GAS-5] Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `yieldFeeBalance -=`
617:         yieldFeeBalance -= _yieldFeeBalance;

/// @audit `yieldFeeBalance +=`
685:             yieldFeeBalance += _yieldFee;

```
*Github:* [[617](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L617), [685](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L685)]



<a name="GAS-6"></a> 
### [GAS-6] Inline `modifier`s that are only used once, to save gas

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

268:     modifier onlyYieldFeeRecipient() {

```
*Github:* [[268](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L268)]


```solidity
File: src/abstract/Claimable.sol

52:     modifier onlyClaimer() {

```
*Github:* [[52](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L52)]



<a name="GAS-7"></a> 
### [GAS-7] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `_tryGetAssetDecimals` is used only once
772:     function _tryGetAssetDecimals(IERC20 asset_) internal view returns (bool, uint8) {

```
*Github:* [[772](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L772)]


```solidity
File: src/TwabERC20.sol

/// @audit `_burn` is used only once
87:     function _burn(address _owner, uint256 _amount) internal virtual override {

```
*Github:* [[87](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L87)]



<a name="GAS-8"></a> 
### [GAS-8] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

*There are <b>8</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

390:             return twabSupplyLimit_ < _maxDeposit ? twabSupplyLimit_ : _maxDeposit;

409:         return _ownerAssets < _maxWithdraw ? _ownerAssets : _maxWithdraw;

422:         if (_ownerShares > _maxWithdraw) {

615:         if (_shares > _yieldFeeBalance) revert SharesExceedsYieldFeeBalance(_shares, _yieldFeeBalance);

679:         if (_amountOut + _yieldFee > _availableYield) {

684:         if (_yieldFee > 0) {

932:         if (_assets > _latentAssets) {

948:         if (_yieldFeePercentage > MAX_YIELD_FEE) {

```
*Github:* [[390](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L390), [409](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L409), [422](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L422), [615](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L615), [679](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L679), [684](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L684), [932](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L932), [948](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L948)]



<a name="GAS-9"></a> 
### [GAS-9] Optimize names to save gas
`public`/`external` function names and `public` member variable names can be optimized to save gas. See this [link](https://gist.github.com/IllIllI000/a5d8b486a8259f9f77891a919febd1a9) for an example of how it works. Below are the interfaces/abstract contracts that can be optimized so that the most frequently-called functions use the least amount of gas possible during method lookup. Method IDs that have two leading zero bytes can save 128 gas each during deployment, and renaming functions to have lower method IDs will save 22 gas per call, [per sorted position shifted](https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92)

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `decimals`, `asset`, `totalAssets`, `convertToShares`, `convertToAssets`, `maxDeposit`, `maxMint`, `maxWithdraw`, `maxRedeem`, `previewDeposit`, `previewMint`, `previewWithdraw`, `previewRedeem`, `deposit`, `mint`, `withdraw`, `redeem`, `depositWithPermit`, `sponsor`, `totalDebt`, `totalYieldBalance`, `availableYieldBalance`, `currentYieldBuffer`, `claimYieldFeeShares`, `liquidatableBalanceOf`, `transferTokensOut`, `verifyTokensIn`, `targetOf`, `isLiquidationPair`, `setClaimer`, `setLiquidationPair`, `setYieldFeePercentage`, `setYieldFeeRecipient`
65: contract PrizeVault is TwabERC20, Claimable, IERC4626, ILiquidationSource, Ownable {

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L65)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit `deployVault`, `totalVaults`
13: contract PrizeVaultFactory {

```
*Github:* [[13](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L13)]


```solidity
File: src/TwabERC20.sol

/// @audit `balanceOf`, `totalSupply`
19: contract TwabERC20 is ERC20, ERC20Permit {

```
*Github:* [[19](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L19)]



<a name="GAS-10"></a> 
### [GAS-10] Reduce gas usage by moving to Solidity 0.8.19 or later
Solidity version 0.8.19 introduced a number of gas optimizations, refer to the [Solidity 0.8.19 Release Announcement](https://soliditylang.org/blog/2023/02/22/solidity-0.8.19-release-announcement/) for details.

*There is one instance of this issue:*
```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]



<a name="GAS-11"></a> 
### [GAS-11] Redundant state variable getters
Getters for public state variables are automatically generated so there is no need to code them manually and waste gas.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {
             return _underlyingDecimals;

```
*Github:* [[320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320)]



<a name="GAS-12"></a> 
### [GAS-12] The result of a function call should be cached rather than re-calling the function
The function calls in solidity are expensive. If the same result of the same function calls are to be used several times, the result should be cached to reduce the gas consumption of repeated calls.

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `balanceOf` is called 2 times
404:     function maxWithdraw(address _owner) public view returns (uint256) {

/// @audit `balanceOf` is called 2 times
415:     function maxRedeem(address _owner) public view returns (uint256) {

/// @audit `mint` is called 2 times
843:     function _depositAndMint(address _caller, address _receiver, uint256 _assets, uint256 _shares) internal {

```
*Github:* [[404](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L404), [415](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L415), [843](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L843)]



<a name="GAS-13"></a> 
### [GAS-13] Optimize external calls with assembly for memory efficiency
Using interfaces to make external contract calls in Solidity is convenient but can be inefficient in terms of memory utilization. Each such call involves creating a new memory location to store the data being passed, thus incurring memory expansion costs.

Inline assembly allows for optimized memory usage by re-using already allocated memory spaces or using the scratch space for smaller datasets. This can result in notable gas savings, especially for contracts that make frequent external calls.

Additionally, using inline assembly enables important safety checks like verifying if the target address has code deployed to it using `extcodesize(addr)` before making the call, mitigating risks associated with contract interactions.

<details>
<summary>
There are <b>13</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

/// @audit `.permit(...)`
540:             IERC20Permit(address(_asset)).permit(_owner, address(this), _assets, _deadline, _v, _r, _s);

/// @audit `.sponsor(...)`
559:             twabController.sponsor(_owner);

/// @audit `.contributePrizeTokens(...)`
713:         prizePool.contributePrizeTokens(address(this), _amountIn);

/// @audit `.safeTransferFrom(...)`
854:         _asset.safeTransferFrom(

/// @audit `.approve(...)`
862:         _asset.approve(address(yieldVault), _assetsWithDust);

/// @audit `.approve(...)`
869:             _asset.approve(address(yieldVault), 0);

/// @audit `.redeem(...)`
936:             yieldVault.redeem(_yieldVaultShares, address(this), address(this));

/// @audit `.transfer(...)`
939:             _asset.transfer(_receiver, _assets);

```
*Github:* [[540](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L540), [559](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L559), [713](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L713), [854](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L854), [862](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L862), [869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869), [936](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L936), [939](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L939)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit `.transferFrom(...)`
118:         IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

/// @audit `.asset(...)`
118:         IERC20(_vault.asset()).transferFrom(msg.sender, address(_vault), YIELD_BUFFER);

```
*Github:* [[118](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L118), [118](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L118)]


```solidity
File: src/TwabERC20.sol

/// @audit `.mint(...)`
77:         twabController.mint(_receiver, SafeCast.toUint96(_amount));

/// @audit `.burn(...)`
88:         twabController.burn(_owner, SafeCast.toUint96(_amount));

/// @audit `.transfer(...)`
101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[77](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L77), [88](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L88), [101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]


</details>


<a name="GAS-14"></a> 
### [GAS-14] Use assembly to compute hashes to save gas
If the arguments to the encode call can fit into the scratch space (two words or fewer), then it's more efficient to use assembly to generate the hash (80 gas):

`keccak256(abi.encodePacked(x, y)) -> assembly {mstore(0x00, a); mstore(0x20, b); let hash := keccak256(0x00, 0x40); }`

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

103:             salt: keccak256(abi.encode(msg.sender, deployerNonces[msg.sender]++))

```
*Github:* [[103](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L103)]



<a name="GAS-15"></a> 
### [GAS-15] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

562:         emit Sponsor(_owner, _assets, _shares);

621:         emit ClaimYieldFeeShares(msg.sender, _shares);

697:         emit TransferYieldOut(msg.sender, _tokenOut, _receiver, _amountOut, _yieldFee);

747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

876:         emit Deposit(_caller, _receiver, _assets, _shares);

909:         emit Withdraw(_caller, _receiver, _owner, _assets, _shares);

952:         emit YieldFeePercentageSet(_yieldFeePercentage);

960:         emit YieldFeeRecipientSet(_yieldFeeRecipient);

```
*Github:* [[562](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L562), [621](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L621), [697](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L697), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [876](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L876), [909](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L909), [952](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L952), [960](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L960)]


```solidity
File: src/PrizeVaultFactory.sol

123:         emit NewPrizeVault(

```
*Github:* [[123](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L123)]


```solidity
File: src/TwabERC20.sol

78:         emit Transfer(address(0), _receiver, _amount);

89:         emit Transfer(_owner, address(0), _amount);

102:         emit Transfer(_from, _to, _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89), [102](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L102)]


```solidity
File: src/abstract/Claimable.sol

131:         emit ClaimerSet(_claimer);

```
*Github:* [[131](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L131)]


```solidity
File: src/abstract/HookManager.sol

31:         emit SetHooks(msg.sender, hooks);

```
*Github:* [[31](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L31)]


</details>


<a name="GAS-16"></a> 
### [GAS-16] Use assembly to validate `msg.sender`

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

261:         if (msg.sender != liquidationPair) {

269:         if (msg.sender != yieldFeeRecipient) {

532:         if (_owner != msg.sender) {

```
*Github:* [[261](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L261), [269](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L269), [532](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L532)]


```solidity
File: src/abstract/Claimable.sol

53:         if (msg.sender != claimer) revert CallerNotClaimer(msg.sender, claimer);

```
*Github:* [[53](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L53)]



<a name="GAS-17"></a> 
### [GAS-17] Use assembly to write address/contract type storage values
Using `assembly { sstore(state.slot, addr)` instead of `state = addr` can save gas.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

306:         _asset = asset_;

308:         yieldVault = yieldVault_;

745:         liquidationPair = _liquidationPair;

959:         yieldFeeRecipient = _yieldFeeRecipient;

```
*Github:* [[306](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L306), [308](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L308), [745](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L745), [959](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L959)]


```solidity
File: src/TwabERC20.sol

48:         twabController = twabController_;

```
*Github:* [[48](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L48)]


```solidity
File: src/abstract/Claimable.sol

66:         prizePool = prizePool_;

130:         claimer = _claimer;

```
*Github:* [[66](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L66), [130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L130)]



<a name="GAS-18"></a> 
### [GAS-18] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

726:         return (_tokenOut == address(_asset) || _tokenOut == address(this)) && _liquidationPair == liquidationPair;

776:         if (success && encodedDecimals.length >= 32) {

```
*Github:* [[726](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L726), [776](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L776)]



<a name="GAS-19"></a> 
### [GAS-19] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

*There is one instance of this issue:*
```solidity
File: src/abstract/HookManager.sol

2: pragma solidity ^0.8.0;

```
*Github:* [[2](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L2)]



<a name="GAS-20"></a> 
### [GAS-20] Use != 0 instead of > 0
Replace spotted instances with != 0 for uints as this uses less gas.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

684:         if (_yieldFee > 0) {

```
*Github:* [[684](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L684)]



<a name="GAS-21"></a> 
### [GAS-21] Consider Using Solady's Gas Optimized Lib for Math
In instances where many similar mathematical operations are performed, consider using Solday's math lib to benefit from the gas saving it can introduce.

*There is one instance of this issue:*
```solidity
File: src/PrizeVault.sol

675:             _yieldFee = (_amountOut * FEE_PRECISION) / (FEE_PRECISION - _yieldFeePercentage) - _amountOut;

```
*Github:* [[675](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L675)]



<a name="GAS-22"></a> 
### [GAS-22] Use solady library where possible to save gas
The following OpenZeppelin imports have a Solady equivalent, as such they can be used to save GAS as Solady modules have been specifically designed to be as GAS efficient as possible

*There are <b>3</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

5: import { SafeERC20, IERC20Permit } from "openzeppelin/token/ERC20/utils/SafeERC20.sol";

6: import { ERC20, IERC20, IERC20Metadata } from "openzeppelin/token/ERC20/ERC20.sol";

```
*Github:* [[5](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L5), [6](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L6)]


```solidity
File: src/TwabERC20.sol

4: import { ERC20 } from "openzeppelin/token/ERC20/ERC20.sol";

```
*Github:* [[4](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L4)]



<a name="GAS-23"></a> 
### [GAS-23] Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes
Avoids a Gsset (20000 gas) when changing from false to true, after having been true in the past. Since most of the bools aren't changed twice in one transaction, I've counted the amount of gas as half of the full amount, for each variable.

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

69:     mapping(address vault => bool deployedByFactory) public deployedVaults;

```
*Github:* [[69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L69)]



<a name="GAS-24"></a> 
### [GAS-24] Use `unchecked` block for safe subtractions
If it can be confirmed that the subtraction operation will not overflow, using an unchecked block can save gas. For example, `require(x <= y); z = y - x;` can be optimized to `require(x <= y); unchecked { z = y - x; }`

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit this subtraction is checked on line 384
388:                 _maxDeposit = _maxYieldVaultDeposit - _latentBalance;

/// @audit this subtraction is checked on line 344
813:                 return _totalAssets - totalDebt_;

/// @audit this subtraction is checked on line 600
828:                 return totalYieldBalance_ - _yieldBuffer;

/// @audit this subtraction is checked on line 932
934:             uint256 _yieldVaultShares = yieldVault.previewWithdraw(_assets - _latentAssets);

```
*Github:* [[388](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L388), [813](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L813), [828](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L828), [934](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L934)]



<a name="GAS-25"></a> 
### [GAS-25] Using bitmap to store bool states can save gas
Using a bitmap instead of a bool array or a bool mapping to store boolean states can save gas fees. This is because the bitmap can store 256 boolean values in a single slot instead of 256 slots, which can save gas when writing bool values or when reading multiple bool values from the same slot.

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

69:     mapping(address vault => bool deployedByFactory) public deployedVaults;

```
*Github:* [[69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L69)]



<a name="GAS-26"></a> 
### [GAS-26] `abi.encodePacked` is more gas efficient than `abi.encode`
`abi.encode` pads all elementary types to 32 bytes, whereas `abi.encodePacked` will only use the minimal required memory to encode the data. See [here](https://docs.soliditylang.org/en/v0.8.11/abi-spec.html?highlight=encodepacked#non-standard-packed-mode) for more info.

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

103:             salt: keccak256(abi.encode(msg.sender, deployerNonces[msg.sender]++))

```
*Github:* [[103](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L103)]



<a name="GAS-27"></a> 
### [GAS-27] Using bools for storage incurs overhead
Use uint256(1) and uint256(2) for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from false to true, after having been true in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*There is one instance of this issue:*
```solidity
File: src/PrizeVaultFactory.sol

69:     mapping(address vault => bool deployedByFactory) public deployedVaults;

```
*Github:* [[69](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L69)]



<a name="GAS-28"></a> 
### [GAS-28] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*There are <b>6</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit make `name_` as a calldata
290:         string memory name_,

/// @audit make `symbol_` as a calldata
291:         string memory symbol_,

```
*Github:* [[290](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L290), [291](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L291)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit make `_name` as a calldata
93:       string memory _name,

/// @audit make `_symbol` as a calldata
94:       string memory _symbol,

```
*Github:* [[93](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L93), [94](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L94)]


```solidity
File: src/TwabERC20.sol

/// @audit make `name_` as a calldata
43:         string memory name_,

/// @audit make `symbol_` as a calldata
44:         string memory symbol_,

```
*Github:* [[43](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L43), [44](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L44)]



<a name="GAS-29"></a> 
### [GAS-29] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

<details>
<summary>
There are <b>27</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

80:     uint32 public constant MAX_YIELD_FEE = 9e8;

119:     uint32 public yieldFeePercentage;

138:     uint8 private immutable _underlyingDecimals;

296:         uint32 yieldFeePercentage_,

304:         (bool success, uint8 assetDecimals) = _tryGetAssetDecimals(asset_);

320:     function decimals() public view override(ERC20, IERC20Metadata) returns (uint8) {

528:         uint8 _v,

668:         uint32 _yieldFeePercentage = yieldFeePercentage;

753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

772:     function _tryGetAssetDecimals(IERC20 asset_) internal view returns (bool, uint8) {

778:             if (returnedDecimals <= type(uint8).max) {

779:                 return (true, uint8(returnedDecimals));

800:             return type(uint96).max - _totalSupply;

947:     function _setYieldFeePercentage(uint32 _yieldFeePercentage) internal {

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L80), [119](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L119), [138](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L138), [296](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L296), [304](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L304), [320](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L320), [528](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L528), [668](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L668), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [772](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L772), [778](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L778), [779](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L779), [800](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L800), [947](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L947)]


```solidity
File: src/PrizeVaultFactory.sol

99:       uint32 _yieldFeePercentage,

```
*Github:* [[99](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L99)]


```solidity
File: src/TwabERC20.sol

77:         twabController.mint(_receiver, SafeCast.toUint96(_amount));

88:         twabController.burn(_owner, SafeCast.toUint96(_amount));

101:         twabController.transfer(_from, _to, SafeCast.toUint96(_amount));

```
*Github:* [[77](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L77), [88](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L88), [101](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L101)]


```solidity
File: src/abstract/Claimable.sol

78:         uint8 _tier,

79:         uint32 _prizeIndex,

80:         uint96 _reward,

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L78), [79](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L79), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L80)]


```solidity
File: src/interfaces/IVaultHooks.sol

28:         uint8 tier,

29:         uint32 prizeIndex,

30:         uint96 reward,

42:         uint8 tier,

43:         uint32 prizeIndex,

```
*Github:* [[28](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L28), [29](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L29), [30](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L30), [42](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L42), [43](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/interfaces/IVaultHooks.sol#L43)]


</details>


<a name="GAS-30"></a> 
### [GAS-30] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There is one instance of this issue:*
```solidity
File: src/abstract/Claimable.sol

64:     constructor(PrizePool prizePool_, address claimer_) {

```
*Github:* [[64](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L64)]



<a name="GAS-31"></a> 
### [GAS-31] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided.

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

611:     function claimYieldFeeShares(uint256 _shares) external onlyYieldFeeRecipient {

735:     function setClaimer(address _claimer) external onlyOwner {

742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {

753:     function setYieldFeePercentage(uint32 _yieldFeePercentage) external onlyOwner {

759:     function setYieldFeeRecipient(address _yieldFeeRecipient) external onlyOwner {

```
*Github:* [[611](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L611), [735](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L735), [742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742), [753](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L753), [759](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L759)]



<a name="GAS-32"></a> 
### [GAS-32] Using `private` rather than `public` for constants, saves gas
If needed, the values can be read from the verified contract source code, or if there are multiple values there can be a single getter function that [returns a tuple](https://github.com/code-423n4/2022-08-frax/blob/90f55a9ce4e25bceed3a74290b854341d8de6afa/src/contracts/FraxlendPair.sol#L156-L178) of the values of all currently-public constants. Saves **3406-3606 gas** in deployment gas due to the compiler not having to create non-payable getter functions for deployment calldata, not having to store the bytes of the value outside of where it's used, and not adding another entry to the method ID table

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

74:     uint32 public constant FEE_PRECISION = 1e9;

80:     uint32 public constant MAX_YIELD_FEE = 9e8;

```
*Github:* [[74](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L74), [80](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L80)]


```solidity
File: src/PrizeVaultFactory.sol

63:     uint256 public constant YIELD_BUFFER = 1e5;

```
*Github:* [[63](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L63)]


```solidity
File: src/abstract/Claimable.sol

21:     uint24 public constant HOOK_GAS = 150_000;

```
*Github:* [[21](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L21)]



<a name="GAS-33"></a> 
### [GAS-33] Use assembly to check for `address(0)`
Saves 6 gas per instance.

*There are <b>7</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

300:         if (address(yieldVault_) == address(0)) revert YieldVaultZeroAddress();

301:         if (owner_ == address(0)) revert OwnerZeroAddress();

743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

```
*Github:* [[300](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L300), [301](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L301), [743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743)]


```solidity
File: src/TwabERC20.sol

47:         if (address(0) == address(twabController_)) revert TwabControllerZeroAddress();

```
*Github:* [[47](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L47)]


```solidity
File: src/abstract/Claimable.sol

65:         if (address(prizePool_) == address(0)) revert PrizePoolZeroAddress();

97:         if (recipient == address(0)) revert ClaimRecipientZeroAddress();

129:         if (_claimer == address(0)) revert ClaimerZeroAddress();

```
*Github:* [[65](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L65), [97](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L97), [129](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L129)]



<a name="GAS-34"></a> 
### [GAS-34] Avoid updating storage when the value hasn't changed
In Ethereum, updating storage is costly in terms of gas. Therefore, it's beneficial to avoid redundant updates, particularly when the value being written is identical to the existing one. A comparison check before updating can prevent unnecessary operations, thus saving gas. The resolution could involve implementing a conditional check in your function to verify if the new value differs from the current one. If it's the same, the function could simply return without proceeding to the costly storage update. This simple adjustment in your code can lead to significant gas savings in scenarios where redundant updates might occur frequently.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

305:         _underlyingDecimals = success ? assetDecimals : 18;

306:         _asset = asset_;

308:         yieldVault = yieldVault_;

309:         yieldBuffer = yieldBuffer_;

617:         yieldFeeBalance -= _yieldFeeBalance;

685:             yieldFeeBalance += _yieldFee;

745:         liquidationPair = _liquidationPair;

951:         yieldFeePercentage = _yieldFeePercentage;

959:         yieldFeeRecipient = _yieldFeeRecipient;

```
*Github:* [[305](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L305), [306](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L306), [308](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L308), [309](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L309), [617](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L617), [685](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L685), [745](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L745), [951](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L951), [959](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L959)]


```solidity
File: src/PrizeVaultFactory.sol

121:         deployedVaults[address(_vault)] = true;

```
*Github:* [[121](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L121)]


```solidity
File: src/TwabERC20.sol

48:         twabController = twabController_;

```
*Github:* [[48](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L48)]


```solidity
File: src/abstract/Claimable.sol

66:         prizePool = prizePool_;

130:         claimer = _claimer;

```
*Github:* [[66](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L66), [130](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/Claimable.sol#L130)]


```solidity
File: src/abstract/HookManager.sol

30:         _hooks[msg.sender] = hooks;

```
*Github:* [[30](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L30)]


</details>


<a name="GAS-35"></a> 
### [GAS-35] Cache address(this) when used more than once

*There are <b>5</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit `address(this)` is used more than once in this function
383:         uint256 _maxYieldVaultDeposit = yieldVault.maxDeposit(address(this));

/// @audit `address(this)` is used more than once in this function
540:             IERC20Permit(address(_asset)).permit(_owner, address(this), _assets, _deadline, _v, _r, _s);

/// @audit `address(this)` is used more than once in this function
639:             _maxAmountOut = _maxYieldVaultWithdraw() + _asset.balanceOf(address(this));

/// @audit `address(this)` is used more than once in this function
866:         uint256 _assetsUsed = yieldVault.mint(_yieldVaultShares, address(this));

/// @audit `address(this)` is used more than once in this function
938:         if (_receiver != address(this)) {

```
*Github:* [[383](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L383), [540](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L540), [639](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L639), [866](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L866), [938](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L938)]



<a name="GAS-36"></a> 
### [GAS-36] Unnecessary casting as variable is already of the same type
Unnecessary casting of a variable to the same type is redundant and can contribute to gas inefficiency and code clutter. This situation commonly arises when developers, perhaps due to oversight or misunderstanding, explicitly cast a variable to its existing type. For example, casting a uint256 variable to uint256 again does not change its type or value but adds unnecessary operations to the code.

Resolution: Developers should scrutinize their code to identify and remove any unnecessary type casting. Utilizing linters or static analysis tools can aid in detecting such redundancies. Ensuring that the code is clean and efficient not only saves gas but also enhances readability and maintainability.

*There are <b>4</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

/// @audit no need to cast `_liquidationPair` into address
743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

/// @audit no need to cast `_liquidationPair` into address
743:         if (address(_liquidationPair) == address(0)) revert LPZeroAddress();

/// @audit no need to cast `_liquidationPair` into address
747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

/// @audit no need to cast `_liquidationPair` into address
747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

```
*Github:* [[743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743), [743](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L743), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747)]



<a name="GAS-37"></a> 
### [GAS-37] Where a value is casted more than once, consider caching the result to save gas
Casting values multiple times in Solidity can be gas-inefficient. When a value undergoes repeated type conversions, the EVM must execute additional operations for each cast, consuming more gas than necessary. To optimize for gas efficiency, cache the result of the initial cast in a local variable and reuse it, rather than performing multiple casts. This not only conserves gas but also enhances code readability, reducing potential error points. For example, instead of repeatedly casting an address to uint256, cast once, store the result in a local variable, and reference that variable in subsequent operations.

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: src/PrizeVault.sol

/// @audit `address(this)` is casted more than once in this function
337:         return yieldVault.convertToAssets(yieldVault.balanceOf(address(this))) + _asset.balanceOf(address(this));

/// @audit `address(this)` is casted more than once in this function
383:         uint256 _maxYieldVaultDeposit = yieldVault.maxDeposit(address(this));

/// @audit `address(this)` is casted more than once in this function
540:             IERC20Permit(address(_asset)).permit(_owner, address(this), _assets, _deadline, _v, _r, _s);

/// @audit `address(this)` is casted more than once in this function
639:             _maxAmountOut = _maxYieldVaultWithdraw() + _asset.balanceOf(address(this));

/// @audit `address(_liquidationPair)` is casted more than once in this function
747:         emit LiquidationPairSet(address(this), address(_liquidationPair));

/// @audit `address(this)` is casted more than once in this function
861:         uint256 _assetsWithDust = _asset.balanceOf(address(this));

/// @audit `address(this)` is casted more than once in this function
866:         uint256 _assetsUsed = yieldVault.mint(_yieldVaultShares, address(this));

/// @audit `address(yieldVault)` is casted more than once in this function
869:             _asset.approve(address(yieldVault), 0);

/// @audit `address(this)` is casted more than once in this function
936:             yieldVault.redeem(_yieldVaultShares, address(this), address(this));

/// @audit `address(this)` is casted more than once in this function
936:             yieldVault.redeem(_yieldVaultShares, address(this), address(this));

/// @audit `address(this)` is casted more than once in this function
938:         if (_receiver != address(this)) {

```
*Github:* [[337](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L337), [383](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L383), [540](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L540), [639](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L639), [747](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L747), [861](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L861), [866](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L866), [869](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L869), [936](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L936), [936](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L936), [938](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L938)]


```solidity
File: src/PrizeVaultFactory.sol

/// @audit `address(_vault)` is casted more than once in this function
121:         deployedVaults[address(_vault)] = true;

```
*Github:* [[121](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVaultFactory.sol#L121)]


</details>


<a name="GAS-38"></a> 
### [GAS-38] It is a waste of GAS to emit variable literals
Emitting variable literals (true, false, 'hello', 1 etc...) in events is inefficient, as it consumes extra gas without providing added value. These literals are fixed values that can be accessed or hardcoded elsewhere in the smart contract or application, making their inclusion in events redundant and an unnecessary drain on resources during transaction execution.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/TwabERC20.sol

/// @audit `address(0)`
78:         emit Transfer(address(0), _receiver, _amount);

/// @audit `address(0)`
89:         emit Transfer(_owner, address(0), _amount);

```
*Github:* [[78](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L78), [89](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/TwabERC20.sol#L89)]



<a name="GAS-39"></a> 
### [GAS-39] Only emit event in setter function if the state variable was changed
Emitting events in setter functions of smart contracts only when state variables change saves gas. This is because emitting events consumes gas, and unnecessary events, where no actual state change occurs, lead to wasteful consumption.

*There are <b>2</b> instances of this issue:*
```solidity
File: src/PrizeVault.sol

742:     function setLiquidationPair(address _liquidationPair) external onlyOwner {
             if (address(_liquidationPair) == address(0)) revert LPZeroAddress();
     
             liquidationPair = _liquidationPair;
     
             emit LiquidationPairSet(address(this), address(_liquidationPair));

```
*Github:* [[742](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/PrizeVault.sol#L742)]


```solidity
File: src/abstract/HookManager.sol

29:     function setHooks(VaultHooks calldata hooks) external {
            _hooks[msg.sender] = hooks;
            emit SetHooks(msg.sender, hooks);

```
*Github:* [[29](https://github.com/code-423n4/2024-03-pooltogether/blob/004e027de5569cca5790e6ed80fa51d026df9b75/pt-v5-vault/src/abstract/HookManager.sol#L29)]



