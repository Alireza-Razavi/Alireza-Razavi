# Report

Audit report for **2023-10-ethena** generated by *ubl4nk_bot*.

## Medium Issues


*Total <b>33</b> instances over <b>3</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [M-1](#M-1) | The remaining ETH may be locked in the contract after call | 2 |
| [M-2](#M-2) | Return values of `transfer()`/`transferFrom()` not checked | 1 |
| [M-3](#M-3) | Centralization Risk for trusted owners | 30 |

## Low Issues


*Total <b>64</b> instances over <b>21</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [L-1](#L-1) | Missing zero address check in functions with address parameters | 22 |
| [L-2](#L-2) | Check division by zero is prevented | 2 |
| [L-3](#L-3) | Consider implementing two-step procedure for updating protocol addresses | 1 |
| [L-4](#L-4) | Constructor / initialization function lacks parameter validation | 2 |
| [L-5](#L-5) | External call recipient can consume all remaining gas | 2 |
| [L-6](#L-6) | External function calls within loops | 1 |
| [L-7](#L-7) | Governance functions should be controlled by time locks | 4 |
| [L-8](#L-8) | Loss of precision in divisions | 2 |
| [L-9](#L-9) | Missing contract existence checks before low-level calls | 2 |
| [L-10](#L-10) | Missing zero address check in constructor | 2 |
| [L-11](#L-11) | Consider some checks for `address(0)` when setting address state variables | 5 |
| [L-12](#L-12) | Prevent re-setting a state variable with the same value | 3 |
| [L-13](#L-13) | `receive()`/`fallback()` function does not authorize requests | 1 |
| [L-14](#L-14) | Some tokens may revert when large transfers are made | 1 |
| [L-15](#L-15) | Some tokens may revert when zero value transfers are made | 1 |
| [L-16](#L-16) | Timestamp may be manipulation | 6 |
| [L-17](#L-17) | Tokens may be minted to `address(0)` | 1 |
| [L-18](#L-18) | Unsafe solidity low-level call can cause gas grief attack | 2 |
| [L-19](#L-19) | Unsafe use of ERC20 `transfer()`/`transferFrom()`/`approve()` | 1 |
| [L-20](#L-20) | Using zero as a parameter | 2 |
| [L-21](#L-21) |  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()` | 1 |

## Non Critical Issues


*Total <b>402</b> instances over <b>51</b> issues:*

|ID|Issue|Instances|
|-|:-|:-:|
| [NC-1](#NC-1) | `abi.encodePacked()` should be replaced with `bytes.concat()` | 1 |
| [NC-2](#NC-2) | Add inline comments for unnamed variables | 2 |
| [NC-3](#NC-3) | Contract declarations should have NatSpec `@author` annotations | 6 |
| [NC-4](#NC-4) | Avoid the use of sensitive terms | 8 |
| [NC-5](#NC-5) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 2 |
| [NC-6](#NC-6) | Consider adding a block/deny-list | 6 |
| [NC-7](#NC-7) | Consider adding formal verification proofs | 1 |
| [NC-8](#NC-8) | Consider using `AccessControlDefaultAdminRules` rather than `AccessControl` | 3 |
| [NC-9](#NC-9) | Consider using descriptive `constant`s when passing zero as a function argument | 2 |
| [NC-10](#NC-10) | Constants should be put on the left side of comparisons | 20 |
| [NC-11](#NC-11) | Contract does not follow the Solidity Style Guide's suggested layout ordering | 1 |
| [NC-12](#NC-12) | Contract should expose an `interface` | 47 |
| [NC-13](#NC-13) | Contracts should have full test coverage | 1 |
| [NC-14](#NC-14) | Events that mark critical parameter changes should contain both the old and the new value | 17 |
| [NC-15](#NC-15) | Duplicated `require()`/`revert()` checks should be refactored | 4 |
| [NC-16](#NC-16) | Enable IR-based code generation | 1 |
| [NC-17](#NC-17) | Events are emitted without the sender information | 12 |
| [NC-18](#NC-18) | Events may be emitted out of order due to reentrancy | 9 |
| [NC-19](#NC-19) |  Function ordering does not follow the Solidity Style Guide | 10 |
| [NC-20](#NC-20) | Functions with array parameters should have length checks in place | 1 |
| [NC-21](#NC-21) | Variable names for `immutable`s should use CONSTANT_CASE | 2 |
| [NC-22](#NC-22) | Import declarations should import specific identifiers, rather than the whole file | 27 |
| [NC-23](#NC-23) | Imports could be organized more systematically | 8 |
| [NC-24](#NC-24) | Inconsistent spacing in comments | 1 |
| [NC-25](#NC-25) | Invalid NatSpec comment style | 1 |
| [NC-26](#NC-26) | Large or complicated code bases should implement invariant tests | 1 |
| [NC-27](#NC-27) | Large multiples of ten should use scientific notation | 2 |
| [NC-28](#NC-28) | Named mappings are recommended | 7 |
| [NC-29](#NC-29) | Named imports of parent contracts are missing | 6 |
| [NC-30](#NC-30) | NatSpec documentation for function is missing | 10 |
| [NC-31](#NC-31) | Modifier declarations should have NatSpec descriptions | 2 |
| [NC-32](#NC-32) | Missing NatSpec `@param` | 32 |
| [NC-33](#NC-33) | Public variable declarations should have NatSpec descriptions | 5 |
| [NC-34](#NC-34) | NatSpec `@return` is missing | 16 |
| [NC-35](#NC-35) | Function declarations should have `@notice` tags | 19 |
| [NC-36](#NC-36) | There is no need to initialize variables with 0 | 6 |
| [NC-37](#NC-37) | Put all system-wide constants in one file | 16 |
| [NC-38](#NC-38) | State variables should include comments | 5 |
| [NC-39](#NC-39) | Lines are too long | 3 |
| [NC-40](#NC-40) | Unnecessary cast | 1 |
| [NC-41](#NC-41) | Unused contract variables | 3 |
| [NC-42](#NC-42) | Consider using `delete` rather than assigning zero/false to clear values | 1 |
| [NC-43](#NC-43) | Expressions for constant values should use `immutable` rather than `constant` | 16 |
| [NC-44](#NC-44) | Use `@inheritdoc` for overridden functions | 12 |
| [NC-45](#NC-45) | Use the latest solidity version for deployment | 6 |
| [NC-46](#NC-46) | Use of `override` is unnecessary | 12 |
| [NC-47](#NC-47) | Returning a struct instead of a bunch of variables is better | 1 |
| [NC-48](#NC-48) | Visibility of state variables is not explicitly defined | 1 |
| [NC-49](#NC-49) | Names of `private`/`internal` state variables should be prefixed with an underscore | 18 |
| [NC-50](#NC-50) | Variables should be named in mixedCase style | 2 |
| [NC-51](#NC-51) | Functions not used internally could be marked `external` | 6 |

## Gas Optimizations


*Total <b>199</b> instances over <b>41</b> issues:*

|ID|Issue|Instances|Gas|
|-|:-|:-:|:-:|
| [GAS-1](#GAS-1) | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate | 2 | - |
| [GAS-2](#GAS-2) | Consider activating via-ir for deploying | 1 | - |
| [GAS-3](#GAS-3) | Divisions can be `unchecked` to save gas | 2 | 40 |
| [GAS-4](#GAS-4) | Don't transfer with zero amount to save gas | 1 | - |
| [GAS-5](#GAS-5) | Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables | 6 | 678 |
| [GAS-6](#GAS-6) | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas | 4 | - |
| [GAS-7](#GAS-7) | Increments can be `unchecked` to save gas | 2 | 120 |
| [GAS-8](#GAS-8) | `internal` functions only called once can be inlined to save gas | 2 | 60 |
| [GAS-9](#GAS-9) | `keccak256()` hash of literals should only be computed once | 11 | 462 |
| [GAS-10](#GAS-10) | Low level `call` can be optimized with assembly | 2 | 496 |
| [GAS-11](#GAS-11) | Multiple accesses of the same mapping/array key/index should be cached | 2 | 84 |
| [GAS-12](#GAS-12) | Newer versions of solidity are more gas efficient | 6 | - |
| [GAS-13](#GAS-13) | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 14 | 42 |
| [GAS-14](#GAS-14) | Optimize names to save gas | 5 | 110 |
| [GAS-15](#GAS-15) | Redundant state variable getters | 1 | - |
| [GAS-16](#GAS-16) | Remove or replace unused state variables | 3 | - |
| [GAS-17](#GAS-17) | The result of a function call should be cached rather than re-calling the function | 2 | 200 |
| [GAS-18](#GAS-18) | Unlimited gas consumption risk due to external call recipients | 2 | - |
| [GAS-19](#GAS-19) | Use assembly to compute hashes to save gas | 15 | 1200 |
| [GAS-20](#GAS-20) | Use assembly to emit events | 19 | 722 |
| [GAS-21](#GAS-21) | Use assembly to write address/contract type storage values | 4 | 200 |
| [GAS-22](#GAS-22) | Using a double `if` statement instead of a logical AND (`&&`) | 3 | 90 |
| [GAS-23](#GAS-23) | Use local variables for emitting | 6 | 582 |
| [GAS-24](#GAS-24) | Use a more recent version of solidity | 6 | - |
| [GAS-25](#GAS-25) | Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes | 1 | 8550 |
| [GAS-26](#GAS-26) | Use `unchecked` block for safe subtractions | 1 | 85 |
| [GAS-27](#GAS-27) | Using bitmap to store bool states can save gas | 1 | - |
| [GAS-28](#GAS-28) | Using `constant`s directly, rather than caching the value, saves gas | 2 | - |
| [GAS-29](#GAS-29) | Using `this` to access functions results in an external call, wasting gas | 1 | 100 |
| [GAS-30](#GAS-30) | Use `selfbalance()` instead of `address(this).balance` | 1 | - |
| [GAS-31](#GAS-31) | Using bools for storage incurs overhead | 1 | 100 |
| [GAS-32](#GAS-32) | Cache array length outside of loop | 4 | - |
| [GAS-33](#GAS-33) | State variables should be cached in stack variables rather than re-reading them from storage | 3 | 291 |
| [GAS-34](#GAS-34) | Use `calldata` instead of `memory` for function arguments that do not get mutated | 2 | - |
| [GAS-35](#GAS-35) | Don't initialize variables with default value | 6 | - |
| [GAS-36](#GAS-36) | Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead | 4 | 220 |
| [GAS-37](#GAS-37) | Constructors can be marked as `payable` to save deployment gas | 3 | 63 |
| [GAS-38](#GAS-38) | Functions guaranteed to revert when called by normal users can be marked `payable` | 20 | 420 |
| [GAS-39](#GAS-39) | `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too) | 2 | 10 |
| [GAS-40](#GAS-40) | Use `!= 0` instead of `> 0` for unsigned integer comparison | 3 | 12 |
| [GAS-41](#GAS-41) | Using assembly to check for zero can save gas | 23 | 138 |
<a name="M-1"></a> 
### [M-1] The remaining ETH may be locked in the contract after call
After calling an external contract and forwards some ETH value, the contract balance should be checked. If there is excess eth left over due to a failed call, or more eth being delivered than needed, or any other reason, this eth must be refunded to the user or handled appropriately, otherwise the eth may be frozen in the contract forever.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="M-2"></a> 
### [M-2] Return values of `transfer()`/`transferFrom()` not checked
Not all ERC20 implementations `revert()` when there's a failure in `transfer()` or `transferFrom()`. The function signature has a boolean return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually transfer anything.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

29:     USDE.transfer(to, amount);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L29)]



<a name="M-3"></a> 
### [M-3] Centralization Risk for trusted owners
Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details>
<summary>
There are <b>30</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

166:     onlyRole(MINTER_ROLE)

198:     onlyRole(REDEEMER_ROLE)

219:   function setMaxMintPerBlock(uint256 _maxMintPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

224:   function setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

229:   function disableMintRedeem() external onlyRole(GATEKEEPER_ROLE) {

247:   function transferToCustody(address wallet, address asset, uint256 amount) external nonReentrant onlyRole(MINTER_ROLE) {

259:   function removeSupportedAsset(address asset) external onlyRole(DEFAULT_ADMIN_ROLE) {

270:   function removeCustodianAddress(address custodian) external onlyRole(DEFAULT_ADMIN_ROLE) {

277:   function removeMinterRole(address minter) external onlyRole(GATEKEEPER_ROLE) {

283:   function removeRedeemerRole(address redeemer) external onlyRole(GATEKEEPER_ROLE) {

290:   function addSupportedAsset(address asset) public onlyRole(DEFAULT_ADMIN_ROLE) {

298:   function addCustodianAddress(address custodian) public onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21), [166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L166), [198](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L198), [219](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L219), [224](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L224), [229](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L229), [247](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L247), [259](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L259), [270](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L270), [277](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L277), [283](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L283), [290](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L290), [298](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L298)]


```solidity
File: contracts/SingleAdminAccessControl.sol

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

25:   function transferAdmin(address newAdmin) external onlyRole(DEFAULT_ADMIN_ROLE) {

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13), [13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13), [13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13), [25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L25), [41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50)]


```solidity
File: contracts/StakedUSDe.sol

21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

89:   function transferInRewards(uint256 amount) external nonReentrant onlyRole(REWARDER_ROLE) notZero(amount) {

107:     external

121:     external

138:   function rescueTokens(address token, uint256 amount, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

148:   function redistributeLockedAmount(address from, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21), [89](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L89), [107](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L107), [121](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L121), [138](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L138), [148](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L148)]


```solidity
File: contracts/StakedUSDeV2.sol

126:   function setCooldownDuration(uint24 duration) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L126)]


```solidity
File: contracts/USDe.sol

15: contract USDe is Ownable2Step, ERC20Burnable, ERC20Permit, IUSDeDefinitions {

23:   function setMinter(address newMinter) external onlyOwner {

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L15), [23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


```solidity
File: contracts/USDeSilo.sol

28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="L-1"></a> 
### [L-1] Missing zero address check in functions with address parameters
Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>
There are <b>22</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

/// @audit missing zero check for `_delegateTo`
235:   function setDelegatedSigner(address _delegateTo) external {

/// @audit missing zero check for `_removedSigner`
241:   function removeDelegatedSigner(address _removedSigner) external {

/// @audit missing zero check for `minter`
277:   function removeMinterRole(address minter) external onlyRole(GATEKEEPER_ROLE) {

/// @audit missing zero check for `redeemer`
283:   function removeRedeemerRole(address redeemer) external onlyRole(GATEKEEPER_ROLE) {

/// @audit missing zero check for `sender`
377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

/// @audit missing zero check for `sender`
391:   function _deduplicateOrder(address sender, uint256 nonce) private returns (bool) {

/// @audit missing zero check for `benefactor`
413:   function _transferCollateral(
         uint256 amount,
         address asset,
         address benefactor,
         address[] calldata addresses,
         uint256[] calldata ratios
       ) internal {

```
*Github:* [[235](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L235), [241](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L241), [277](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L277), [283](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L283), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377), [391](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L391), [413](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L413)]


```solidity
File: contracts/SingleAdminAccessControl.sol

/// @audit missing zero check for `newAdmin`
25:   function transferAdmin(address newAdmin) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing zero check for `account`
41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

/// @audit missing zero check for `account`
50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

/// @audit missing zero check for `account`
58:   function renounceRole(bytes32 role, address account) public virtual override notAdmin(role) {

/// @audit missing zero check for `account`
72:   function _grantRole(bytes32 role, address account) internal override {

```
*Github:* [[25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L25), [41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L58), [72](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L72)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit missing zero check for `to`
138:   function rescueTokens(address token, uint256 amount, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing zero check for `caller`
/// @audit missing zero check for `receiver`
203:   function _deposit(address caller, address receiver, uint256 assets, uint256 shares)
         internal
         override
         nonReentrant
         notZero(assets)
         notZero(shares)
       {

/// @audit missing zero check for `caller`
/// @audit missing zero check for `receiver`
/// @audit missing zero check for `_owner`
225:   function _withdraw(address caller, address receiver, address _owner, uint256 assets, uint256 shares)
         internal
         override
         nonReentrant
         notZero(assets)
         notZero(shares)
       {

/// @audit missing zero check for `from`
245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

```
*Github:* [[138](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L138), [203](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L203), [225](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L225), [245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit missing zero check for `receiver`
/// @audit missing zero check for `owner`
52:   function withdraw(uint256 assets, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

/// @audit missing zero check for `receiver`
/// @audit missing zero check for `owner`
65:   function redeem(uint256 shares, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

/// @audit missing zero check for `receiver`
78:   function unstake(address receiver) external {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L52), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L65), [78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L78)]


```solidity
File: contracts/USDe.sol

/// @audit missing zero check for `newMinter`
23:   function setMinter(address newMinter) external onlyOwner {

/// @audit missing zero check for `to`
28:   function mint(address to, uint256 amount) external {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28)]


```solidity
File: contracts/USDeSilo.sol

/// @audit missing zero check for `to`
28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="L-2"></a> 
### [L-2] Check division by zero is prevented

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

425:       uint256 amountToTransfer = (amount * ratios[i]) / 10_000;

```
*Github:* [[425](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L425)]


```solidity
File: contracts/StakedUSDe.sol

180:     return ((VESTING_PERIOD - timeSinceLastDistribution) * vestingAmount) / VESTING_PERIOD;

```
*Github:* [[180](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L180)]



<a name="L-3"></a> 
### [L-3] Consider implementing two-step procedure for updating protocol addresses
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must "accept" the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the "set" functions ensure that the recipient is of the right interface type.

*There is one instance of this issue:*
```solidity
File: contracts/USDe.sol

23:   function setMinter(address newMinter) external onlyOwner {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23)]



<a name="L-4"></a> 
### [L-4] Constructor / initialization function lacks parameter validation
Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDeV2.sol

/// @audit `initialRewarder` not validated
/// @audit `owner` not validated
42:   constructor(IERC20 _asset, address initialRewarder, address owner) StakedUSDe(_asset, initialRewarder, owner) {

```
*Github:* [[42](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L42)]


```solidity
File: contracts/USDeSilo.sol

/// @audit `stakingVault` not validated
18:   constructor(address stakingVault, address usde) {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18)]



<a name="L-5"></a> 
### [L-5] External call recipient can consume all remaining gas
There is no limit specified on the amount of gas used, so the recipient can use up all of the remaining gas (`gasleft()`), causing it to revert. Therefore, when calling an external contract, it is necessary to specify a limited amount of gas to forward.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="L-6"></a> 
### [L-6] External function calls within loops
Calling external functions within loops can easily result in insufficient gas. This greatly increases the likelihood of transaction failures, DOS attacks, and other unexpected actions. It is recommended to limit the number of loops within loops that call external functions, and to limit the gas line for each external call.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `.safeTransferFrom(..)` is called in loop
/// @audit `.safeTransferFrom(..)` is called in loop
/// @audit `.safeTransferFrom(..)` is called in loop
/// @audit `.safeTransferFrom(..)` is called in loop
424:     for (uint256 i = 0; i < addresses.length; ++i) {

```
*Github:* [[424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424)]



<a name="L-7"></a> 
### [L-7] Governance functions should be controlled by time locks
Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

219:   function setMaxMintPerBlock(uint256 _maxMintPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

224:   function setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[219](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L219), [224](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L224)]


```solidity
File: contracts/StakedUSDeV2.sol

126:   function setCooldownDuration(uint24 duration) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L126)]


```solidity
File: contracts/USDe.sol

23:   function setMinter(address newMinter) external onlyOwner {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23)]



<a name="L-8"></a> 
### [L-8] Loss of precision in divisions
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

425:       uint256 amountToTransfer = (amount * ratios[i]) / 10_000;

```
*Github:* [[425](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L425)]


```solidity
File: contracts/StakedUSDe.sol

180:     return ((VESTING_PERIOD - timeSinceLastDistribution) * vestingAmount) / VESTING_PERIOD;

```
*Github:* [[180](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L180)]



<a name="L-9"></a> 
### [L-9] Missing contract existence checks before low-level calls
Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `<address>.code.length > 0`

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="L-10"></a> 
### [L-10] Missing zero address check in constructor
Constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a checking, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could be due to an error or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it will be irretrievable. It's therefore crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDeV2.sol

/// @audit missing zero check for `initialRewarder`
/// @audit missing zero check for `owner`
42:   constructor(IERC20 _asset, address initialRewarder, address owner) StakedUSDe(_asset, initialRewarder, owner) {

```
*Github:* [[42](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L42)]


```solidity
File: contracts/USDeSilo.sol

/// @audit missing zero check for `stakingVault`
18:   constructor(address stakingVault, address usde) {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18)]



<a name="L-11"></a> 
### [L-11] Consider some checks for `address(0)` when setting address state variables

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/SingleAdminAccessControl.sol

76:       _currentDefaultAdmin = account;

```
*Github:* [[76](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L76)]


```solidity
File: contracts/StakedUSDeV2.sol

43:     silo = new USDeSilo(address(this), address(_asset));

```
*Github:* [[43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L43)]


```solidity
File: contracts/USDe.sol

25:     minter = newMinter;

```
*Github:* [[25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L25)]


```solidity
File: contracts/USDeSilo.sol

19:     STAKING_VAULT = stakingVault;

20:     USDE = IERC20(usde);

```
*Github:* [[19](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L19), [20](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L20)]



<a name="L-12"></a> 
### [L-12] Prevent re-setting a state variable with the same value
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

122:     usde = _usde;

438:     maxMintPerBlock = _maxMintPerBlock;

445:     maxRedeemPerBlock = _maxRedeemPerBlock;

```
*Github:* [[122](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L122), [438](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L438), [445](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L445)]



<a name="L-13"></a> 
### [L-13] `receive()`/`fallback()` function does not authorize requests
Having no access control on the function (e.g. `require(msg.sender == address(weth))`) means that someone may send Ether to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue mistakenly-sent Ether.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

153:   receive() external payable {

```
*Github:* [[153](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L153)]



<a name="L-14"></a> 
### [L-14] Some tokens may revert when large transfers are made
Tokens such as COMP or UNI will revert when an address' balance reaches `type(uint96).max`. Ensure that the calls below can be broken up into smaller batches if necessary.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

29:     USDE.transfer(to, amount);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L29)]



<a name="L-15"></a> 
### [L-15] Some tokens may revert when zero value transfers are made
Despite the fact that [EIP-20 states](https://github.com/ethereum/EIPs/blob/7500ac4fc1bbdfaf684e7ef851f798f6b667b2fe/EIPS/eip-20.md?plain=1#L116) that zero-value transfers must be accepted, some tokens, such as LEND, will revert if this is attempted, which may cause transactions that involve other tokens (such as batch operations) to fully revert. Consider skipping the transfer if the amount is zero, which will also save gas.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

29:     USDE.transfer(to, amount);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L29)]



<a name="L-16"></a> 
### [L-16] Timestamp may be manipulation
The `block.timestamp` can be manipulated by miners to perform MEV profiting or other time-based attacks.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

346:     if (block.timestamp > order.expiry) revert SignatureExpired();

```
*Github:* [[346](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L346)]


```solidity
File: contracts/StakedUSDe.sol

94:     lastDistributionTimestamp = block.timestamp;

174:     uint256 timeSinceLastDistribution = block.timestamp - lastDistributionTimestamp;

```
*Github:* [[94](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L94), [174](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L174)]


```solidity
File: contracts/StakedUSDeV2.sol

82:     if (block.timestamp >= userCooldown.cooldownEnd) {

100:     cooldowns[owner].cooldownEnd = uint104(block.timestamp) + cooldownDuration;

116:     cooldowns[owner].cooldownEnd = uint104(block.timestamp) + cooldownDuration;

```
*Github:* [[82](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L82), [100](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L100), [116](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L116)]



<a name="L-17"></a> 
### [L-17] Tokens may be minted to `address(0)`

*There is one instance of this issue:*
```solidity
File: contracts/USDe.sol

28:   function mint(address to, uint256 amount) external {
        if (msg.sender != minter) revert OnlyMinter();
        _mint(to, amount);
      }

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28)]



<a name="L-18"></a> 
### [L-18] Unsafe solidity low-level call can cause gas grief attack
Using the low-level calls of a solidity address can leave the contract open to gas grief attacks. These attacks occur when the called contract returns a large amount of data. So when calling an external contract, it is necessary to check the length of the return data before reading/copying it (using `returndatasize()`).

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="L-19"></a> 
### [L-19] Unsafe use of ERC20 `transfer()`/`transferFrom()`/`approve()`
Some tokens do not implement the ERC20 standard properly. For example Tether (USDT)'s `transfer()` and `transferFrom()` functions do not return booleans as the ERC20 specification requires, and instead have no return value. When these sorts of tokens are cast to IERC20/ERC20, their function signatures do not match and therefore the calls made will revert.It is recommended to use the [`SafeERC20`](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/f347b410cf6aeeaaf5197e1fece139c793c03b2b/contracts/token/ERC20/utils/SafeERC20.sol#L19)'s `safeTransfer()` and `safeTransferFrom()` from OpenZeppelin instead.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

29:     USDE.transfer(to, amount);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L29)]



<a name="L-20"></a> 
### [L-20] Using zero as a parameter
Taking `0` as a valid argument in Solidity without checks can lead to severe security issues. A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because 0 can be interpreted as an uninitialized `address`, leading to transfers to the 0x0 address, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code. It's important to always validate input and handle edge cases like `0` appropriately. Use `require()` statements to enforce conditions and provide clear error messages to facilitate debugging and safer code.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

230:     _setMaxMintPerBlock(0);

231:     _setMaxRedeemPerBlock(0);

```
*Github:* [[230](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L230), [231](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L231)]



<a name="L-21"></a> 
### [L-21]  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`
Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

```
*Github:* [[49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49)]



<a name="NC-1"></a> 
### [NC-1] `abi.encodePacked()` should be replaced with `bytes.concat()`
Solidity version 0.8.4 introduces `bytes.concat()`, which can be used to replace `abi.encodePacked()` on bytes/strings. It can make the intended operation clearer, leading to less reviewer confusion.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

```
*Github:* [[49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49)]



<a name="NC-2"></a> 
### [NC-2] Add inline comments for unnamed variables
`function foo(address x, address)` -> `function foo(address x, address /* y */)`

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245), [257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]



<a name="NC-3"></a> 
### [NC-3] Contract declarations should have NatSpec `@author` annotations

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21)]


```solidity
File: contracts/SingleAdminAccessControl.sol

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13)]


```solidity
File: contracts/StakedUSDe.sol

21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21)]


```solidity
File: contracts/StakedUSDeV2.sol

15: contract StakedUSDeV2 is IStakedUSDeCooldown, StakedUSDe {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L15)]


```solidity
File: contracts/USDe.sol

15: contract USDe is Ownable2Step, ERC20Burnable, ERC20Permit, IUSDeDefinitions {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L15)]


```solidity
File: contracts/USDeSilo.sol

12: contract USDeSilo is IUSDeSiloDefinitions {

```
*Github:* [[12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L12)]



<a name="NC-4"></a> 
### [NC-4] Avoid the use of sensitive terms
Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

27:   /// @notice The role that is allowed to blacklist and un-blacklist addresses

55:   /// @notice ensures blacklist target is not owner

102:    * @notice Allows the owner (DEFAULT_ADMIN_ROLE) and blacklist managers to blacklist addresses.

103:    * @param target The address to blacklist.

104:    * @param isFullBlacklisting Soft or full blacklisting level.

116:    * @notice Allows the owner (DEFAULT_ADMIN_ROLE) and blacklist managers to un-blacklist addresses.

117:    * @param target The address to un-blacklist.

118:    * @param isFullBlacklisting Soft or full blacklisting level.

```
*Github:* [[27](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L27), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L55), [102](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L102), [103](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L103), [104](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L104), [116](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L116), [117](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L117), [118](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L118)]



<a name="NC-5"></a> 
### [NC-5] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

78:   mapping(address => mapping(uint256 => uint256)) private _orderBitmaps;

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

```
*Github:* [[78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L78), [86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86)]



<a name="NC-6"></a> 
### [NC-6] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21)]


```solidity
File: contracts/SingleAdminAccessControl.sol

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13)]


```solidity
File: contracts/StakedUSDe.sol

21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21)]


```solidity
File: contracts/StakedUSDeV2.sol

15: contract StakedUSDeV2 is IStakedUSDeCooldown, StakedUSDe {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L15)]


```solidity
File: contracts/USDe.sol

15: contract USDe is Ownable2Step, ERC20Burnable, ERC20Permit, IUSDeDefinitions {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L15)]


```solidity
File: contracts/USDeSilo.sol

12: contract USDeSilo is IUSDeSiloDefinitions {

```
*Github:* [[12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L12)]



<a name="NC-7"></a> 
### [NC-7] Consider adding formal verification proofs
Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/)]



<a name="NC-8"></a> 
### [NC-8] Consider using `AccessControlDefaultAdminRules` rather than `AccessControl`
`AccessControlDefaultAdminRules` implements multiple [security best practices](https://docs.openzeppelin.com/contracts/4.x/api/access#AccessControlDefaultAdminRules) on top of the normal `AccessControl` rules, so consider using it instead.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21)]


```solidity
File: contracts/SingleAdminAccessControl.sol

13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13)]


```solidity
File: contracts/StakedUSDe.sol

21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21)]



<a name="NC-9"></a> 
### [NC-9] Consider using descriptive `constant`s when passing zero as a function argument
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

230:     _setMaxMintPerBlock(0);

231:     _setMaxRedeemPerBlock(0);

```
*Github:* [[230](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L230), [231](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L231)]



<a name="NC-10"></a> 
### [NC-10] Constants should be put on the left side of comparisons
Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions). Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

119:     if (address(_usde) == address(0)) revert InvalidUSDeAddress();

120:     if (_assets.length == 0) revert NoAssetsProvided();

121:     if (_admin == address(0)) revert InvalidZeroAddress();

248:     if (wallet == address(0) || !_custodianAddresses.contains(wallet)) revert InvalidAddress();

291:     if (asset == address(0) || asset == address(usde) || !_supportedAssets.add(asset)) {

299:     if (custodian == address(0) || custodian == address(usde) || !_custodianAddresses.add(custodian)) {

343:     if (order.beneficiary == address(0)) revert InvalidAmount();

344:     if (order.collateral_amount == 0) revert InvalidAmount();

345:     if (order.usde_amount == 0) revert InvalidAmount();

360:     if (route.addresses.length == 0) {

364:       if (!_custodianAddresses.contains(route.addresses[i]) || route.addresses[i] == address(0) || route.ratios[i] == 0)

378:     if (nonce == 0) revert InvalidNonce();

383:     if (invalidator & invalidatorBit != 0) revert InvalidNonce();

```
*Github:* [[119](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L119), [120](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L120), [121](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L121), [248](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L248), [291](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L291), [299](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L299), [343](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L343), [344](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L344), [345](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L345), [360](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L360), [364](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L364), [378](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L378), [383](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L383)]


```solidity
File: contracts/StakedUSDe.sol

51:     if (amount == 0) revert InvalidAmount();

75:     if (_owner == address(0) || _initialRewarder == address(0) || address(_asset) == address(0)) {

153:       if (to != address(0)) _mint(to, amountToDistribute);

246:     if (hasRole(FULL_RESTRICTED_STAKER_ROLE, from) && to != address(0)) {

```
*Github:* [[51](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L51), [75](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L75), [153](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L153), [246](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L246)]


```solidity
File: contracts/StakedUSDeV2.sol

28:     if (cooldownDuration != 0) revert OperationNotAllowed();

34:     if (cooldownDuration == 0) revert OperationNotAllowed();

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L28), [34](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L34)]


```solidity
File: contracts/USDe.sol

19:     if (admin == address(0)) revert ZeroAddressException();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L19)]


</details>


<a name="NC-11"></a> 
### [NC-11] Contract does not follow the Solidity Style Guide's suggested layout ordering
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be `1) Type declarations`, `2) State variables`, `3) Events`, `4) Modifiers`, and `5) Functions`, but the contract(s) below do not follow this ordering

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

/// @audit function `constructor` came earlier
23:   modifier onlyStakingVault() {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L23)]



<a name="NC-12"></a> 
### [NC-12] Contract should expose an `interface`
All `external`/`public` functions should extend an `interface`. This is useful to make sure that the whole API is extracted.

*Note:* It is possible that the interface is out-of-scope and has not been seen by the bot.

<details>
<summary>
There are <b>47</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

162:   function mint(Order calldata order, Route calldata route, Signature calldata signature)

194:   function redeem(Order calldata order, Signature calldata signature)

219:   function setMaxMintPerBlock(uint256 _maxMintPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

224:   function setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

229:   function disableMintRedeem() external onlyRole(GATEKEEPER_ROLE) {

235:   function setDelegatedSigner(address _delegateTo) external {

241:   function removeDelegatedSigner(address _removedSigner) external {

247:   function transferToCustody(address wallet, address asset, uint256 amount) external nonReentrant onlyRole(MINTER_ROLE) {

259:   function removeSupportedAsset(address asset) external onlyRole(DEFAULT_ADMIN_ROLE) {

265:   function isSupportedAsset(address asset) external view returns (bool) {

270:   function removeCustodianAddress(address custodian) external onlyRole(DEFAULT_ADMIN_ROLE) {

277:   function removeMinterRole(address minter) external onlyRole(GATEKEEPER_ROLE) {

283:   function removeRedeemerRole(address redeemer) external onlyRole(GATEKEEPER_ROLE) {

290:   function addSupportedAsset(address asset) public onlyRole(DEFAULT_ADMIN_ROLE) {

298:   function addCustodianAddress(address custodian) public onlyRole(DEFAULT_ADMIN_ROLE) {

308:   function getDomainSeparator() public view returns (bytes32) {

316:   function hashOrder(Order calldata order) public view override returns (bytes32) {

320:   function encodeOrder(Order calldata order) public pure returns (bytes memory) {

334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

351:   function verifyRoute(Route calldata route, OrderType orderType) public view override returns (bool) {

377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

```
*Github:* [[162](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L162), [194](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L194), [219](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L219), [224](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L224), [229](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L229), [235](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L235), [241](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L241), [247](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L247), [259](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L259), [265](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L265), [270](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L270), [277](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L277), [283](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L283), [290](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L290), [298](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L298), [308](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L308), [316](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L316), [320](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L320), [334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339), [351](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L351), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377)]


```solidity
File: contracts/SingleAdminAccessControl.sol

25:   function transferAdmin(address newAdmin) external onlyRole(DEFAULT_ADMIN_ROLE) {

31:   function acceptAdmin() external {

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

58:   function renounceRole(bytes32 role, address account) public virtual override notAdmin(role) {

65:   function owner() public view virtual returns (address) {

```
*Github:* [[25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L25), [31](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L31), [41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L58), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L65)]


```solidity
File: contracts/StakedUSDe.sol

89:   function transferInRewards(uint256 amount) external nonReentrant onlyRole(REWARDER_ROLE) notZero(amount) {

106:   function addToBlacklist(address target, bool isFullBlacklisting)

120:   function removeFromBlacklist(address target, bool isFullBlacklisting)

138:   function rescueTokens(address token, uint256 amount, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

148:   function redistributeLockedAmount(address from, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

166:   function totalAssets() public view override returns (uint256) {

173:   function getUnvestedAmount() public view returns (uint256) {

184:   function decimals() public pure override(ERC4626, ERC20) returns (uint8) {

257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[89](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L89), [106](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L106), [120](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L120), [138](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L138), [148](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L148), [166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L166), [173](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L173), [184](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L184), [257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]


```solidity
File: contracts/StakedUSDeV2.sol

52:   function withdraw(uint256 assets, address receiver, address owner)

65:   function redeem(uint256 shares, address receiver, address owner)

78:   function unstake(address receiver) external {

95:   function cooldownAssets(uint256 assets, address owner) external ensureCooldownOn returns (uint256) {

111:   function cooldownShares(uint256 shares, address owner) external ensureCooldownOn returns (uint256) {

126:   function setCooldownDuration(uint24 duration) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L52), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L65), [78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L78), [95](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L95), [111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L111), [126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L126)]


```solidity
File: contracts/USDe.sol

23:   function setMinter(address newMinter) external onlyOwner {

28:   function mint(address to, uint256 amount) external {

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28), [33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


```solidity
File: contracts/USDeSilo.sol

28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="NC-13"></a> 
### [NC-13] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/)]



<a name="NC-14"></a> 
### [NC-14] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>
There are <b>17</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

145:     emit USDeSet(address(_usde));

154:     emit Received(msg.sender, msg.value);

237:     emit DelegatedSignerAdded(_delegateTo, msg.sender);

243:     emit DelegatedSignerRemoved(_removedSigner, msg.sender);

255:     emit CustodyTransfer(wallet, asset, amount);

261:     emit AssetRemoved(asset);

272:     emit CustodianAddressRemoved(custodian);

294:     emit AssetAdded(asset);

302:     emit CustodianAddressAdded(custodian);

439:     emit MaxMintPerBlockChanged(oldMaxMintPerBlock, maxMintPerBlock);

446:     emit MaxRedeemPerBlockChanged(oldMaxRedeemPerBlock, maxRedeemPerBlock);

```
*Github:* [[145](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L145), [154](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L154), [237](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L237), [243](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L243), [255](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L255), [261](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L261), [272](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L272), [294](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L294), [302](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L302), [439](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L439), [446](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L446)]


```solidity
File: contracts/SingleAdminAccessControl.sol

28:     emit AdminTransferRequested(_currentDefaultAdmin, newAdmin);

74:       emit AdminTransferred(_currentDefaultAdmin, account);

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L28), [74](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L74)]


```solidity
File: contracts/StakedUSDe.sol

98:     emit RewardsReceived(amount, newVestingAmount);

155:       emit LockedAmountRedistributed(from, to, amountToDistribute);

```
*Github:* [[98](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L98), [155](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L155)]


```solidity
File: contracts/StakedUSDeV2.sol

133:     emit CooldownDurationUpdated(previousDuration, cooldownDuration);

```
*Github:* [[133](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L133)]


```solidity
File: contracts/USDe.sol

24:     emit MinterUpdated(newMinter, minter);

```
*Github:* [[24](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L24)]


</details>


<a name="NC-15"></a> 
### [NC-15] Duplicated `require()`/`revert()` checks should be refactored
Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit duplicated on line 211
157:       revert OperationNotAllowed();

/// @audit duplicated on line 247
233:       revert OperationNotAllowed();

/// @audit duplicated on line 250
258:     revert OperationNotAllowed();

```
*Github:* [[157](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L157), [233](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L233), [258](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L258)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit duplicated on line 128
88:       revert InvalidCooldown();

```
*Github:* [[88](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L88)]



<a name="NC-16"></a> 
### [NC-16] Enable IR-based code generation
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions. You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`. This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/)]



<a name="NC-17"></a> 
### [NC-17] Events are emitted without the sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

145:     emit USDeSet(address(_usde));

255:     emit CustodyTransfer(wallet, asset, amount);

261:     emit AssetRemoved(asset);

272:     emit CustodianAddressRemoved(custodian);

294:     emit AssetAdded(asset);

302:     emit CustodianAddressAdded(custodian);

439:     emit MaxMintPerBlockChanged(oldMaxMintPerBlock, maxMintPerBlock);

446:     emit MaxRedeemPerBlockChanged(oldMaxRedeemPerBlock, maxRedeemPerBlock);

```
*Github:* [[145](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L145), [255](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L255), [261](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L261), [272](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L272), [294](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L294), [302](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L302), [439](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L439), [446](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L446)]


```solidity
File: contracts/SingleAdminAccessControl.sol

28:     emit AdminTransferRequested(_currentDefaultAdmin, newAdmin);

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L28)]


```solidity
File: contracts/StakedUSDe.sol

98:     emit RewardsReceived(amount, newVestingAmount);

```
*Github:* [[98](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L98)]


```solidity
File: contracts/StakedUSDeV2.sol

133:     emit CooldownDurationUpdated(previousDuration, cooldownDuration);

```
*Github:* [[133](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L133)]


```solidity
File: contracts/USDe.sol

24:     emit MinterUpdated(newMinter, minter);

```
*Github:* [[24](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L24)]


</details>


<a name="NC-18"></a> 
### [NC-18] Events may be emitted out of order due to reentrancy
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

*There are <b>9</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `.mint(..)` is called before emit
178:     usde.mint(order.beneficiary, order.usde_amount);
         emit Mint(

/// @audit `.burnFrom(..)` is called before emit
206:     usde.burnFrom(order.benefactor, order.usde_amount);
         _transferToBeneficiary(order.beneficiary, order.collateral_asset, order.collateral_amount);
         emit Redeem(

/// @audit `.contains(..)` is called before emit
248:     if (wallet == address(0) || !_custodianAddresses.contains(wallet)) revert InvalidAddress();
         if (asset == NATIVE_TOKEN) {
           (bool success,) = wallet.call{value: amount}("");
           if (!success) revert TransferFailed();
         } else {
           IERC20(asset).safeTransfer(wallet, amount);
         }
         emit CustodyTransfer(wallet, asset, amount);

/// @audit `.safeTransfer(..)` is called before emit
253:       IERC20(asset).safeTransfer(wallet, amount);
         }
         emit CustodyTransfer(wallet, asset, amount);

/// @audit `.remove(..)` is called before emit
260:     if (!_supportedAssets.remove(asset)) revert InvalidAssetAddress();
         emit AssetRemoved(asset);

/// @audit `.remove(..)` is called before emit
271:     if (!_custodianAddresses.remove(custodian)) revert InvalidCustodianAddress();
         emit CustodianAddressRemoved(custodian);

/// @audit `.add(..)` is called before emit
291:     if (asset == address(0) || asset == address(usde) || !_supportedAssets.add(asset)) {
           revert InvalidAssetAddress();
         }
         emit AssetAdded(asset);

/// @audit `.add(..)` is called before emit
299:     if (custodian == address(0) || custodian == address(usde) || !_custodianAddresses.add(custodian)) {
           revert InvalidCustodianAddress();
         }
         emit CustodianAddressAdded(custodian);

```
*Github:* [[178](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L178), [206](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L206), [248](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L248), [253](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L253), [260](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L260), [271](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L271), [291](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L291), [299](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L299)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit `.safeTransferFrom(..)` is called before emit
96:     IERC20(asset()).safeTransferFrom(msg.sender, address(this), amount);
    
        emit RewardsReceived(amount, newVestingAmount);

```
*Github:* [[96](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L96)]



<a name="NC-19"></a> 
### [NC-19]  Function ordering does not follow the Solidity Style Guide
According to the [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order: `constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit private function `_deduplicateOrder` came earlier from this internal function
401:   function _transferToBeneficiary(address beneficiary, address asset, uint256 amount) internal {

/// @audit private function `_deduplicateOrder` came earlier from this internal function
413:   function _transferCollateral(

/// @audit private function `_deduplicateOrder` came earlier from this internal function
436:   function _setMaxMintPerBlock(uint256 _maxMintPerBlock) internal {

/// @audit private function `_deduplicateOrder` came earlier from this internal function
443:   function _setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) internal {

/// @audit private function `_deduplicateOrder` came earlier from this internal function
451:   function _computeDomainSeparator() internal view returns (bytes32) {

```
*Github:* [[401](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L401), [413](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L413), [436](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L436), [443](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L443), [451](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L451)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit internal function `_checkMinShares` came earlier from this public function
/// @audit internal function `_deposit` came earlier from this public function
/// @audit internal function `_withdraw` came earlier from this public function
/// @audit internal function `_beforeTokenTransfer` came earlier from this public function
257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit public function `withdraw` came earlier from this external function
/// @audit public function `redeem` came earlier from this external function
78:   function unstake(address receiver) external {

/// @audit public function `withdraw` came earlier from this external function
/// @audit public function `redeem` came earlier from this external function
95:   function cooldownAssets(uint256 assets, address owner) external ensureCooldownOn returns (uint256) {

/// @audit public function `withdraw` came earlier from this external function
/// @audit public function `redeem` came earlier from this external function
111:   function cooldownShares(uint256 shares, address owner) external ensureCooldownOn returns (uint256) {

/// @audit public function `withdraw` came earlier from this external function
/// @audit public function `redeem` came earlier from this external function
126:   function setCooldownDuration(uint24 duration) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L78), [95](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L95), [111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L111), [126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L126)]



<a name="NC-20"></a> 
### [NC-20] Functions with array parameters should have length checks in place

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `ratios`
413:   function _transferCollateral(

```
*Github:* [[413](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L413)]



<a name="NC-21"></a> 
### [NC-21] Variable names for `immutable`s should use CONSTANT_CASE
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

72:   uint256 private immutable _chainId;

75:   bytes32 private immutable _domainSeparator;

```
*Github:* [[72](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L72), [75](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L75)]



<a name="NC-22"></a> 
### [NC-22] Import declarations should import specific identifiers, rather than the whole file
Using import declarations of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas).

<details>
<summary>
There are <b>27</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

8: import "./SingleAdminAccessControl.sol";

9: import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

10: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

11: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

12: import "@openzeppelin/contracts/utils/structs/EnumerableSet.sol";

14: import "./interfaces/IUSDe.sol";

15: import "./interfaces/IEthenaMinting.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L8), [9](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L9), [10](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L10), [11](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L11), [12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L12), [14](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L14), [15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L15)]


```solidity
File: contracts/SingleAdminAccessControl.sol

4: import "@openzeppelin/contracts/access/AccessControl.sol";

5: import "@openzeppelin/contracts/interfaces/IERC5313.sol";

6: import "./interfaces/ISingleAdminAccessControl.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L4), [5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L5), [6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L6)]


```solidity
File: contracts/StakedUSDe.sol

8: import "@openzeppelin/contracts/token/ERC20/extensions/ERC4626.sol";

9: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

10: import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

11: import "@openzeppelin/contracts/token/ERC20/extensions/draft-ERC20Permit.sol";

12: import "./SingleAdminAccessControl.sol";

13: import "./interfaces/IStakedUSDe.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L8), [9](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L9), [10](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L10), [11](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L11), [12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L12), [13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L13)]


```solidity
File: contracts/StakedUSDeV2.sol

4: import "./StakedUSDe.sol";

5: import "./interfaces/IStakedUSDeCooldown.sol";

6: import "./USDeSilo.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L4), [5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L5), [6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L6)]


```solidity
File: contracts/USDe.sol

4: import "@openzeppelin/contracts/token/ERC20/ERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";

6: import "@openzeppelin/contracts/token/ERC20/extensions/draft-ERC20Permit.sol";

7: import "@openzeppelin/contracts/access/Ownable2Step.sol";

8: import "./interfaces/IUSDeDefinitions.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L4), [5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L5), [6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L6), [7](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L7), [8](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L8)]


```solidity
File: contracts/USDeSilo.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

6: import "../contracts/interfaces/IUSDeSiloDefinitions.sol";

```
*Github:* [[4](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L4), [5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L5), [6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L6)]


</details>


<a name="NC-23"></a> 
### [NC-23] Imports could be organized more systematically
The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*There are <b>8</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

14: import "./interfaces/IUSDe.sol";

15: import "./interfaces/IEthenaMinting.sol";

```
*Github:* [[14](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L14), [15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L15)]


```solidity
File: contracts/SingleAdminAccessControl.sol

5: import "@openzeppelin/contracts/interfaces/IERC5313.sol";

6: import "./interfaces/ISingleAdminAccessControl.sol";

```
*Github:* [[5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L5), [6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L6)]


```solidity
File: contracts/StakedUSDe.sol

13: import "./interfaces/IStakedUSDe.sol";

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L13)]


```solidity
File: contracts/StakedUSDeV2.sol

5: import "./interfaces/IStakedUSDeCooldown.sol";

```
*Github:* [[5](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L5)]


```solidity
File: contracts/USDe.sol

8: import "./interfaces/IUSDeDefinitions.sol";

```
*Github:* [[8](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L8)]


```solidity
File: contracts/USDeSilo.sol

6: import "../contracts/interfaces/IUSDeSiloDefinitions.sol";

```
*Github:* [[6](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L6)]



<a name="NC-24"></a> 
### [NC-24] Inconsistent spacing in comments
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

90:   ///@notice max redeemed USDe allowed per block

```
*Github:* [[90](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L90)]



<a name="NC-25"></a> 
### [NC-25] Invalid NatSpec comment style
NatSpec must begin with `///` or use `/* ... */` syntax

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

68:   // @notice custodian addresses

```
*Github:* [[68](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L68)]



<a name="NC-26"></a> 
### [NC-26] Large or complicated code bases should implement invariant tests
This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/)]



<a name="NC-27"></a> 
### [NC-27] Large multiples of ten should use scientific notation
Use a scientific notation rather than decimal literals (e.g. `1e6` instead of `1000000`), for better code readability.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

370:     if (totalRatio != 10_000) {

425:       uint256 amountToTransfer = (amount * ratios[i]) / 10_000;

```
*Github:* [[370](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L370), [425](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L425)]



<a name="NC-28"></a> 
### [NC-28] Named mappings are recommended
[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

*There are <b>7</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

78:   mapping(address => mapping(uint256 => uint256)) private _orderBitmaps;

81:   mapping(uint256 => uint256) public mintedPerBlock;

83:   mapping(uint256 => uint256) public redeemedPerBlock;

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

381:     mapping(uint256 => uint256) storage invalidatorStorage = _orderBitmaps[sender];

393:     mapping(uint256 => uint256) storage invalidatorStorage = _orderBitmaps[sender];

```
*Github:* [[78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L78), [81](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L81), [83](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L83), [86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86), [381](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L381), [393](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L393)]


```solidity
File: contracts/StakedUSDeV2.sol

18:   mapping(address => UserCooldown) public cooldowns;

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L18)]



<a name="NC-29"></a> 
### [NC-29] Named imports of parent contracts are missing

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `IEthenaMinting`
/// @audit `SingleAdminAccessControl`
/// @audit `ReentrancyGuard`
21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21)]


```solidity
File: contracts/SingleAdminAccessControl.sol

/// @audit `IERC5313`
/// @audit `ISingleAdminAccessControl`
/// @audit `AccessControl`
13: abstract contract SingleAdminAccessControl is IERC5313, ISingleAdminAccessControl, AccessControl {

```
*Github:* [[13](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L13)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit `SingleAdminAccessControl`
/// @audit `ReentrancyGuard`
/// @audit `ERC20Permit`
/// @audit `ERC4626`
/// @audit `IStakedUSDe`
21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit `IStakedUSDeCooldown`
/// @audit `StakedUSDe`
15: contract StakedUSDeV2 is IStakedUSDeCooldown, StakedUSDe {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L15)]


```solidity
File: contracts/USDe.sol

/// @audit `Ownable2Step`
/// @audit `ERC20Burnable`
/// @audit `ERC20Permit`
/// @audit `IUSDeDefinitions`
15: contract USDe is Ownable2Step, ERC20Burnable, ERC20Permit, IUSDeDefinitions {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L15)]


```solidity
File: contracts/USDeSilo.sol

/// @audit `IUSDeSiloDefinitions`
12: contract USDeSilo is IUSDeSiloDefinitions {

```
*Github:* [[12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L12)]



<a name="NC-30"></a> 
### [NC-30] NatSpec documentation for function is missing
It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as DeFi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.

*There are <b>10</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

111:   constructor(
         IUSDe _usde,
         address[] memory _assets,
         address[] memory _custodians,
         address _admin,
         uint256 _maxMintPerBlock,
         uint256 _maxRedeemPerBlock
       ) {

320:   function encodeOrder(Order calldata order) public pure returns (bytes memory) {

334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

```
*Github:* [[111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L111), [320](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L320), [334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334)]


```solidity
File: contracts/SingleAdminAccessControl.sol

31:   function acceptAdmin() external {

```
*Github:* [[31](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L31)]


```solidity
File: contracts/USDe.sol

18:   constructor(address admin) ERC20("USDe", "USDe") ERC20Permit("USDe") {

23:   function setMinter(address newMinter) external onlyOwner {

28:   function mint(address to, uint256 amount) external {

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L18), [23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28), [33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


```solidity
File: contracts/USDeSilo.sol

18:   constructor(address stakingVault, address usde) {

28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]



<a name="NC-31"></a> 
### [NC-31] Modifier declarations should have NatSpec descriptions

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/SingleAdminAccessControl.sol

17:   modifier notAdmin(bytes32 role) {

```
*Github:* [[17](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L17)]


```solidity
File: contracts/USDeSilo.sol

23:   modifier onlyStakingVault() {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L23)]



<a name="NC-32"></a> 
### [NC-32] Missing NatSpec `@param`
Some functions have an incomplete NatSpec: add a `@param` notation to describe the function parameters to improve the code documentation.

<details>
<summary>
There are <b>32</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

/// @audit missing @param for `_usde`
/// @audit missing @param for `_assets`
/// @audit missing @param for `_custodians`
/// @audit missing @param for `_admin`
/// @audit missing @param for `_maxMintPerBlock`
/// @audit missing @param for `_maxRedeemPerBlock`
111:   constructor(
         IUSDe _usde,
         address[] memory _assets,
         address[] memory _custodians,
         address _admin,
         uint256 _maxMintPerBlock,
         uint256 _maxRedeemPerBlock
       ) {

/// @audit missing @param for `route`
162:   function mint(Order calldata order, Route calldata route, Signature calldata signature)
         external
         override
         nonReentrant
         onlyRole(MINTER_ROLE)
         belowMaxMintPerBlock(order.usde_amount)
       {

/// @audit missing @param for `_maxMintPerBlock`
219:   function setMaxMintPerBlock(uint256 _maxMintPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `_maxRedeemPerBlock`
224:   function setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `_delegateTo`
235:   function setDelegatedSigner(address _delegateTo) external {

/// @audit missing @param for `_removedSigner`
241:   function removeDelegatedSigner(address _removedSigner) external {

/// @audit missing @param for `wallet`
/// @audit missing @param for `asset`
/// @audit missing @param for `amount`
247:   function transferToCustody(address wallet, address asset, uint256 amount) external nonReentrant onlyRole(MINTER_ROLE) {

/// @audit missing @param for `asset`
259:   function removeSupportedAsset(address asset) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `asset`
265:   function isSupportedAsset(address asset) external view returns (bool) {

/// @audit missing @param for `custodian`
270:   function removeCustodianAddress(address custodian) external onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `asset`
290:   function addSupportedAsset(address asset) public onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `custodian`
298:   function addCustodianAddress(address custodian) public onlyRole(DEFAULT_ADMIN_ROLE) {

/// @audit missing @param for `order`
316:   function hashOrder(Order calldata order) public view override returns (bytes32) {

/// @audit missing @param for `order`
320:   function encodeOrder(Order calldata order) public pure returns (bytes memory) {

/// @audit missing @param for `route`
334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

/// @audit missing @param for `order`
/// @audit missing @param for `signature`
339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

/// @audit missing @param for `route`
/// @audit missing @param for `orderType`
351:   function verifyRoute(Route calldata route, OrderType orderType) public view override returns (bool) {

/// @audit missing @param for `sender`
/// @audit missing @param for `nonce`
377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

/// @audit missing @param for `sender`
/// @audit missing @param for `nonce`
391:   function _deduplicateOrder(address sender, uint256 nonce) private returns (bool) {

/// @audit missing @param for `beneficiary`
/// @audit missing @param for `asset`
/// @audit missing @param for `amount`
401:   function _transferToBeneficiary(address beneficiary, address asset, uint256 amount) internal {

/// @audit missing @param for `amount`
/// @audit missing @param for `asset`
/// @audit missing @param for `benefactor`
/// @audit missing @param for `addresses`
/// @audit missing @param for `ratios`
413:   function _transferCollateral(
         uint256 amount,
         address asset,
         address benefactor,
         address[] calldata addresses,
         uint256[] calldata ratios
       ) internal {

/// @audit missing @param for `_maxMintPerBlock`
436:   function _setMaxMintPerBlock(uint256 _maxMintPerBlock) internal {

/// @audit missing @param for `_maxRedeemPerBlock`
443:   function _setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) internal {

```
*Github:* [[111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L111), [162](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L162), [219](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L219), [224](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L224), [235](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L235), [241](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L241), [247](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L247), [259](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L259), [265](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L265), [270](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L270), [290](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L290), [298](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L298), [316](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L316), [320](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L320), [334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339), [351](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L351), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377), [391](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L391), [401](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L401), [413](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L413), [436](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L436), [443](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L443)]


```solidity
File: contracts/SingleAdminAccessControl.sol

/// @audit missing @param for `role`
/// @audit missing @param for `account`
72:   function _grantRole(bytes32 role, address account) internal override {

```
*Github:* [[72](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L72)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit missing @param for `from`
/// @audit missing @param for `to`
245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

```
*Github:* [[245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit missing @param for `assets`
/// @audit missing @param for `receiver`
/// @audit missing @param for `owner`
52:   function withdraw(uint256 assets, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

/// @audit missing @param for `shares`
/// @audit missing @param for `receiver`
/// @audit missing @param for `owner`
65:   function redeem(uint256 shares, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L52), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L65)]


```solidity
File: contracts/USDe.sol

/// @audit missing @param for `admin`
18:   constructor(address admin) ERC20("USDe", "USDe") ERC20Permit("USDe") {

/// @audit missing @param for `newMinter`
23:   function setMinter(address newMinter) external onlyOwner {

/// @audit missing @param for `to`
/// @audit missing @param for `amount`
28:   function mint(address to, uint256 amount) external {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L18), [23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28)]


```solidity
File: contracts/USDeSilo.sol

/// @audit missing @param for `stakingVault`
/// @audit missing @param for `usde`
18:   constructor(address stakingVault, address usde) {

/// @audit missing @param for `to`
/// @audit missing @param for `amount`
28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="NC-33"></a> 
### [NC-33] Public variable declarations should have NatSpec descriptions

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/StakedUSDeV2.sol

18:   mapping(address => UserCooldown) public cooldowns;

20:   USDeSilo public silo;

22:   uint24 public MAX_COOLDOWN_DURATION = 90 days;

24:   uint24 public cooldownDuration;

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L18), [20](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L20), [22](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L22), [24](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L24)]


```solidity
File: contracts/USDe.sol

16:   address public minter;

```
*Github:* [[16](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L16)]



<a name="NC-34"></a> 
### [NC-34] NatSpec `@return` is missing
It is recommended that Solidity contracts are fully annotated using NatSpec

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

265:   function isSupportedAsset(address asset) external view returns (bool) {

316:   function hashOrder(Order calldata order) public view override returns (bytes32) {

320:   function encodeOrder(Order calldata order) public pure returns (bytes memory) {

334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

351:   function verifyRoute(Route calldata route, OrderType orderType) public view override returns (bool) {

377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

391:   function _deduplicateOrder(address sender, uint256 nonce) private returns (bool) {

```
*Github:* [[265](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L265), [316](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L316), [320](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L320), [334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339), [351](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L351), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377), [391](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L391)]


```solidity
File: contracts/SingleAdminAccessControl.sol

65:   function owner() public view virtual returns (address) {

```
*Github:* [[65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L65)]


```solidity
File: contracts/StakedUSDe.sol

166:   function totalAssets() public view override returns (uint256) {

173:   function getUnvestedAmount() public view returns (uint256) {

184:   function decimals() public pure override(ERC4626, ERC20) returns (uint8) {

```
*Github:* [[166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L166), [173](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L173), [184](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L184)]


```solidity
File: contracts/StakedUSDeV2.sol

52:   function withdraw(uint256 assets, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

65:   function redeem(uint256 shares, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

95:   function cooldownAssets(uint256 assets, address owner) external ensureCooldownOn returns (uint256) {

111:   function cooldownShares(uint256 shares, address owner) external ensureCooldownOn returns (uint256) {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L52), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L65), [95](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L95), [111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L111)]


</details>


<a name="NC-35"></a> 
### [NC-35] Function declarations should have `@notice` tags

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

111:   constructor(
         IUSDe _usde,
         address[] memory _assets,
         address[] memory _custodians,
         address _admin,
         uint256 _maxMintPerBlock,
         uint256 _maxRedeemPerBlock
       ) {

320:   function encodeOrder(Order calldata order) public pure returns (bytes memory) {

334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

```
*Github:* [[111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L111), [320](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L320), [334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334)]


```solidity
File: contracts/SingleAdminAccessControl.sol

31:   function acceptAdmin() external {

65:   function owner() public view virtual returns (address) {

```
*Github:* [[31](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L31), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L65)]


```solidity
File: contracts/StakedUSDe.sol

148:   function redistributeLockedAmount(address from, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

184:   function decimals() public pure override(ERC4626, ERC20) returns (uint8) {

203:   function _deposit(address caller, address receiver, uint256 assets, uint256 shares)
         internal
         override
         nonReentrant
         notZero(assets)
         notZero(shares)
       {

225:   function _withdraw(address caller, address receiver, address _owner, uint256 assets, uint256 shares)
         internal
         override
         nonReentrant
         notZero(assets)
         notZero(shares)
       {

245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[148](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L148), [184](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L184), [203](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L203), [225](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L225), [245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245), [257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]


```solidity
File: contracts/StakedUSDeV2.sol

52:   function withdraw(uint256 assets, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

65:   function redeem(uint256 shares, address receiver, address owner)
        public
        virtual
        override
        ensureCooldownOff
        returns (uint256)
      {

```
*Github:* [[52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L52), [65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L65)]


```solidity
File: contracts/USDe.sol

18:   constructor(address admin) ERC20("USDe", "USDe") ERC20Permit("USDe") {

23:   function setMinter(address newMinter) external onlyOwner {

28:   function mint(address to, uint256 amount) external {

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L18), [23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L28), [33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


```solidity
File: contracts/USDeSilo.sol

18:   constructor(address stakingVault, address usde) {

28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="NC-36"></a> 
### [NC-36] There is no need to initialize variables with 0
Since the variables are automatically set to 0 when created, it is redundant to initialize it with 0 again.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

126:     for (uint256 i = 0; i < _assets.length; i++) {

130:     for (uint256 j = 0; j < _custodians.length; j++) {

356:     uint256 totalRatio = 0;

363:     for (uint256 i = 0; i < route.addresses.length; ++i) {

423:     uint256 totalTransferred = 0;

424:     for (uint256 i = 0; i < addresses.length; ++i) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L126), [130](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L130), [356](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L356), [363](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L363), [423](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L423), [424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424)]



<a name="NC-37"></a> 
### [NC-37] Put all system-wide constants in one file
Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

28:   bytes32 private constant EIP712_DOMAIN =

32:   bytes32 private constant ROUTE_TYPE = keccak256("Route(address[] addresses,uint256[] ratios)");

35:   bytes32 private constant ORDER_TYPE = keccak256(

40:   bytes32 private constant MINTER_ROLE = keccak256("MINTER_ROLE");

43:   bytes32 private constant REDEEMER_ROLE = keccak256("REDEEMER_ROLE");

46:   bytes32 private constant GATEKEEPER_ROLE = keccak256("GATEKEEPER_ROLE");

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

52:   address private constant NATIVE_TOKEN = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L28), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L32), [35](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L35), [40](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L40), [43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L43), [46](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L46), [49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L52), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]


```solidity
File: contracts/StakedUSDe.sol

26:   bytes32 private constant REWARDER_ROLE = keccak256("REWARDER_ROLE");

28:   bytes32 private constant BLACKLIST_MANAGER_ROLE = keccak256("BLACKLIST_MANAGER_ROLE");

30:   bytes32 private constant SOFT_RESTRICTED_STAKER_ROLE = keccak256("SOFT_RESTRICTED_STAKER_ROLE");

32:   bytes32 private constant FULL_RESTRICTED_STAKER_ROLE = keccak256("FULL_RESTRICTED_STAKER_ROLE");

34:   uint256 private constant VESTING_PERIOD = 8 hours;

36:   uint256 private constant MIN_SHARES = 1 ether;

```
*Github:* [[26](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L26), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L28), [30](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L30), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L32), [34](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L34), [36](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L36)]


</details>


<a name="NC-38"></a> 
### [NC-38] State variables should include comments
Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

28:   bytes32 private constant EIP712_DOMAIN =

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L28)]


```solidity
File: contracts/SingleAdminAccessControl.sol

14:   address private _currentDefaultAdmin;

15:   address private _pendingDefaultAdmin;

```
*Github:* [[14](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L14), [15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L15)]


```solidity
File: contracts/USDe.sol

16:   address public minter;

```
*Github:* [[16](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L16)]


```solidity
File: contracts/USDeSilo.sol

15:   address immutable STAKING_VAULT;

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L15)]



<a name="NC-39"></a> 
### [NC-39] Lines are too long
The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

36:     "Order(uint8 order_type,uint256 expiry,uint256 nonce,address benefactor,address beneficiary,address collateral_asset,uint256 collateral_amount,uint256 usde_amount)"

247:   function transferToCustody(address wallet, address asset, uint256 amount) external nonReentrant onlyRole(MINTER_ROLE) {

339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

```
*Github:* [[36](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L36), [247](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L247), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339)]



<a name="NC-40"></a> 
### [NC-40] Unnecessary cast
The variable is being cast to its own type.

*There is one instance of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit no need to cast `token` into address
139:     if (address(token) == asset()) revert InvalidToken();

```
*Github:* [[139](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L139)]



<a name="NC-41"></a> 
### [NC-41] Unused contract variables
The following state variables are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]



<a name="NC-42"></a> 
### [NC-42] Consider using `delete` rather than assigning zero/false to clear values
The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

242:     delegatedSigner[_removedSigner][msg.sender] = false;

```
*Github:* [[242](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L242)]



<a name="NC-43"></a> 
### [NC-43] Expressions for constant values should use `immutable` rather than `constant`
While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary>
There are <b>16</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

28:   bytes32 private constant EIP712_DOMAIN =

32:   bytes32 private constant ROUTE_TYPE = keccak256("Route(address[] addresses,uint256[] ratios)");

35:   bytes32 private constant ORDER_TYPE = keccak256(

40:   bytes32 private constant MINTER_ROLE = keccak256("MINTER_ROLE");

43:   bytes32 private constant REDEEMER_ROLE = keccak256("REDEEMER_ROLE");

46:   bytes32 private constant GATEKEEPER_ROLE = keccak256("GATEKEEPER_ROLE");

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

52:   address private constant NATIVE_TOKEN = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L28), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L32), [35](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L35), [40](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L40), [43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L43), [46](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L46), [49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L52), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]


```solidity
File: contracts/StakedUSDe.sol

26:   bytes32 private constant REWARDER_ROLE = keccak256("REWARDER_ROLE");

28:   bytes32 private constant BLACKLIST_MANAGER_ROLE = keccak256("BLACKLIST_MANAGER_ROLE");

30:   bytes32 private constant SOFT_RESTRICTED_STAKER_ROLE = keccak256("SOFT_RESTRICTED_STAKER_ROLE");

32:   bytes32 private constant FULL_RESTRICTED_STAKER_ROLE = keccak256("FULL_RESTRICTED_STAKER_ROLE");

34:   uint256 private constant VESTING_PERIOD = 8 hours;

36:   uint256 private constant MIN_SHARES = 1 ether;

```
*Github:* [[26](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L26), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L28), [30](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L30), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L32), [34](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L34), [36](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L36)]


</details>


<a name="NC-44"></a> 
### [NC-44] Use `@inheritdoc` for overridden functions

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

316:   function hashOrder(Order calldata order) public view override returns (bytes32) {

339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

351:   function verifyRoute(Route calldata route, OrderType orderType) public view override returns (bool) {

377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

```
*Github:* [[316](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L316), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339), [351](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L351), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377)]


```solidity
File: contracts/SingleAdminAccessControl.sol

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

58:   function renounceRole(bytes32 role, address account) public virtual override notAdmin(role) {

72:   function _grantRole(bytes32 role, address account) internal override {

```
*Github:* [[41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L58), [72](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L72)]


```solidity
File: contracts/StakedUSDe.sol

166:   function totalAssets() public view override returns (uint256) {

245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L166), [245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245), [257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]


```solidity
File: contracts/USDe.sol

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


</details>


<a name="NC-45"></a> 
### [NC-45] Use the latest solidity version for deployment
Upgrading to a newer Solidity release can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L2)]


```solidity
File: contracts/SingleAdminAccessControl.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L2)]


```solidity
File: contracts/StakedUSDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L2)]


```solidity
File: contracts/StakedUSDeV2.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L2)]


```solidity
File: contracts/USDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L2)]


```solidity
File: contracts/USDeSilo.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L2)]



<a name="NC-46"></a> 
### [NC-46] Use of `override` is unnecessary
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

<details>
<summary>
There are <b>12</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

316:   function hashOrder(Order calldata order) public view override returns (bytes32) {

339:   function verifyOrder(Order calldata order, Signature calldata signature) public view override returns (bool, bytes32) {

351:   function verifyRoute(Route calldata route, OrderType orderType) public view override returns (bool) {

377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

```
*Github:* [[316](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L316), [339](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L339), [351](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L351), [377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377)]


```solidity
File: contracts/SingleAdminAccessControl.sol

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

58:   function renounceRole(bytes32 role, address account) public virtual override notAdmin(role) {

72:   function _grantRole(bytes32 role, address account) internal override {

```
*Github:* [[41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L58), [72](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L72)]


```solidity
File: contracts/StakedUSDe.sol

166:   function totalAssets() public view override returns (uint256) {

245:   function _beforeTokenTransfer(address from, address to, uint256) internal virtual override {

257:   function renounceRole(bytes32, address) public virtual override {

```
*Github:* [[166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L166), [245](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L245), [257](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L257)]


```solidity
File: contracts/USDe.sol

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


</details>


<a name="NC-47"></a> 
### [NC-47] Returning a struct instead of a bunch of variables is better
If a function returns [too many variables](https://docs.soliditylang.org/en/v0.8.21/contracts.html#returning-multiple-values), replacing them with a struct can improve code readability, maintainability and reusability.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit 4 return variables
377:   function verifyNonce(address sender, uint256 nonce) public view override returns (bool, uint256, uint256, uint256) {

```
*Github:* [[377](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L377)]



<a name="NC-48"></a> 
### [NC-48] Visibility of state variables is not explicitly defined
To avoid misunderstandings and unexpected state accesses, it is recommended to explicitly define the visibility of each state variable.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

15:   address immutable STAKING_VAULT;

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L15)]



<a name="NC-49"></a> 
### [NC-49] Names of `private`/`internal` state variables should be prefixed with an underscore
It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

<details>
<summary>
There are <b>18</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

28:   bytes32 private constant EIP712_DOMAIN =

32:   bytes32 private constant ROUTE_TYPE = keccak256("Route(address[] addresses,uint256[] ratios)");

35:   bytes32 private constant ORDER_TYPE = keccak256(

40:   bytes32 private constant MINTER_ROLE = keccak256("MINTER_ROLE");

43:   bytes32 private constant REDEEMER_ROLE = keccak256("REDEEMER_ROLE");

46:   bytes32 private constant GATEKEEPER_ROLE = keccak256("GATEKEEPER_ROLE");

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

52:   address private constant NATIVE_TOKEN = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L28), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L32), [35](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L35), [40](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L40), [43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L43), [46](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L46), [49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [52](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L52), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]


```solidity
File: contracts/StakedUSDe.sol

26:   bytes32 private constant REWARDER_ROLE = keccak256("REWARDER_ROLE");

28:   bytes32 private constant BLACKLIST_MANAGER_ROLE = keccak256("BLACKLIST_MANAGER_ROLE");

30:   bytes32 private constant SOFT_RESTRICTED_STAKER_ROLE = keccak256("SOFT_RESTRICTED_STAKER_ROLE");

32:   bytes32 private constant FULL_RESTRICTED_STAKER_ROLE = keccak256("FULL_RESTRICTED_STAKER_ROLE");

34:   uint256 private constant VESTING_PERIOD = 8 hours;

36:   uint256 private constant MIN_SHARES = 1 ether;

```
*Github:* [[26](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L26), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L28), [30](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L30), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L32), [34](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L34), [36](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L36)]


```solidity
File: contracts/USDeSilo.sol

15:   address immutable STAKING_VAULT;

16:   IERC20 immutable USDE;

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L15), [16](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L16)]


</details>


<a name="NC-50"></a> 
### [NC-50] Variables should be named in mixedCase style
As the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) suggests: arguments, local variables and mutable state variables should be named in mixedCase style.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

340:     bytes32 taker_order_hash = hashOrder(order);

```
*Github:* [[340](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L340)]


```solidity
File: contracts/StakedUSDeV2.sol

22:   uint24 public MAX_COOLDOWN_DURATION = 90 days;

```
*Github:* [[22](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L22)]



<a name="NC-51"></a> 
### [NC-51] Functions not used internally could be marked `external`

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

334:   function encodeRoute(Route calldata route) public pure returns (bytes memory) {

```
*Github:* [[334](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L334)]


```solidity
File: contracts/SingleAdminAccessControl.sol

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

```
*Github:* [[41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50)]


```solidity
File: contracts/StakedUSDe.sol

166:   function totalAssets() public view override returns (uint256) {

184:   function decimals() public pure override(ERC4626, ERC20) returns (uint8) {

```
*Github:* [[166](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L166), [184](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L184)]


```solidity
File: contracts/USDe.sol

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]



<a name="GAS-1"></a> 
### [GAS-1] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate
Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot. Finally, if both fields are accessed in the same function, can save ~42 gas per access due to not having to [recalculate the key's keccak256 hash](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0) (Gkeccak256 - 30 gas) and that calculation's associated stack operations.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

78:   mapping(address => mapping(uint256 => uint256)) private _orderBitmaps;

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

```
*Github:* [[78](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L78), [86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86)]



<a name="GAS-2"></a> 
### [GAS-2] Consider activating via-ir for deploying
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*
```solidity

Global finding

```
*Github:* [[Global](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/)]



<a name="GAS-3"></a> 
### [GAS-3] Divisions can be `unchecked` to save gas
The expression `type(int).min/(-1)` is the only case where division causes an overflow. Therefore, uncheck can be used to [save gas](https://gist.github.com/DadeKuma/3bc597338ae774b8b3bd43280d55271f) in scenarios where it is certain that such an overflow will not occur.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

425:       uint256 amountToTransfer = (amount * ratios[i]) / 10_000;

```
*Github:* [[425](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L425)]


```solidity
File: contracts/StakedUSDe.sol

180:     return ((VESTING_PERIOD - timeSinceLastDistribution) * vestingAmount) / VESTING_PERIOD;

```
*Github:* [[180](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L180)]



<a name="GAS-4"></a> 
### [GAS-4] Don't transfer with zero amount to save gas
In Solidity, unnecessary operations can waste gas. For example, a transfer function without a zero amount check uses gas even if called with a zero amount, since the contract state remains unchanged. Implementing a zero amount check avoids these unnecessary function calls, saving gas and improving efficiency.

*There is one instance of this issue:*
```solidity
File: contracts/USDeSilo.sol

29:     USDE.transfer(to, amount);

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L29)]



<a name="GAS-5"></a> 
### [GAS-5] Operator `+=` costs more gas than `<x> = <x> + <y>` for state variables

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

174:     mintedPerBlock[block.number] += order.usde_amount;

205:     redeemedPerBlock[block.number] += order.usde_amount;

368:       totalRatio += route.ratios[i];

427:       totalTransferred += amountToTransfer;

```
*Github:* [[174](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L174), [205](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L205), [368](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L368), [427](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L427)]


```solidity
File: contracts/StakedUSDeV2.sol

101:     cooldowns[owner].underlyingAmount += assets;

117:     cooldowns[owner].underlyingAmount += assets;

```
*Github:* [[101](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L101), [117](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L117)]



<a name="GAS-6"></a> 
### [GAS-6] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function to save gas
Saves deployment costs.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit duplicated on line 211
157:       revert OperationNotAllowed();

/// @audit duplicated on line 247
233:       revert OperationNotAllowed();

/// @audit duplicated on line 250
258:     revert OperationNotAllowed();

```
*Github:* [[157](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L157), [233](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L233), [258](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L258)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit duplicated on line 128
88:       revert InvalidCooldown();

```
*Github:* [[88](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L88)]



<a name="GAS-7"></a> 
### [GAS-7] Increments can be `unchecked` to save gas
Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save 30-40 gas per iteration. So it is recommended to use unchecked increments when overflow is not possible.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

363:     for (uint256 i = 0; i < route.addresses.length; ++i) {

424:     for (uint256 i = 0; i < addresses.length; ++i) {

```
*Github:* [[363](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L363), [424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424)]



<a name="GAS-8"></a> 
### [GAS-8] `internal` functions only called once can be inlined to save gas
If an `internal` function is only used once, there is no need to modularize it, unless the function calling it would otherwise be too long and complex. Not inlining costs 20 to 40 gas because of two extra JUMP instructions and additional stack operations needed for function calls.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `_transferToBeneficiary` is used only once
401:   function _transferToBeneficiary(address beneficiary, address asset, uint256 amount) internal {

/// @audit `_transferCollateral` is used only once
413:   function _transferCollateral(

```
*Github:* [[401](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L401), [413](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L413)]



<a name="GAS-9"></a> 
### [GAS-9] `keccak256()` hash of literals should only be computed once
The result of the hash should be stored in an immutable variable, and the variable should be used instead. If the hash is being used as a part of a function selector, the cast to `bytes4` should also only be done once.

<details>
<summary>
There are <b>11</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

29:     keccak256("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)");

32:   bytes32 private constant ROUTE_TYPE = keccak256("Route(address[] addresses,uint256[] ratios)");

40:   bytes32 private constant MINTER_ROLE = keccak256("MINTER_ROLE");

43:   bytes32 private constant REDEEMER_ROLE = keccak256("REDEEMER_ROLE");

46:   bytes32 private constant GATEKEEPER_ROLE = keccak256("GATEKEEPER_ROLE");

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L29), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L32), [40](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L40), [43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L43), [46](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L46), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]


```solidity
File: contracts/StakedUSDe.sol

26:   bytes32 private constant REWARDER_ROLE = keccak256("REWARDER_ROLE");

28:   bytes32 private constant BLACKLIST_MANAGER_ROLE = keccak256("BLACKLIST_MANAGER_ROLE");

30:   bytes32 private constant SOFT_RESTRICTED_STAKER_ROLE = keccak256("SOFT_RESTRICTED_STAKER_ROLE");

32:   bytes32 private constant FULL_RESTRICTED_STAKER_ROLE = keccak256("FULL_RESTRICTED_STAKER_ROLE");

```
*Github:* [[26](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L26), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L28), [30](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L30), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L32)]


</details>


<a name="GAS-10"></a> 
### [GAS-10] Low level `call` can be optimized with assembly
When using low-level calls, the `returnData` is copied to memory even if the variable is not utilized. The proper way to handle this is through a low level assembly call.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="GAS-11"></a> 
### [GAS-11] Multiple accesses of the same mapping/array key/index should be cached
The instances below point to the second+ access of a value inside a mapping/array, within a function. Caching a mapping's value in a local `storage` or `calldata` variable when the value is accessed [multiple times](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0), saves ~42 gas per access due to not having to recalculate the key's keccak256 hash (Gkeccak256 - 30 gas) and that calculation's associated stack operations. Caching an array's struct avoids recalculating the array offsets into memory/calldata

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDeV2.sol

/// @audit `cooldowns[owner]` is also accessed on line 100
101:     cooldowns[owner].underlyingAmount += assets;

/// @audit `cooldowns[owner]` is also accessed on line 116
117:     cooldowns[owner].underlyingAmount += assets;

```
*Github:* [[101](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L101), [117](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L117)]



<a name="GAS-12"></a> 
### [GAS-12] Newer versions of solidity are more gas efficient
The solidity language continues to pursue more efficient gas optimization schemes. Adopting a newer version of solidity can be more gas efficient.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L2)]


```solidity
File: contracts/SingleAdminAccessControl.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L2)]


```solidity
File: contracts/StakedUSDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L2)]


```solidity
File: contracts/StakedUSDeV2.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L2)]


```solidity
File: contracts/USDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L2)]


```solidity
File: contracts/USDeSilo.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L2)]



<a name="GAS-13"></a> 
### [GAS-13] Operator `>=`/`<=` costs less gas than operator `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can save 3 gas for each. It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

<details>
<summary>
There are <b>14</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

98:     if (mintedPerBlock[block.number] + mintAmount > maxMintPerBlock) revert MaxMintPerBlockExceeded();

105:     if (redeemedPerBlock[block.number] + redeemAmount > maxRedeemPerBlock) revert MaxRedeemPerBlockExceeded();

126:     for (uint256 i = 0; i < _assets.length; i++) {

130:     for (uint256 j = 0; j < _custodians.length; j++) {

346:     if (block.timestamp > order.expiry) revert SignatureExpired();

363:     for (uint256 i = 0; i < route.addresses.length; ++i) {

403:       if (address(this).balance < amount) revert InvalidAmount();

424:     for (uint256 i = 0; i < addresses.length; ++i) {

430:     if (remainingBalance > 0) {

```
*Github:* [[98](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L98), [105](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L105), [126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L126), [130](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L130), [346](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L346), [363](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L363), [403](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L403), [424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424), [430](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L430)]


```solidity
File: contracts/StakedUSDe.sol

193:     if (_totalSupply > 0 && _totalSupply < MIN_SHARES) revert MinSharesViolation();

193:     if (_totalSupply > 0 && _totalSupply < MIN_SHARES) revert MinSharesViolation();

```
*Github:* [[193](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L193), [193](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L193)]


```solidity
File: contracts/StakedUSDeV2.sol

96:     if (assets > maxWithdraw(owner)) revert ExcessiveWithdrawAmount();

112:     if (shares > maxRedeem(owner)) revert ExcessiveRedeemAmount();

127:     if (duration > MAX_COOLDOWN_DURATION) {

```
*Github:* [[96](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L96), [112](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L112), [127](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L127)]


</details>


<a name="GAS-14"></a> 
### [GAS-14] Optimize names to save gas
`public`/`external` function names and `public` member variable names can be optimized to save gas. See this [link](https://gist.github.com/IllIllI000/a5d8b486a8259f9f77891a919febd1a9) for an example of how it works. Below are the interfaces/abstract contracts that can be optimized so that the most frequently-called functions use the least amount of gas possible during method lookup. Method IDs that have two leading zero bytes can save 128 gas each during deployment, and renaming functions to have lower method IDs will save 22 gas per call, [per sorted position shifted](https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92)

*There are <b>5</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `mint`, `redeem`, `setMaxMintPerBlock`, `setMaxRedeemPerBlock`, `disableMintRedeem`, `setDelegatedSigner`, `removeDelegatedSigner`, `transferToCustody`, `removeSupportedAsset`, `isSupportedAsset`, `removeCustodianAddress`, `removeMinterRole`, `removeRedeemerRole`, `addSupportedAsset`, `addCustodianAddress`, `getDomainSeparator`, `hashOrder`, `encodeOrder`, `encodeRoute`, `verifyOrder`, `verifyRoute`, `verifyNonce`
21: contract EthenaMinting is IEthenaMinting, SingleAdminAccessControl, ReentrancyGuard {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L21)]


```solidity
File: contracts/StakedUSDe.sol

/// @audit `transferInRewards`, `addToBlacklist`, `removeFromBlacklist`, `rescueTokens`, `redistributeLockedAmount`, `totalAssets`, `getUnvestedAmount`, `decimals`, `renounceRole`
21: contract StakedUSDe is SingleAdminAccessControl, ReentrancyGuard, ERC20Permit, ERC4626, IStakedUSDe {

```
*Github:* [[21](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L21)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit `withdraw`, `redeem`, `unstake`, `cooldownAssets`, `cooldownShares`, `setCooldownDuration`
15: contract StakedUSDeV2 is IStakedUSDeCooldown, StakedUSDe {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L15)]


```solidity
File: contracts/USDe.sol

/// @audit `setMinter`, `mint`, `renounceOwnership`
15: contract USDe is Ownable2Step, ERC20Burnable, ERC20Permit, IUSDeDefinitions {

```
*Github:* [[15](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L15)]


```solidity
File: contracts/USDeSilo.sol

/// @audit `withdraw`
12: contract USDeSilo is IUSDeSiloDefinitions {

```
*Github:* [[12](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L12)]



<a name="GAS-15"></a> 
### [GAS-15] Redundant state variable getters
Getters for public state variables are automatically generated so there is no need to code them manually and waste gas.

*There is one instance of this issue:*
```solidity
File: contracts/SingleAdminAccessControl.sol

65:   function owner() public view virtual returns (address) {
        return _currentDefaultAdmin;

```
*Github:* [[65](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L65)]



<a name="GAS-16"></a> 
### [GAS-16] Remove or replace unused state variables
Saves a storage slot. If the variable is assigned a non-zero value, saves Gsset (20000 gas). If it's assigned a zero value, saves Gsreset (2900 gas). If the variable remains unassigned, there is no gas savings unless the variable is `public`, in which case the compiler-generated non-payable getter deployment cost is saved. If the state variable is overriding an interface's public function, mark the variable as `constant` or `immutable` so that it does not use a storage slot.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

```
*Github:* [[49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58)]



<a name="GAS-17"></a> 
### [GAS-17] The result of a function call should be cached rather than re-calling the function
The function calls in solidity are expensive. If the same result of the same function calls are to be used several times, the result should be cached to reduce the gas consumption of repeated calls.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit `getUnvestedAmount` is called 2 times
70:   constructor(IERC20 _asset, address _initialRewarder, address _owner)
        ERC20("Staked USDe", "stUSDe")
        ERC4626(_asset)
        ERC20Permit("stUSDe")
      {

/// @audit `getUnvestedAmount` is called 2 times
89:   function transferInRewards(uint256 amount) external nonReentrant onlyRole(REWARDER_ROLE) notZero(amount) {

```
*Github:* [[70](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L70), [89](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L89)]



<a name="GAS-18"></a> 
### [GAS-18] Unlimited gas consumption risk due to external call recipients
When calling an external function without specifying a gas limit , the called contract may consume all the remaining gas, causing the tx to be reverted. To mitigate this, it is recommended to explicitly set a gas limit when making low level external calls.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

250:       (bool success,) = wallet.call{value: amount}("");

404:       (bool success,) = (beneficiary).call{value: amount}("");

```
*Github:* [[250](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L250), [404](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L404)]



<a name="GAS-19"></a> 
### [GAS-19] Use assembly to compute hashes to save gas
If the arguments to the encode call can fit into the scratch space (two words or fewer), then it's more efficient to use assembly to generate the hash (80 gas):

`keccak256(abi.encodePacked(x, y)) -> assembly {mstore(0x00, a); mstore(0x20, b); let hash := keccak256(0x00, 0x40); }`

<details>
<summary>
There are <b>15</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

29:     keccak256("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)");

32:   bytes32 private constant ROUTE_TYPE = keccak256("Route(address[] addresses,uint256[] ratios)");

35:   bytes32 private constant ORDER_TYPE = keccak256(

40:   bytes32 private constant MINTER_ROLE = keccak256("MINTER_ROLE");

43:   bytes32 private constant REDEEMER_ROLE = keccak256("REDEEMER_ROLE");

46:   bytes32 private constant GATEKEEPER_ROLE = keccak256("GATEKEEPER_ROLE");

49:   bytes32 private constant EIP712_DOMAIN_TYPEHASH = keccak256(abi.encodePacked(EIP712_DOMAIN));

55:   bytes32 private constant EIP_712_NAME = keccak256("EthenaMinting");

58:   bytes32 private constant EIP712_REVISION = keccak256("1");

317:     return ECDSA.toTypedDataHash(getDomainSeparator(), keccak256(encodeOrder(order)));

452:     return keccak256(abi.encode(EIP712_DOMAIN, EIP_712_NAME, EIP712_REVISION, block.chainid, address(this)));

```
*Github:* [[29](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L29), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L32), [35](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L35), [40](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L40), [43](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L43), [46](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L46), [49](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L49), [55](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L55), [58](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L58), [317](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L317), [452](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L452)]


```solidity
File: contracts/StakedUSDe.sol

26:   bytes32 private constant REWARDER_ROLE = keccak256("REWARDER_ROLE");

28:   bytes32 private constant BLACKLIST_MANAGER_ROLE = keccak256("BLACKLIST_MANAGER_ROLE");

30:   bytes32 private constant SOFT_RESTRICTED_STAKER_ROLE = keccak256("SOFT_RESTRICTED_STAKER_ROLE");

32:   bytes32 private constant FULL_RESTRICTED_STAKER_ROLE = keccak256("FULL_RESTRICTED_STAKER_ROLE");

```
*Github:* [[26](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L26), [28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L28), [30](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L30), [32](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L32)]


</details>


<a name="GAS-20"></a> 
### [GAS-20] Use assembly to emit events
To efficiently emit events, it's possible to utilize assembly by making use of scratch space and the free memory pointer. This approach has the advantage of potentially avoiding the costs associated with memory expansion.

However, it's important to note that in order to safely optimize this process, it is preferable to cache and restore the free memory pointer.

A good example of such practice can be seen in [Solady's](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC1155.sol#L167) codebase.

<details>
<summary>
There are <b>19</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

145:     emit USDeSet(address(_usde));

154:     emit Received(msg.sender, msg.value);

179:     emit Mint(

208:     emit Redeem(

237:     emit DelegatedSignerAdded(_delegateTo, msg.sender);

243:     emit DelegatedSignerRemoved(_removedSigner, msg.sender);

255:     emit CustodyTransfer(wallet, asset, amount);

261:     emit AssetRemoved(asset);

272:     emit CustodianAddressRemoved(custodian);

294:     emit AssetAdded(asset);

302:     emit CustodianAddressAdded(custodian);

439:     emit MaxMintPerBlockChanged(oldMaxMintPerBlock, maxMintPerBlock);

446:     emit MaxRedeemPerBlockChanged(oldMaxRedeemPerBlock, maxRedeemPerBlock);

```
*Github:* [[145](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L145), [154](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L154), [179](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L179), [208](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L208), [237](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L237), [243](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L243), [255](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L255), [261](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L261), [272](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L272), [294](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L294), [302](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L302), [439](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L439), [446](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L446)]


```solidity
File: contracts/SingleAdminAccessControl.sol

28:     emit AdminTransferRequested(_currentDefaultAdmin, newAdmin);

74:       emit AdminTransferred(_currentDefaultAdmin, account);

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L28), [74](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L74)]


```solidity
File: contracts/StakedUSDe.sol

98:     emit RewardsReceived(amount, newVestingAmount);

155:       emit LockedAmountRedistributed(from, to, amountToDistribute);

```
*Github:* [[98](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L98), [155](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L155)]


```solidity
File: contracts/StakedUSDeV2.sol

133:     emit CooldownDurationUpdated(previousDuration, cooldownDuration);

```
*Github:* [[133](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L133)]


```solidity
File: contracts/USDe.sol

24:     emit MinterUpdated(newMinter, minter);

```
*Github:* [[24](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L24)]


</details>


<a name="GAS-21"></a> 
### [GAS-21] Use assembly to write address/contract type storage values
Using `assembly { sstore(state.slot, addr)` instead of `state = addr` can save gas.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/SingleAdminAccessControl.sol

27:     _pendingDefaultAdmin = newAdmin;

76:       _currentDefaultAdmin = account;

```
*Github:* [[27](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L27), [76](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L76)]


```solidity
File: contracts/USDe.sol

25:     minter = newMinter;

25:     minter = newMinter;

```
*Github:* [[25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L25), [25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L25)]



<a name="GAS-22"></a> 
### [GAS-22] Using a double `if` statement instead of a logical AND (`&&`)
Using a double `if` statement instead of a logical AND (`&&`) can provide similar short-circuiting behavior whereas double if is slightly [more gas efficient](https://gist.github.com/DadeKuma/931ce6794a050201ec6544dbcc31316c).

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

149:     if (hasRole(FULL_RESTRICTED_STAKER_ROLE, from) && !hasRole(FULL_RESTRICTED_STAKER_ROLE, to)) {

193:     if (_totalSupply > 0 && _totalSupply < MIN_SHARES) revert MinSharesViolation();

246:     if (hasRole(FULL_RESTRICTED_STAKER_ROLE, from) && to != address(0)) {

```
*Github:* [[149](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L149), [193](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L193), [246](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L246)]



<a name="GAS-23"></a> 
### [GAS-23] Use local variables for emitting
Use the function/modifier's local copy of the state variable, rather than incurring an extra Gwarmaccess (100 gas). In the unlikely event that the state variable hasn't already been used by the function/modifier, consider whether it is really necessary to include it in the event, given the fact that it incurs a Gcoldsload (2100 gas), or whether it can be passed in to or back out of the functions that do use it

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit `maxMintPerBlock`
439:     emit MaxMintPerBlockChanged(oldMaxMintPerBlock, maxMintPerBlock);

/// @audit `maxRedeemPerBlock`
446:     emit MaxRedeemPerBlockChanged(oldMaxRedeemPerBlock, maxRedeemPerBlock);

```
*Github:* [[439](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L439), [446](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L446)]


```solidity
File: contracts/SingleAdminAccessControl.sol

/// @audit `_currentDefaultAdmin`
28:     emit AdminTransferRequested(_currentDefaultAdmin, newAdmin);

/// @audit `_currentDefaultAdmin`
74:       emit AdminTransferred(_currentDefaultAdmin, account);

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L28), [74](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L74)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit `cooldownDuration`
133:     emit CooldownDurationUpdated(previousDuration, cooldownDuration);

```
*Github:* [[133](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L133)]


```solidity
File: contracts/USDe.sol

/// @audit `minter`
24:     emit MinterUpdated(newMinter, minter);

```
*Github:* [[24](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L24)]



<a name="GAS-24"></a> 
### [GAS-24] Use a more recent version of solidity
- Use a solidity version of at least 0.8.2 to get simple compiler automatic inlining.
- Use a solidity version of at least 0.8.3 to get better struct packing and cheaper multiple storage reads.
- Use a solidity version of at least 0.8.4 to get custom errors, which are cheaper at deployment than revert()/require() strings.
- Use a solidity version of at least 0.8.10 to have external calls skip contract existence checks if the external call has a return value.

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L2)]


```solidity
File: contracts/SingleAdminAccessControl.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L2)]


```solidity
File: contracts/StakedUSDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L2)]


```solidity
File: contracts/StakedUSDeV2.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L2)]


```solidity
File: contracts/USDe.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L2)]


```solidity
File: contracts/USDeSilo.sol

2: pragma solidity 0.8.19;

```
*Github:* [[2](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L2)]



<a name="GAS-25"></a> 
### [GAS-25] Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes
Avoids a Gsset (20000 gas) when changing from false to true, after having been true in the past. Since most of the bools aren't changed twice in one transaction, I've counted the amount of gas as half of the full amount, for each variable.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

```
*Github:* [[86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86)]



<a name="GAS-26"></a> 
### [GAS-26] Use `unchecked` block for safe subtractions
If it can be confirmed that the subtraction operation will not overflow, using an unchecked block can save gas. For example, `require(x <= y); z = y - x;` can be optimized to `require(x <= y); unchecked { z = y - x; }`

*There is one instance of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit this subtraction is checked on line 176
180:     return ((VESTING_PERIOD - timeSinceLastDistribution) * vestingAmount) / VESTING_PERIOD;

```
*Github:* [[180](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L180)]



<a name="GAS-27"></a> 
### [GAS-27] Using bitmap to store bool states can save gas
Using a bitmap instead of a bool array or a bool mapping to store boolean states can save gas fees. This is because the bitmap can store 256 boolean values in a single slot instead of 256 slots, which can save gas when writing bool values or when reading multiple bool values from the same slot.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

```
*Github:* [[86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86)]



<a name="GAS-28"></a> 
### [GAS-28] Using `constant`s directly, rather than caching the value, saves gas

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/StakedUSDe.sol

/// @audit `SOFT_RESTRICTED_STAKER_ROLE`
111:     bytes32 role = isFullBlacklisting ? FULL_RESTRICTED_STAKER_ROLE : SOFT_RESTRICTED_STAKER_ROLE;

/// @audit `SOFT_RESTRICTED_STAKER_ROLE`
125:     bytes32 role = isFullBlacklisting ? FULL_RESTRICTED_STAKER_ROLE : SOFT_RESTRICTED_STAKER_ROLE;

```
*Github:* [[111](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L111), [125](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L125)]



<a name="GAS-29"></a> 
### [GAS-29] Using `this` to access functions results in an external call, wasting gas
External calls have an overhead of 100 gas, which can be avoided by not referencing the function using `this`. Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`, so make this change if it's required in order to call the function internally.

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

403:       if (address(this).balance < amount) revert InvalidAmount();

```
*Github:* [[403](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L403)]



<a name="GAS-30"></a> 
### [GAS-30] Use `selfbalance()` instead of `address(this).balance`
Use assembly when getting a contract's balance of ETH.

You can use `selfbalance()` instead of `address(this).balance` when getting your contract's balance of ETH to save gas.
Additionally, you can use `balance(address)` instead of `address.balance()` when getting an external contract's balance of ETH.

*Saves 15 gas when checking internal balance, 6 for external*

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

403:       if (address(this).balance < amount) revert InvalidAmount();

```
*Github:* [[403](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L403)]



<a name="GAS-31"></a> 
### [GAS-31] Using bools for storage incurs overhead
Use uint256(1) and uint256(2) for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from false to true, after having been true in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*There is one instance of this issue:*
```solidity
File: contracts/EthenaMinting.sol

86:   mapping(address => mapping(address => bool)) public delegatedSigner;

```
*Github:* [[86](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L86)]



<a name="GAS-32"></a> 
### [GAS-32] Cache array length outside of loop
If not cached, the solidity compiler will always read the length of the array during each iteration. That is, if it is a storage array, this is an extra sload operation (100 additional extra gas for each iteration except for the first) and if it is a memory array, this is an extra mload operation (3 additional gas for each iteration except for the first).

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

126:     for (uint256 i = 0; i < _assets.length; i++) {

130:     for (uint256 j = 0; j < _custodians.length; j++) {

363:     for (uint256 i = 0; i < route.addresses.length; ++i) {

424:     for (uint256 i = 0; i < addresses.length; ++i) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L126), [130](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L130), [363](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L363), [424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424)]



<a name="GAS-33"></a> 
### [GAS-33] State variables should be cached in stack variables rather than re-reading them from storage
The instances below point to the second+ access of a state variable within a function. Caching of a state variable replaces each Gwarmaccess (100 gas) with a much cheaper stack read. Other less obvious fixes/optimizations include having local memory caches of state variable structs, or having local caches of state variable contracts/addresses.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

/// @audit more than 1 read for `maxMintPerBlock`, line 438 and 437
438:     maxMintPerBlock = _maxMintPerBlock;

/// @audit more than 1 read for `maxRedeemPerBlock`, line 445 and 444
445:     maxRedeemPerBlock = _maxRedeemPerBlock;

```
*Github:* [[438](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L438), [445](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L445)]


```solidity
File: contracts/StakedUSDeV2.sol

/// @audit more than 1 read for `cooldownDuration`, line 132 and 131
132:     cooldownDuration = duration;

```
*Github:* [[132](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L132)]



<a name="GAS-34"></a> 
### [GAS-34] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

113:     address[] memory _assets,

114:     address[] memory _custodians,

```
*Github:* [[113](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L113), [114](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L114)]



<a name="GAS-35"></a> 
### [GAS-35] Don't initialize variables with default value

*There are <b>6</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

126:     for (uint256 i = 0; i < _assets.length; i++) {

130:     for (uint256 j = 0; j < _custodians.length; j++) {

356:     uint256 totalRatio = 0;

363:     for (uint256 i = 0; i < route.addresses.length; ++i) {

423:     uint256 totalTransferred = 0;

424:     for (uint256 i = 0; i < addresses.length; ++i) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L126), [130](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L130), [356](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L356), [363](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L363), [423](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L423), [424](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L424)]



<a name="GAS-36"></a> 
### [GAS-36] Usage of `int`s/`uint`s smaller than 32 bytes incurs overhead
Using `int`s/`uint`s smaller than 32 bytes may cost more gas. This is because the EVM operates on 32 bytes at a time, so if an element is smaller than 32 bytes, the EVM must perform more operations to reduce the size of the element from 32 bytes to the desired size.

*There are <b>4</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

36:     "Order(uint8 order_type,uint256 expiry,uint256 nonce,address benefactor,address beneficiary,address collateral_asset,uint256 collateral_amount,uint256 usde_amount)"

379:     uint256 invalidatorSlot = uint64(nonce) >> 8;

380:     uint256 invalidatorBit = 1 << uint8(nonce);

```
*Github:* [[36](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L36), [379](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L379), [380](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L380)]


```solidity
File: contracts/StakedUSDe.sol

184:   function decimals() public pure override(ERC4626, ERC20) returns (uint8) {

```
*Github:* [[184](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L184)]



<a name="GAS-37"></a> 
### [GAS-37] Constructors can be marked as `payable` to save deployment gas
Payable functions cost less gas to execute, because the compiler does not have to add extra checks to ensure that no payment is provided. A constructor can be safely marked as payable, because only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/StakedUSDeV2.sol

42:   constructor(IERC20 _asset, address initialRewarder, address owner) StakedUSDe(_asset, initialRewarder, owner) {

```
*Github:* [[42](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L42)]


```solidity
File: contracts/USDe.sol

18:   constructor(address admin) ERC20("USDe", "USDe") ERC20Permit("USDe") {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L18)]


```solidity
File: contracts/USDeSilo.sol

18:   constructor(address stakingVault, address usde) {

```
*Github:* [[18](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L18)]



<a name="GAS-38"></a> 
### [GAS-38] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided.

<details>
<summary>
There are <b>20</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

219:   function setMaxMintPerBlock(uint256 _maxMintPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

224:   function setMaxRedeemPerBlock(uint256 _maxRedeemPerBlock) external onlyRole(DEFAULT_ADMIN_ROLE) {

229:   function disableMintRedeem() external onlyRole(GATEKEEPER_ROLE) {

247:   function transferToCustody(address wallet, address asset, uint256 amount) external nonReentrant onlyRole(MINTER_ROLE) {

259:   function removeSupportedAsset(address asset) external onlyRole(DEFAULT_ADMIN_ROLE) {

270:   function removeCustodianAddress(address custodian) external onlyRole(DEFAULT_ADMIN_ROLE) {

277:   function removeMinterRole(address minter) external onlyRole(GATEKEEPER_ROLE) {

283:   function removeRedeemerRole(address redeemer) external onlyRole(GATEKEEPER_ROLE) {

290:   function addSupportedAsset(address asset) public onlyRole(DEFAULT_ADMIN_ROLE) {

298:   function addCustodianAddress(address custodian) public onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[219](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L219), [224](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L224), [229](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L229), [247](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L247), [259](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L259), [270](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L270), [277](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L277), [283](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L283), [290](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L290), [298](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L298)]


```solidity
File: contracts/SingleAdminAccessControl.sol

25:   function transferAdmin(address newAdmin) external onlyRole(DEFAULT_ADMIN_ROLE) {

41:   function grantRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

50:   function revokeRole(bytes32 role, address account) public override onlyRole(DEFAULT_ADMIN_ROLE) notAdmin(role) {

```
*Github:* [[25](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L25), [41](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L41), [50](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/SingleAdminAccessControl.sol#L50)]


```solidity
File: contracts/StakedUSDe.sol

89:   function transferInRewards(uint256 amount) external nonReentrant onlyRole(REWARDER_ROLE) notZero(amount) {

138:   function rescueTokens(address token, uint256 amount, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

148:   function redistributeLockedAmount(address from, address to) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[89](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L89), [138](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L138), [148](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L148)]


```solidity
File: contracts/StakedUSDeV2.sol

126:   function setCooldownDuration(uint24 duration) external onlyRole(DEFAULT_ADMIN_ROLE) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L126)]


```solidity
File: contracts/USDe.sol

23:   function setMinter(address newMinter) external onlyOwner {

33:   function renounceOwnership() public view override onlyOwner {

```
*Github:* [[23](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L23), [33](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L33)]


```solidity
File: contracts/USDeSilo.sol

28:   function withdraw(address to, uint256 amount) external onlyStakingVault {

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDeSilo.sol#L28)]


</details>


<a name="GAS-39"></a> 
### [GAS-39] `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too)
*Saves 5 gas per loop*

*There are <b>2</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

126:     for (uint256 i = 0; i < _assets.length; i++) {

130:     for (uint256 j = 0; j < _custodians.length; j++) {

```
*Github:* [[126](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L126), [130](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L130)]



<a name="GAS-40"></a> 
### [GAS-40] Use `!= 0` instead of `> 0` for unsigned integer comparison
Using `== 0`, `!= 0` instead of `> 0`, `>= 1`, `< 1`, `<= 0` can save gas.

*There are <b>3</b> instances of this issue:*
```solidity
File: contracts/EthenaMinting.sol

430:     if (remainingBalance > 0) {

```
*Github:* [[430](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L430)]


```solidity
File: contracts/StakedUSDe.sol

90:     if (getUnvestedAmount() > 0) revert StillVesting();

193:     if (_totalSupply > 0 && _totalSupply < MIN_SHARES) revert MinSharesViolation();

```
*Github:* [[90](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L90), [193](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L193)]



<a name="GAS-41"></a> 
### [GAS-41] Using assembly to check for zero can save gas
Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

<details>
<summary>
There are <b>23</b> instances (click to show):
</summary>

```solidity
File: contracts/EthenaMinting.sol

119:     if (address(_usde) == address(0)) revert InvalidUSDeAddress();

120:     if (_assets.length == 0) revert NoAssetsProvided();

121:     if (_admin == address(0)) revert InvalidZeroAddress();

248:     if (wallet == address(0) || !_custodianAddresses.contains(wallet)) revert InvalidAddress();

291:     if (asset == address(0) || asset == address(usde) || !_supportedAssets.add(asset)) {

299:     if (custodian == address(0) || custodian == address(usde) || !_custodianAddresses.add(custodian)) {

343:     if (order.beneficiary == address(0)) revert InvalidAmount();

344:     if (order.collateral_amount == 0) revert InvalidAmount();

345:     if (order.usde_amount == 0) revert InvalidAmount();

360:     if (route.addresses.length == 0) {

364:       if (!_custodianAddresses.contains(route.addresses[i]) || route.addresses[i] == address(0) || route.ratios[i] == 0)

364:       if (!_custodianAddresses.contains(route.addresses[i]) || route.addresses[i] == address(0) || route.ratios[i] == 0)

378:     if (nonce == 0) revert InvalidNonce();

383:     if (invalidator & invalidatorBit != 0) revert InvalidNonce();

```
*Github:* [[119](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L119), [120](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L120), [121](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L121), [248](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L248), [291](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L291), [299](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L299), [343](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L343), [344](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L344), [345](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L345), [360](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L360), [364](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L364), [364](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L364), [378](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L378), [383](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/EthenaMinting.sol#L383)]


```solidity
File: contracts/StakedUSDe.sol

51:     if (amount == 0) revert InvalidAmount();

75:     if (_owner == address(0) || _initialRewarder == address(0) || address(_asset) == address(0)) {

75:     if (_owner == address(0) || _initialRewarder == address(0) || address(_asset) == address(0)) {

75:     if (_owner == address(0) || _initialRewarder == address(0) || address(_asset) == address(0)) {

153:       if (to != address(0)) _mint(to, amountToDistribute);

246:     if (hasRole(FULL_RESTRICTED_STAKER_ROLE, from) && to != address(0)) {

```
*Github:* [[51](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L51), [75](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L75), [75](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L75), [75](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L75), [153](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L153), [246](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDe.sol#L246)]


```solidity
File: contracts/StakedUSDeV2.sol

28:     if (cooldownDuration != 0) revert OperationNotAllowed();

34:     if (cooldownDuration == 0) revert OperationNotAllowed();

```
*Github:* [[28](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L28), [34](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/StakedUSDeV2.sol#L34)]


```solidity
File: contracts/USDe.sol

19:     if (admin == address(0)) revert ZeroAddressException();

```
*Github:* [[19](https://github.com/code-423n4/2023-10-ethena/blob/75cfa2533af38a049bbe12e929bdcb9a3df0b100/contracts/USDe.sol#L19)]


</details>


